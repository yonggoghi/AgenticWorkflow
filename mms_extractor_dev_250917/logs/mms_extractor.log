2025-08-13 17:19:57,050 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 17:19:57,050 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 17:19:57,087 - __main__ - INFO - Using device: mps
2025-08-13 17:19:57,087 - __main__ - INFO - _initialize_device 실행완료: 0.04초
2025-08-13 17:19:57,281 - __main__ - INFO - LLM 초기화 완료: gpt (openai/gpt-4o-2024-11-20)
2025-08-13 17:19:57,282 - __main__ - INFO - _initialize_llm 실행완료: 0.19초
2025-08-13 17:19:57,282 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 17:19:57,282 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 17:19:57,282 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 17:19:58,361 - __main__ - INFO - Model loaded on mps
2025-08-13 17:19:58,361 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.08초
2025-08-13 17:19:58,776 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 17:19:58,776 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-08-13 17:19:58,776 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 17:19:58,900 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 17:19:59,199 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 17:19:59,200 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 17:19:59,263 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 17:19:59,263 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 17:19:59,265 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 17:19:59,265 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 17:19:59,425 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 17:19:59,897 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 17:19:59,897 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 17:19:59,897 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 17:19:59,897 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 17:19:59,897 - __main__ - INFO - 메시지 처리 시작
2025-08-13 17:19:59,897 - __main__ - INFO - 메시지 처리 시작: [LG유플러스] 인터넷 서비스 안내...
2025-08-13 17:20:00,411 - __main__ - INFO - Kiwi 추출 엔티티: ['LG유플러스']
2025-08-13 17:20:01,150 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.25초
2025-08-13 17:20:02,119 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:02,123 - __main__ - WARNING - LLM 호출 재시도 1/3: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:03,172 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:03,173 - __main__ - WARNING - LLM 호출 재시도 2/3: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:05,202 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:05,204 - __main__ - ERROR - LLM 호출 최종 실패: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:05,204 - __main__ - INFO - Fallback 추출 로직 실행
2025-08-13 17:20:05,206 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 17:20:05,458 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:05,459 - __main__ - WARNING - LLM 호출 재시도 1/3: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:06,500 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:06,501 - __main__ - WARNING - LLM 호출 재시도 2/3: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:08,532 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 403 Forbidden"
2025-08-13 17:20:08,533 - __main__ - ERROR - LLM 호출 최종 실패: Error code: 403 - {'error': {'message': 'Not allowed to use the requested model', 'type': 'forbidden', 'code': 'unauthorized'}}
2025-08-13 17:20:08,534 - __main__ - INFO - Fallback 추출 로직 실행
2025-08-13 17:20:09,024 - __main__ - INFO - extract_entities_by_llm 실행완료: 3.82초
2025-08-13 17:20:09,031 - __main__ - INFO - 메시지 처리 완료
2025-08-13 17:20:09,031 - __main__ - INFO - process_message 실행완료: 9.13초
2025-08-13 17:20:27,243 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 17:20:27,243 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 17:20:27,265 - __main__ - INFO - Using device: mps
2025-08-13 17:20:27,265 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 17:20:27,421 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 17:20:27,421 - __main__ - INFO - _initialize_llm 실행완료: 0.16초
2025-08-13 17:20:27,421 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 17:20:27,421 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 17:20:27,421 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 17:20:28,238 - __main__ - INFO - Model loaded on mps
2025-08-13 17:20:28,238 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.82초
2025-08-13 17:20:28,634 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 17:20:28,635 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 17:20:28,635 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 17:20:28,757 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 17:20:29,058 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 17:20:29,059 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 17:20:29,121 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 17:20:29,121 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 17:20:29,123 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 17:20:29,123 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 17:20:29,267 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 17:20:29,739 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 17:20:29,739 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 17:20:29,739 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-13 17:20:29,739 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 17:20:29,739 - __main__ - INFO - 메시지 처리 시작
2025-08-13 17:20:29,739 - __main__ - INFO - 메시지 처리 시작: [LG유플러스] 인터넷 서비스 안내...
2025-08-13 17:20:30,250 - __main__ - INFO - Kiwi 추출 엔티티: ['LG유플러스']
2025-08-13 17:20:31,001 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.26초
2025-08-13 17:20:34,363 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 17:20:34,376 - __main__ - INFO - LLM 추출 엔티티: ['인터넷 서비스']
2025-08-13 17:20:36,106 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 17:20:36,337 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.96초
2025-08-13 17:20:36,343 - __main__ - INFO - 메시지 처리 완료
2025-08-13 17:20:36,344 - __main__ - INFO - process_message 실행완료: 6.60초
2025-08-13 17:20:57,834 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 17:20:57,834 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 17:20:57,857 - __main__ - INFO - Using device: mps
2025-08-13 17:20:57,857 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 17:20:58,005 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 17:20:58,005 - __main__ - INFO - _initialize_llm 실행완료: 0.15초
2025-08-13 17:20:58,005 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 17:20:58,005 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 17:20:58,005 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 17:20:58,820 - __main__ - INFO - Model loaded on mps
2025-08-13 17:20:58,820 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.82초
2025-08-13 17:20:59,228 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 17:20:59,228 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 17:20:59,228 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 17:20:59,350 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 17:20:59,648 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 17:20:59,649 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 17:20:59,721 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 17:20:59,722 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 17:20:59,723 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 17:20:59,723 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 17:20:59,894 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 17:21:00,379 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 17:21:00,379 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 17:21:00,379 - __main__ - INFO - _load_data 실행완료: 1.15초
2025-08-13 17:21:00,379 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 17:21:00,379 - __main__ - INFO - 메시지 처리 시작
2025-08-13 17:21:00,379 - __main__ - INFO - 메시지 처리 시작: [LG유플러스] 인터넷 서비스 안내...
2025-08-13 17:21:00,891 - __main__ - INFO - Kiwi 추출 엔티티: ['LG유플러스']
2025-08-13 17:21:01,626 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.25초
2025-08-13 17:21:14,857 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 17:21:14,871 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 17:21:15,477 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 17:21:15,706 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.83초
2025-08-13 17:21:15,713 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 17:21:15,713 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 17:21:15,713 - __main__ - INFO - 메시지 처리 완료
2025-08-13 17:21:15,713 - __main__ - INFO - process_message 실행완료: 15.33초
2025-08-13 18:26:51,835 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:26:51,835 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:26:51,861 - __main__ - INFO - Using device: mps
2025-08-13 18:26:51,861 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-13 18:26:52,040 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:26:52,040 - __main__ - INFO - _initialize_llm 실행완료: 0.18초
2025-08-13 18:26:52,040 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:26:52,040 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:26:52,040 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:26:53,125 - __main__ - INFO - Model loaded on mps
2025-08-13 18:26:53,125 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.08초
2025-08-13 18:26:53,534 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:26:53,534 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:26:53,534 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:26:53,656 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:26:53,955 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:26:53,958 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:26:54,020 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:26:54,020 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:26:54,022 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:26:54,022 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:26:54,174 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:26:54,666 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:26:54,666 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:26:54,666 - __main__ - INFO - _load_data 실행완료: 1.13초
2025-08-13 18:26:54,666 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:26:54,666 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:26:54,666 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:26:55,188 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '0 day', '뚜레쥬르', '에이닷이빵쏜닷', '데일리', '베어유']
2025-08-13 18:26:57,300 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.63초
2025-08-13 18:27:15,519 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:27:15,533 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:27:16,671 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:27:17,013 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.48초
2025-08-13 18:27:17,020 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:27:17,020 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:27:17,020 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:27:17,020 - __main__ - INFO - process_message 실행완료: 22.35초
2025-08-13 18:28:22,988 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:28:22,988 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:28:23,009 - __main__ - INFO - Using device: mps
2025-08-13 18:28:23,009 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:28:23,199 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:28:23,199 - __main__ - INFO - _initialize_llm 실행완료: 0.19초
2025-08-13 18:28:23,199 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:28:23,199 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:28:23,199 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:28:24,115 - __main__ - INFO - Model loaded on mps
2025-08-13 18:28:24,115 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.92초
2025-08-13 18:28:24,517 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:28:24,517 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 18:28:24,517 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:28:24,636 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:28:24,939 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:28:24,940 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:28:24,998 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:28:24,998 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:28:25,000 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:28:25,000 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:28:25,144 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:28:25,619 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:28:25,619 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:28:25,619 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-13 18:28:25,619 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:28:25,619 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:28:25,620 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:28:26,100 - __main__ - INFO - Kiwi 추출 엔티티: ['베어유', '데일리', '0 day', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-08-13 18:28:28,069 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.45초
2025-08-13 18:28:46,304 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:28:46,313 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:28:47,262 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:28:47,600 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.29초
2025-08-13 18:28:47,606 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:28:47,606 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:28:47,607 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:28:47,607 - __main__ - INFO - process_message 실행완료: 21.99초
2025-08-13 18:31:07,471 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:31:07,471 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:31:07,537 - __main__ - INFO - Using device: mps
2025-08-13 18:31:07,537 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-13 18:31:09,057 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-08-13 18:31:09,057 - __main__ - INFO - _initialize_llm 실행완료: 1.52초
2025-08-13 18:31:09,057 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:31:09,058 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:31:09,058 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:31:14,983 - __main__ - INFO - Model loaded on mps
2025-08-13 18:31:14,983 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.93초
2025-08-13 18:31:15,455 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:31:15,455 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-08-13 18:31:15,455 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:31:15,581 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:31:15,888 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:31:15,896 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:31:15,953 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:31:15,953 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:31:15,963 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:31:15,963 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:31:16,154 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:31:16,657 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:31:16,657 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:31:16,657 - __main__ - INFO - _load_data 실행완료: 1.20초
2025-08-13 18:31:16,657 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:31:16,657 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:31:16,657 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:31:17,129 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '데일리', '베어유', '뚜레쥬르', '시크릿', '0 day']
2025-08-13 18:31:19,134 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.48초
2025-08-13 18:31:37,234 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:31:37,265 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:31:38,237 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:31:38,624 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.36초
2025-08-13 18:31:38,630 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:31:38,630 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:31:38,630 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:31:38,631 - __main__ - INFO - process_message 실행완료: 21.97초
2025-08-13 18:33:08,418 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:33:08,418 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:33:08,439 - __main__ - INFO - Using device: mps
2025-08-13 18:33:08,439 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:33:08,655 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-08-13 18:33:08,656 - __main__ - INFO - _initialize_llm 실행완료: 0.22초
2025-08-13 18:33:08,656 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:33:08,656 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:33:08,656 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:33:10,689 - __main__ - INFO - Model loaded on mps
2025-08-13 18:33:10,689 - __main__ - INFO - _initialize_embedding_model 실행완료: 2.03초
2025-08-13 18:33:11,090 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:33:11,090 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 18:33:11,090 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:33:11,212 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:33:11,513 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:33:11,514 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:33:11,570 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:33:11,570 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:33:11,572 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:33:11,572 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:33:11,709 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:33:12,182 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:33:12,182 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:33:12,182 - __main__ - INFO - _load_data 실행완료: 1.09초
2025-08-13 18:33:12,182 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:33:12,182 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:33:12,182 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:33:12,658 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '데일리', '뚜레쥬르', '0 day', '에이닷이빵쏜닷', '베어유']
2025-08-13 18:33:14,608 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.43초
2025-08-13 18:33:32,641 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:33:32,656 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:33:33,562 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:33:33,925 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.27초
2025-08-13 18:33:33,932 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:33:33,932 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:33:33,932 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:33:33,932 - __main__ - INFO - process_message 실행완료: 21.75초
2025-08-13 18:35:49,304 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:35:49,304 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:35:49,335 - __main__ - INFO - Using device: mps
2025-08-13 18:35:49,335 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-13 18:35:49,610 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:35:49,610 - __main__ - INFO - _initialize_llm 실행완료: 0.28초
2025-08-13 18:35:49,610 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:35:49,610 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:35:49,610 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:35:50,536 - __main__ - INFO - Model loaded on mps
2025-08-13 18:35:50,536 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.93초
2025-08-13 18:35:50,941 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:35:50,941 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:35:50,941 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:35:51,060 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:35:51,361 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:35:51,362 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:35:51,420 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:35:51,420 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:35:51,422 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:35:51,422 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:35:51,571 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:35:52,044 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:35:52,044 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:35:52,044 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-13 18:35:52,044 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:35:52,044 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:35:52,044 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:35:52,531 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리', '베어유']
2025-08-13 18:35:54,479 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.43초
2025-08-13 18:36:07,760 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:36:07,774 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:36:08,611 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:36:08,958 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.18초
2025-08-13 18:36:08,965 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:36:08,965 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:36:08,965 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:36:08,965 - __main__ - INFO - process_message 실행완료: 16.92초
2025-08-13 18:42:43,133 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:42:43,133 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:42:43,154 - __main__ - INFO - Using device: mps
2025-08-13 18:42:43,154 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:42:43,314 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:42:43,314 - __main__ - INFO - _initialize_llm 실행완료: 0.16초
2025-08-13 18:42:43,314 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:42:43,315 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:42:43,315 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:42:44,712 - __main__ - INFO - Model loaded on mps
2025-08-13 18:42:44,712 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.40초
2025-08-13 18:42:45,127 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:42:45,127 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:42:45,127 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:42:45,247 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:42:45,556 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:42:45,557 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:42:45,626 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:42:45,626 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:42:45,627 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:42:45,627 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:42:45,775 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:42:46,245 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:42:46,245 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:42:46,245 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 18:42:46,245 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:42:46,245 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:42:46,245 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:42:46,729 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '베어유', '에이닷이빵쏜닷', '시크릿', '데일리', '뚜레쥬르']
2025-08-13 18:42:48,774 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.53초
2025-08-13 18:43:06,826 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:43:06,838 - __main__ - ERROR - 메시지 처리 실패: 'str' object has no attribute 'keys'
2025-08-13 18:43:06,839 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1500, in process_message
    if "value" in json_objects_temp[k].keys():
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'keys'

2025-08-13 18:43:06,840 - __main__ - INFO - process_message 실행완료: 20.59초
2025-08-13 18:43:55,497 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:43:55,497 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:43:55,525 - __main__ - INFO - Using device: mps
2025-08-13 18:43:55,525 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-13 18:43:55,755 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:43:55,755 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-13 18:43:55,755 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:43:55,756 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:43:55,756 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:43:59,417 - __main__ - INFO - Model loaded on mps
2025-08-13 18:43:59,418 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.66초
2025-08-13 18:43:59,851 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:43:59,851 - __main__ - INFO - _initialize_kiwi 실행완료: 0.43초
2025-08-13 18:43:59,851 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:43:59,978 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:44:00,292 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:44:00,293 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:44:00,355 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:44:00,355 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:44:00,356 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:44:00,356 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:44:00,510 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:44:00,995 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:44:00,995 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:44:00,995 - __main__ - INFO - _load_data 실행완료: 1.14초
2025-08-13 18:44:00,995 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:44:00,995 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:44:00,995 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:44:01,500 - __main__ - INFO - Kiwi 추출 엔티티: ['베어유', '0 day', '뚜레쥬르', '에이닷이빵쏜닷', '데일리', '시크릿']
2025-08-13 18:44:03,448 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.45초
2025-08-13 18:44:21,452 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:44:21,476 - __main__ - ERROR - 메시지 처리 실패: 'str' object has no attribute 'keys'
2025-08-13 18:44:21,478 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1504, in process_message
    if "value" in json_objects_temp[k].keys():
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'keys'

2025-08-13 18:44:21,479 - __main__ - INFO - process_message 실행완료: 20.48초
2025-08-13 18:47:13,052 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:47:13,053 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:47:13,129 - __main__ - INFO - Using device: mps
2025-08-13 18:47:13,129 - __main__ - INFO - _initialize_device 실행완료: 0.07초
2025-08-13 18:47:16,027 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:47:16,027 - __main__ - INFO - _initialize_llm 실행완료: 2.90초
2025-08-13 18:47:16,027 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:47:16,028 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:47:16,028 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:47:24,562 - __main__ - INFO - Model loaded on mps
2025-08-13 18:47:24,563 - __main__ - INFO - _initialize_embedding_model 실행완료: 8.54초
2025-08-13 18:47:25,023 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:47:25,024 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-08-13 18:47:25,024 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:47:25,150 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:47:25,456 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:47:25,463 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:47:25,520 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:47:25,520 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:47:25,530 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:47:25,530 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:47:25,742 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:47:26,240 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:47:26,241 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:47:26,241 - __main__ - INFO - _load_data 실행완료: 1.22초
2025-08-13 18:47:26,241 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:47:26,241 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:47:26,241 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:47:26,729 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '베어유', '0 day', '에이닷이빵쏜닷', '시크릿', '데일리']
2025-08-13 18:47:28,741 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.50초
2025-08-13 18:47:42,175 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:47:42,190 - __main__ - ERROR - 메시지 처리 실패: 'str' object has no attribute 'keys'
2025-08-13 18:47:42,191 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1504, in process_message
    if "value" in json_objects_temp[k].keys():
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'keys'

2025-08-13 18:47:42,191 - __main__ - INFO - process_message 실행완료: 15.95초
2025-08-13 18:48:51,022 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:48:51,022 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:48:51,043 - __main__ - INFO - Using device: mps
2025-08-13 18:48:51,043 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:48:51,223 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:48:51,223 - __main__ - INFO - _initialize_llm 실행완료: 0.18초
2025-08-13 18:48:51,223 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:48:51,224 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:48:51,224 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:48:52,188 - __main__ - INFO - Model loaded on mps
2025-08-13 18:48:52,188 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.97초
2025-08-13 18:48:52,599 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:48:52,599 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:48:52,599 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:48:52,720 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:48:53,023 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:48:53,025 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:48:53,083 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:48:53,083 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:48:53,084 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:48:53,084 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:48:53,221 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:48:53,692 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:48:53,692 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:48:53,692 - __main__ - INFO - _load_data 실행완료: 1.09초
2025-08-13 18:48:53,692 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:48:53,692 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:48:53,692 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:48:54,169 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '0 day', '뚜레쥬르', '베어유', '데일리', '에이닷이빵쏜닷']
2025-08-13 18:48:56,223 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.53초
2025-08-13 18:49:09,486 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:49:09,500 - __main__ - ERROR - 메시지 처리 실패: expected string or bytes-like object, got 'dict'
2025-08-13 18:49:09,523 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1498, in process_message
    json_objects_temp = extract_json_objects(json_objects_list[0])[0]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 223, in extract_json_objects
    for match in re.finditer(pattern, text):
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/re/__init__.py", line 224, in finditer
    return _compile(pattern, flags).finditer(string)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: expected string or bytes-like object, got 'dict'

2025-08-13 18:49:09,524 - __main__ - INFO - process_message 실행완료: 15.83초
2025-08-13 18:50:50,810 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:50:50,811 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:50:50,829 - __main__ - INFO - Using device: mps
2025-08-13 18:50:50,829 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:50:50,975 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:50:50,975 - __main__ - INFO - _initialize_llm 실행완료: 0.15초
2025-08-13 18:50:50,975 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:50:50,976 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:50:50,976 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:50:51,735 - __main__ - INFO - Model loaded on mps
2025-08-13 18:50:51,735 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.76초
2025-08-13 18:50:52,136 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:50:52,136 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 18:50:52,136 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:50:52,256 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:50:52,564 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:50:52,565 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:50:52,623 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:50:52,623 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:50:52,624 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:50:52,624 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:50:52,782 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:50:53,261 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:50:53,261 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:50:53,261 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 18:50:53,261 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:50:53,261 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:50:53,261 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:50:53,749 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '베어유', '0 day', '데일리', '시크릿', '에이닷이빵쏜닷']
2025-08-13 18:50:55,756 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.50초
2025-08-13 18:51:10,131 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:51:10,146 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 18:51:11,197 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:51:11,621 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.47초
2025-08-13 18:51:11,629 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:51:11,629 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 18:51:11,629 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:51:11,629 - __main__ - INFO - process_message 실행완료: 18.37초
2025-08-13 18:51:55,562 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:51:55,562 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:51:55,590 - __main__ - INFO - Using device: mps
2025-08-13 18:51:55,590 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-13 18:51:55,913 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:51:55,913 - __main__ - INFO - _initialize_llm 실행완료: 0.32초
2025-08-13 18:51:55,913 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:51:55,913 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:51:55,913 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:51:56,858 - __main__ - INFO - Model loaded on mps
2025-08-13 18:51:56,858 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.95초
2025-08-13 18:51:57,306 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:51:57,306 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-08-13 18:51:57,306 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:51:57,434 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:51:57,735 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:51:57,737 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:51:57,795 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:51:57,795 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:51:57,797 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:51:57,797 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:51:57,948 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:51:58,425 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:51:58,425 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:51:58,425 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 18:51:58,425 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:51:58,425 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:51:58,425 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:51:58,902 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '에이닷이빵쏜닷', '베어유', '뚜레쥬르', '시크릿', '데일리']
2025-08-13 18:52:00,868 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.44초
2025-08-13 18:52:16,110 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:52:16,131 - __main__ - ERROR - 최종 결과 구성 실패: 'list' object has no attribute 'get'
2025-08-13 18:52:16,132 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:52:16,132 - __main__ - ERROR - 결과 검증 실패: list indices must be integers or slices, not str
2025-08-13 18:52:16,132 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:52:16,132 - __main__ - INFO - process_message 실행완료: 17.71초
2025-08-13 18:52:16,133 - __main__ - ERROR - 실행 실패: 'list' object has no attribute 'get'
2025-08-13 18:52:16,136 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1686, in main
    print(f"✅ 제목: {result.get('title', 'N/A')}")
                      ^^^^^^^^^^
AttributeError: 'list' object has no attribute 'get'

2025-08-13 18:54:41,309 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:54:41,309 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:54:41,328 - __main__ - INFO - Using device: mps
2025-08-13 18:54:41,328 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:54:41,483 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:54:41,484 - __main__ - INFO - _initialize_llm 실행완료: 0.16초
2025-08-13 18:54:41,484 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:54:41,484 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:54:41,484 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:54:42,343 - __main__ - INFO - Model loaded on mps
2025-08-13 18:54:42,343 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-08-13 18:54:42,741 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:54:42,741 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 18:54:42,741 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:54:42,857 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:54:43,156 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:54:43,157 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:54:43,213 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:54:43,213 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:54:43,214 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:54:43,214 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:54:43,361 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:54:43,833 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:54:43,833 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:54:43,833 - __main__ - INFO - _load_data 실행완료: 1.09초
2025-08-13 18:54:43,833 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:54:43,834 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:54:43,834 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:54:44,314 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '베어유', '데일리', '에이닷이빵쏜닷', '뚜레쥬르', '0 day']
2025-08-13 18:54:48,101 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 4.27초
2025-08-13 18:54:56,985 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:54:56,996 - __main__ - ERROR - 최종 결과 구성 실패: 'list' object has no attribute 'get'
2025-08-13 18:54:56,996 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 18:54:56,996 - __main__ - ERROR - 결과 검증 실패: list indices must be integers or slices, not str
2025-08-13 18:54:56,996 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:54:56,997 - __main__ - INFO - process_message 실행완료: 13.16초
2025-08-13 18:54:56,997 - __main__ - ERROR - 실행 실패: 'list' object has no attribute 'get'
2025-08-13 18:54:56,998 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 1686, in main
    print(f"✅ 제목: {result.get('title', 'N/A')}")
                      ^^^^^^^^^^
AttributeError: 'list' object has no attribute 'get'

2025-08-13 18:56:48,879 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:56:48,879 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:56:48,900 - __main__ - INFO - Using device: mps
2025-08-13 18:56:48,901 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:56:49,059 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 18:56:49,059 - __main__ - INFO - _initialize_llm 실행완료: 0.16초
2025-08-13 18:56:49,059 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:56:49,059 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:56:49,059 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:56:49,955 - __main__ - INFO - Model loaded on mps
2025-08-13 18:56:49,955 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.90초
2025-08-13 18:56:50,366 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:56:50,366 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:56:50,366 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:56:50,487 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:56:50,787 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:56:50,788 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:56:50,845 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:56:50,846 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:56:50,847 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:56:50,847 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:56:50,994 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:56:51,483 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:56:51,483 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:56:51,483 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 18:56:51,483 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:56:51,483 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:56:51,483 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:56:51,975 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '데일리', '0 day', '에이닷이빵쏜닷', '뚜레쥬르', '베어유']
2025-08-13 18:56:53,949 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.47초
2025-08-13 18:57:02,081 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:57:02,093 - __main__ - INFO - LLM 추출 엔티티: ['0 day', '베어유', 'T 멤버십', '뚜레쥬르 데일리우유식빵']
2025-08-13 18:57:03,002 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:57:03,326 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.23초
2025-08-13 18:57:03,334 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:57:03,334 - __main__ - INFO - process_message 실행완료: 11.85초
2025-08-13 18:57:50,055 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:57:50,055 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:57:50,077 - __main__ - INFO - Using device: mps
2025-08-13 18:57:50,078 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:57:50,309 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-08-13 18:57:50,309 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-13 18:57:50,309 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:57:50,309 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:57:50,309 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:57:52,854 - __main__ - INFO - Model loaded on mps
2025-08-13 18:57:52,854 - __main__ - INFO - _initialize_embedding_model 실행완료: 2.55초
2025-08-13 18:57:53,264 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:57:53,264 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 18:57:53,264 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:57:53,386 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:57:53,691 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:57:53,692 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:57:53,749 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:57:53,749 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:57:53,751 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:57:53,751 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:57:53,894 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:57:54,367 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:57:54,367 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:57:54,367 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-13 18:57:54,367 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:57:54,367 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:57:54,367 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:57:54,845 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '에이닷이빵쏜닷', '데일리', '0 day', '뚜레쥬르', '베어유']
2025-08-13 18:57:56,794 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.43초
2025-08-13 18:58:04,988 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:58:05,001 - __main__ - INFO - LLM 추출 엔티티: ['0 day', '베어유', 'T 멤버십', '뚜레쥬르 데일리우유식빵']
2025-08-13 18:58:05,908 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:58:06,237 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.23초
2025-08-13 18:58:06,244 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:58:06,244 - __main__ - INFO - process_message 실행완료: 11.88초
2025-08-13 18:58:51,259 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 18:58:51,259 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 18:58:51,279 - __main__ - INFO - Using device: mps
2025-08-13 18:58:51,279 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 18:58:51,446 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-08-13 18:58:51,447 - __main__ - INFO - _initialize_llm 실행완료: 0.17초
2025-08-13 18:58:51,447 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 18:58:51,447 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 18:58:51,447 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 18:58:53,977 - __main__ - INFO - Model loaded on mps
2025-08-13 18:58:53,977 - __main__ - INFO - _initialize_embedding_model 실행완료: 2.53초
2025-08-13 18:58:54,740 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 18:58:54,740 - __main__ - INFO - _initialize_kiwi 실행완료: 0.76초
2025-08-13 18:58:54,740 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 18:58:54,890 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 18:58:55,225 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 18:58:55,226 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 18:58:55,286 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 18:58:55,286 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 18:58:55,288 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 18:58:55,288 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 18:58:55,491 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 18:58:55,995 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 18:58:55,995 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 18:58:55,996 - __main__ - INFO - _load_data 실행완료: 1.26초
2025-08-13 18:58:55,996 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 18:58:55,996 - __main__ - INFO - 메시지 처리 시작
2025-08-13 18:58:55,996 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 18:58:56,483 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '0 day', '베어유', '시크릿', '데일리', '뚜레쥬르']
2025-08-13 18:58:58,467 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.47초
2025-08-13 18:59:06,428 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:59:06,440 - __main__ - INFO - LLM 추출 엔티티: ['0 day', '베어유', 'T 멤버십', '뚜레쥬르 데일리우유식빵']
2025-08-13 18:59:07,464 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 18:59:07,841 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.40초
2025-08-13 18:59:07,848 - __main__ - INFO - 메시지 처리 완료
2025-08-13 18:59:07,849 - __main__ - INFO - process_message 실행완료: 11.85초
2025-08-13 19:02:06,477 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:02:06,477 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:02:06,542 - __main__ - INFO - Using device: mps
2025-08-13 19:02:06,542 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-13 19:02:08,143 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-08-13 19:02:08,143 - __main__ - INFO - _initialize_llm 실행완료: 1.60초
2025-08-13 19:02:08,143 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:02:08,144 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:02:08,144 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:02:12,858 - __main__ - INFO - Model loaded on mps
2025-08-13 19:02:12,858 - __main__ - INFO - _initialize_embedding_model 실행완료: 4.71초
2025-08-13 19:02:13,345 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:02:13,345 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-08-13 19:02:13,345 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:02:13,476 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:02:13,828 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:02:13,831 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:02:13,895 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:02:13,895 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:02:13,906 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:02:13,906 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:02:14,140 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:02:14,680 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:02:14,680 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:02:14,680 - __main__ - INFO - _load_data 실행완료: 1.33초
2025-08-13 19:02:14,680 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:02:14,680 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:02:14,680 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:02:15,190 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '에이닷이빵쏜닷', '0 day', '베어유', '시크릿', '데일리']
2025-08-13 19:02:17,249 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.57초
2025-08-13 19:02:24,291 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:02:24,304 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:02:25,241 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:02:25,636 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.33초
2025-08-13 19:02:25,643 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:02:25,643 - __main__ - INFO - process_message 실행완료: 10.96초
2025-08-13 19:02:50,773 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:02:50,773 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:02:50,793 - __main__ - INFO - Using device: mps
2025-08-13 19:02:50,793 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:02:51,025 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:02:51,025 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-13 19:02:51,026 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:02:51,026 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:02:51,026 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:02:53,491 - __main__ - INFO - Model loaded on mps
2025-08-13 19:02:53,491 - __main__ - INFO - _initialize_embedding_model 실행완료: 2.47초
2025-08-13 19:02:53,901 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:02:53,901 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 19:02:53,901 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:02:54,022 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:02:54,326 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:02:54,327 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:02:54,385 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:02:54,385 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:02:54,386 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:02:54,386 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:02:54,532 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:02:55,020 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:02:55,021 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:02:55,021 - __main__ - INFO - _load_data 실행완료: 1.12초
2025-08-13 19:02:55,021 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:02:55,021 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:02:55,021 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:02:55,507 - __main__ - INFO - Kiwi 추출 엔티티: ['데일리', '베어유', '뚜레쥬르', '에이닷이빵쏜닷', '0 day', '시크릿']
2025-08-13 19:02:57,455 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.43초
2025-08-13 19:03:08,108 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:03:08,123 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 19:03:09,031 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:03:09,373 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.25초
2025-08-13 19:03:09,380 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 19:03:09,381 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 19:03:09,381 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:03:09,381 - __main__ - INFO - process_message 실행완료: 14.36초
2025-08-13 19:04:28,795 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:04:28,795 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:04:28,817 - __main__ - INFO - Using device: mps
2025-08-13 19:04:28,817 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:04:29,014 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:04:29,014 - __main__ - INFO - _initialize_llm 실행완료: 0.20초
2025-08-13 19:04:29,014 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:04:29,014 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:04:29,014 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:04:31,552 - __main__ - INFO - Model loaded on mps
2025-08-13 19:04:31,552 - __main__ - INFO - _initialize_embedding_model 실행완료: 2.54초
2025-08-13 19:04:31,966 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:04:31,966 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 19:04:31,966 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:04:32,087 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:04:32,388 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:04:32,389 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:04:32,447 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:04:32,447 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:04:32,448 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:04:32,448 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:04:32,591 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:04:33,065 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:04:33,066 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:04:33,066 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-13 19:04:33,066 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:04:33,066 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:04:33,066 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:04:33,585 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '데일리', '베어유', '에이닷이빵쏜닷', '시크릿', '0 day']
2025-08-13 19:04:35,557 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.49초
2025-08-13 19:04:43,344 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:04:43,356 - __main__ - INFO - LLM 추출 엔티티: ['0 day', '베어유', 'T 멤버십', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:04:44,337 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:04:44,720 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.36초
2025-08-13 19:04:44,727 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:04:44,727 - __main__ - INFO - process_message 실행완료: 11.66초
2025-08-13 19:05:32,574 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:05:32,574 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:05:32,600 - __main__ - INFO - Using device: mps
2025-08-13 19:05:32,600 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:05:32,767 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:05:32,768 - __main__ - INFO - _initialize_llm 실행완료: 0.17초
2025-08-13 19:05:32,768 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:05:32,768 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:05:32,768 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:05:33,686 - __main__ - INFO - Model loaded on mps
2025-08-13 19:05:33,686 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.92초
2025-08-13 19:05:34,091 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:05:34,091 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-13 19:05:34,091 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:05:34,213 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:05:34,519 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:05:34,520 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:05:34,599 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:05:34,599 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:05:34,600 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:05:34,600 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:05:34,789 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:05:35,270 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:05:35,270 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:05:35,270 - __main__ - INFO - _load_data 실행완료: 1.18초
2025-08-13 19:05:35,270 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:05:35,270 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:05:35,270 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:05:35,831 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '에이닷이빵쏜닷', '시크릿', '0 day', '데일리', '베어유']
2025-08-13 19:05:38,349 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 3.08초
2025-08-13 19:05:45,331 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:05:45,345 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:05:46,329 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:05:46,743 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.40초
2025-08-13 19:05:46,751 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:05:46,751 - __main__ - INFO - process_message 실행완료: 11.48초
2025-08-13 19:17:40,449 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:17:40,449 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:17:40,519 - __main__ - INFO - Using device: mps
2025-08-13 19:17:40,519 - __main__ - INFO - _initialize_device 실행완료: 0.07초
2025-08-13 19:17:42,406 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:17:42,407 - __main__ - INFO - _initialize_llm 실행완료: 1.89초
2025-08-13 19:17:42,407 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:17:42,408 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:17:42,408 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:17:47,576 - __main__ - INFO - Model loaded on mps
2025-08-13 19:17:47,576 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.17초
2025-08-13 19:17:48,121 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:17:48,122 - __main__ - INFO - _initialize_kiwi 실행완료: 0.55초
2025-08-13 19:17:48,122 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:17:48,275 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:17:48,594 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:17:48,604 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:17:48,661 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:17:48,661 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:17:48,672 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:17:48,672 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:17:48,934 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:17:49,439 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:17:49,439 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:17:49,439 - __main__ - INFO - _load_data 실행완료: 1.32초
2025-08-13 19:17:49,439 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:17:49,439 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:17:49,439 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:17:49,930 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '베어유', '뚜레쥬르', '데일리', '시크릿', '0 day']
2025-08-13 19:17:51,968 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.53초
2025-08-13 19:18:00,042 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:18:00,058 - __main__ - INFO - LLM 추출 엔티티: ['0 day', '베어유', 'T 멤버십', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:18:00,931 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:18:01,299 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.24초
2025-08-13 19:18:01,306 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:18:01,306 - __main__ - INFO - process_message 실행완료: 11.87초
2025-08-13 19:18:25,465 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:18:25,465 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:18:25,482 - __main__ - INFO - Using device: mps
2025-08-13 19:18:25,482 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:18:25,683 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:18:25,683 - __main__ - INFO - _initialize_llm 실행완료: 0.20초
2025-08-13 19:18:25,683 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:18:25,683 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:18:25,683 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:18:26,592 - __main__ - INFO - Model loaded on mps
2025-08-13 19:18:26,592 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.91초
2025-08-13 19:18:26,992 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:18:26,992 - __main__ - INFO - _initialize_kiwi 실행완료: 0.40초
2025-08-13 19:18:26,992 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:18:27,112 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:18:27,414 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:18:27,415 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:18:27,473 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:18:27,473 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:18:27,474 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:18:27,474 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:18:27,623 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:18:28,102 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:18:28,102 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:18:28,102 - __main__ - INFO - _load_data 실행완료: 1.11초
2025-08-13 19:18:28,102 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:18:28,102 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:18:28,102 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:18:28,601 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '0 day', '베어유', '데일리', '에이닷이빵쏜닷', '뚜레쥬르']
2025-08-13 19:18:30,594 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.49초
2025-08-13 19:18:37,572 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:18:37,591 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:18:38,442 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:18:38,813 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.22초
2025-08-13 19:18:38,820 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:18:38,820 - __main__ - INFO - process_message 실행완료: 10.72초
2025-08-13 19:19:01,770 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:19:01,770 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:19:01,793 - __main__ - INFO - Using device: mps
2025-08-13 19:19:01,793 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:19:01,959 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:19:01,959 - __main__ - INFO - _initialize_llm 실행완료: 0.17초
2025-08-13 19:19:01,959 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:19:01,959 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:19:01,959 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:19:02,995 - __main__ - INFO - Model loaded on mps
2025-08-13 19:19:02,996 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.04초
2025-08-13 19:19:03,523 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:19:03,523 - __main__ - INFO - _initialize_kiwi 실행완료: 0.53초
2025-08-13 19:19:03,523 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:19:03,667 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:19:04,001 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:19:04,003 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:19:04,071 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:19:04,071 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:19:04,073 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:19:04,073 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:19:04,285 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:19:04,833 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:19:04,834 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:19:04,834 - __main__ - INFO - _load_data 실행완료: 1.31초
2025-08-13 19:19:04,834 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:19:04,834 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:19:04,834 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:19:05,332 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '0 day', '에이닷이빵쏜닷', '베어유', '뚜레쥬르', '데일리']
2025-08-13 19:19:07,413 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.58초
2025-08-13 19:19:17,670 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:19:17,679 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 19:19:18,533 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:19:18,936 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.26초
2025-08-13 19:19:18,943 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 19:19:18,943 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 19:19:18,943 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:19:18,944 - __main__ - INFO - process_message 실행완료: 14.11초
2025-08-13 19:19:52,642 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:19:52,642 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:19:52,665 - __main__ - INFO - Using device: mps
2025-08-13 19:19:52,665 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:19:52,862 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:19:52,862 - __main__ - INFO - _initialize_llm 실행완료: 0.20초
2025-08-13 19:19:52,862 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:19:52,862 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:19:52,862 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:19:54,049 - __main__ - INFO - Model loaded on mps
2025-08-13 19:19:54,050 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.19초
2025-08-13 19:19:54,502 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:19:54,502 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-08-13 19:19:54,502 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:19:54,628 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:19:54,933 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:19:54,935 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:19:54,993 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:19:54,993 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:19:54,995 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:19:54,995 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:19:55,164 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:19:55,644 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:19:55,644 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:19:55,644 - __main__ - INFO - _load_data 실행완료: 1.14초
2025-08-13 19:19:55,644 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:19:55,645 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:19:55,645 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:19:56,139 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '데일리', '뚜레쥬르', '0 day', '베어유']
2025-08-13 19:19:58,142 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.50초
2025-08-13 19:20:05,059 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:20:05,077 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:20:06,045 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:20:06,452 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.38초
2025-08-13 19:20:06,460 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:20:06,460 - __main__ - INFO - process_message 실행완료: 10.82초
2025-08-13 19:20:25,370 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:20:25,371 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:20:25,391 - __main__ - INFO - Using device: mps
2025-08-13 19:20:25,391 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:20:25,565 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:20:25,565 - __main__ - INFO - _initialize_llm 실행완료: 0.17초
2025-08-13 19:20:25,565 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:20:25,565 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:20:25,565 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:20:26,517 - __main__ - INFO - Model loaded on mps
2025-08-13 19:20:26,517 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.95초
2025-08-13 19:20:26,954 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:20:26,954 - __main__ - INFO - _initialize_kiwi 실행완료: 0.44초
2025-08-13 19:20:26,954 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:20:27,079 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:20:27,385 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:20:27,387 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:20:27,445 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:20:27,445 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:20:27,447 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:20:27,447 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:20:27,617 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:20:28,101 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:20:28,101 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:20:28,101 - __main__ - INFO - _load_data 실행완료: 1.15초
2025-08-13 19:20:28,101 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:20:28,101 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:20:28,101 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:20:28,594 - __main__ - INFO - Kiwi 추출 엔티티: ['베어유', '0 day', '에이닷이빵쏜닷', '데일리', '뚜레쥬르', '시크릿']
2025-08-13 19:20:30,556 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.45초
2025-08-13 19:20:40,746 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:20:40,759 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 19:20:41,624 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:20:41,980 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.22초
2025-08-13 19:20:41,987 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 19:20:41,987 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 19:20:41,987 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:20:41,987 - __main__ - INFO - process_message 실행완료: 13.89초
2025-08-13 19:21:13,195 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:21:13,195 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:21:13,216 - __main__ - INFO - Using device: mps
2025-08-13 19:21:13,216 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-13 19:21:13,563 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:21:13,563 - __main__ - INFO - _initialize_llm 실행완료: 0.35초
2025-08-13 19:21:13,563 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:21:13,563 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:21:13,563 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:21:14,412 - __main__ - INFO - Model loaded on mps
2025-08-13 19:21:14,412 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.85초
2025-08-13 19:21:14,831 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:21:14,831 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-08-13 19:21:14,831 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:21:14,956 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:21:15,264 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:21:15,265 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:21:15,324 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:21:15,324 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:21:15,326 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:21:15,326 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:21:15,522 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:21:16,029 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:21:16,029 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:21:16,029 - __main__ - INFO - _load_data 실행완료: 1.20초
2025-08-13 19:21:16,029 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:21:16,029 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:21:16,029 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:21:16,574 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '에이닷이빵쏜닷', '베어유', '뚜레쥬르', '시크릿', '데일리']
2025-08-13 19:21:18,592 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.56초
2025-08-13 19:21:28,762 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:21:28,779 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-13 19:21:29,743 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:21:30,180 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.40초
2025-08-13 19:21:30,186 - __main__ - WARNING - 필수 필드 누락: title
2025-08-13 19:21:30,186 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-13 19:21:30,186 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:21:30,186 - __main__ - INFO - process_message 실행완료: 14.16초
2025-08-13 19:22:39,224 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-13 19:22:39,224 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-13 19:22:39,284 - __main__ - INFO - Using device: mps
2025-08-13 19:22:39,285 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-13 19:22:40,540 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-13 19:22:40,540 - __main__ - INFO - _initialize_llm 실행완료: 1.26초
2025-08-13 19:22:40,540 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-13 19:22:40,541 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-13 19:22:40,541 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-13 19:22:45,766 - __main__ - INFO - Model loaded on mps
2025-08-13 19:22:45,766 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.23초
2025-08-13 19:22:46,282 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-13 19:22:46,282 - __main__ - INFO - _initialize_kiwi 실행완료: 0.52초
2025-08-13 19:22:46,282 - __main__ - INFO - 데이터 로딩 시작
2025-08-13 19:22:46,404 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-13 19:22:46,751 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-13 19:22:46,753 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-13 19:22:46,811 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-13 19:22:46,811 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-13 19:22:46,813 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-13 19:22:46,813 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-13 19:22:48,551 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-13 19:22:49,021 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-13 19:22:49,021 - __main__ - INFO - 데이터 로딩 완료
2025-08-13 19:22:49,021 - __main__ - INFO - _load_data 실행완료: 2.74초
2025-08-13 19:22:49,021 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-13 19:22:49,021 - __main__ - INFO - 메시지 처리 시작
2025-08-13 19:22:49,021 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-13 19:22:49,510 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '0 day', '베어유', '시크릿', '데일리']
2025-08-13 19:22:51,069 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.05초
2025-08-13 19:22:59,135 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:22:59,145 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-13 19:23:00,132 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-13 19:23:00,417 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.27초
2025-08-13 19:23:00,424 - __main__ - INFO - 메시지 처리 완료
2025-08-13 19:23:00,424 - __main__ - INFO - process_message 실행완료: 11.40초
2025-08-14 08:46:01,826 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:46:01,826 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:46:01,869 - __main__ - INFO - Using device: mps
2025-08-14 08:46:01,869 - __main__ - INFO - _initialize_device 실행완료: 0.04초
2025-08-14 08:46:02,880 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:46:02,880 - __main__ - INFO - _initialize_llm 실행완료: 1.01초
2025-08-14 08:46:02,880 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:46:02,881 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:46:02,881 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:46:06,712 - __main__ - INFO - Model loaded on mps
2025-08-14 08:46:06,712 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.83초
2025-08-14 08:46:07,206 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:46:07,206 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-08-14 08:46:07,207 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:46:07,339 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:46:07,677 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:46:07,685 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:46:07,743 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:46:07,743 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:46:07,756 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:46:07,756 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:46:07,965 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:46:08,469 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:46:08,469 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:46:08,469 - __main__ - INFO - _load_data 실행완료: 1.26초
2025-08-14 08:46:08,469 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:46:08,469 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:46:08,469 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:46:09,004 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '에이닷이빵쏜닷', '베어유', '데일리', '뚜레쥬르', '시크릿']
2025-08-14 08:46:10,706 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.24초
2025-08-14 08:46:17,883 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:46:17,896 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 08:46:19,316 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:46:19,601 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.70초
2025-08-14 08:46:19,607 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:46:19,607 - __main__ - INFO - process_message 실행완료: 11.14초
2025-08-14 08:46:33,341 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:46:33,341 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:46:33,366 - __main__ - INFO - Using device: mps
2025-08-14 08:46:33,366 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-14 08:46:33,632 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:46:33,632 - __main__ - INFO - _initialize_llm 실행완료: 0.27초
2025-08-14 08:46:33,632 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:46:33,633 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:46:33,633 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:46:34,852 - __main__ - INFO - Model loaded on mps
2025-08-14 08:46:34,852 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.22초
2025-08-14 08:46:35,398 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:46:35,398 - __main__ - INFO - _initialize_kiwi 실행완료: 0.55초
2025-08-14 08:46:35,398 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:46:35,530 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:46:35,870 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:46:35,872 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:46:35,930 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:46:35,930 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:46:35,931 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:46:35,931 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:46:36,070 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:46:36,540 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:46:36,540 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:46:36,540 - __main__ - INFO - _load_data 실행완료: 1.14초
2025-08-14 08:46:36,540 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:46:36,540 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:46:36,540 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:46:37,034 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '데일리', '뚜레쥬르', '0 day', '시크릿', '베어유']
2025-08-14 08:46:38,613 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.07초
2025-08-14 08:46:48,942 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:46:48,956 - __main__ - INFO - LLM 추출 엔티티: []
2025-08-14 08:46:49,865 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:46:50,147 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.19초
2025-08-14 08:46:50,153 - __main__ - WARNING - 필수 필드 누락: title
2025-08-14 08:46:50,153 - __main__ - WARNING - 필수 필드 누락: purpose
2025-08-14 08:46:50,153 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:46:50,153 - __main__ - INFO - process_message 실행완료: 13.61초
2025-08-14 08:47:30,912 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:47:30,912 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:47:30,935 - __main__ - INFO - Using device: mps
2025-08-14 08:47:30,936 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-14 08:47:31,161 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:47:31,161 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-14 08:47:31,161 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:47:31,162 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:47:31,162 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:47:31,876 - __main__ - INFO - Model loaded on mps
2025-08-14 08:47:31,876 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.71초
2025-08-14 08:47:32,299 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:47:32,299 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-08-14 08:47:32,299 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:47:32,423 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:47:32,765 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:47:32,766 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:47:32,826 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:47:32,826 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:47:32,826 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:47:32,826 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:47:32,949 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:47:33,455 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:47:33,455 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:47:33,455 - __main__ - INFO - _load_data 실행완료: 1.16초
2025-08-14 08:47:33,455 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:47:33,455 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:47:33,455 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:47:33,940 - __main__ - INFO - Kiwi 추출 엔티티: ['뚜레쥬르', '시크릿', '에이닷이빵쏜닷', '데일리', '0 day', '베어유']
2025-08-14 08:47:35,477 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.02초
2025-08-14 08:47:42,625 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:47:42,638 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 08:47:43,671 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:47:43,955 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.32초
2025-08-14 08:47:43,962 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:47:43,962 - __main__ - INFO - process_message 실행완료: 10.51초
2025-08-14 08:47:51,658 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:47:51,658 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:47:51,685 - __main__ - INFO - Using device: mps
2025-08-14 08:47:51,685 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 08:47:51,915 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:47:51,916 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-14 08:47:51,916 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:47:51,916 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:47:51,916 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:47:52,739 - __main__ - INFO - Model loaded on mps
2025-08-14 08:47:52,739 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.82초
2025-08-14 08:47:53,133 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:47:53,133 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-14 08:47:53,133 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:47:53,251 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:47:53,584 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:47:53,585 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:47:53,643 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:47:53,643 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:47:53,645 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:47:53,645 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:47:53,770 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:47:54,240 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:47:54,240 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:47:54,240 - __main__ - INFO - _load_data 실행완료: 1.11초
2025-08-14 08:47:54,240 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:47:54,240 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:47:54,240 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:47:54,724 - __main__ - INFO - Kiwi 추출 엔티티: ['데일리', '뚜레쥬르', '시크릿', '에이닷이빵쏜닷', '0 day', '베어유']
2025-08-14 08:47:56,289 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.05초
2025-08-14 08:48:03,179 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:48:03,196 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 08:48:04,118 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:48:04,406 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.21초
2025-08-14 08:48:04,413 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:48:04,413 - __main__ - INFO - process_message 실행완료: 10.17초
2025-08-14 08:50:32,863 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:50:32,863 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:50:32,945 - __main__ - INFO - Using device: mps
2025-08-14 08:50:32,945 - __main__ - INFO - _initialize_device 실행완료: 0.08초
2025-08-14 08:50:34,478 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:50:34,479 - __main__ - INFO - _initialize_llm 실행완료: 1.53초
2025-08-14 08:50:34,479 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:50:34,480 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:50:34,480 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:50:39,836 - __main__ - INFO - Model loaded on mps
2025-08-14 08:50:39,836 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.36초
2025-08-14 08:50:40,286 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:50:40,286 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-08-14 08:50:40,286 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:50:40,406 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:50:40,745 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:50:40,753 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:50:40,812 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:50:40,812 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:50:40,824 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:50:40,825 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:50:40,977 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:50:41,446 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:50:41,446 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:50:41,446 - __main__ - INFO - _load_data 실행완료: 1.16초
2025-08-14 08:50:41,446 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:50:41,447 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:50:41,447 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:50:41,915 - __main__ - INFO - Kiwi 추출 엔티티: ['데일리', '에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '0 day', '베어유']
2025-08-14 08:50:43,471 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.02초
2025-08-14 08:50:50,569 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:50:50,582 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 08:50:51,591 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:50:51,876 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.29초
2025-08-14 08:50:51,882 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:50:51,882 - __main__ - INFO - process_message 실행완료: 10.44초
2025-08-14 08:52:40,385 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 08:52:40,385 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 08:52:40,415 - __main__ - INFO - Using device: mps
2025-08-14 08:52:40,415 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 08:52:40,648 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 08:52:40,648 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-14 08:52:40,648 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 08:52:40,649 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 08:52:40,649 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 08:52:41,456 - __main__ - INFO - Model loaded on mps
2025-08-14 08:52:41,456 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.81초
2025-08-14 08:52:41,841 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 08:52:41,841 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-14 08:52:41,841 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 08:52:41,957 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 08:52:42,289 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 08:52:42,290 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 08:52:42,350 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 08:52:42,350 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 08:52:42,352 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 08:52:42,352 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 08:52:42,474 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 08:52:42,931 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 08:52:42,931 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 08:52:42,931 - __main__ - INFO - _load_data 실행완료: 1.09초
2025-08-14 08:52:42,931 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 08:52:42,931 - __main__ - INFO - 메시지 처리 시작
2025-08-14 08:52:42,931 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 08:52:43,409 - __main__ - INFO - Kiwi 추출 엔티티: ['0 day', '에이닷이빵쏜닷', '시크릿', '베어유', '데일리', '뚜레쥬르']
2025-08-14 08:52:44,958 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.03초
2025-08-14 08:52:52,017 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:52:52,029 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 08:52:53,151 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 08:52:53,437 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.41초
2025-08-14 08:52:53,444 - __main__ - INFO - 메시지 처리 완료
2025-08-14 08:52:53,444 - __main__ - INFO - process_message 실행완료: 10.51초
2025-08-14 09:08:31,800 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 09:08:31,800 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 09:08:31,836 - __main__ - INFO - Using device: mps
2025-08-14 09:08:31,836 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 09:08:33,636 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 09:08:33,636 - __main__ - INFO - _initialize_llm 실행완료: 1.80초
2025-08-14 09:08:33,636 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 09:08:33,637 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 09:08:33,637 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 09:08:40,169 - __main__ - INFO - Model loaded on mps
2025-08-14 09:08:40,169 - __main__ - INFO - _initialize_embedding_model 실행완료: 6.53초
2025-08-14 09:08:40,664 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 09:08:40,664 - __main__ - INFO - _initialize_kiwi 실행완료: 0.50초
2025-08-14 09:08:40,664 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 09:08:40,794 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 09:08:41,138 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 09:08:41,145 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 09:08:41,205 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 09:08:41,205 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 09:08:41,217 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 09:08:41,217 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 09:08:41,387 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 09:08:41,883 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 09:08:41,883 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 09:08:41,883 - __main__ - INFO - _load_data 실행완료: 1.22초
2025-08-14 09:08:41,883 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 09:08:41,883 - __main__ - INFO - 메시지 처리 시작
2025-08-14 09:08:41,884 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 09:08:42,385 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '데일리', '베어유', '뚜레쥬르', '시크릿', '0 day']
2025-08-14 09:08:43,979 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.10초
2025-08-14 09:08:51,251 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:08:51,262 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 09:08:52,319 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:08:52,609 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.35초
2025-08-14 09:08:52,616 - __main__ - INFO - 메시지 처리 완료
2025-08-14 09:08:52,616 - __main__ - INFO - process_message 실행완료: 10.73초
2025-08-14 09:09:39,871 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 09:09:39,871 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 09:09:39,899 - __main__ - INFO - Using device: mps
2025-08-14 09:09:39,899 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 09:09:40,147 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 09:09:40,147 - __main__ - INFO - _initialize_llm 실행완료: 0.25초
2025-08-14 09:09:40,147 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 09:09:40,147 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 09:09:40,147 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 09:09:40,954 - __main__ - INFO - Model loaded on mps
2025-08-14 09:09:40,955 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.81초
2025-08-14 09:09:41,374 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 09:09:41,374 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-08-14 09:09:41,374 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 09:09:41,494 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 09:09:41,824 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 09:09:41,825 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 09:09:41,884 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 09:09:41,884 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 09:09:41,885 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 09:09:41,885 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 09:09:42,000 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 09:09:42,467 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 09:09:42,467 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 09:09:42,467 - __main__ - INFO - _load_data 실행완료: 1.09초
2025-08-14 09:09:42,467 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 09:09:42,467 - __main__ - INFO - 메시지 처리 시작
2025-08-14 09:09:42,467 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 09:09:42,958 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '데일리', '뚜레쥬르', '0 day', '베어유', '에이닷이빵쏜닷']
2025-08-14 09:09:44,530 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.06초
2025-08-14 09:09:51,761 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:09:51,774 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 09:09:52,744 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:09:53,053 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.28초
2025-08-14 09:09:53,060 - __main__ - INFO - 메시지 처리 완료
2025-08-14 09:09:53,060 - __main__ - INFO - process_message 실행완료: 10.59초
2025-08-14 09:10:01,654 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 09:10:01,654 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 09:10:01,683 - __main__ - INFO - Using device: mps
2025-08-14 09:10:01,683 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 09:10:01,908 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 09:10:01,908 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-14 09:10:01,908 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 09:10:01,909 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 09:10:01,909 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 09:10:02,712 - __main__ - INFO - Model loaded on mps
2025-08-14 09:10:02,712 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.80초
2025-08-14 09:10:03,105 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 09:10:03,105 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-14 09:10:03,105 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 09:10:03,226 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 09:10:03,560 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 09:10:03,562 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 09:10:03,621 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 09:10:03,621 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 09:10:03,622 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 09:10:03,622 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 09:10:03,736 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 09:10:04,203 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 09:10:04,203 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 09:10:04,203 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-14 09:10:04,203 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 09:10:04,203 - __main__ - INFO - 메시지 처리 시작
2025-08-14 09:10:04,203 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 09:10:04,692 - __main__ - INFO - Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '베어유', '0 day', '시크릿', '데일리']
2025-08-14 09:10:06,262 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.06초
2025-08-14 09:10:13,420 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:10:13,432 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 09:10:14,646 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:10:14,930 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.50초
2025-08-14 09:10:14,937 - __main__ - INFO - 메시지 처리 완료
2025-08-14 09:10:14,937 - __main__ - INFO - process_message 실행완료: 10.73초
2025-08-14 09:11:11,666 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 09:11:11,666 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 09:11:11,695 - __main__ - INFO - Using device: mps
2025-08-14 09:11:11,695 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 09:11:11,926 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 09:11:11,926 - __main__ - INFO - _initialize_llm 실행완료: 0.23초
2025-08-14 09:11:11,926 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 09:11:11,927 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 09:11:11,927 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 09:11:12,754 - __main__ - INFO - Model loaded on mps
2025-08-14 09:11:12,754 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.83초
2025-08-14 09:11:13,144 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 09:11:13,144 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-14 09:11:13,144 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 09:11:13,262 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 09:11:13,598 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 09:11:13,599 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 09:11:13,664 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 09:11:13,665 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 09:11:13,666 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 09:11:13,666 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 09:11:13,782 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 09:11:14,246 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 09:11:14,246 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 09:11:14,246 - __main__ - INFO - _load_data 실행완료: 1.10초
2025-08-14 09:11:14,246 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 09:11:14,246 - __main__ - INFO - 메시지 처리 시작
2025-08-14 09:11:14,246 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 09:11:14,733 - __main__ - INFO - Kiwi 추출 엔티티: ['시크릿', '에이닷이빵쏜닷', '데일리', '0 day', '뚜레쥬르', '베어유']
2025-08-14 09:11:16,291 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.05초
2025-08-14 09:11:23,130 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:11:23,144 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 09:11:24,381 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:11:24,668 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.52초
2025-08-14 09:11:24,675 - __main__ - INFO - 메시지 처리 완료
2025-08-14 09:11:24,675 - __main__ - INFO - process_message 실행완료: 10.43초
2025-08-14 09:12:19,473 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 09:12:19,473 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 09:12:19,499 - __main__ - INFO - Using device: mps
2025-08-14 09:12:19,499 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-14 09:12:19,722 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 09:12:19,723 - __main__ - INFO - _initialize_llm 실행완료: 0.22초
2025-08-14 09:12:19,723 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 09:12:19,723 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 09:12:19,723 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 09:12:20,526 - __main__ - INFO - Model loaded on mps
2025-08-14 09:12:20,527 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.80초
2025-08-14 09:12:20,915 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 09:12:20,915 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-14 09:12:20,915 - __main__ - INFO - 데이터 로딩 시작
2025-08-14 09:12:21,032 - __main__ - INFO - 상품 정보 로드 완료: 44275개 상품
2025-08-14 09:12:21,367 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 09:12:21,368 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 09:12:21,425 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개
2025-08-14 09:12:21,425 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 09:12:21,426 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 09:12:21,426 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 09:12:21,590 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 09:12:22,065 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 09:12:22,065 - __main__ - INFO - 데이터 로딩 완료
2025-08-14 09:12:22,065 - __main__ - INFO - _load_data 실행완료: 1.15초
2025-08-14 09:12:22,065 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 09:12:22,065 - __main__ - INFO - 메시지 처리 시작
2025-08-14 09:12:22,065 - __main__ - INFO - 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의...
2025-08-14 09:12:22,549 - __main__ - INFO - Kiwi 추출 엔티티: ['데일리', '시크릿', '베어유', '에이닷이빵쏜닷', '0 day', '뚜레쥬르']
2025-08-14 09:12:24,108 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.04초
2025-08-14 09:12:31,074 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:12:31,084 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 09:12:32,272 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 09:12:32,565 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.48초
2025-08-14 09:12:32,572 - __main__ - INFO - 메시지 처리 완료
2025-08-14 09:12:32,572 - __main__ - INFO - process_message 실행완료: 10.51초
2025-08-14 16:10:50,070 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-14 16:10:50,070 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-14 16:10:50,135 - __main__ - INFO - Using device: mps
2025-08-14 16:10:50,135 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-14 16:10:51,899 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-14 16:10:51,900 - __main__ - INFO - _initialize_llm 실행완료: 1.76초
2025-08-14 16:10:51,900 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-14 16:10:51,901 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-14 16:10:51,901 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-14 16:10:57,439 - __main__ - INFO - Model loaded on mps
2025-08-14 16:10:57,439 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.54초
2025-08-14 16:10:57,999 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-14 16:10:57,999 - __main__ - INFO - _initialize_kiwi 실행완료: 0.56초
2025-08-14 16:10:57,999 - __main__ - INFO - ============================================================
2025-08-14 16:10:57,999 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-14 16:10:57,999 - __main__ - INFO - ============================================================
2025-08-14 16:10:57,999 - __main__ - INFO - 데이터 소스 모드: local
2025-08-14 16:10:57,999 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-14 16:10:57,999 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-14 16:10:57,999 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-14 16:10:57,999 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-14 16:10:58,127 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-14 16:10:58,127 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-14 16:10:58,138 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-14 16:10:58,143 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-14 16:10:58,144 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-14 16:10:58,149 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-14 16:10:58,149 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-14 16:10:58,149 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-14 16:10:58,149 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-14 16:10:58,149 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-14 16:10:58,149 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-14 16:10:58,149 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-14 16:10:58,156 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-14 16:10:58,157 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-14 16:10:58,157 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-14 16:10:58,476 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-14 16:10:58,479 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-14 16:10:58,479 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-14 16:10:58,480 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-14 16:10:58,480 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-14 16:10:58,488 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-14 16:10:58,488 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-14 16:10:58,488 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-14 16:10:58,488 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-14 16:10:58,496 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-14 16:10:58,498 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-14 16:10:58,498 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-14 16:10:58,560 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-14 16:10:58,561 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-14 16:10:58,561 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-14 16:10:58,573 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-14 16:10:58,573 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-14 16:10:58,885 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-14 16:10:58,885 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-14 16:10:58,885 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-14 16:10:59,415 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-14 16:10:59,416 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-14 16:10:59,416 - __main__ - INFO - ============================================================
2025-08-14 16:10:59,416 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-14 16:10:59,416 - __main__ - INFO - ============================================================
2025-08-14 16:10:59,416 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-14 16:10:59,416 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-14 16:10:59,416 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-14 16:10:59,416 - __main__ - INFO - ✅ 정지어: 166개
2025-08-14 16:10:59,416 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-14 16:10:59,421 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-14 16:10:59,429 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-14 16:10:59,433 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-14 16:10:59,433 - __main__ - INFO - _load_data 실행완료: 1.43초
2025-08-14 16:10:59,433 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-14 16:10:59,433 - __main__ - INFO - 메시지 처리 시작
2025-08-14 16:10:59,433 - __main__ - INFO - ============================================================
2025-08-14 16:10:59,433 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-14 16:10:59,433 - __main__ - INFO - ============================================================
2025-08-14 16:10:59,433 - __main__ - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내 광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다 (선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3S...
2025-08-14 16:10:59,433 - __main__ - INFO - 메시지 길이: 368 문자
2025-08-14 16:10:59,433 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-14 16:10:59,433 - __main__ - INFO - 데이터 소스: local
2025-08-14 16:10:59,433 - __main__ - INFO - 상품 정보 추출 모드: llm
2025-08-14 16:10:59,433 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-14 16:10:59,433 - __main__ - INFO - LLM 모델: ax
2025-08-14 16:10:59,433 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-14 16:10:59,433 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-14 16:10:59,433 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-14 16:10:59,433 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-14 16:10:59,433 - __main__ - INFO - 처리할 메시지 길이: 368 문자
2025-08-14 16:10:59,439 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-14 16:10:59,947 - __main__ - INFO - 분할된 문장 수: 13개
2025-08-14 16:10:59,948 - __main__ - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-08-14 16:10:59,949 - __main__ - INFO - 전체 토큰 수: 130개
2025-08-14 16:10:59,949 - __main__ - INFO - NNP 태그 토큰들: ['SK텔레콤', '0 day', '광고', '0 day', '베어유', '에이닷', '시크릿', '이벤트', '에이닷', '쿠폰', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '쿠폰', '시크릿', '수신거부']
2025-08-14 16:10:59,949 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '뚜레쥬르', '시크릿', '에이닷이빵쏜닷', '0 day', '베어유']
2025-08-14 16:10:59,949 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-14 16:11:01,912 - __main__ - INFO - 퍼지 매칭 결과 크기: (14224, 3)
2025-08-14 16:11:01,912 - __main__ - INFO - 퍼지 매칭 성공: 14224개 결과
2025-08-14 16:11:01,920 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'Galaxy 탭 S6', 'sim': 0.42105263157894735}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'galaxy 탭 S6', 'sim': 0.42105263157894735}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '특별한혜택충전 개편', 'sim': 0.4}]
2025-08-14 16:11:01,920 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-14 16:11:02,055 - __main__ - INFO - 시퀀스 유사도 결과 크기: (14224, 3)
2025-08-14 16:11:02,056 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'Galaxy 탭 S6', 'sim': 0.2909090909090909}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'galaxy 탭 S6', 'sim': 0.2909090909090909}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '특별한혜택충전 개편', 'sim': 0.24}]
2025-08-14 16:11:02,056 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-14 16:11:02,060 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-08-14 16:11:02,066 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-08-14 16:11:02,067 - __main__ - INFO - 통합된 후보 아이템 수: 15개
2025-08-14 16:11:02,068 - __main__ - INFO - 최종 후보 아이템 리스트: ['0 day', '뚜레쥬르', '베어유', '시크릿', 'T쿠폰', 'data', '우드', 'T 에이스', 'CU(0 day)', 'LTE 혜택 안내']
2025-08-14 16:11:02,072 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-08-14 16:11:02,072 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '0 day', 'item_id': ['9301']}, {'item_nm': 'CU(0 day)', 'item_id': ['V861']}, {'item_nm': 'LTE 혜택 안내', 'item_id': ['NA00004316']}]
2025-08-14 16:11:02,073 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.64초
2025-08-14 16:11:02,073 - __main__ - INFO - 추출된 후보 엔티티: ['0 day' '뚜레쥬르' '베어유' '시크릿' 'T쿠폰' 'data' '우드' 'T 에이스' 'CU(0 day)'
 'LTE 혜택 안내']
2025-08-14 16:11:02,073 - __main__ - INFO - 매칭된 상품 정보: (10, 2)
2025-08-14 16:11:02,073 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-14 16:11:02,204 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-14 16:11:02,204 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-14 16:11:02,204 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-08-14 16:11:02,204 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-14 16:11:02,204 - __main__ - INFO - 후보 아이템 리스트 크기: 10개
2025-08-14 16:11:02,204 - __main__ - INFO - 후보 아이템 리스트: ['0 day' '뚜레쥬르' '베어유' '시크릿' 'T쿠폰' 'data' '우드' 'T 에이스' 'CU(0 day)'
 'LTE 혜택 안내']
2025-08-14 16:11:02,204 - __main__ - INFO - extra_item_pdf 크기: (10, 2)
2025-08-14 16:11:02,204 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-14 16:11:02,204 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '0 day', 'item_id': ['9301']}, {'item_nm': 'CU(0 day)', 'item_id': ['V861']}]
2025-08-14 16:11:02,204 - __main__ - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-08-14 16:11:02,205 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-14 16:11:02,205 - __main__ - INFO - 구성된 프롬프트 길이: 6207 문자
2025-08-14 16:11:02,205 - __main__ - INFO - RAG 컨텍스트 포함 여부: True
2025-08-14 16:11:09,442 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 16:11:09,454 - __main__ - INFO - LLM 응답 길이: 942 문자
2025-08-14 16:11:09,455 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵",
            "action": "구매"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action"...
2025-08-14 16:11:09,455 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-14 16:11:09,456 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-14 16:11:09,456 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-14 16:11:09,456 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵', 'action': '구매'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-08-14 16:11:09,456 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-14 16:11:09,456 - __main__ - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-08-14 16:11:10,532 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-14 16:11:10,911 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.46초
2025-08-14 16:11:10,919 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-14 16:11:10,919 - __main__ - INFO - ============================================================
2025-08-14 16:11:10,919 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-14 16:11:10,919 - __main__ - INFO - ============================================================
2025-08-14 16:11:10,919 - __main__ - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-08-14 16:11:10,919 - __main__ - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-08-14 16:11:10,919 - __main__ - INFO - 상품 수: 2개
2025-08-14 16:11:10,919 - __main__ - INFO - 채널 수: 4개
2025-08-14 16:11:10,919 - __main__ - INFO - 프로그램 수: 2개
2025-08-14 16:11:10,919 - __main__ - INFO - process_message 실행완료: 11.49초
2025-08-19 14:40:01,830 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 14:40:01,830 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 14:40:01,854 - __main__ - INFO - Using device: mps
2025-08-19 14:40:01,854 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-19 14:40:01,855 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 14:40:01,855 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 14:40:01,855 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 14:40:01,855 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 14:40:01,855 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 14:40:06,294 - __main__ - INFO - Model loaded on mps
2025-08-19 14:40:06,294 - __main__ - INFO - _initialize_embedding_model 실행완료: 4.44초
2025-08-19 14:40:06,843 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 14:40:06,843 - __main__ - INFO - _initialize_kiwi 실행완료: 0.55초
2025-08-19 14:40:06,843 - __main__ - INFO - ============================================================
2025-08-19 14:40:06,843 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 14:40:06,843 - __main__ - INFO - ============================================================
2025-08-19 14:40:06,843 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 14:40:06,843 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 14:40:06,843 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 14:40:06,843 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 14:40:06,843 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 14:40:06,958 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 14:40:06,958 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 14:40:06,969 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 14:40:06,974 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 14:40:06,975 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:40:06,978 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 14:40:06,978 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 14:40:06,979 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 14:40:06,979 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 14:40:06,979 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 14:40:06,979 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 14:40:06,979 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 14:40:06,987 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 14:40:06,988 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 14:40:06,988 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 14:40:07,334 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 14:40:07,335 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 14:40:07,335 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 14:40:07,336 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 14:40:07,336 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 14:40:07,337 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 14:40:07,337 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 14:40:07,337 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 14:40:07,337 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 14:40:07,344 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 14:40:07,347 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 14:40:07,347 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:40:07,396 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 14:40:07,397 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 14:40:07,397 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 14:40:07,409 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 14:40:07,409 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 14:40:07,644 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 14:40:07,645 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 14:40:07,645 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 14:40:08,143 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 14:40:08,143 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 14:40:08,144 - __main__ - INFO - ============================================================
2025-08-19 14:40:08,144 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 14:40:08,144 - __main__ - INFO - ============================================================
2025-08-19 14:40:08,144 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 14:40:08,144 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 14:40:08,144 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 14:40:08,144 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 14:40:08,144 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 14:40:08,148 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 14:40:08,155 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 14:40:08,158 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 14:40:08,159 - __main__ - INFO - _load_data 실행완료: 1.32초
2025-08-19 14:40:08,159 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 14:40:08,159 - __main__ - INFO - 메시지 처리 시작
2025-08-19 14:40:08,159 - __main__ - INFO - ============================================================
2025-08-19 14:40:08,159 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 14:40:08,159 - __main__ - INFO - ============================================================
2025-08-19 14:40:08,159 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 14:40:08,159 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 14:40:08,159 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 14:40:08,159 - __main__ - INFO - 데이터 소스: local
2025-08-19 14:40:08,159 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 14:40:08,159 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 14:40:08,159 - __main__ - INFO - LLM 모델: ax
2025-08-19 14:40:08,159 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 14:40:08,159 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 14:40:08,159 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 14:40:08,159 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 14:40:08,159 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 14:40:08,164 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 14:40:08,672 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 14:40:08,672 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 14:40:08,676 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 14:40:08,676 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 14:40:08,676 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '방진', '아이', '키즈폰']
2025-08-19 14:40:08,676 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 14:40:09,409 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 14:40:09,409 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 14:40:09,418 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 14:40:09,418 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 14:40:09,538 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 14:40:09,539 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 14:40:09,539 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 14:40:09,541 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 14:40:09,546 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 14:40:09,546 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 14:40:09,549 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 14:40:09,552 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 14:40:09,552 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 14:40:09,553 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.39초
2025-08-19 14:40:09,553 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:40:09,553 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 14:40:09,553 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 14:40:09,657 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 14:40:09,657 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 14:40:09,657 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 14:40:09,657 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 14:40:09,657 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 14:40:09,657 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:40:09,657 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 14:40:09,657 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 14:40:09,657 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 14:40:09,658 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 14:40:09,658 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 14:40:09,658 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 14:40:09,658 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 14:40:09,658 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 14:40:16,096 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:40:16,108 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 14:40:16,108 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 14:40:16,108 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 14:40:16,108 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 14:40:16,108 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 14:40:16,108 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 14:40:16,108 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 14:40:16,108 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 14:40:16,853 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:40:17,016 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.91초
2025-08-19 14:40:17,701 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 14:40:17,701 - __main__ - INFO - ============================================================
2025-08-19 14:40:17,701 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 14:40:17,701 - __main__ - INFO - ============================================================
2025-08-19 14:40:17,701 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 14:40:17,701 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 14:40:17,701 - __main__ - INFO - 상품 수: 1개
2025-08-19 14:40:17,701 - __main__ - INFO - 채널 수: 3개
2025-08-19 14:40:17,701 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 14:40:17,701 - __main__ - INFO - process_message 실행완료: 9.54초
2025-08-19 14:42:49,685 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 14:42:49,685 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 14:42:49,707 - __main__ - INFO - Using device: mps
2025-08-19 14:42:49,707 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-19 14:42:49,707 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 14:42:49,707 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 14:42:49,707 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 14:42:49,708 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 14:42:49,708 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 14:42:50,548 - __main__ - INFO - Model loaded on mps
2025-08-19 14:42:50,548 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.84초
2025-08-19 14:42:50,943 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 14:42:50,943 - __main__ - INFO - _initialize_kiwi 실행완료: 0.39초
2025-08-19 14:42:50,943 - __main__ - INFO - ============================================================
2025-08-19 14:42:50,943 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 14:42:50,943 - __main__ - INFO - ============================================================
2025-08-19 14:42:50,943 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 14:42:50,943 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 14:42:50,943 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 14:42:50,943 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 14:42:50,943 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 14:42:51,051 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 14:42:51,051 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 14:42:51,059 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 14:42:51,063 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 14:42:51,064 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:42:51,067 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 14:42:51,067 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 14:42:51,067 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 14:42:51,067 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 14:42:51,067 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 14:42:51,067 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 14:42:51,067 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 14:42:51,068 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 14:42:51,069 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 14:42:51,069 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 14:42:51,411 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 14:42:51,413 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 14:42:51,413 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 14:42:51,413 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 14:42:51,413 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 14:42:51,414 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 14:42:51,414 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 14:42:51,414 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 14:42:51,414 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 14:42:51,422 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 14:42:51,425 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 14:42:51,425 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:42:51,473 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 14:42:51,473 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 14:42:51,473 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 14:42:51,474 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 14:42:51,474 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 14:42:51,602 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 14:42:51,602 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 14:42:51,603 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 14:42:52,068 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 14:42:52,068 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 14:42:52,068 - __main__ - INFO - ============================================================
2025-08-19 14:42:52,068 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 14:42:52,068 - __main__ - INFO - ============================================================
2025-08-19 14:42:52,068 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 14:42:52,068 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 14:42:52,068 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 14:42:52,068 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 14:42:52,068 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 14:42:52,072 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 14:42:52,079 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 14:42:52,082 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 14:42:52,082 - __main__ - INFO - _load_data 실행완료: 1.14초
2025-08-19 14:42:52,082 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 14:42:52,082 - __main__ - INFO - 메시지 처리 시작
2025-08-19 14:42:52,082 - __main__ - INFO - ============================================================
2025-08-19 14:42:52,082 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 14:42:52,082 - __main__ - INFO - ============================================================
2025-08-19 14:42:52,082 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 14:42:52,082 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 14:42:52,082 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 14:42:52,082 - __main__ - INFO - 데이터 소스: local
2025-08-19 14:42:52,082 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 14:42:52,082 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 14:42:52,082 - __main__ - INFO - LLM 모델: ax
2025-08-19 14:42:52,082 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 14:42:52,082 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 14:42:52,082 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 14:42:52,083 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 14:42:52,083 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 14:42:52,088 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 14:42:52,583 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 14:42:52,583 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 14:42:52,586 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 14:42:52,586 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 14:42:52,586 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '아이']
2025-08-19 14:42:52,587 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 14:42:53,303 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 14:42:53,303 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 14:42:53,305 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 14:42:53,305 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 14:42:53,413 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 14:42:53,413 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 14:42:53,413 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 14:42:53,415 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 14:42:53,420 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 14:42:53,420 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 14:42:53,422 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 14:42:53,425 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 14:42:53,425 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 14:42:53,425 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.34초
2025-08-19 14:42:53,425 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:42:53,425 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 14:42:53,425 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 14:42:53,509 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 14:42:53,509 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 14:42:53,509 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 14:42:53,509 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 14:42:53,509 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 14:42:53,509 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:42:53,509 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 14:42:53,509 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 14:42:53,510 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 14:42:53,511 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 14:42:53,511 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 14:42:53,511 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 14:42:53,511 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 14:42:53,511 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 14:42:59,597 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:42:59,612 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 14:42:59,612 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 14:42:59,612 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 14:42:59,613 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 14:42:59,613 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 14:42:59,613 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 14:42:59,613 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 14:42:59,613 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 14:43:00,321 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:43:00,481 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.87초
2025-08-19 14:43:01,171 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 14:43:01,171 - __main__ - INFO - ============================================================
2025-08-19 14:43:01,171 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 14:43:01,171 - __main__ - INFO - ============================================================
2025-08-19 14:43:01,171 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 14:43:01,171 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 14:43:01,171 - __main__ - INFO - 상품 수: 1개
2025-08-19 14:43:01,171 - __main__ - INFO - 채널 수: 3개
2025-08-19 14:43:01,171 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 14:43:01,171 - __main__ - INFO - process_message 실행완료: 9.09초
2025-08-19 14:43:01,171 - __main__ - ERROR - 실행 실패: 'str' object has no attribute 'invoke'
2025-08-19 14:43:01,174 - __main__ - ERROR - Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 2248, in main
    extract_dag_result = extract_dag(DAGParser(), test_message, args.llm_model)
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/entity_dag_extractor.py", line 624, in extract_dag
    dag_raw = llm_model.invoke(prompt).content
              ^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'invoke'

2025-08-19 14:44:52,362 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 14:44:52,362 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 14:44:52,386 - __main__ - INFO - Using device: mps
2025-08-19 14:44:52,386 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-19 14:44:52,386 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 14:44:52,387 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 14:44:52,387 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 14:44:52,387 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 14:44:52,387 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 14:44:54,191 - __main__ - INFO - Model loaded on mps
2025-08-19 14:44:54,192 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.81초
2025-08-19 14:44:54,665 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 14:44:54,665 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-08-19 14:44:54,665 - __main__ - INFO - ============================================================
2025-08-19 14:44:54,665 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 14:44:54,665 - __main__ - INFO - ============================================================
2025-08-19 14:44:54,665 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 14:44:54,665 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 14:44:54,665 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 14:44:54,666 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 14:44:54,666 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 14:44:54,774 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 14:44:54,774 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 14:44:54,782 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 14:44:54,786 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 14:44:54,787 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:44:54,790 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 14:44:54,790 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 14:44:54,790 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 14:44:54,790 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 14:44:54,790 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 14:44:54,790 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 14:44:54,790 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 14:44:54,792 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 14:44:54,793 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 14:44:54,793 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 14:44:55,136 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 14:44:55,138 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 14:44:55,138 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 14:44:55,138 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 14:44:55,138 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 14:44:55,140 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 14:44:55,140 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 14:44:55,140 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 14:44:55,140 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 14:44:55,147 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 14:44:55,150 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 14:44:55,150 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:44:55,198 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 14:44:55,198 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 14:44:55,198 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 14:44:55,200 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 14:44:55,200 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 14:44:55,332 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 14:44:55,332 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 14:44:55,332 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 14:44:55,804 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 14:44:55,804 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 14:44:55,804 - __main__ - INFO - ============================================================
2025-08-19 14:44:55,804 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 14:44:55,804 - __main__ - INFO - ============================================================
2025-08-19 14:44:55,804 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 14:44:55,804 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 14:44:55,804 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 14:44:55,804 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 14:44:55,804 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 14:44:55,808 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 14:44:55,815 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 14:44:55,819 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 14:44:55,819 - __main__ - INFO - _load_data 실행완료: 1.15초
2025-08-19 14:44:55,819 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 14:44:55,819 - __main__ - INFO - 메시지 처리 시작
2025-08-19 14:44:55,819 - __main__ - INFO - ============================================================
2025-08-19 14:44:55,819 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 14:44:55,819 - __main__ - INFO - ============================================================
2025-08-19 14:44:55,819 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 14:44:55,819 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 14:44:55,819 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 14:44:55,819 - __main__ - INFO - 데이터 소스: local
2025-08-19 14:44:55,819 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 14:44:55,819 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 14:44:55,819 - __main__ - INFO - LLM 모델: ax
2025-08-19 14:44:55,819 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 14:44:55,819 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 14:44:55,819 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 14:44:55,819 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 14:44:55,819 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 14:44:55,825 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 14:44:56,323 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 14:44:56,323 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 14:44:56,327 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 14:44:56,327 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 14:44:56,327 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '방진', '아이', '키즈폰']
2025-08-19 14:44:56,327 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 14:44:57,062 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 14:44:57,062 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 14:44:57,067 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 14:44:57,067 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 14:44:57,172 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 14:44:57,173 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 14:44:57,173 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 14:44:57,175 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 14:44:57,180 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 14:44:57,180 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 14:44:57,182 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 14:44:57,185 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 14:44:57,185 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 14:44:57,186 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.37초
2025-08-19 14:44:57,186 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:44:57,186 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 14:44:57,186 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 14:44:57,279 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 14:44:57,279 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 14:44:57,279 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 14:44:57,279 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 14:44:57,279 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 14:44:57,279 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:44:57,279 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 14:44:57,279 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 14:44:57,280 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 14:44:57,281 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 14:44:57,281 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 14:44:57,281 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 14:44:57,281 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 14:44:57,281 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 14:45:03,631 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:45:03,644 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 14:45:03,645 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 14:45:03,645 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 14:45:03,645 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 14:45:03,645 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 14:45:03,645 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 14:45:03,645 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 14:45:03,645 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 14:45:04,422 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:45:04,585 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.94초
2025-08-19 14:45:05,271 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 14:45:05,271 - __main__ - INFO - ============================================================
2025-08-19 14:45:05,271 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 14:45:05,271 - __main__ - INFO - ============================================================
2025-08-19 14:45:05,272 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 14:45:05,272 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 14:45:05,272 - __main__ - INFO - 상품 수: 1개
2025-08-19 14:45:05,272 - __main__ - INFO - 채널 수: 3개
2025-08-19 14:45:05,272 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 14:45:05,272 - __main__ - INFO - process_message 실행완료: 9.45초
2025-08-19 14:45:28,457 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:53:48,430 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 14:53:48,430 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 14:53:48,495 - __main__ - INFO - Using device: mps
2025-08-19 14:53:48,495 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-19 14:53:48,496 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 14:53:48,496 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 14:53:48,496 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 14:53:48,496 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 14:53:48,496 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 14:53:53,957 - __main__ - INFO - Model loaded on mps
2025-08-19 14:53:53,957 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.46초
2025-08-19 14:53:54,427 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 14:53:54,427 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-08-19 14:53:54,427 - __main__ - INFO - ============================================================
2025-08-19 14:53:54,427 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 14:53:54,427 - __main__ - INFO - ============================================================
2025-08-19 14:53:54,427 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 14:53:54,427 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 14:53:54,427 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 14:53:54,427 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 14:53:54,427 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 14:53:54,542 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 14:53:54,543 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 14:53:54,551 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 14:53:54,555 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 14:53:54,556 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:53:54,559 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 14:53:54,559 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 14:53:54,560 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 14:53:54,560 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 14:53:54,560 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 14:53:54,560 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 14:53:54,560 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 14:53:54,567 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 14:53:54,568 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 14:53:54,568 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 14:53:54,914 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 14:53:54,916 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 14:53:54,916 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 14:53:54,917 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 14:53:54,917 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 14:53:54,918 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 14:53:54,918 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 14:53:54,918 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 14:53:54,918 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 14:53:54,925 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 14:53:54,928 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 14:53:54,928 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 14:53:54,977 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 14:53:54,977 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 14:53:54,977 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 14:53:54,989 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 14:53:54,989 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 14:53:55,172 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 14:53:55,172 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 14:53:55,172 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 14:53:55,675 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 14:53:55,675 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 14:53:55,675 - __main__ - INFO - ============================================================
2025-08-19 14:53:55,675 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 14:53:55,675 - __main__ - INFO - ============================================================
2025-08-19 14:53:55,675 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 14:53:55,675 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 14:53:55,675 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 14:53:55,675 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 14:53:55,675 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 14:53:55,680 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 14:53:55,687 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 14:53:55,690 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 14:53:55,690 - __main__ - INFO - _load_data 실행완료: 1.26초
2025-08-19 14:53:55,690 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 14:53:55,690 - __main__ - INFO - 메시지 처리 시작
2025-08-19 14:53:55,690 - __main__ - INFO - ============================================================
2025-08-19 14:53:55,690 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 14:53:55,691 - __main__ - INFO - ============================================================
2025-08-19 14:53:55,691 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 14:53:55,691 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 14:53:55,691 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 14:53:55,691 - __main__ - INFO - 데이터 소스: local
2025-08-19 14:53:55,691 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 14:53:55,691 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 14:53:55,691 - __main__ - INFO - LLM 모델: ax
2025-08-19 14:53:55,691 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 14:53:55,691 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 14:53:55,691 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 14:53:55,691 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 14:53:55,691 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 14:53:55,696 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 14:53:56,217 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 14:53:56,217 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 14:53:56,220 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 14:53:56,220 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 14:53:56,220 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '방진', '키즈폰', '아이']
2025-08-19 14:53:56,220 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 14:53:56,965 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 14:53:56,966 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 14:53:56,974 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 14:53:56,974 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 14:53:57,097 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 14:53:57,098 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 14:53:57,098 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 14:53:57,100 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 14:53:57,105 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 14:53:57,105 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 14:53:57,107 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 14:53:57,110 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 14:53:57,110 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 14:53:57,111 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.42초
2025-08-19 14:53:57,111 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:53:57,111 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 14:53:57,111 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 14:53:57,202 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 14:53:57,202 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 14:53:57,202 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 14:53:57,202 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 14:53:57,202 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 14:53:57,202 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 14:53:57,202 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 14:53:57,202 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 14:53:57,202 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 14:53:57,203 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 14:53:57,203 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 14:53:57,203 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 14:53:57,203 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 14:53:57,203 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 14:54:03,350 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:54:03,363 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 14:54:03,363 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 14:54:03,363 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 14:54:03,364 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 14:54:03,364 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 14:54:03,364 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 14:54:03,364 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 14:54:03,364 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 14:54:04,155 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:54:04,313 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.95초
2025-08-19 14:54:05,006 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 14:54:29,731 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 14:54:30,230 - __main__ - INFO - ============================================================
2025-08-19 14:54:30,230 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 14:54:30,230 - __main__ - INFO - ============================================================
2025-08-19 14:54:30,231 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 14:54:30,231 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 14:54:30,231 - __main__ - INFO - 상품 수: 1개
2025-08-19 14:54:30,231 - __main__ - INFO - 채널 수: 3개
2025-08-19 14:54:30,231 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 14:54:30,231 - __main__ - INFO - process_message 실행완료: 34.54초
2025-08-19 15:16:10,253 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 15:16:10,253 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 15:16:10,315 - __main__ - INFO - Using device: mps
2025-08-19 15:16:10,315 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-08-19 15:16:10,316 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 15:16:10,316 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 15:16:10,316 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 15:16:10,316 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 15:16:10,316 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 15:16:15,356 - __main__ - INFO - Model loaded on mps
2025-08-19 15:16:15,356 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.04초
2025-08-19 15:16:15,802 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 15:16:15,803 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-08-19 15:16:15,803 - __main__ - INFO - ============================================================
2025-08-19 15:16:15,803 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 15:16:15,803 - __main__ - INFO - ============================================================
2025-08-19 15:16:15,803 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 15:16:15,803 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 15:16:15,803 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 15:16:15,803 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 15:16:15,803 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 15:16:15,918 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 15:16:15,918 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 15:16:15,927 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 15:16:15,931 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 15:16:15,932 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 15:16:15,935 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 15:16:15,935 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 15:16:15,935 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 15:16:15,935 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 15:16:15,935 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 15:16:15,935 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 15:16:15,935 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 15:16:15,943 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 15:16:15,944 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 15:16:15,944 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 15:16:16,287 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 15:16:16,289 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 15:16:16,289 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 15:16:16,289 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 15:16:16,289 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 15:16:16,290 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 15:16:16,290 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 15:16:16,290 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 15:16:16,290 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 15:16:16,297 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 15:16:16,301 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 15:16:16,301 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 15:16:16,351 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 15:16:16,352 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 15:16:16,352 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 15:16:16,365 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 15:16:16,365 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 15:16:16,533 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 15:16:16,534 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 15:16:16,534 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 15:16:17,015 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 15:16:17,015 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 15:16:17,015 - __main__ - INFO - ============================================================
2025-08-19 15:16:17,015 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 15:16:17,015 - __main__ - INFO - ============================================================
2025-08-19 15:16:17,015 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 15:16:17,015 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 15:16:17,015 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 15:16:17,015 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 15:16:17,015 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 15:16:17,019 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 15:16:17,026 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 15:16:17,030 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 15:16:17,030 - __main__ - INFO - _load_data 실행완료: 1.23초
2025-08-19 15:16:17,030 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 15:16:17,030 - __main__ - INFO - 메시지 처리 시작
2025-08-19 15:16:17,030 - __main__ - INFO - ============================================================
2025-08-19 15:16:17,030 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 15:16:17,030 - __main__ - INFO - ============================================================
2025-08-19 15:16:17,030 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 15:16:17,030 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 15:16:17,030 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 15:16:17,030 - __main__ - INFO - 데이터 소스: local
2025-08-19 15:16:17,030 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 15:16:17,030 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 15:16:17,030 - __main__ - INFO - LLM 모델: ax
2025-08-19 15:16:17,030 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 15:16:17,030 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 15:16:17,030 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 15:16:17,030 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 15:16:17,030 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 15:16:17,036 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 15:16:17,523 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 15:16:17,524 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 15:16:17,527 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 15:16:17,527 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 15:16:17,527 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '아이', '방진', '키즈폰']
2025-08-19 15:16:17,527 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 15:16:18,249 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 15:16:18,249 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 15:16:18,258 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 15:16:18,258 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 15:16:18,366 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 15:16:18,367 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 15:16:18,367 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 15:16:18,369 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 15:16:18,373 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 15:16:18,374 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 15:16:18,375 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 15:16:18,378 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 15:16:18,378 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 15:16:18,379 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.35초
2025-08-19 15:16:18,379 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 15:16:18,379 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 15:16:18,379 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 15:16:18,462 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 15:16:18,462 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 15:16:18,462 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 15:16:18,462 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 15:16:18,462 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 15:16:18,462 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 15:16:18,462 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 15:16:18,462 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 15:16:18,462 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 15:16:18,463 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 15:16:18,463 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 15:16:18,463 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 15:16:18,463 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 15:16:18,463 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 15:16:24,633 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:16:24,641 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 15:16:24,641 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 15:16:24,641 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 15:16:24,642 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 15:16:24,642 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 15:16:24,642 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 15:16:24,642 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 15:16:24,642 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 15:16:25,432 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:16:25,586 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.94초
2025-08-19 15:16:26,320 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 15:16:48,684 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:16:51,420 - __main__ - INFO - ============================================================
2025-08-19 15:16:51,420 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 15:16:51,420 - __main__ - INFO - ============================================================
2025-08-19 15:16:51,420 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 15:16:51,420 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 15:16:51,420 - __main__ - INFO - 상품 수: 1개
2025-08-19 15:16:51,420 - __main__ - INFO - 채널 수: 3개
2025-08-19 15:16:51,420 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 15:16:51,420 - __main__ - INFO - process_message 실행완료: 34.39초
2025-08-19 15:36:45,068 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-19 15:36:45,068 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-19 15:36:45,089 - __main__ - INFO - Using device: mps
2025-08-19 15:36:45,089 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-19 15:36:45,089 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-19 15:36:45,089 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-19 15:36:45,089 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-19 15:36:45,089 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-19 15:36:45,089 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-19 15:36:51,730 - __main__ - INFO - Model loaded on mps
2025-08-19 15:36:51,730 - __main__ - INFO - _initialize_embedding_model 실행완료: 6.64초
2025-08-19 15:36:52,292 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-19 15:36:52,293 - __main__ - INFO - _initialize_kiwi 실행완료: 0.56초
2025-08-19 15:36:52,293 - __main__ - INFO - ============================================================
2025-08-19 15:36:52,293 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-19 15:36:52,293 - __main__ - INFO - ============================================================
2025-08-19 15:36:52,293 - __main__ - INFO - 데이터 소스 모드: local
2025-08-19 15:36:52,293 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-19 15:36:52,293 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-19 15:36:52,293 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-19 15:36:52,293 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-19 15:36:52,401 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-19 15:36:52,401 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-19 15:36:52,414 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-19 15:36:52,419 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-19 15:36:52,420 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 15:36:52,425 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-19 15:36:52,425 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-19 15:36:52,425 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-19 15:36:52,425 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-19 15:36:52,425 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-19 15:36:52,425 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-19 15:36:52,425 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-19 15:36:52,427 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-19 15:36:52,428 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-19 15:36:52,428 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-19 15:36:52,735 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-19 15:36:52,736 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-19 15:36:52,737 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-19 15:36:52,737 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-19 15:36:52,737 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-19 15:36:52,738 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-19 15:36:52,738 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-19 15:36:52,738 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-19 15:36:52,738 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-19 15:36:52,745 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-19 15:36:52,748 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-19 15:36:52,748 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-19 15:36:52,802 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-19 15:36:52,803 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-19 15:36:52,803 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-19 15:36:52,805 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-19 15:36:52,805 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-19 15:36:53,005 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-19 15:36:53,005 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-19 15:36:53,005 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-19 15:36:53,504 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-19 15:36:53,504 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-19 15:36:53,504 - __main__ - INFO - ============================================================
2025-08-19 15:36:53,504 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-19 15:36:53,504 - __main__ - INFO - ============================================================
2025-08-19 15:36:53,504 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-19 15:36:53,504 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-19 15:36:53,504 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-19 15:36:53,504 - __main__ - INFO - ✅ 정지어: 166개
2025-08-19 15:36:53,504 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-19 15:36:53,509 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-19 15:36:53,517 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-19 15:36:53,521 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-19 15:36:53,521 - __main__ - INFO - _load_data 실행완료: 1.23초
2025-08-19 15:36:53,521 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-19 15:36:53,521 - __main__ - INFO - 메시지 처리 시작
2025-08-19 15:36:53,521 - __main__ - INFO - ============================================================
2025-08-19 15:36:53,521 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-19 15:36:53,521 - __main__ - INFO - ============================================================
2025-08-19 15:36:53,521 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-19 15:36:53,521 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-19 15:36:53,521 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-19 15:36:53,521 - __main__ - INFO - 데이터 소스: local
2025-08-19 15:36:53,521 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-19 15:36:53,521 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-19 15:36:53,521 - __main__ - INFO - LLM 모델: ax
2025-08-19 15:36:53,521 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-19 15:36:53,521 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-19 15:36:53,521 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-19 15:36:53,521 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-19 15:36:53,521 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-19 15:36:53,527 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-19 15:36:54,086 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-19 15:36:54,087 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-19 15:36:54,090 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-19 15:36:54,090 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-19 15:36:54,090 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '키즈폰', '아이', '방진']
2025-08-19 15:36:54,090 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-19 15:36:55,235 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-19 15:36:55,236 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-19 15:36:55,244 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-19 15:36:55,244 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-19 15:36:55,401 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-19 15:36:55,401 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-19 15:36:55,401 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-19 15:36:55,406 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-19 15:36:55,411 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-19 15:36:55,411 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-19 15:36:55,415 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-19 15:36:55,420 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-19 15:36:55,420 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-19 15:36:55,421 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.90초
2025-08-19 15:36:55,421 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 15:36:55,421 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-19 15:36:55,421 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-19 15:36:55,528 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-19 15:36:55,528 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-19 15:36:55,528 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-19 15:36:55,528 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-19 15:36:55,528 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-19 15:36:55,528 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3' 'ZEM폰 포켓몬에디션2' 'I8' '스마트로' '조선' '이마트' '위모' '우리아이' '스키'
 '스마트콘' '스마트60' 'T 에이스' '스마트 사인' '모스트' '마제' '리안' 'kt키즈폰' '치안']
2025-08-19 15:36:55,528 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-19 15:36:55,528 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-19 15:36:55,529 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-19 15:36:55,530 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-19 15:36:55,530 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-19 15:36:55,530 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-19 15:36:55,530 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-19 15:36:55,530 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-19 15:37:01,643 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:37:01,660 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-19 15:37:01,660 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-19 15:37:01,660 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-19 15:37:01,661 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-19 15:37:01,661 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-19 15:37:01,661 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-19 15:37:01,661 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-19 15:37:01,661 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-19 15:37:02,569 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:37:02,824 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.16초
2025-08-19 15:37:03,703 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-19 15:37:30,257 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-19 15:37:30,505 - __main__ - INFO - ============================================================
2025-08-19 15:37:30,505 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-19 15:37:30,505 - __main__ - INFO - ============================================================
2025-08-19 15:37:30,505 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-19 15:37:30,505 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-19 15:37:30,505 - __main__ - INFO - 상품 수: 1개
2025-08-19 15:37:30,505 - __main__ - INFO - 채널 수: 3개
2025-08-19 15:37:30,505 - __main__ - INFO - 프로그램 수: 2개
2025-08-19 15:37:30,505 - __main__ - INFO - process_message 실행완료: 36.98초
2025-08-25 08:52:04,646 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-25 08:52:04,646 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-25 08:52:04,646 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-25 08:52:04,702 - __main__ - INFO - Using device: mps
2025-08-25 08:52:04,702 - __main__ - INFO - _initialize_device 실행완료: 0.05초
2025-08-25 08:52:04,702 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-25 08:52:04,702 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-25 08:52:04,702 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-25 08:52:04,702 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-25 08:52:04,702 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-25 08:52:08,915 - __main__ - INFO - Model loaded on mps
2025-08-25 08:52:08,915 - __main__ - INFO - _initialize_embedding_model 실행완료: 4.21초
2025-08-25 08:52:09,459 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-25 08:52:09,459 - __main__ - INFO - _initialize_kiwi 실행완료: 0.54초
2025-08-25 08:52:09,459 - __main__ - INFO - ============================================================
2025-08-25 08:52:09,459 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-25 08:52:09,459 - __main__ - INFO - ============================================================
2025-08-25 08:52:09,459 - __main__ - INFO - 데이터 소스 모드: local
2025-08-25 08:52:09,459 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-25 08:52:09,459 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-25 08:52:09,459 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-25 08:52:09,459 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-25 08:52:09,574 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-25 08:52:09,574 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-25 08:52:09,584 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-25 08:52:09,589 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-25 08:52:09,591 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 08:52:09,594 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-25 08:52:09,594 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-25 08:52:09,594 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-25 08:52:09,595 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-25 08:52:09,595 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-25 08:52:09,595 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-25 08:52:09,595 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-25 08:52:09,601 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-25 08:52:09,602 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-25 08:52:09,602 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-25 08:52:09,908 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-25 08:52:09,910 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-25 08:52:09,910 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-25 08:52:09,910 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-25 08:52:09,910 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-25 08:52:09,911 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-25 08:52:09,911 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-25 08:52:09,911 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-25 08:52:09,911 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-25 08:52:09,918 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-25 08:52:09,921 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-25 08:52:09,921 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 08:52:09,975 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-25 08:52:09,976 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-25 08:52:09,976 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-25 08:52:09,987 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-25 08:52:09,987 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-25 08:52:11,683 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-25 08:52:11,683 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-25 08:52:11,683 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-25 08:52:12,200 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-25 08:52:12,200 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-25 08:52:12,200 - __main__ - INFO - ============================================================
2025-08-25 08:52:12,200 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-25 08:52:12,200 - __main__ - INFO - ============================================================
2025-08-25 08:52:12,200 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-25 08:52:12,200 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-25 08:52:12,200 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-25 08:52:12,200 - __main__ - INFO - ✅ 정지어: 166개
2025-08-25 08:52:12,200 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-25 08:52:12,206 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-25 08:52:12,213 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-25 08:52:12,217 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-25 08:52:12,217 - __main__ - INFO - _load_data 실행완료: 2.76초
2025-08-25 08:52:12,217 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-25 08:52:12,217 - __main__ - INFO - 메시지 처리 시작
2025-08-25 08:52:12,217 - __main__ - INFO - ============================================================
2025-08-25 08:52:12,217 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-25 08:52:12,217 - __main__ - INFO - ============================================================
2025-08-25 08:52:12,218 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-25 08:52:12,218 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-25 08:52:12,218 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-25 08:52:12,218 - __main__ - INFO - 데이터 소스: local
2025-08-25 08:52:12,218 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-25 08:52:12,218 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-25 08:52:12,218 - __main__ - INFO - LLM 모델: ax
2025-08-25 08:52:12,218 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-25 08:52:12,218 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-25 08:52:12,218 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-25 08:52:12,218 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-25 08:52:12,218 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-25 08:52:12,224 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-25 08:52:12,775 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-25 08:52:12,775 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-25 08:52:12,779 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-25 08:52:12,779 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-25 08:52:12,779 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['키즈폰', '방진', 'ZEM폰 포켓몬에디션3', '아이']
2025-08-25 08:52:12,779 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-25 08:52:13,929 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-25 08:52:13,929 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-25 08:52:13,939 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-25 08:52:13,940 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-25 08:52:14,087 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-25 08:52:14,088 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-25 08:52:14,088 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-25 08:52:14,092 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-25 08:52:14,097 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-25 08:52:14,097 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-25 08:52:14,099 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 08:52:14,104 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-25 08:52:14,104 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-25 08:52:14,105 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.89초
2025-08-25 08:52:14,105 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 08:52:14,105 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-25 08:52:14,105 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-25 08:52:15,234 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-25 08:52:15,234 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-25 08:52:15,234 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-25 08:52:15,234 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-25 08:52:15,234 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-25 08:52:15,234 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 08:52:15,234 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-25 08:52:15,234 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-25 08:52:15,234 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-25 08:52:15,235 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-25 08:52:15,235 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-25 08:52:15,235 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-25 08:52:15,235 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-25 08:52:15,235 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-25 08:52:21,694 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 08:52:21,703 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-25 08:52:21,703 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-25 08:52:21,703 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-25 08:52:21,704 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-25 08:52:21,704 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-25 08:52:21,704 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-25 08:52:21,704 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-25 08:52:21,704 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-25 08:52:22,496 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 08:52:22,732 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.03초
2025-08-25 08:52:23,603 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-25 08:52:23,603 - __main__ - INFO - ============================================================
2025-08-25 08:52:23,603 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-25 08:52:23,604 - __main__ - INFO - ============================================================
2025-08-25 08:52:23,604 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-25 08:52:23,604 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-25 08:52:23,604 - __main__ - INFO - 상품 수: 1개
2025-08-25 08:52:23,604 - __main__ - INFO - 채널 수: 3개
2025-08-25 08:52:23,604 - __main__ - INFO - 프로그램 수: 2개
2025-08-25 08:52:23,604 - __main__ - INFO - process_message 실행완료: 11.39초
2025-08-25 08:52:23,604 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-08-25 08:52:23,604 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 578자
2025-08-25 08:52:23,604 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x343b1fe90> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x343b1f920> root_client=<openai.OpenAI object at 0x33859fb90> root_async_client=<openai.AsyncOpenAI object at 0x343b1fd10> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-08-25 08:52:23,604 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-08-25 08:52:23,604 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3523자
2025-08-25 08:52:46,734 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 08:52:46,735 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2626자
2025-08-25 08:52:46,735 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ### 1. 메시지 분석
```
[메시지 요약 및 핵심 의도]
SKT는 신학기를 맞아 자녀의 첫 스마트폰으로 'ZEM폰 포켓몬에디션3'을 추천하며, SK텔레콤 공식 인증 대리점에서 구매 시 다양한 기능과 혜택을 제공한다는 내용을 전달하고 있습니다.

[식별된 가치 제안 목록]
- ZEM폰 포켓몬에디션3 구매 시 제공되는 주요 기능
  1. 실시간 위치 조회...
2025-08-25 08:52:46,735 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-08-25 08:52:46,735 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 324자
2025-08-25 08:52:46,735 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-08-25 08:52:46,736 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 2
2025-08-25 08:52:46,736 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['SK텔레콤 공식 인증 대리점:방문', 'ZEM폰 포켓몬에디션3:구매', '다양한 혜택:수령', 'ZEM폰 포켓몬에디션3:사용']
2025-08-25 08:52:46,736 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('SK텔레콤 공식 인증 대리점:방문', 'ZEM폰 포켓몬에디션3:구매'), ('ZEM폰 포켓몬에디션3:구매', '다양한 혜택:수령')]
2025-08-25 08:52:46,736 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-08-25 09:11:51,367 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-25 09:11:51,367 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-25 09:11:51,367 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-25 09:11:51,401 - __main__ - INFO - Using device: mps
2025-08-25 09:11:51,401 - __main__ - INFO - _initialize_device 실행완료: 0.03초
2025-08-25 09:11:51,401 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-25 09:11:51,401 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-25 09:11:51,401 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-25 09:11:51,402 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-25 09:11:51,402 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-25 09:11:56,421 - __main__ - INFO - Model loaded on mps
2025-08-25 09:11:56,421 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.02초
2025-08-25 09:11:56,912 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-25 09:11:56,912 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-08-25 09:11:56,912 - __main__ - INFO - ============================================================
2025-08-25 09:11:56,912 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-25 09:11:56,912 - __main__ - INFO - ============================================================
2025-08-25 09:11:56,912 - __main__ - INFO - 데이터 소스 모드: local
2025-08-25 09:11:56,912 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-25 09:11:56,912 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-25 09:11:56,912 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-25 09:11:56,912 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-25 09:11:57,026 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-25 09:11:57,026 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-25 09:11:57,035 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-25 09:11:57,039 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-25 09:11:57,040 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:11:57,043 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-25 09:11:57,043 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-25 09:11:57,044 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-25 09:11:57,044 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-25 09:11:57,044 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-25 09:11:57,044 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-25 09:11:57,044 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-25 09:11:57,052 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-25 09:11:57,053 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-25 09:11:57,053 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-25 09:11:57,358 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-25 09:11:57,360 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-25 09:11:57,360 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-25 09:11:57,360 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-25 09:11:57,360 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-25 09:11:57,361 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-25 09:11:57,361 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-25 09:11:57,361 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-25 09:11:57,361 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-25 09:11:57,368 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-25 09:11:57,370 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-25 09:11:57,370 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:11:57,427 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-25 09:11:57,427 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-25 09:11:57,427 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-25 09:11:57,439 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-25 09:11:57,439 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-25 09:11:57,693 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-25 09:11:57,694 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-25 09:11:57,694 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-25 09:11:58,187 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-25 09:11:58,187 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-25 09:11:58,187 - __main__ - INFO - ============================================================
2025-08-25 09:11:58,187 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-25 09:11:58,187 - __main__ - INFO - ============================================================
2025-08-25 09:11:58,187 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-25 09:11:58,187 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-25 09:11:58,187 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-25 09:11:58,187 - __main__ - INFO - ✅ 정지어: 166개
2025-08-25 09:11:58,187 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-25 09:11:58,192 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-25 09:11:58,199 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-25 09:11:58,203 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-25 09:11:58,203 - __main__ - INFO - _load_data 실행완료: 1.29초
2025-08-25 09:11:58,203 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-25 09:11:58,203 - __main__ - INFO - 메시지 처리 시작
2025-08-25 09:11:58,203 - __main__ - INFO - ============================================================
2025-08-25 09:11:58,203 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-25 09:11:58,203 - __main__ - INFO - ============================================================
2025-08-25 09:11:58,203 - __main__ - INFO - 메시지 내용: 
        [SKT] ZEM폰 포켓몬에디션3 안내
        (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
        우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
        ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!
 ...
2025-08-25 09:11:58,203 - __main__ - INFO - 메시지 길이: 578 문자
2025-08-25 09:11:58,203 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-25 09:11:58,204 - __main__ - INFO - 데이터 소스: local
2025-08-25 09:11:58,204 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-25 09:11:58,204 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-25 09:11:58,204 - __main__ - INFO - LLM 모델: ax
2025-08-25 09:11:58,204 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-25 09:11:58,204 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-25 09:11:58,204 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-25 09:11:58,204 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-25 09:11:58,204 - __main__ - INFO - 처리할 메시지 길이: 560 문자
2025-08-25 09:11:58,209 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-25 09:11:58,747 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-25 09:11:58,748 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-25 09:11:58,751 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-25 09:11:58,751 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-25 09:11:58,751 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['방진', 'ZEM폰 포켓몬에디션3', '아이', '키즈폰']
2025-08-25 09:11:58,751 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-25 09:11:59,876 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-25 09:11:59,876 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-25 09:11:59,885 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-25 09:11:59,885 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-25 09:12:00,029 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-25 09:12:00,030 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-25 09:12:00,030 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-25 09:12:00,032 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-25 09:12:00,038 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-25 09:12:00,038 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-25 09:12:00,040 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:12:00,044 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-25 09:12:00,044 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-25 09:12:00,045 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.84초
2025-08-25 09:12:00,045 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:12:00,045 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-25 09:12:00,045 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-25 09:12:00,139 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-25 09:12:00,139 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-25 09:12:00,139 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-25 09:12:00,139 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-25 09:12:00,139 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-25 09:12:00,139 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:12:00,139 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-25 09:12:00,140 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-25 09:12:00,140 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-25 09:12:00,141 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-25 09:12:00,141 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-25 09:12:00,141 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-25 09:12:00,141 - __main__ - INFO - 구성된 프롬프트 길이: 6405 문자
2025-08-25 09:12:00,141 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-25 09:12:06,609 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:12:06,622 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-25 09:12:06,622 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-25 09:12:06,622 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-25 09:12:06,623 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-25 09:12:06,623 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-25 09:12:06,623 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-25 09:12:06,623 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-25 09:12:06,623 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-25 09:12:07,446 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:12:07,675 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.05초
2025-08-25 09:12:08,544 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-25 09:12:08,544 - __main__ - INFO - ============================================================
2025-08-25 09:12:08,544 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-25 09:12:08,544 - __main__ - INFO - ============================================================
2025-08-25 09:12:08,544 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-25 09:12:08,544 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-25 09:12:08,544 - __main__ - INFO - 상품 수: 1개
2025-08-25 09:12:08,544 - __main__ - INFO - 채널 수: 3개
2025-08-25 09:12:08,544 - __main__ - INFO - 프로그램 수: 2개
2025-08-25 09:12:08,545 - __main__ - INFO - process_message 실행완료: 10.34초
2025-08-25 09:12:08,545 - __main__ - INFO - ============================== DAG 추출 시작 ==============================
2025-08-25 09:12:08,545 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-08-25 09:12:08,545 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 578자
2025-08-25 09:12:08,545 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358e1ffe0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358bf43e0> root_client=<openai.OpenAI object at 0x3331041d0> root_async_client=<openai.AsyncOpenAI object at 0x358bf4110> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-08-25 09:12:08,545 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-08-25 09:12:08,545 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3523자
2025-08-25 09:12:34,769 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:12:34,771 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2755자
2025-08-25 09:12:34,772 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ### 1. 메시지 분석
```
[메시지 요약 및 핵심 의도]
SKT는 신학기를 맞아 자녀의 첫 스마트폰으로 'ZEM폰 포켓몬에디션3'을 추천하며, SK텔레콤 공식 인증 대리점에서 구매 시 다양한 기능과 혜택을 제공한다는 내용을 전달하고 있습니다.

[식별된 가치 제안 목록]
- ZEM폰 포켓몬에디션3 구매 시 제공되는 주요 기능
  1. 실시간 위치 조회...
2025-08-25 09:12:34,772 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-08-25 09:12:34,773 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 270자
2025-08-25 09:12:34,773 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-08-25 09:12:34,774 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 9, 엣지 수: 7
2025-08-25 09:12:34,774 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['SK텔레콤공식인증대리점:방문', 'ZEM폰포켓몬에디션3:구매', '풍성한혜택:수령', 'ZEM앱:사용', '자녀스마트폰관리:경험', 'ZEM폰포켓몬에디션3:사용', '안전보안기능:경험', '편의기능:경험', 'IP68방수방진:경험']
2025-08-25 09:12:34,775 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('SK텔레콤공식인증대리점:방문', 'ZEM폰포켓몬에디션3:구매'), ('ZEM폰포켓몬에디션3:구매', '풍성한혜택:수령'), ('ZEM폰포켓몬에디션3:구매', 'ZEM앱:사용'), ('ZEM앱:사용', '자녀스마트폰관리:경험'), ('ZEM폰포켓몬에디션3:사용', '안전보안기능:경험'), ('ZEM폰포켓몬에디션3:사용', '편의기능:경험'), ('ZEM폰포켓몬에디션3:사용', 'IP68방수방진:경험')]
2025-08-25 09:12:34,775 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-08-25 09:12:34,776 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_a870365d62d68e3417e8da03af770a96d64293c4c3c09413b25c232df5394e51
2025-08-25 09:12:34,776 - utils - INFO - 📊 입력 그래프 - 노드 수: 9, 엣지 수: 7
2025-08-25 09:12:34,778 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-08-25 09:12:35,742 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_a870365d62d68e3417e8da03af770a96d64293c4c3c09413b25c232df5394e51.png
2025-08-25 09:12:35,742 - __main__ - INFO - ✅ DAG 추출 완료: dag_a870365d62d68e3417e8da03af770a96d64293c4c3c09413b25c232df5394e51
2025-08-25 09:12:35,742 - __main__ - INFO - 🕒 DAG 처리 시간: 27.198초
2025-08-25 09:12:35,742 - __main__ - INFO - 📏 DAG 섹션 길이: 270자
2025-08-25 09:12:35,742 - __main__ - INFO - 📄 DAG 내용 미리보기: (SK텔레콤공식인증대리점:방문) -[방문하여]-> (ZEM폰포켓몬에디션3:구매)
(ZEM폰포켓몬에디션3:구매) -[구매하면]-> (풍성한혜택:수령)
(ZEM폰포켓몬에디션3:구매) -[구매하면]-> (ZEM앱:사용)
(ZEM앱:사용) -[사용하면]-> (자녀스마트폰관리:경험)
(ZEM폰포켓몬에디션3:사용) -[사용하면]-> (안전보안기능:경험)
(ZEM폰포켓...
2025-08-25 09:18:35,565 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-25 09:18:35,565 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-25 09:18:35,565 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-25 09:18:35,636 - __main__ - INFO - Using device: mps
2025-08-25 09:18:35,636 - __main__ - INFO - _initialize_device 실행완료: 0.07초
2025-08-25 09:18:35,637 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-25 09:18:35,637 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-25 09:18:35,637 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-25 09:18:35,637 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-25 09:18:35,637 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-25 09:18:41,381 - __main__ - INFO - Model loaded on mps
2025-08-25 09:18:41,381 - __main__ - INFO - _initialize_embedding_model 실행완료: 5.74초
2025-08-25 09:18:41,838 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-25 09:18:41,839 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-08-25 09:18:41,839 - __main__ - INFO - ============================================================
2025-08-25 09:18:41,839 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-25 09:18:41,839 - __main__ - INFO - ============================================================
2025-08-25 09:18:41,839 - __main__ - INFO - 데이터 소스 모드: local
2025-08-25 09:18:41,839 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-25 09:18:41,839 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-25 09:18:41,839 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-25 09:18:41,839 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-25 09:18:41,952 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-25 09:18:41,952 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-25 09:18:41,961 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-25 09:18:41,965 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-25 09:18:41,966 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:18:41,969 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-25 09:18:41,969 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-25 09:18:41,970 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-25 09:18:41,970 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-25 09:18:41,970 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-25 09:18:41,970 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-25 09:18:41,970 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-25 09:18:41,977 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-25 09:18:41,978 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-25 09:18:41,978 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-25 09:18:42,285 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-25 09:18:42,287 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-25 09:18:42,287 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-25 09:18:42,287 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-25 09:18:42,287 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-25 09:18:42,288 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-25 09:18:42,288 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-25 09:18:42,288 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-25 09:18:42,288 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-25 09:18:42,295 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-25 09:18:42,297 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-25 09:18:42,297 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:18:42,351 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-25 09:18:42,351 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-25 09:18:42,351 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-25 09:18:42,363 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-25 09:18:42,364 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-25 09:18:42,578 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-25 09:18:42,578 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-25 09:18:42,579 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-25 09:18:43,070 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-25 09:18:43,070 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-25 09:18:43,070 - __main__ - INFO - ============================================================
2025-08-25 09:18:43,070 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-25 09:18:43,070 - __main__ - INFO - ============================================================
2025-08-25 09:18:43,070 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-25 09:18:43,070 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-25 09:18:43,070 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-25 09:18:43,070 - __main__ - INFO - ✅ 정지어: 166개
2025-08-25 09:18:43,070 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-25 09:18:43,075 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-25 09:18:43,082 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-25 09:18:43,086 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-25 09:18:43,086 - __main__ - INFO - _load_data 실행완료: 1.25초
2025-08-25 09:18:43,086 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-25 09:18:43,086 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-08-25 09:18:43,086 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            [SKT] ZEM폰 포켓몬에디션3 안내
            (광고...
2025-08-25 09:18:43,086 - __main__ - INFO - ============================================================
2025-08-25 09:18:43,086 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-25 09:18:43,086 - __main__ - INFO - ============================================================
2025-08-25 09:18:43,086 - __main__ - INFO - 메시지 내용: 
            [SKT] ZEM폰 포켓몬에디션3 안내
            (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
            우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
            ZEM폰 포켓몬에디션3으로 우리 아...
2025-08-25 09:18:43,086 - __main__ - INFO - 메시지 길이: 646 문자
2025-08-25 09:18:43,086 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-25 09:18:43,086 - __main__ - INFO - 데이터 소스: local
2025-08-25 09:18:43,086 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-25 09:18:43,086 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-25 09:18:43,086 - __main__ - INFO - LLM 모델: ax
2025-08-25 09:18:43,086 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-25 09:18:43,086 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-25 09:18:43,086 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-25 09:18:43,086 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-25 09:18:43,086 - __main__ - INFO - 처리할 메시지 길이: 620 문자
2025-08-25 09:18:43,091 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-25 09:18:43,643 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-25 09:18:43,644 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-25 09:18:43,647 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-25 09:18:43,647 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-25 09:18:43,647 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['키즈폰', 'ZEM폰 포켓몬에디션3', '아이', '방진']
2025-08-25 09:18:43,647 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-25 09:18:44,890 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-25 09:18:44,891 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-25 09:18:44,900 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-25 09:18:44,900 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-25 09:18:45,047 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-25 09:18:45,047 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-25 09:18:45,047 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-25 09:18:45,050 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-25 09:18:45,055 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-25 09:18:45,055 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-25 09:18:45,057 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:18:45,062 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-25 09:18:45,062 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-25 09:18:45,062 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.98초
2025-08-25 09:18:45,063 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:18:45,063 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-25 09:18:45,063 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-25 09:18:45,170 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-25 09:18:45,170 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-25 09:18:45,170 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-25 09:18:45,170 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-25 09:18:45,170 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-25 09:18:45,170 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:18:45,170 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-25 09:18:45,170 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-25 09:18:45,171 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-25 09:18:45,172 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-25 09:18:45,172 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-25 09:18:45,172 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-25 09:18:45,172 - __main__ - INFO - 구성된 프롬프트 길이: 6465 문자
2025-08-25 09:18:45,172 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-25 09:18:51,699 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:18:51,704 - __main__ - INFO - LLM 응답 길이: 817 문자
2025-08-25 09:18:51,704 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-25 09:18:51,704 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-25 09:18:51,704 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-25 09:18:51,704 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-25 09:18:51,704 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-25 09:18:51,704 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-25 09:18:51,704 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-25 09:18:52,520 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:18:52,747 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.04초
2025-08-25 09:18:53,617 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-25 09:18:53,617 - __main__ - INFO - ============================================================
2025-08-25 09:18:53,617 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-25 09:18:53,617 - __main__ - INFO - ============================================================
2025-08-25 09:18:53,617 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-25 09:18:53,617 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-25 09:18:53,617 - __main__ - INFO - 상품 수: 1개
2025-08-25 09:18:53,617 - __main__ - INFO - 채널 수: 3개
2025-08-25 09:18:53,617 - __main__ - INFO - 프로그램 수: 2개
2025-08-25 09:18:53,617 - __main__ - INFO - process_message 실행완료: 10.53초
2025-08-25 09:18:53,617 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-08-25 09:19:43,245 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-25 09:19:43,245 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-25 09:19:43,245 - __main__ - INFO - 🎯 DAG 추출 모드 활성화됨
2025-08-25 09:19:43,264 - __main__ - INFO - Using device: mps
2025-08-25 09:19:43,264 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-25 09:19:43,264 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-25 09:19:43,264 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-25 09:19:43,264 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-25 09:19:43,264 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-25 09:19:43,264 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-25 09:19:44,143 - __main__ - INFO - Model loaded on mps
2025-08-25 09:19:44,143 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.88초
2025-08-25 09:19:44,551 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-25 09:19:44,551 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-25 09:19:44,551 - __main__ - INFO - ============================================================
2025-08-25 09:19:44,551 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-25 09:19:44,551 - __main__ - INFO - ============================================================
2025-08-25 09:19:44,551 - __main__ - INFO - 데이터 소스 모드: local
2025-08-25 09:19:44,551 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-25 09:19:44,551 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-25 09:19:44,551 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-25 09:19:44,551 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-25 09:19:44,659 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-25 09:19:44,659 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-25 09:19:44,667 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-25 09:19:44,671 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-25 09:19:44,672 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:19:44,676 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-25 09:19:44,677 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-25 09:19:44,677 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-25 09:19:44,677 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-25 09:19:44,677 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-25 09:19:44,677 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-25 09:19:44,677 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-25 09:19:44,678 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-25 09:19:44,679 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-25 09:19:44,679 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-25 09:19:44,984 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-25 09:19:44,985 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-25 09:19:44,985 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-25 09:19:44,986 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-25 09:19:44,986 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-25 09:19:44,987 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-25 09:19:44,987 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-25 09:19:44,987 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-25 09:19:44,987 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-25 09:19:44,994 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-25 09:19:44,996 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-25 09:19:44,996 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-25 09:19:45,050 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-25 09:19:45,051 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-25 09:19:45,051 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-25 09:19:45,052 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-25 09:19:45,052 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-25 09:19:45,221 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-25 09:19:45,222 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-25 09:19:45,222 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-25 09:19:45,695 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-25 09:19:45,695 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-25 09:19:45,695 - __main__ - INFO - ============================================================
2025-08-25 09:19:45,695 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-25 09:19:45,695 - __main__ - INFO - ============================================================
2025-08-25 09:19:45,695 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-25 09:19:45,695 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-25 09:19:45,696 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-25 09:19:45,696 - __main__ - INFO - ✅ 정지어: 166개
2025-08-25 09:19:45,696 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-25 09:19:45,700 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-25 09:19:45,708 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-25 09:19:45,712 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-25 09:19:45,712 - __main__ - INFO - _load_data 실행완료: 1.16초
2025-08-25 09:19:45,712 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-25 09:19:45,712 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-08-25 09:19:45,712 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            [SKT] ZEM폰 포켓몬에디션3 안내
            (광고...
2025-08-25 09:19:45,712 - __main__ - INFO - ============================================================
2025-08-25 09:19:45,712 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-25 09:19:45,712 - __main__ - INFO - ============================================================
2025-08-25 09:19:45,712 - __main__ - INFO - 메시지 내용: 
            [SKT] ZEM폰 포켓몬에디션3 안내
            (광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
            우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
            ZEM폰 포켓몬에디션3으로 우리 아...
2025-08-25 09:19:45,712 - __main__ - INFO - 메시지 길이: 646 문자
2025-08-25 09:19:45,712 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-25 09:19:45,712 - __main__ - INFO - ============================== DAG 추출 시작 ==============================
2025-08-25 09:19:45,712 - __main__ - INFO - 데이터 소스: local
2025-08-25 09:19:45,713 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-08-25 09:19:45,713 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-08-25 09:19:45,713 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 646자
2025-08-25 09:19:45,713 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-25 09:19:45,713 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34ee05b50> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35a8917f0> root_client=<openai.OpenAI object at 0x34ee05bb0> root_async_client=<openai.AsyncOpenAI object at 0x34ee05a90> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-08-25 09:19:45,713 - __main__ - INFO - LLM 모델: ax
2025-08-25 09:19:45,713 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-08-25 09:19:45,713 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-25 09:19:45,713 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3591자
2025-08-25 09:19:45,713 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-25 09:19:45,713 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-25 09:19:45,713 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-25 09:19:45,713 - __main__ - INFO - 처리할 메시지 길이: 620 문자
2025-08-25 09:19:45,721 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-25 09:19:46,252 - __main__ - INFO - 분할된 문장 수: 5개
2025-08-25 09:19:46,265 - __main__ - INFO - 필터링된 문장들: [' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-08-25 09:19:46,270 - __main__ - INFO - 전체 토큰 수: 151개
2025-08-25 09:19:46,271 - __main__ - INFO - NNP 태그 토큰들: ['ZEM폰 포켓몬에디션3', '광고', '우리', '스마트폰', '우리', '아이', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '방진', '수신거부']
2025-08-25 09:19:46,271 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '방진', '키즈폰', '아이']
2025-08-25 09:19:46,271 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-25 09:19:47,461 - __main__ - INFO - 퍼지 매칭 결과 크기: (4047, 3)
2025-08-25 09:19:47,461 - __main__ - INFO - 퍼지 매칭 성공: 4047개 결과
2025-08-25 09:19:47,463 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.5}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.4285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.41666666666666663}]
2025-08-25 09:19:47,463 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-25 09:19:47,624 - __main__ - INFO - 시퀀스 유사도 결과 크기: (4047, 3)
2025-08-25 09:19:47,625 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '아이폰 14', 'sim': 0.4}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트피싱보호', 'sim': 0.34285714285714286}, {'sent': ' SKT ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': 'PPS스마트폰 프리미엄', 'sim': 0.4}]
2025-08-25 09:19:47,625 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-25 09:19:47,628 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 24개
2025-08-25 09:19:47,632 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-08-25 09:19:47,633 - __main__ - INFO - 통합된 후보 아이템 수: 25개
2025-08-25 09:19:47,634 - __main__ - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:19:47,639 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (18, 2)
2025-08-25 09:19:47,640 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}, {'item_nm': 'ZEM폰 포켓몬에디션2', 'item_id': ['A53S']}]
2025-08-25 09:19:47,640 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.93초
2025-08-25 09:19:47,640 - __main__ - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:19:47,640 - __main__ - INFO - 매칭된 상품 정보: (18, 2)
2025-08-25 09:19:47,640 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-25 09:19:47,732 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-25 09:19:47,732 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-25 09:19:47,732 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-08-25 09:19:47,732 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-25 09:19:47,732 - __main__ - INFO - 후보 아이템 리스트 크기: 18개
2025-08-25 09:19:47,732 - __main__ - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', 'ZEM폰 포켓몬에디션2', 'I8', '스마트로', '조선', '이마트', '위모', '우리아이', '스키', '스마트콘', '스마트60', 'T 에이스', '스마트 사인', '모스트', '마제', '리안', 'kt키즈폰', '치안']
2025-08-25 09:19:47,732 - __main__ - INFO - extra_item_pdf 크기: (18, 2)
2025-08-25 09:19:47,732 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-25 09:19:47,732 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'I8', 'item_id': ['A0PD']}, {'item_nm': 'T 에이스', 'item_id': ['NA00005525']}]
2025-08-25 09:19:47,733 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 18개
2025-08-25 09:19:47,733 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'I8', 'action': '기타'}, {'name': 'T 에이스', 'action': '기타'}]
2025-08-25 09:19:47,733 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-25 09:19:47,734 - __main__ - INFO - 구성된 프롬프트 길이: 6465 문자
2025-08-25 09:19:47,734 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-08-25 09:19:54,891 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:19:54,903 - __main__ - INFO - LLM 응답 길이: 925 문자
2025-08-25 09:19:54,903 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 키즈폰",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx",
            "action": "추가 정보"
        },
...
2025-08-25 09:19:54,903 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-25 09:19:54,903 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-25 09:19:54,903 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-25 09:19:54,904 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[SKT] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 키즈폰', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=30684&a=&u=https://bit.ly/3yQF2hx', 'action': '추가 정보'}, {'type': '전화번호', 'value': 'SKT 고객센터(1558, 무료)', 'action': '문의'}, {'type': '대리점', 'value': 'SK텔레콤 공식 인증 대리점', 'action': '가입'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-08-25 09:19:54,904 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-25 09:19:54,904 - __main__ - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 키즈폰']
2025-08-25 09:19:55,801 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:19:56,029 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.13초
2025-08-25 09:19:56,909 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-25 09:19:56,909 - __main__ - INFO - ============================================================
2025-08-25 09:19:56,909 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-25 09:19:56,909 - __main__ - INFO - ============================================================
2025-08-25 09:19:56,909 - __main__ - INFO - 제목: [SKT] ZEM폰 포켓몬에디션3 안내
2025-08-25 09:19:56,909 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-08-25 09:19:56,909 - __main__ - INFO - 상품 수: 1개
2025-08-25 09:19:56,909 - __main__ - INFO - 채널 수: 4개
2025-08-25 09:19:56,910 - __main__ - INFO - 프로그램 수: 2개
2025-08-25 09:19:56,910 - __main__ - INFO - process_message 실행완료: 11.20초
2025-08-25 09:20:08,599 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-25 09:20:08,603 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2449자
2025-08-25 09:20:08,604 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ### 1. 메시지 분석
```
[메시지 요약 및 핵심 의도]
SKT는 신학기를 맞아 자녀의 첫 스마트폰으로 'ZEM폰 포켓몬에디션3'을 추천하며, SK텔레콤 공식 인증 대리점에서 구매 시 다양한 기능과 혜택을 제공한다는 내용을 전달하고 있습니다.

[식별된 가치 제안 목록]
- ZEM폰 포켓몬에디션3 구매 시 제공되는 주요 기능
  1. 실시간 위치 조회...
2025-08-25 09:20:08,604 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-08-25 09:20:08,605 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 165자
2025-08-25 09:20:08,605 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-08-25 09:20:08,606 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-08-25 09:20:08,606 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['SK텔레콤공식인증대리점:방문', 'ZEM폰포켓몬에디션3:구매', 'ZEM앱설치안전한키즈폰:사용', '주요기능:사용', '풍성한혜택:수령']
2025-08-25 09:20:08,606 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('SK텔레콤공식인증대리점:방문', 'ZEM폰포켓몬에디션3:구매'), ('ZEM폰포켓몬에디션3:구매', 'ZEM앱설치안전한키즈폰:사용'), ('ZEM폰포켓몬에디션3:구매', '풍성한혜택:수령'), ('ZEM앱설치안전한키즈폰:사용', '주요기능:사용')]
2025-08-25 09:20:08,607 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-08-25 09:20:08,607 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_93143232a3b270438c89d90b655a15945a8add64d42775097edd35c2a262bce6
2025-08-25 09:20:08,607 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-08-25 09:20:08,608 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-08-25 09:20:09,210 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_93143232a3b270438c89d90b655a15945a8add64d42775097edd35c2a262bce6.png
2025-08-25 09:20:09,211 - __main__ - INFO - ✅ DAG 추출 완료: dag_93143232a3b270438c89d90b655a15945a8add64d42775097edd35c2a262bce6
2025-08-25 09:20:09,211 - __main__ - INFO - 🕒 DAG 처리 시간: 23.498초
2025-08-25 09:20:09,211 - __main__ - INFO - 📏 DAG 섹션 길이: 165자
2025-08-25 09:20:09,211 - __main__ - INFO - 📄 DAG 내용 미리보기: (SK텔레콤공식인증대리점:방문) -[방문하여]-> (ZEM폰포켓몬에디션3:구매)
(ZEM폰포켓몬에디션3:구매) -[구매하면]-> (ZEM앱설치안전한키즈폰:사용)
(ZEM앱설치안전한키즈폰:사용) -[사용하면]-> (주요기능:사용)
(ZEM폰포켓몬에디션3:구매) -[구매하면]-> (풍성한혜택:수령)...
2025-08-25 09:20:09,212 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-08-26 16:16:55,412 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-26 16:16:55,412 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-26 16:16:55,412 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-26 16:16:55,431 - __main__ - INFO - Using device: mps
2025-08-26 16:16:55,431 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-26 16:16:55,431 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-26 16:16:55,431 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-26 16:16:55,431 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-26 16:16:55,432 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-26 16:16:55,432 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-26 16:16:59,389 - __main__ - INFO - Model loaded on mps
2025-08-26 16:16:59,389 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.96초
2025-08-26 16:16:59,844 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-26 16:16:59,844 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-08-26 16:16:59,844 - __main__ - INFO - ============================================================
2025-08-26 16:16:59,844 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-26 16:16:59,844 - __main__ - INFO - ============================================================
2025-08-26 16:16:59,844 - __main__ - INFO - 데이터 소스 모드: local
2025-08-26 16:16:59,844 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-26 16:16:59,844 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-26 16:16:59,844 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-26 16:16:59,844 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-26 16:16:59,957 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-26 16:16:59,957 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-26 16:16:59,966 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-26 16:16:59,970 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-26 16:16:59,971 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:16:59,975 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-26 16:16:59,975 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-26 16:16:59,975 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-26 16:16:59,975 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-26 16:16:59,975 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-26 16:16:59,975 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-26 16:16:59,976 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-26 16:16:59,985 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-26 16:16:59,986 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-26 16:16:59,986 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-26 16:17:00,305 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-26 16:17:00,307 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-26 16:17:00,307 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-26 16:17:00,307 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-26 16:17:00,307 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-26 16:17:00,309 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-26 16:17:00,309 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-26 16:17:00,309 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-26 16:17:00,309 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-26 16:17:00,316 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-26 16:17:00,319 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-26 16:17:00,319 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:17:00,370 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-26 16:17:00,371 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-26 16:17:00,371 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-26 16:17:00,384 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-26 16:17:00,384 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-26 16:17:02,163 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-26 16:17:02,163 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-26 16:17:02,163 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-26 16:17:02,652 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-26 16:17:02,652 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-26 16:17:02,652 - __main__ - INFO - ============================================================
2025-08-26 16:17:02,652 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-26 16:17:02,652 - __main__ - INFO - ============================================================
2025-08-26 16:17:02,652 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-26 16:17:02,652 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-26 16:17:02,652 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-26 16:17:02,653 - __main__ - INFO - ✅ 정지어: 166개
2025-08-26 16:17:02,653 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-26 16:17:02,657 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-26 16:17:02,665 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-26 16:17:02,669 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-26 16:17:02,669 - __main__ - INFO - _load_data 실행완료: 2.83초
2025-08-26 16:17:02,669 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-26 16:17:02,669 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-08-26 16:17:02,669 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-08-26 16:17:02,669 - __main__ - INFO - ============================================================
2025-08-26 16:17:02,669 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-26 16:17:02,669 - __main__ - INFO - ============================================================
2025-08-26 16:17:02,669 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-08-26 16:17:02,669 - __main__ - INFO - 메시지 길이: 675 문자
2025-08-26 16:17:02,670 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-26 16:17:02,670 - __main__ - INFO - 데이터 소스: local
2025-08-26 16:17:02,670 - __main__ - INFO - 상품 정보 추출 모드: rag
2025-08-26 16:17:02,670 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-26 16:17:02,670 - __main__ - INFO - LLM 모델: ax
2025-08-26 16:17:02,670 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-26 16:17:02,670 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-26 16:17:02,670 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-26 16:17:02,670 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-26 16:17:02,670 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-08-26 16:17:02,675 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-26 16:17:03,199 - __main__ - INFO - 분할된 문장 수: 21개
2025-08-26 16:17:03,200 - __main__ - INFO - 필터링된 문장들: [' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', '넷플릭스 웨이브 월 이게 되네 ', ' 고객님 ']...
2025-08-26 16:17:03,205 - __main__ - INFO - 전체 토큰 수: 261개
2025-08-26 16:17:03,205 - __main__ - INFO - NNP 태그 토큰들: ['넷플릭스', '웨이브', '광고', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '우주패스 Netflix', '-', '-', '우주패스 Netflix', '광고', '스탠다드', '쿠폰', '우주패스 Netflix', '-', '기본', 'Netflix 광고형 스탠다드', '-', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', '프리미엄', '-', '쿠폰', '-', '쿠폰', '할인', '수신거부']
2025-08-26 16:17:03,205 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', '넷플릭스', '웨이브', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드']
2025-08-26 16:17:03,205 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-26 16:17:05,976 - __main__ - INFO - 퍼지 매칭 결과 크기: (14056, 3)
2025-08-26 16:17:05,976 - __main__ - INFO - 퍼지 매칭 성공: 14056개 결과
2025-08-26 16:17:05,983 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.5714285714285714}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.4}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.4}]
2025-08-26 16:17:05,984 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-26 16:17:06,177 - __main__ - INFO - 시퀀스 유사도 결과 크기: (14056, 3)
2025-08-26 16:17:06,178 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.6000000000000001}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.32000000000000006}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.32000000000000006}]
2025-08-26 16:17:06,178 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-26 16:17:06,182 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 111개
2025-08-26 16:17:06,188 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 8개
2025-08-26 16:17:06,188 - __main__ - INFO - 통합된 후보 아이템 수: 119개
2025-08-26 16:17:06,190 - __main__ - INFO - 최종 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:17:06,194 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (52, 2)
2025-08-26 16:17:06,194 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}, {'item_nm': 'FLO', 'item_id': ['V683']}]
2025-08-26 16:17:06,195 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 3.53초
2025-08-26 16:17:06,195 - __main__ - INFO - 추출된 후보 엔티티: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:17:06,195 - __main__ - INFO - 매칭된 상품 정보: (52, 2)
2025-08-26 16:17:06,195 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-26 16:17:07,281 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-26 16:17:07,281 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-26 16:17:07,281 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-08-26 16:17:07,281 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-26 16:17:07,281 - __main__ - INFO - 후보 아이템 리스트 크기: 63개
2025-08-26 16:17:07,281 - __main__ - INFO - 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:17:07,281 - __main__ - INFO - extra_item_pdf 크기: (52, 2)
2025-08-26 16:17:07,281 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-26 16:17:07,282 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}]
2025-08-26 16:17:07,282 - __main__ - INFO - RAG 모드: 후보 상품 목록을 RAG 컨텍스트에 추가
2025-08-26 16:17:07,282 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-26 16:17:07,282 - __main__ - INFO - 구성된 프롬프트 길이: 6970 문자
2025-08-26 16:17:07,282 - __main__ - INFO - RAG 컨텍스트 포함 여부: True
2025-08-26 16:17:13,092 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:17:13,105 - __main__ - INFO - LLM 응답 길이: 774 문자
2025-08-26 16:17:13,106 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/jAs/#74",
            "action": "추가 정보"
        },
        {
            ...
2025-08-26 16:17:13,106 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-26 16:17:13,106 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-26 16:17:13,106 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-26 16:17:13,106 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-08-26 16:17:13,106 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-26 16:17:13,106 - __main__ - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Wavve 콘텐츠 팩']
2025-08-26 16:17:14,229 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:17:14,643 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.54초
2025-08-26 16:17:14,650 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-26 16:17:14,651 - __main__ - INFO - ============================================================
2025-08-26 16:17:14,651 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-26 16:17:14,651 - __main__ - INFO - ============================================================
2025-08-26 16:17:14,651 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-08-26 16:17:14,651 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-08-26 16:17:14,651 - __main__ - INFO - 상품 수: 4개
2025-08-26 16:17:14,651 - __main__ - INFO - 채널 수: 3개
2025-08-26 16:17:14,651 - __main__ - INFO - 프로그램 수: 2개
2025-08-26 16:17:14,651 - __main__ - INFO - process_message 실행완료: 11.98초
2025-08-26 16:17:14,651 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-08-26 16:18:36,824 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-26 16:18:36,825 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-26 16:18:36,825 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-26 16:18:36,844 - __main__ - INFO - Using device: mps
2025-08-26 16:18:36,844 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-26 16:18:36,844 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-26 16:18:36,844 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-26 16:18:36,844 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-26 16:18:36,844 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-26 16:18:36,844 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-26 16:18:37,752 - __main__ - INFO - Model loaded on mps
2025-08-26 16:18:37,752 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.91초
2025-08-26 16:18:38,161 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-26 16:18:38,161 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-08-26 16:18:38,161 - __main__ - INFO - ============================================================
2025-08-26 16:18:38,161 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-26 16:18:38,161 - __main__ - INFO - ============================================================
2025-08-26 16:18:38,161 - __main__ - INFO - 데이터 소스 모드: local
2025-08-26 16:18:38,161 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-26 16:18:38,161 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-26 16:18:38,161 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-26 16:18:38,161 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-26 16:18:38,269 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-26 16:18:38,269 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-26 16:18:38,278 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-26 16:18:38,282 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-26 16:18:38,283 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:18:38,286 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-26 16:18:38,287 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-26 16:18:38,287 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-26 16:18:38,287 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-26 16:18:38,287 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-26 16:18:38,287 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-26 16:18:38,287 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-26 16:18:38,289 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-26 16:18:38,290 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-26 16:18:38,290 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-26 16:18:38,603 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-26 16:18:38,605 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-26 16:18:38,605 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-26 16:18:38,605 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-26 16:18:38,606 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-26 16:18:38,607 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-26 16:18:38,607 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-26 16:18:38,607 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-26 16:18:38,607 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-26 16:18:38,614 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-26 16:18:38,616 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-26 16:18:38,616 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:18:38,681 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-26 16:18:38,682 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-26 16:18:38,682 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-26 16:18:38,683 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-26 16:18:38,683 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-26 16:18:38,853 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-26 16:18:38,853 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-26 16:18:38,853 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-26 16:18:39,375 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-26 16:18:39,375 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-26 16:18:39,375 - __main__ - INFO - ============================================================
2025-08-26 16:18:39,375 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-26 16:18:39,375 - __main__ - INFO - ============================================================
2025-08-26 16:18:39,375 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-26 16:18:39,375 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-26 16:18:39,375 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-26 16:18:39,375 - __main__ - INFO - ✅ 정지어: 166개
2025-08-26 16:18:39,375 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-26 16:18:39,380 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-26 16:18:39,387 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-26 16:18:39,391 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-26 16:18:39,391 - __main__ - INFO - _load_data 실행완료: 1.23초
2025-08-26 16:18:39,391 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-26 16:18:39,391 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-08-26 16:18:39,391 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-08-26 16:18:39,391 - __main__ - INFO - ============================================================
2025-08-26 16:18:39,391 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-26 16:18:39,391 - __main__ - INFO - ============================================================
2025-08-26 16:18:39,391 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-08-26 16:18:39,391 - __main__ - INFO - 메시지 길이: 675 문자
2025-08-26 16:18:39,391 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-26 16:18:39,391 - __main__ - INFO - 데이터 소스: local
2025-08-26 16:18:39,391 - __main__ - INFO - 상품 정보 추출 모드: rag
2025-08-26 16:18:39,391 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-26 16:18:39,391 - __main__ - INFO - LLM 모델: ax
2025-08-26 16:18:39,391 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-26 16:18:39,391 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-26 16:18:39,391 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-26 16:18:39,391 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-26 16:18:39,391 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-08-26 16:18:39,397 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-26 16:18:39,934 - __main__ - INFO - 분할된 문장 수: 21개
2025-08-26 16:18:39,935 - __main__ - INFO - 필터링된 문장들: [' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', '넷플릭스 웨이브 월 이게 되네 ', ' 고객님 ']...
2025-08-26 16:18:39,940 - __main__ - INFO - 전체 토큰 수: 261개
2025-08-26 16:18:39,940 - __main__ - INFO - NNP 태그 토큰들: ['넷플릭스', '웨이브', '광고', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '우주패스 Netflix', '-', '-', '우주패스 Netflix', '광고', '스탠다드', '쿠폰', '우주패스 Netflix', '-', '기본', 'Netflix 광고형 스탠다드', '-', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', '프리미엄', '-', '쿠폰', '-', '쿠폰', '할인', '수신거부']
2025-08-26 16:18:39,940 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', 'Netflix 스탠다드', '넷플릭스', 'Netflix 광고형 스탠다드', '우주패스 Netflix', '웨이브']
2025-08-26 16:18:39,940 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-26 16:18:42,706 - __main__ - INFO - 퍼지 매칭 결과 크기: (14056, 3)
2025-08-26 16:18:42,706 - __main__ - INFO - 퍼지 매칭 성공: 14056개 결과
2025-08-26 16:18:42,709 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.5714285714285714}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.4}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.4}]
2025-08-26 16:18:42,709 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-26 16:18:42,908 - __main__ - INFO - 시퀀스 유사도 결과 크기: (14056, 3)
2025-08-26 16:18:42,908 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.6000000000000001}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.32000000000000006}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.32000000000000006}]
2025-08-26 16:18:42,908 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-26 16:18:42,913 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 111개
2025-08-26 16:18:42,918 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 8개
2025-08-26 16:18:42,919 - __main__ - INFO - 통합된 후보 아이템 수: 119개
2025-08-26 16:18:42,921 - __main__ - INFO - 최종 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:18:42,925 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (52, 2)
2025-08-26 16:18:42,925 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}, {'item_nm': 'FLO', 'item_id': ['V683']}]
2025-08-26 16:18:42,926 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 3.53초
2025-08-26 16:18:42,926 - __main__ - INFO - 추출된 후보 엔티티: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:18:42,926 - __main__ - INFO - 매칭된 상품 정보: (52, 2)
2025-08-26 16:18:42,926 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-26 16:18:43,050 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-26 16:18:43,050 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-26 16:18:43,050 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-08-26 16:18:43,050 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-26 16:18:43,050 - __main__ - INFO - 후보 아이템 리스트 크기: 63개
2025-08-26 16:18:43,051 - __main__ - INFO - 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:18:43,051 - __main__ - INFO - extra_item_pdf 크기: (52, 2)
2025-08-26 16:18:43,051 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-26 16:18:43,051 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}]
2025-08-26 16:18:43,051 - __main__ - INFO - RAG 모드: 후보 상품 목록을 RAG 컨텍스트에 추가
2025-08-26 16:18:43,051 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-26 16:18:43,051 - __main__ - INFO - 구성된 프롬프트 길이: 6970 문자
2025-08-26 16:18:43,051 - __main__ - INFO - RAG 컨텍스트 포함 여부: True
2025-08-26 16:18:48,759 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:18:48,773 - __main__ - INFO - LLM 응답 길이: 774 문자
2025-08-26 16:18:48,773 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/jAs/#74",
            "action": "추가 정보"
        },
        {
            ...
2025-08-26 16:18:48,773 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-26 16:18:48,773 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-26 16:18:48,774 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-26 16:18:48,774 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-08-26 16:18:48,774 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-26 16:18:48,774 - __main__ - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Wavve 콘텐츠 팩']
2025-08-26 16:18:49,939 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:18:50,347 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.57초
2025-08-26 16:18:50,355 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-26 16:18:50,355 - __main__ - INFO - ============================================================
2025-08-26 16:18:50,355 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-26 16:18:50,355 - __main__ - INFO - ============================================================
2025-08-26 16:18:50,355 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-08-26 16:18:50,355 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-08-26 16:18:50,355 - __main__ - INFO - 상품 수: 4개
2025-08-26 16:18:50,355 - __main__ - INFO - 채널 수: 3개
2025-08-26 16:18:50,355 - __main__ - INFO - 프로그램 수: 2개
2025-08-26 16:18:50,355 - __main__ - INFO - process_message 실행완료: 10.96초
2025-08-26 16:18:50,355 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-08-26 16:31:52,648 - __main__ - INFO - MMS 추출기 초기화 중...
2025-08-26 16:31:52,648 - __main__ - INFO - MMSExtractor 초기화 시작
2025-08-26 16:31:52,648 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-08-26 16:31:52,669 - __main__ - INFO - Using device: mps
2025-08-26 16:31:52,670 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-08-26 16:31:52,670 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-08-26 16:31:52,670 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-08-26 16:31:52,670 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-08-26 16:31:52,670 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-08-26 16:31:52,670 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-08-26 16:31:53,765 - __main__ - INFO - Model loaded on mps
2025-08-26 16:31:53,765 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.09초
2025-08-26 16:31:54,229 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-08-26 16:31:54,229 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-08-26 16:31:54,229 - __main__ - INFO - ============================================================
2025-08-26 16:31:54,229 - __main__ - INFO - 📊 데이터 로딩 시작
2025-08-26 16:31:54,229 - __main__ - INFO - ============================================================
2025-08-26 16:31:54,230 - __main__ - INFO - 데이터 소스 모드: local
2025-08-26 16:31:54,230 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-08-26 16:31:54,230 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-08-26 16:31:54,230 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-08-26 16:31:54,230 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-08-26 16:31:54,336 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-08-26 16:31:54,336 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-08-26 16:31:54,344 - __main__ - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-08-26 16:31:54,348 - __main__ - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-08-26 16:31:54,349 - __main__ - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:31:54,354 - __main__ - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-08-26 16:31:54,354 - __main__ - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-08-26 16:31:54,354 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-08-26 16:31:54,354 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-08-26 16:31:54,354 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-08-26 16:31:54,354 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-08-26 16:31:54,354 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-08-26 16:31:54,356 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-08-26 16:31:54,357 - __main__ - INFO - null이 아닌 상품명 수: 44275개
2025-08-26 16:31:54,357 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-08-26 16:31:54,661 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-08-26 16:31:54,663 - __main__ - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-08-26 16:31:54,663 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-08-26 16:31:54,663 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-08-26 16:31:54,663 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-08-26 16:31:54,664 - __main__ - INFO - 정지어 로드 완료: 166개
2025-08-26 16:31:54,664 - __main__ - INFO - 로드된 정지어 수: 166개
2025-08-26 16:31:54,664 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-08-26 16:31:54,664 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-08-26 16:31:54,671 - __main__ - INFO - 등록할 고유 별칭 수: 65154개
2025-08-26 16:31:54,673 - __main__ - INFO - 유효한 별칭 수: 65154개
2025-08-26 16:31:54,673 - __main__ - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-08-26 16:31:54,725 - __main__ - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-08-26 16:31:54,726 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-08-26 16:31:54,726 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-08-26 16:31:54,727 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-08-26 16:31:54,727 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-08-26 16:31:54,929 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-08-26 16:31:54,929 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-08-26 16:31:54,929 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-08-26 16:31:55,411 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-08-26 16:31:55,411 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-08-26 16:31:55,412 - __main__ - INFO - ============================================================
2025-08-26 16:31:55,412 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-08-26 16:31:55,412 - __main__ - INFO - ============================================================
2025-08-26 16:31:55,412 - __main__ - INFO - ✅ 상품 데이터: (94279, 9)
2025-08-26 16:31:55,412 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-08-26 16:31:55,412 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-08-26 16:31:55,412 - __main__ - INFO - ✅ 정지어: 166개
2025-08-26 16:31:55,412 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-08-26 16:31:55,417 - __main__ - INFO - 고유 상품명 수: 32157개
2025-08-26 16:31:55,424 - __main__ - INFO - 고유 별칭 수: 65154개
2025-08-26 16:31:55,428 - __main__ - INFO - 고유 상품ID 수: 44186개
2025-08-26 16:31:55,428 - __main__ - INFO - _load_data 실행완료: 1.20초
2025-08-26 16:31:55,428 - __main__ - INFO - MMSExtractor 초기화 완료
2025-08-26 16:31:55,428 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-08-26 16:31:55,428 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-08-26 16:31:55,428 - __main__ - INFO - ============================================================
2025-08-26 16:31:55,428 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-08-26 16:31:55,428 - __main__ - INFO - ============================================================
2025-08-26 16:31:55,428 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-08-26 16:31:55,428 - __main__ - INFO - 메시지 길이: 675 문자
2025-08-26 16:31:55,428 - __main__ - INFO - === 현재 추출기 설정 ===
2025-08-26 16:31:55,428 - __main__ - INFO - 데이터 소스: local
2025-08-26 16:31:55,428 - __main__ - INFO - 상품 정보 추출 모드: rag
2025-08-26 16:31:55,428 - __main__ - INFO - 엔티티 추출 모드: llm
2025-08-26 16:31:55,428 - __main__ - INFO - LLM 모델: ax
2025-08-26 16:31:55,428 - __main__ - INFO - 상품 데이터 크기: (94279, 9)
2025-08-26 16:31:55,428 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-08-26 16:31:55,428 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-08-26 16:31:55,428 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-08-26 16:31:55,428 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-08-26 16:31:55,434 - __main__ - INFO - 매칭할 상품 별칭 수: 65154개
2025-08-26 16:31:55,971 - __main__ - INFO - 분할된 문장 수: 21개
2025-08-26 16:31:55,972 - __main__ - INFO - 필터링된 문장들: [' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', '넷플릭스 웨이브 월 이게 되네 ', ' 고객님 ']...
2025-08-26 16:31:55,976 - __main__ - INFO - 전체 토큰 수: 261개
2025-08-26 16:31:55,976 - __main__ - INFO - NNP 태그 토큰들: ['넷플릭스', '웨이브', '광고', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '넷플릭스', '웨이브', '우주패스 Netflix', '-', '-', '우주패스 Netflix', '광고', '스탠다드', '쿠폰', '우주패스 Netflix', '-', '기본', 'Netflix 광고형 스탠다드', '-', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', '프리미엄', '-', '쿠폰', '-', '쿠폰', '할인', '수신거부']
2025-08-26 16:31:55,976 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix 광고형 스탠다드', '웨이브', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', '우주패스 Netflix']
2025-08-26 16:31:55,976 - __main__ - INFO - 퍼지 매칭 시작...
2025-08-26 16:31:58,756 - __main__ - INFO - 퍼지 매칭 결과 크기: (14056, 3)
2025-08-26 16:31:58,756 - __main__ - INFO - 퍼지 매칭 성공: 14056개 결과
2025-08-26 16:31:58,758 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.5714285714285714}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.4}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.4}]
2025-08-26 16:31:58,758 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-08-26 16:31:58,958 - __main__ - INFO - 시퀀스 유사도 결과 크기: (14056, 3)
2025-08-26 16:31:58,959 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': 'test', 'sim': 0.6000000000000001}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '노턴플러스', 'sim': 0.32000000000000006}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '데빌스카이', 'sim': 0.32000000000000006}]
2025-08-26 16:31:58,959 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-08-26 16:31:58,964 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 111개
2025-08-26 16:31:58,971 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 8개
2025-08-26 16:31:58,971 - __main__ - INFO - 통합된 후보 아이템 수: 119개
2025-08-26 16:31:58,973 - __main__ - INFO - 최종 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:31:58,977 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (52, 2)
2025-08-26 16:31:58,977 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}, {'item_nm': 'FLO', 'item_id': ['V683']}]
2025-08-26 16:31:58,978 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 3.55초
2025-08-26 16:31:58,978 - __main__ - INFO - 추출된 후보 엔티티: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:31:58,978 - __main__ - INFO - 매칭된 상품 정보: (52, 2)
2025-08-26 16:31:58,978 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-08-26 16:31:59,092 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-08-26 16:31:59,093 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-08-26 16:31:59,093 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-08-26 16:31:59,093 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-08-26 16:31:59,093 - __main__ - INFO - 후보 아이템 리스트 크기: 63개
2025-08-26 16:31:59,093 - __main__ - INFO - 후보 아이템 리스트: ['Netflix 프리미엄', 'Netflix 스탠다드', 'Wavve 콘텐츠 팩', '웨이브', '넷플릭스', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Netflix', 'wavve', '스탠다드', '스탠다드+', 'Netflix 광고형 스탠다드 이용권', 'I-프리미엄', '(T)프리미엄', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '기본형.', '나우', '우드', '기본형', 'T쿠폰', '플로', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩 구독', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩_인증', 'Netflix 조합상품', '넷플릭스 광고형 스탠다드', 'tossi 런칭 프로모션', 'Netflix 단독', '타다 쿠폰', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', '플로 콘텐츠 팩', '멜론 콘텐츠 팩', 'TVING 광고형 스탠다드', 'tving 광고형 스탠다드', '우주패스 life', '우주패스 slim', '우주패스 mini', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'ⓜU-Fax 프리미엄', 'U-Fax 프리미엄', '우주패스 all', 'Wavve 콘텐츠 팩 PLUS', 'Wavve 콘텐츠 팩 Plus', '우주패스 배달형', 'Wavve 콘텐츠 팩 plus', '웹ex_스탠다드', '웹ex_프리미엄', '클럽T 스탠다드', '클럽T 프리미엄', 'Wavve 콘텐츠 팩 프리미엄', '스탠다드 Netflix', 'BTP(프로모션)']
2025-08-26 16:31:59,093 - __main__ - INFO - extra_item_pdf 크기: (52, 2)
2025-08-26 16:31:59,093 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-08-26 16:31:59,093 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '(T)프리미엄', 'item_id': ['NS00000005']}, {'item_nm': 'BTP(프로모션)', 'item_id': ['NA00005178']}]
2025-08-26 16:31:59,093 - __main__ - INFO - RAG 모드: 후보 상품 목록을 RAG 컨텍스트에 추가
2025-08-26 16:31:59,093 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-08-26 16:31:59,093 - __main__ - INFO - 구성된 프롬프트 길이: 6970 문자
2025-08-26 16:31:59,093 - __main__ - INFO - RAG 컨텍스트 포함 여부: True
2025-08-26 16:32:04,682 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:32:04,697 - __main__ - INFO - LLM 응답 길이: 774 문자
2025-08-26 16:32:04,697 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/jAs/#74",
            "action": "추가 정보"
        },
        {
            ...
2025-08-26 16:32:04,697 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-08-26 16:32:04,698 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-08-26 16:32:04,698 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-08-26 16:32:04,698 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-08-26 16:32:04,698 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-08-26 16:32:04,698 - __main__ - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Wavve 콘텐츠 팩']
2025-08-26 16:32:05,947 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:32:06,367 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.67초
2025-08-26 16:32:06,374 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-08-26 16:32:06,374 - __main__ - INFO - ============================================================
2025-08-26 16:32:06,374 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-08-26 16:32:06,374 - __main__ - INFO - ============================================================
2025-08-26 16:32:06,374 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-08-26 16:32:06,375 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-08-26 16:32:06,375 - __main__ - INFO - 상품 수: 4개
2025-08-26 16:32:06,375 - __main__ - INFO - 채널 수: 3개
2025-08-26 16:32:06,375 - __main__ - INFO - 프로그램 수: 2개
2025-08-26 16:32:06,375 - __main__ - INFO - process_message 실행완료: 10.95초
2025-08-26 16:32:06,375 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:53:24,302 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:53:24,302 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:53:24,302 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:53:24,319 - __main__ - INFO - Using device: mps
2025-09-04 08:53:24,319 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:53:24,319 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-04 08:53:24,320 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:53:24,320 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:53:24,320 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:53:24,320 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:53:25,382 - __main__ - INFO - Model loaded on mps
2025-09-04 08:53:25,382 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.06초
2025-09-04 08:53:25,855 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:53:25,855 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-04 08:53:25,855 - __main__ - INFO - ============================================================
2025-09-04 08:53:25,855 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:53:25,855 - __main__ - INFO - ============================================================
2025-09-04 08:53:25,855 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:53:25,855 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:53:25,855 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:53:25,855 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:53:25,855 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:53:25,968 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:53:25,968 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:53:25,976 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:53:25,980 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 812, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:53:25,981 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:53:25,983 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:53:25,983 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:53:25,983 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:53:25,983 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:53:25,983 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:53:25,985 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:53:25,985 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:53:25,986 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:53:25,986 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:53:25,986 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:53:25,986 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:53:25,987 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:53:25,987 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:53:25,987 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:53:25,987 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:53:25,987 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:53:25,987 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:53:25,987 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:53:25,987 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:53:25,987 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:53:25,988 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:53:25,988 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:53:27,849 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:53:27,849 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:53:27,849 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:53:28,357 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:53:28,357 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:53:28,357 - __main__ - INFO - ============================================================
2025-09-04 08:53:28,357 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:53:28,357 - __main__ - INFO - ============================================================
2025-09-04 08:53:28,357 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:53:28,357 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:53:28,357 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:53:28,357 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:53:28,357 - __main__ - INFO - _load_data 실행완료: 2.50초
2025-09-04 08:53:28,357 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:53:28,357 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp48z25k35.txt
2025-09-04 08:53:28,358 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:53:28,358 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:53:28,358 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:53:28,358 - __main__ - INFO - ============================================================
2025-09-04 08:53:28,358 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:53:28,358 - __main__ - INFO - ============================================================
2025-09-04 08:53:28,358 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:53:28,358 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:53:28,358 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:53:28,359 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:53:28,359 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:53:28,359 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:53:28,359 - __main__ - INFO - LLM 모델: ax
2025-09-04 08:53:28,359 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:53:28,359 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:53:28,359 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:53:28,359 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:53:28,359 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:53:28,359 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:53:28,359 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:53:28,359 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:53:28,359 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:53:28,359 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:53:29,756 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:53:29,756 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:53:29,756 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:53:29,756 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:53:29,756 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:53:29,756 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:53:29,756 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:53:29,756 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:53:29,756 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:53:29,756 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:53:29,756 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:53:29,756 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:53:29,756 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:53:29,756 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:53:29,756 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:53:31,484 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:53:31,494 - __main__ - INFO - LLM 응답 길이: 152 문자
2025-09-04 08:53:31,494 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test", "TOS운영자_test"]
}
```...
2025-09-04 08:53:31,495 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:53:31,495 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:53:31,495 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:53:31,495 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test', 'TOS운영자_test']}
2025-09-04 08:53:31,495 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:53:31,495 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:53:31,516 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:53:31,516 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:53:31,523 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:53:31,524 - __main__ - INFO - ============================================================
2025-09-04 08:53:31,524 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:53:31,524 - __main__ - INFO - ============================================================
2025-09-04 08:53:31,524 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:53:31,524 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:53:31,524 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:53:31,524 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:53:31,524 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:53:31,524 - __main__ - INFO - process_message 실행완료: 3.17초
2025-09-04 08:53:31,524 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:53:31,524 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:53:31,524 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 3.17초
2025-09-04 08:53:31,524 - __main__ - INFO - 평균 처리 시간: 3.17초/메시지
2025-09-04 08:53:38,168 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:53:38,169 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:53:38,169 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:53:38,186 - __main__ - INFO - Using device: mps
2025-09-04 08:53:38,186 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:53:38,186 - __main__ - INFO - LLM 초기화 완료: gpt (azure/openai/gpt-4o-2024-08-06)
2025-09-04 08:53:38,186 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:53:38,186 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:53:38,187 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:53:38,187 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:53:39,163 - __main__ - INFO - Model loaded on mps
2025-09-04 08:53:39,163 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.98초
2025-09-04 08:53:39,634 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:53:39,635 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-04 08:53:39,635 - __main__ - INFO - ============================================================
2025-09-04 08:53:39,635 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:53:39,635 - __main__ - INFO - ============================================================
2025-09-04 08:53:39,635 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:53:39,635 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:53:39,635 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:53:39,635 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:53:39,635 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:53:39,746 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:53:39,746 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:53:39,753 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:53:39,758 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 812, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:53:39,758 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:53:39,760 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:53:39,760 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:53:39,760 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:53:39,761 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:53:39,761 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:53:39,762 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:53:39,762 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:53:39,763 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:53:39,763 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:53:39,763 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:53:39,763 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:53:39,764 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:53:39,764 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:53:39,764 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:53:39,764 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:53:39,764 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:53:39,764 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:53:39,764 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:53:39,764 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:53:39,764 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:53:39,765 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:53:39,765 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:53:39,941 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:53:39,942 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:53:39,942 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:53:40,449 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:53:40,450 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:53:40,450 - __main__ - INFO - ============================================================
2025-09-04 08:53:40,450 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:53:40,450 - __main__ - INFO - ============================================================
2025-09-04 08:53:40,450 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:53:40,450 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:53:40,450 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:53:40,450 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:53:40,450 - __main__ - INFO - _load_data 실행완료: 0.82초
2025-09-04 08:53:40,450 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:53:40,450 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp48z25k35.txt
2025-09-04 08:53:40,451 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:53:40,451 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:53:40,451 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:53:40,452 - __main__ - INFO - ============================================================
2025-09-04 08:53:40,452 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:53:40,452 - __main__ - INFO - ============================================================
2025-09-04 08:53:40,452 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:53:40,452 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:53:40,452 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:53:40,452 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:53:40,452 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:53:40,452 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:53:40,452 - __main__ - INFO - LLM 모델: gpt
2025-09-04 08:53:40,452 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:53:40,452 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:53:40,452 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:53:40,452 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:53:40,452 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:53:40,452 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:53:40,452 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:53:40,452 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:53:40,452 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:53:40,452 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:53:40,545 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:53:40,545 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:53:40,545 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:53:40,545 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:53:40,545 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:53:40,545 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:53:40,545 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:53:40,545 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:53:40,545 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:53:40,545 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:53:40,545 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:53:40,545 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:53:40,545 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:53:40,545 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:53:40,545 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:53:42,810 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:53:42,815 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:53:42,815 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:53:42,815 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:53:42,815 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:53:42,815 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:53:42,815 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:53:42,815 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:53:42,815 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:53:42,831 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:53:42,831 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:53:42,848 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:53:42,848 - __main__ - INFO - ============================================================
2025-09-04 08:53:42,848 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:53:42,848 - __main__ - INFO - ============================================================
2025-09-04 08:53:42,848 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:53:42,849 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:53:42,849 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:53:42,849 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:53:42,849 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:53:42,849 - __main__ - INFO - process_message 실행완료: 2.40초
2025-09-04 08:53:42,849 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:53:42,850 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:53:42,850 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 2.40초
2025-09-04 08:53:42,851 - __main__ - INFO - 평균 처리 시간: 2.40초/메시지
2025-09-04 08:53:49,876 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:53:49,877 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:53:49,877 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:53:49,894 - __main__ - INFO - Using device: mps
2025-09-04 08:53:49,894 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:53:49,894 - __main__ - INFO - LLM 초기화 완료: gem (skt/ax4)
2025-09-04 08:53:49,894 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:53:49,894 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:53:49,894 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:53:49,894 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:53:50,804 - __main__ - INFO - Model loaded on mps
2025-09-04 08:53:50,804 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.91초
2025-09-04 08:53:51,293 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:53:51,293 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-04 08:53:51,293 - __main__ - INFO - ============================================================
2025-09-04 08:53:51,293 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:53:51,293 - __main__ - INFO - ============================================================
2025-09-04 08:53:51,293 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:53:51,293 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:53:51,293 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:53:51,294 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:53:51,294 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:53:51,404 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:53:51,404 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:53:51,411 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:53:51,414 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 812, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:53:51,414 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:53:51,416 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:53:51,416 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:53:51,417 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:53:51,417 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:53:51,417 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:53:51,418 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:53:51,418 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:53:51,418 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:53:51,419 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:53:51,419 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:53:51,419 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:53:51,419 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:53:51,419 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:53:51,419 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:53:51,419 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:53:51,419 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:53:51,419 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:53:51,419 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:53:51,419 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:53:51,419 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:53:51,420 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:53:51,420 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:53:51,593 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:53:51,593 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:53:51,593 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:53:52,100 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:53:52,100 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:53:52,100 - __main__ - INFO - ============================================================
2025-09-04 08:53:52,100 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:53:52,100 - __main__ - INFO - ============================================================
2025-09-04 08:53:52,100 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:53:52,100 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:53:52,100 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:53:52,100 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:53:52,100 - __main__ - INFO - _load_data 실행완료: 0.81초
2025-09-04 08:53:52,100 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:53:52,100 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp48z25k35.txt
2025-09-04 08:53:52,101 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:53:52,101 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:53:52,101 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:53:52,101 - __main__ - INFO - ============================================================
2025-09-04 08:53:52,101 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:53:52,101 - __main__ - INFO - ============================================================
2025-09-04 08:53:52,101 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:53:52,101 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:53:52,101 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:53:52,101 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:53:52,101 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:53:52,101 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:53:52,101 - __main__ - INFO - LLM 모델: gem
2025-09-04 08:53:52,101 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:53:52,101 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:53:52,101 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:53:52,101 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:53:52,101 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:53:52,101 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:53:52,101 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:53:52,102 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:53:52,102 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:53:52,102 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:53:52,197 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:53:52,197 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:53:52,197 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:53:52,197 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:53:52,197 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:53:52,197 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:53:52,197 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:53:52,197 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:53:52,197 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:53:52,197 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:53:52,197 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:53:52,197 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:53:52,197 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:53:52,197 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:53:52,197 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:53:53,740 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:53:53,749 - __main__ - INFO - LLM 응답 길이: 152 문자
2025-09-04 08:53:53,749 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test", "TOS운영자_test"]
}
```...
2025-09-04 08:53:53,750 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:53:53,750 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:53:53,750 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:53:53,750 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test', 'TOS운영자_test']}
2025-09-04 08:53:53,750 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:53:53,750 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:53:53,764 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:53:53,765 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-04 08:53:53,766 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:53:53,767 - __main__ - INFO - ============================================================
2025-09-04 08:53:53,767 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:53:53,767 - __main__ - INFO - ============================================================
2025-09-04 08:53:53,767 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:53:53,767 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:53:53,767 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:53:53,767 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:53:53,767 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:53:53,767 - __main__ - INFO - process_message 실행완료: 1.67초
2025-09-04 08:53:53,767 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:53:53,767 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:53:53,767 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.67초
2025-09-04 08:53:53,767 - __main__ - INFO - 평균 처리 시간: 1.67초/메시지
2025-09-04 08:54:00,171 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:54:00,171 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:54:00,171 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:54:00,187 - __main__ - INFO - Using device: mps
2025-09-04 08:54:00,187 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:54:00,187 - __main__ - INFO - LLM 초기화 완료: cld (skt/ax4)
2025-09-04 08:54:00,187 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:54:00,187 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:54:00,188 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:54:00,188 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:54:01,080 - __main__ - INFO - Model loaded on mps
2025-09-04 08:54:01,080 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.89초
2025-09-04 08:54:01,558 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:54:01,558 - __main__ - INFO - _initialize_kiwi 실행완료: 0.48초
2025-09-04 08:54:01,558 - __main__ - INFO - ============================================================
2025-09-04 08:54:01,558 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:54:01,558 - __main__ - INFO - ============================================================
2025-09-04 08:54:01,558 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:54:01,558 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:54:01,558 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:54:01,558 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:54:01,558 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:54:01,669 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:54:01,669 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:54:01,677 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:54:01,681 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 812, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:54:01,682 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:54:01,684 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:54:01,684 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:54:01,684 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:54:01,684 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:54:01,684 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:54:01,685 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:54:01,686 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:54:01,686 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:54:01,686 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:54:01,686 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:54:01,687 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:54:01,687 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:54:01,687 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:54:01,687 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:54:01,687 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:54:01,687 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:54:01,687 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:54:01,687 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:54:01,687 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:54:01,687 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:54:01,688 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:54:01,688 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:54:01,861 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:54:01,861 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:54:01,861 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:54:02,384 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:54:02,384 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:54:02,384 - __main__ - INFO - ============================================================
2025-09-04 08:54:02,384 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:54:02,384 - __main__ - INFO - ============================================================
2025-09-04 08:54:02,384 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:54:02,384 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:54:02,384 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:54:02,384 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:54:02,384 - __main__ - INFO - _load_data 실행완료: 0.83초
2025-09-04 08:54:02,384 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:54:02,384 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp48z25k35.txt
2025-09-04 08:54:02,386 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:54:02,386 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:54:02,386 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:54:02,386 - __main__ - INFO - ============================================================
2025-09-04 08:54:02,386 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:54:02,386 - __main__ - INFO - ============================================================
2025-09-04 08:54:02,386 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:54:02,386 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:54:02,386 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:54:02,386 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:54:02,386 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:54:02,386 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:54:02,386 - __main__ - INFO - LLM 모델: cld
2025-09-04 08:54:02,386 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:54:02,386 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:54:02,386 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:54:02,386 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:54:02,386 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:54:02,386 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:54:02,386 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:54:02,386 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:54:02,386 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:54:02,387 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:54:02,481 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:54:02,481 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:54:02,481 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:54:02,481 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:54:02,481 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:54:02,481 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:54:02,481 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:54:02,481 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:54:02,481 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:54:02,481 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:54:02,481 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:54:02,481 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:54:02,481 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:54:02,481 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:54:02,481 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:54:04,097 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:54:04,106 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:54:04,106 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:54:04,106 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:54:04,106 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:54:04,106 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:54:04,106 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:54:04,106 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:54:04,106 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:54:04,122 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:54:04,122 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:54:04,127 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:54:04,127 - __main__ - INFO - ============================================================
2025-09-04 08:54:04,127 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:54:04,127 - __main__ - INFO - ============================================================
2025-09-04 08:54:04,127 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:54:04,127 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:54:04,127 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:54:04,127 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:54:04,127 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:54:04,127 - __main__ - INFO - process_message 실행완료: 1.74초
2025-09-04 08:54:04,127 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:54:04,127 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:54:04,128 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.74초
2025-09-04 08:54:04,128 - __main__ - INFO - 평균 처리 시간: 1.74초/메시지
2025-09-04 08:54:56,220 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:54:56,220 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:54:56,220 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:54:56,237 - __main__ - INFO - Using device: mps
2025-09-04 08:54:56,237 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:54:56,237 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-04 08:54:56,237 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:54:56,237 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:54:56,237 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:54:56,237 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:54:57,126 - __main__ - INFO - Model loaded on mps
2025-09-04 08:54:57,126 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.89초
2025-09-04 08:54:57,622 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:54:57,622 - __main__ - INFO - _initialize_kiwi 실행완료: 0.50초
2025-09-04 08:54:57,622 - __main__ - INFO - ============================================================
2025-09-04 08:54:57,622 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:54:57,622 - __main__ - INFO - ============================================================
2025-09-04 08:54:57,622 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:54:57,622 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:54:57,622 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:54:57,622 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:54:57,622 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:54:57,733 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:54:57,733 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:54:57,741 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:54:57,745 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:54:57,746 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:54:57,748 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:54:57,748 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:54:57,748 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:54:57,748 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:54:57,748 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:54:57,749 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:54:57,749 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:54:57,750 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:54:57,750 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:54:57,750 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:54:57,750 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:54:57,751 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:54:57,751 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:54:57,751 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:54:57,751 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:54:57,751 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:54:57,751 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:54:57,751 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:54:57,751 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:54:57,751 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:54:57,752 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:54:57,752 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:54:57,930 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:54:57,930 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:54:57,930 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:54:58,467 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:54:58,467 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:54:58,467 - __main__ - INFO - ============================================================
2025-09-04 08:54:58,467 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:54:58,467 - __main__ - INFO - ============================================================
2025-09-04 08:54:58,467 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:54:58,467 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:54:58,467 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:54:58,467 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:54:58,467 - __main__ - INFO - _load_data 실행완료: 0.85초
2025-09-04 08:54:58,467 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:54:58,467 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmpwt8wpymi.txt
2025-09-04 08:54:58,468 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:54:58,468 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:54:58,468 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:54:58,468 - __main__ - INFO - ============================================================
2025-09-04 08:54:58,468 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:54:58,468 - __main__ - INFO - ============================================================
2025-09-04 08:54:58,468 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:54:58,468 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:54:58,468 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:54:58,468 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:54:58,468 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:54:58,468 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:54:58,468 - __main__ - INFO - LLM 모델: ax
2025-09-04 08:54:58,468 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:54:58,468 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:54:58,468 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:54:58,468 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:54:58,468 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:54:58,468 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:54:58,469 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:54:58,469 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:54:58,469 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:54:58,469 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:54:58,555 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:54:58,555 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:54:58,555 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:54:58,555 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:54:58,555 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:54:58,555 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:54:58,555 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:54:58,555 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:54:58,555 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:54:58,555 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:54:58,555 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:54:58,555 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:54:58,555 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:54:58,555 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:54:58,555 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:55:00,125 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:55:00,134 - __main__ - INFO - LLM 응답 길이: 152 문자
2025-09-04 08:55:00,134 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test", "TOS운영자_test"]
}
```...
2025-09-04 08:55:00,134 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:55:00,135 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:55:00,135 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:55:00,135 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test', 'TOS운영자_test']}
2025-09-04 08:55:00,135 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:55:00,135 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:55:00,152 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:55:00,152 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:55:00,154 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:55:00,154 - __main__ - INFO - ============================================================
2025-09-04 08:55:00,154 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:55:00,154 - __main__ - INFO - ============================================================
2025-09-04 08:55:00,154 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:55:00,154 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:55:00,154 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:55:00,154 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:55:00,154 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:55:00,155 - __main__ - INFO - process_message 실행완료: 1.69초
2025-09-04 08:55:00,155 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:55:00,155 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:55:00,155 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.69초
2025-09-04 08:55:00,155 - __main__ - INFO - 평균 처리 시간: 1.69초/메시지
2025-09-04 08:55:06,461 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:55:06,461 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:55:06,461 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:55:06,480 - __main__ - INFO - Using device: mps
2025-09-04 08:55:06,480 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:55:06,480 - __main__ - INFO - LLM 초기화 완료: gpt (azure/openai/gpt-4o-2024-08-06)
2025-09-04 08:55:06,480 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:55:06,480 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:55:06,481 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:55:06,481 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:55:07,403 - __main__ - INFO - Model loaded on mps
2025-09-04 08:55:07,403 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.92초
2025-09-04 08:55:07,915 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:55:07,915 - __main__ - INFO - _initialize_kiwi 실행완료: 0.51초
2025-09-04 08:55:07,915 - __main__ - INFO - ============================================================
2025-09-04 08:55:07,915 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:55:07,915 - __main__ - INFO - ============================================================
2025-09-04 08:55:07,915 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:55:07,915 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:55:07,915 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:55:07,915 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:55:07,915 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:55:08,028 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:55:08,028 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:55:08,037 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:55:08,041 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:55:08,042 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:55:08,044 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:55:08,044 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:55:08,044 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:55:08,044 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:55:08,044 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:55:08,045 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:55:08,045 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:55:08,046 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:55:08,046 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:55:08,046 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:55:08,046 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:55:08,047 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:55:08,047 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:55:08,047 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:55:08,047 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:55:08,047 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:55:08,047 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:55:08,047 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:55:08,047 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:55:08,047 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:55:08,048 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:55:08,048 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:55:08,220 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:55:08,221 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:55:08,221 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:55:08,745 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:55:08,745 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:55:08,745 - __main__ - INFO - ============================================================
2025-09-04 08:55:08,745 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:55:08,745 - __main__ - INFO - ============================================================
2025-09-04 08:55:08,745 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:55:08,745 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:55:08,745 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:55:08,745 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:55:08,745 - __main__ - INFO - _load_data 실행완료: 0.83초
2025-09-04 08:55:08,745 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:55:08,745 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmpwt8wpymi.txt
2025-09-04 08:55:08,746 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:55:08,747 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:55:08,747 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:55:08,747 - __main__ - INFO - ============================================================
2025-09-04 08:55:08,747 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:55:08,747 - __main__ - INFO - ============================================================
2025-09-04 08:55:08,747 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:55:08,747 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:55:08,747 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:55:08,747 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:55:08,747 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:55:08,747 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:55:08,747 - __main__ - INFO - LLM 모델: gpt
2025-09-04 08:55:08,747 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:55:08,747 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:55:08,747 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:55:08,747 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:55:08,747 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:55:08,747 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:55:08,747 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:55:08,747 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:55:08,747 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:55:08,747 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:55:08,843 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:55:08,843 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:55:08,843 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:55:08,843 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:55:08,843 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:55:08,843 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:55:08,843 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:55:08,843 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:55:08,843 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:55:08,843 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:55:08,843 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:55:08,843 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:55:08,843 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:55:08,843 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:55:08,843 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:55:13,065 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:55:13,076 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:55:13,076 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:55:13,076 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:55:13,076 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:55:13,076 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:55:13,076 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:55:13,076 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:55:13,076 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:55:13,092 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:55:13,092 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:55:13,097 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:55:13,097 - __main__ - INFO - ============================================================
2025-09-04 08:55:13,097 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:55:13,097 - __main__ - INFO - ============================================================
2025-09-04 08:55:13,097 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:55:13,097 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:55:13,097 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:55:13,097 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:55:13,098 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:55:13,098 - __main__ - INFO - process_message 실행완료: 4.35초
2025-09-04 08:55:13,098 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:55:13,098 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:55:13,098 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 4.35초
2025-09-04 08:55:13,098 - __main__ - INFO - 평균 처리 시간: 4.35초/메시지
2025-09-04 08:55:19,378 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:55:19,378 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:55:19,378 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:55:19,394 - __main__ - INFO - Using device: mps
2025-09-04 08:55:19,394 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:55:19,394 - __main__ - INFO - LLM 초기화 완료: gem (skt/gemma3-12b-it)
2025-09-04 08:55:19,394 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:55:19,394 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:55:19,395 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:55:19,395 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:55:20,298 - __main__ - INFO - Model loaded on mps
2025-09-04 08:55:20,298 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.90초
2025-09-04 08:55:20,758 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:55:20,758 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-04 08:55:20,758 - __main__ - INFO - ============================================================
2025-09-04 08:55:20,758 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:55:20,758 - __main__ - INFO - ============================================================
2025-09-04 08:55:20,758 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:55:20,758 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:55:20,758 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:55:20,758 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:55:20,758 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:55:20,868 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:55:20,868 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:55:20,876 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:55:20,878 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:55:20,879 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:55:20,881 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:55:20,881 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:55:20,881 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:55:20,881 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:55:20,881 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:55:20,882 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:55:20,882 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:55:20,883 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:55:20,883 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:55:20,883 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:55:20,883 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:55:20,884 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:55:20,884 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:55:20,884 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:55:20,884 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:55:20,884 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:55:20,884 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:55:20,884 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:55:20,884 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:55:20,884 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:55:20,884 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:55:20,885 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:55:21,063 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:55:21,063 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:55:21,063 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:55:21,575 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:55:21,575 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:55:21,575 - __main__ - INFO - ============================================================
2025-09-04 08:55:21,575 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:55:21,575 - __main__ - INFO - ============================================================
2025-09-04 08:55:21,575 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:55:21,575 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:55:21,575 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:55:21,575 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:55:21,575 - __main__ - INFO - _load_data 실행완료: 0.82초
2025-09-04 08:55:21,575 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:55:21,575 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmpwt8wpymi.txt
2025-09-04 08:55:21,576 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:55:21,576 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:55:21,576 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:55:21,576 - __main__ - INFO - ============================================================
2025-09-04 08:55:21,576 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:55:21,576 - __main__ - INFO - ============================================================
2025-09-04 08:55:21,576 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:55:21,576 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:55:21,576 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:55:21,576 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:55:21,576 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:55:21,576 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:55:21,576 - __main__ - INFO - LLM 모델: gem
2025-09-04 08:55:21,576 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:55:21,576 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:55:21,576 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:55:21,576 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:55:21,576 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:55:21,576 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:55:21,577 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:55:21,577 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:55:21,577 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:55:21,577 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:55:21,665 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:55:21,665 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:55:21,665 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:55:21,665 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:55:21,665 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:55:21,665 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:55:21,665 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:55:21,665 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:55:21,665 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:55:21,665 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:55:21,665 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:55:21,665 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:55:21,665 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:55:21,665 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:55:21,665 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:55:23,261 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:55:23,269 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:55:23,269 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:55:23,269 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:55:23,270 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:55:23,270 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:55:23,270 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:55:23,270 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:55:23,270 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:55:23,284 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:55:23,284 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-04 08:55:23,287 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:55:23,287 - __main__ - INFO - ============================================================
2025-09-04 08:55:23,287 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:55:23,287 - __main__ - INFO - ============================================================
2025-09-04 08:55:23,287 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:55:23,287 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:55:23,287 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:55:23,287 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:55:23,287 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:55:23,288 - __main__ - INFO - process_message 실행완료: 1.71초
2025-09-04 08:55:23,288 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:55:23,288 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:55:23,288 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.71초
2025-09-04 08:55:23,288 - __main__ - INFO - 평균 처리 시간: 1.71초/메시지
2025-09-04 08:55:29,487 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:55:29,487 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:55:29,487 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:55:29,503 - __main__ - INFO - Using device: mps
2025-09-04 08:55:29,503 - __main__ - INFO - _initialize_device 실행완료: 0.01초
2025-09-04 08:55:29,503 - __main__ - INFO - LLM 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-04 08:55:29,503 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:55:29,503 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:55:29,503 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:55:29,503 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:55:30,556 - __main__ - INFO - Model loaded on mps
2025-09-04 08:55:30,556 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.05초
2025-09-04 08:55:31,003 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:55:31,003 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-04 08:55:31,003 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,003 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:55:31,003 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,003 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:55:31,003 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:55:31,003 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:55:31,003 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:55:31,003 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:55:31,111 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:55:31,111 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:55:31,119 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:55:31,121 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:55:31,122 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:55:31,125 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:55:31,125 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:55:31,125 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:55:31,125 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:55:31,125 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:55:31,126 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:55:31,126 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:55:31,127 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:55:31,127 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:55:31,127 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:55:31,127 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:55:31,128 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:55:31,128 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:55:31,128 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:55:31,128 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:55:31,128 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:55:31,128 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:55:31,128 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:55:31,128 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:55:31,128 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:55:31,129 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:55:31,129 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:55:31,301 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:55:31,301 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:55:31,301 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:55:31,807 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:55:31,807 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:55:31,807 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,807 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:55:31,807 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,807 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:55:31,807 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:55:31,807 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:55:31,807 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:55:31,808 - __main__ - INFO - _load_data 실행완료: 0.80초
2025-09-04 08:55:31,808 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:55:31,808 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmpwt8wpymi.txt
2025-09-04 08:55:31,808 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:55:31,808 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:55:31,809 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:55:31,809 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,809 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:55:31,809 - __main__ - INFO - ============================================================
2025-09-04 08:55:31,809 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:55:31,809 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:55:31,809 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:55:31,809 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:55:31,809 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:55:31,809 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:55:31,809 - __main__ - INFO - LLM 모델: cld
2025-09-04 08:55:31,809 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:55:31,809 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:55:31,809 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:55:31,809 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:55:31,809 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:55:31,809 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:55:31,809 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:55:31,809 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:55:31,809 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:55:31,809 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:55:31,898 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:55:31,898 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:55:31,898 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:55:31,899 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:55:31,899 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:55:31,899 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:55:31,899 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:55:31,899 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:55:31,899 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:55:31,899 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:55:31,899 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:55:31,899 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:55:31,899 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:55:31,899 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:55:31,899 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:55:33,763 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:55:33,771 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:55:33,771 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:55:33,771 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:55:33,772 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:55:33,772 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:55:33,772 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:55:33,772 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:55:33,772 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:55:33,787 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:55:33,787 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:55:33,789 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:55:33,789 - __main__ - INFO - ============================================================
2025-09-04 08:55:33,790 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:55:33,790 - __main__ - INFO - ============================================================
2025-09-04 08:55:33,790 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:55:33,790 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:55:33,790 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:55:33,790 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:55:33,790 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:55:33,790 - __main__ - INFO - process_message 실행완료: 1.98초
2025-09-04 08:55:33,790 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:55:33,790 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:55:33,790 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.98초
2025-09-04 08:55:33,790 - __main__ - INFO - 평균 처리 시간: 1.98초/메시지
2025-09-04 08:56:09,953 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:56:09,953 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:56:09,953 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:56:09,969 - __main__ - INFO - Using device: mps
2025-09-04 08:56:09,970 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:56:09,970 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-04 08:56:09,970 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:56:09,970 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:56:09,970 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:56:09,970 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:56:10,863 - __main__ - INFO - Model loaded on mps
2025-09-04 08:56:10,863 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.89초
2025-09-04 08:56:11,321 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:56:11,321 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-04 08:56:11,321 - __main__ - INFO - ============================================================
2025-09-04 08:56:11,321 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:56:11,321 - __main__ - INFO - ============================================================
2025-09-04 08:56:11,321 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:56:11,321 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:56:11,321 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:56:11,321 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:56:11,321 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:56:11,429 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:56:11,430 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:56:11,437 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:56:11,439 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:56:11,440 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:56:11,442 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:56:11,442 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:56:11,443 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:56:11,443 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:56:11,443 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:56:11,444 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:56:11,444 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:56:11,445 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:56:11,445 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:56:11,445 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:56:11,445 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:56:11,445 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:56:11,445 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:56:11,446 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:56:11,446 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:56:11,446 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:56:11,446 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:56:11,446 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:56:11,446 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:56:11,446 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:56:11,446 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:56:11,446 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:56:11,621 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:56:11,621 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:56:11,621 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:56:12,129 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:56:12,129 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:56:12,129 - __main__ - INFO - ============================================================
2025-09-04 08:56:12,129 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:56:12,129 - __main__ - INFO - ============================================================
2025-09-04 08:56:12,129 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:56:12,129 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:56:12,129 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:56:12,129 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:56:12,130 - __main__ - INFO - _load_data 실행완료: 0.81초
2025-09-04 08:56:12,130 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:56:12,130 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp646fn27a.txt
2025-09-04 08:56:12,130 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:56:12,130 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:56:12,131 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:56:12,131 - __main__ - INFO - ============================================================
2025-09-04 08:56:12,131 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:56:12,131 - __main__ - INFO - ============================================================
2025-09-04 08:56:12,131 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:56:12,131 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:56:12,131 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:56:12,131 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:56:12,131 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:56:12,131 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:56:12,131 - __main__ - INFO - LLM 모델: ax
2025-09-04 08:56:12,131 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:56:12,131 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:56:12,131 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:56:12,131 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:56:12,131 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:56:12,131 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:56:12,131 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:56:12,131 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:56:12,131 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:56:12,131 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:56:12,223 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:56:12,223 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:56:12,223 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:56:12,223 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:56:12,223 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:56:12,223 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:56:12,223 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:56:12,223 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:56:12,223 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:56:12,223 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:56:12,223 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:56:12,223 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:56:12,224 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:56:12,224 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:56:12,224 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:56:13,838 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:56:13,842 - __main__ - INFO - LLM 응답 길이: 152 문자
2025-09-04 08:56:13,843 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test", "TOS운영자_test"]
}
```...
2025-09-04 08:56:13,843 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:56:13,843 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:56:13,843 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:56:13,843 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test', 'TOS운영자_test']}
2025-09-04 08:56:13,843 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:56:13,843 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:56:13,853 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:56:13,854 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-04 08:56:13,855 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:56:13,855 - __main__ - INFO - ============================================================
2025-09-04 08:56:13,855 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:56:13,855 - __main__ - INFO - ============================================================
2025-09-04 08:56:13,855 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:56:13,855 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:56:13,856 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:56:13,856 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:56:13,856 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:56:13,856 - __main__ - INFO - process_message 실행완료: 1.73초
2025-09-04 08:56:13,856 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:56:13,856 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:56:13,856 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.73초
2025-09-04 08:56:13,856 - __main__ - INFO - 평균 처리 시간: 1.73초/메시지
2025-09-04 08:56:19,998 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:56:19,999 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:56:19,999 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:56:20,016 - __main__ - INFO - Using device: mps
2025-09-04 08:56:20,016 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:56:20,016 - __main__ - INFO - LLM 초기화 완료: gpt (azure/openai/gpt-4o-2024-08-06)
2025-09-04 08:56:20,016 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:56:20,016 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:56:20,017 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:56:20,017 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:56:20,897 - __main__ - INFO - Model loaded on mps
2025-09-04 08:56:20,897 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.88초
2025-09-04 08:56:21,377 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:56:21,377 - __main__ - INFO - _initialize_kiwi 실행완료: 0.48초
2025-09-04 08:56:21,377 - __main__ - INFO - ============================================================
2025-09-04 08:56:21,377 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:56:21,377 - __main__ - INFO - ============================================================
2025-09-04 08:56:21,377 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:56:21,377 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:56:21,377 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:56:21,377 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:56:21,377 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:56:21,489 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:56:21,489 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:56:21,497 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:56:21,499 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:56:21,500 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:56:21,502 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:56:21,502 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:56:21,502 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:56:21,502 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:56:21,502 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:56:21,503 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:56:21,503 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:56:21,504 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:56:21,504 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:56:21,504 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:56:21,504 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:56:21,505 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:56:21,505 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:56:21,505 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:56:21,505 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:56:21,505 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:56:21,505 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:56:21,505 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:56:21,505 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:56:21,505 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:56:21,506 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:56:21,506 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:56:21,681 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:56:21,681 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:56:21,681 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:56:22,185 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:56:22,185 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:56:22,185 - __main__ - INFO - ============================================================
2025-09-04 08:56:22,185 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:56:22,185 - __main__ - INFO - ============================================================
2025-09-04 08:56:22,185 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:56:22,185 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:56:22,186 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:56:22,186 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:56:22,186 - __main__ - INFO - _load_data 실행완료: 0.81초
2025-09-04 08:56:22,186 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:56:22,186 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp646fn27a.txt
2025-09-04 08:56:22,186 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:56:22,186 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:56:22,187 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:56:22,187 - __main__ - INFO - ============================================================
2025-09-04 08:56:22,187 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:56:22,187 - __main__ - INFO - ============================================================
2025-09-04 08:56:22,187 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:56:22,187 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:56:22,187 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:56:22,187 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:56:22,187 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:56:22,187 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:56:22,187 - __main__ - INFO - LLM 모델: gpt
2025-09-04 08:56:22,187 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:56:22,187 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:56:22,187 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:56:22,187 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:56:22,187 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:56:22,187 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:56:22,187 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:56:22,187 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:56:22,187 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:56:22,187 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:56:22,278 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:56:22,278 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:56:22,278 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:56:22,278 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:56:22,278 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:56:22,278 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:56:22,278 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:56:22,278 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:56:22,278 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:56:22,278 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:56:22,278 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:56:22,278 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:56:22,278 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:56:22,278 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:56:22,278 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:56:23,847 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:56:23,856 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:56:23,856 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:56:23,856 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:56:23,856 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:56:23,856 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:56:23,856 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:56:23,856 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:56:23,856 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:56:23,870 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:56:23,870 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-04 08:56:23,872 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:56:23,872 - __main__ - INFO - ============================================================
2025-09-04 08:56:23,873 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:56:23,873 - __main__ - INFO - ============================================================
2025-09-04 08:56:23,873 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:56:23,873 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:56:23,873 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:56:23,873 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:56:23,873 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:56:23,873 - __main__ - INFO - process_message 실행완료: 1.69초
2025-09-04 08:56:23,873 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:56:23,873 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:56:23,873 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.69초
2025-09-04 08:56:23,873 - __main__ - INFO - 평균 처리 시간: 1.69초/메시지
2025-09-04 08:56:29,978 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:56:29,978 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:56:29,978 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:56:29,995 - __main__ - INFO - Using device: mps
2025-09-04 08:56:29,995 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:56:29,995 - __main__ - INFO - LLM 초기화 완료: gem (skt/gemma3-12b-it)
2025-09-04 08:56:29,995 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:56:29,995 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:56:29,995 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:56:29,995 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:56:30,891 - __main__ - INFO - Model loaded on mps
2025-09-04 08:56:30,892 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.90초
2025-09-04 08:56:31,349 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:56:31,349 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-04 08:56:31,349 - __main__ - INFO - ============================================================
2025-09-04 08:56:31,349 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:56:31,350 - __main__ - INFO - ============================================================
2025-09-04 08:56:31,350 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:56:31,350 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:56:31,350 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:56:31,350 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:56:31,350 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:56:31,458 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:56:31,458 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:56:31,465 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:56:31,467 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:56:31,468 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:56:31,470 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:56:31,470 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:56:31,470 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:56:31,470 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:56:31,470 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:56:31,471 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:56:31,472 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:56:31,472 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:56:31,472 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:56:31,473 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:56:31,473 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:56:31,473 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:56:31,473 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:56:31,473 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:56:31,473 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:56:31,473 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:56:31,473 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:56:31,473 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:56:31,473 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:56:31,473 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:56:31,474 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:56:31,474 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:56:31,643 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:56:31,643 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:56:31,643 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:56:32,147 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:56:32,147 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:56:32,147 - __main__ - INFO - ============================================================
2025-09-04 08:56:32,147 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:56:32,147 - __main__ - INFO - ============================================================
2025-09-04 08:56:32,147 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:56:32,147 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:56:32,147 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:56:32,147 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:56:32,147 - __main__ - INFO - _load_data 실행완료: 0.80초
2025-09-04 08:56:32,147 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:56:32,147 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp646fn27a.txt
2025-09-04 08:56:32,148 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:56:32,148 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:56:32,148 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:56:32,148 - __main__ - INFO - ============================================================
2025-09-04 08:56:32,148 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:56:32,148 - __main__ - INFO - ============================================================
2025-09-04 08:56:32,148 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:56:32,148 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:56:32,148 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:56:32,148 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:56:32,148 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:56:32,148 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:56:32,149 - __main__ - INFO - LLM 모델: gem
2025-09-04 08:56:32,149 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:56:32,149 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:56:32,149 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:56:32,149 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:56:32,149 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:56:32,149 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:56:32,149 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:56:32,149 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:56:32,149 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:56:32,149 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:56:32,241 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:56:32,241 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:56:32,241 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:56:32,241 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:56:32,241 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:56:32,241 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:56:32,241 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:56:32,241 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:56:32,241 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:56:32,241 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:56:32,241 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:56:32,241 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:56:32,241 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:56:32,241 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:56:32,241 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:56:33,653 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:56:33,663 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:56:33,663 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:56:33,663 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:56:33,663 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:56:33,663 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:56:33,663 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:56:33,663 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:56:33,663 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:56:33,678 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:56:33,678 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-04 08:56:33,681 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:56:33,681 - __main__ - INFO - ============================================================
2025-09-04 08:56:33,681 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:56:33,681 - __main__ - INFO - ============================================================
2025-09-04 08:56:33,681 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:56:33,681 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:56:33,681 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:56:33,681 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:56:33,681 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:56:33,681 - __main__ - INFO - process_message 실행완료: 1.53초
2025-09-04 08:56:33,681 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:56:33,681 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:56:33,681 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 1.53초
2025-09-04 08:56:33,681 - __main__ - INFO - 평균 처리 시간: 1.53초/메시지
2025-09-04 08:56:39,866 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-04 08:56:39,866 - __main__ - INFO - MMSExtractor 초기화 시작
2025-09-04 08:56:39,866 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-04 08:56:39,882 - __main__ - INFO - Using device: mps
2025-09-04 08:56:39,882 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-04 08:56:39,883 - __main__ - INFO - LLM 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-04 08:56:39,883 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-04 08:56:39,883 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-04 08:56:39,883 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-04 08:56:39,883 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-04 08:56:40,785 - __main__ - INFO - Model loaded on mps
2025-09-04 08:56:40,785 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.90초
2025-09-04 08:56:41,248 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-04 08:56:41,249 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-04 08:56:41,249 - __main__ - INFO - ============================================================
2025-09-04 08:56:41,249 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-04 08:56:41,249 - __main__ - INFO - ============================================================
2025-09-04 08:56:41,249 - __main__ - INFO - 데이터 소스 모드: local
2025-09-04 08:56:41,249 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-04 08:56:41,249 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-04 08:56:41,249 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-04 08:56:41,249 - __main__ - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-04 08:56:41,359 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-04 08:56:41,359 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'domain', 'start_dt', 'end_dt', 'rank']
2025-09-04 08:56:41,366 - __main__ - ERROR - 상품 정보 로드 실패: "['item_dmn'] not in index"
2025-09-04 08:56:41,369 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_unified/mms_extractor.py", line 815, in _load_item_data
    self.item_pdf_all = item_pdf_raw.drop_duplicates(['item_nm','item_id'])[['item_nm','item_id','item_desc','item_dmn']].copy()
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['item_dmn'] not in index"

2025-09-04 08:56:41,370 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-04 08:56:41,372 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-04 08:56:41,372 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-04 08:56:41,372 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-04 08:56:41,372 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-04 08:56:41,372 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-04 08:56:41,373 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-04 08:56:41,373 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-04 08:56:41,374 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-04 08:56:41,374 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-04 08:56:41,374 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-04 08:56:41,374 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-04 08:56:41,375 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-04 08:56:41,375 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-04 08:56:41,375 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-04 08:56:41,375 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-04 08:56:41,375 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-04 08:56:41,375 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-04 08:56:41,375 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-04 08:56:41,375 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-04 08:56:41,375 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-04 08:56:41,376 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-04 08:56:41,376 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-04 08:56:41,555 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-04 08:56:41,555 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-04 08:56:41,555 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-04 08:56:42,064 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-04 08:56:42,064 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-04 08:56:42,064 - __main__ - INFO - ============================================================
2025-09-04 08:56:42,064 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-04 08:56:42,064 - __main__ - INFO - ============================================================
2025-09-04 08:56:42,064 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-04 08:56:42,064 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-04 08:56:42,064 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-04 08:56:42,064 - __main__ - INFO - ✅ 정지어: 143개
2025-09-04 08:56:42,064 - __main__ - INFO - _load_data 실행완료: 0.82초
2025-09-04 08:56:42,064 - __main__ - INFO - MMSExtractor 초기화 완료
2025-09-04 08:56:42,064 - __main__ - INFO - 배치 파일에서 메시지 로드: /var/folders/0h/3c1x50w901n85pq5kbbn9mn020dh7m/T/tmp646fn27a.txt
2025-09-04 08:56:42,064 - __main__ - INFO - 로드된 메시지 수: 1개
2025-09-04 08:56:42,064 - __main__ - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-04 08:56:42,065 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 테스트 메시지입니다....
2025-09-04 08:56:42,065 - __main__ - INFO - ============================================================
2025-09-04 08:56:42,065 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-04 08:56:42,065 - __main__ - INFO - ============================================================
2025-09-04 08:56:42,065 - __main__ - INFO - 메시지 내용: 테스트 메시지입니다....
2025-09-04 08:56:42,065 - __main__ - INFO - 메시지 길이: 11 문자
2025-09-04 08:56:42,065 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-04 08:56:42,065 - __main__ - INFO - 데이터 소스: local
2025-09-04 08:56:42,065 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-04 08:56:42,065 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-04 08:56:42,065 - __main__ - INFO - LLM 모델: cld
2025-09-04 08:56:42,065 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-04 08:56:42,065 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-04 08:56:42,065 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-04 08:56:42,065 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-04 08:56:42,065 - __main__ - INFO - 처리할 메시지 길이: 11 문자
2025-09-04 08:56:42,065 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-04 08:56:42,065 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-04 08:56:42,065 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-04 08:56:42,065 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-04 08:56:42,065 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-04 08:56:42,159 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-04 08:56:42,159 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-04 08:56:42,159 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 257 문자
2025-09-04 08:56:42,159 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-04 08:56:42,159 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-04 08:56:42,159 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-04 08:56:42,159 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-04 08:56:42,159 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-04 08:56:42,159 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-04 08:56:42,159 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-04 08:56:42,159 - __main__ - INFO - 구성된 프롬프트 길이: 5033 문자
2025-09-04 08:56:42,159 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-04 08:56:42,159 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5033)
2025-09-04 08:56:42,159 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-04 08:56:42,159 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-04 08:56:44,279 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-04 08:56:44,287 - __main__ - INFO - LLM 응답 길이: 137 문자
2025-09-04 08:56:44,287 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "테스트 메시지입니다.",
    "purpose": ["기타 정보 제공"],
    "product": [],
    "channel": [],
    "pgm": ["TOS운영자_test"]
}
```...
2025-09-04 08:56:44,287 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-04 08:56:44,288 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-04 08:56:44,288 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-04 08:56:44,288 - __main__ - INFO - 파싱된 JSON 내용: {'title': '테스트 메시지입니다.', 'purpose': ['기타 정보 제공'], 'product': [], 'channel': [], 'pgm': ['TOS운영자_test']}
2025-09-04 08:56:44,288 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-04 08:56:44,288 - __main__ - INFO - LLM 추출 엔티티: []
2025-09-04 08:56:44,301 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-04 08:56:44,301 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-04 08:56:44,305 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-04 08:56:44,305 - __main__ - INFO - ============================================================
2025-09-04 08:56:44,305 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-04 08:56:44,305 - __main__ - INFO - ============================================================
2025-09-04 08:56:44,305 - __main__ - INFO - 제목: 테스트 메시지입니다.
2025-09-04 08:56:44,305 - __main__ - INFO - 목적: ['기타 정보 제공']
2025-09-04 08:56:44,305 - __main__ - INFO - 상품 수: 0개
2025-09-04 08:56:44,305 - __main__ - INFO - 채널 수: 0개
2025-09-04 08:56:44,305 - __main__ - INFO - 프로그램 수: 2개
2025-09-04 08:56:44,305 - __main__ - INFO - process_message 실행완료: 2.24초
2025-09-04 08:56:44,305 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-04 08:56:44,305 - __main__ - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-04 08:56:44,305 - __main__ - INFO - 배치 처리 완료: 1개 메시지, 2.24초
2025-09-04 08:56:44,306 - __main__ - INFO - 평균 처리 시간: 2.24초/메시지
2025-09-11 11:22:36,321 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:22:36,321 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:22:36,321 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:22:36,321 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:22:36,321 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:22:36,322 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:22:36,339 - __main__ - INFO - Using device: mps
2025-09-11 11:22:36,339 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:22:36,339 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:22:36,339 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:22:36,339 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:22:36,339 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:22:36,339 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:22:36,339 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:22:36,339 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:22:37,390 - __main__ - INFO - Model loaded on mps
2025-09-11 11:22:37,390 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.05초
2025-09-11 11:22:37,390 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:22:37,832 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:22:37,832 - __main__ - INFO - _initialize_kiwi 실행완료: 0.44초
2025-09-11 11:22:37,832 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:22:37,832 - __main__ - INFO - ============================================================
2025-09-11 11:22:37,832 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:22:37,832 - __main__ - INFO - ============================================================
2025-09-11 11:22:37,832 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:22:37,832 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:22:37,832 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:22:37,832 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:22:37,832 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:22:37,833 - __main__ - ERROR - 상품 정보 로드 실패: [Errno 2] No such file or directory: './data/offer_master_data.csv'
2025-09-11 11:22:37,835 - __main__ - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_dev/mms_extractor.py", line 992, in _load_item_data
    item_pdf_raw = pd.read_csv(csv_path)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './data/offer_master_data.csv'

2025-09-11 11:22:37,836 - __main__ - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-11 11:22:37,836 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-11 11:22:37,836 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-11 11:22:37,836 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:22:37,836 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:22:37,836 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-11 11:22:37,838 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:22:37,838 - __main__ - INFO - null이 아닌 상품명 수: 0개
2025-09-11 11:22:37,838 - __main__ - INFO - 기존 item_nm_alias 데이터가 없어 item_nm에서 별칭을 생성합니다.
2025-09-11 11:22:37,839 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-11 11:22:37,839 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:22:37,839 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-11 11:22:37,846 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:22:37,847 - __main__ - INFO - 정지어 로드 완료: 143개
2025-09-11 11:22:37,847 - __main__ - INFO - 로드된 정지어 수: 143개
2025-09-11 11:22:37,847 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:22:37,847 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:22:37,847 - __main__ - INFO - 등록할 고유 별칭 수: 0개
2025-09-11 11:22:37,847 - __main__ - INFO - 유효한 별칭 수: 0개
2025-09-11 11:22:37,847 - __main__ - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-11 11:22:37,847 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:22:37,847 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:22:37,848 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:22:37,848 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:22:38,024 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:22:38,024 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:22:38,024 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:22:38,530 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-11 11:22:38,530 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-11 11:22:38,530 - __main__ - INFO - ============================================================
2025-09-11 11:22:38,530 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:22:38,530 - __main__ - INFO - ============================================================
2025-09-11 11:22:38,530 - __main__ - INFO - ✅ 상품 데이터: (0, 5)
2025-09-11 11:22:38,530 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:22:38,530 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-11 11:22:38,530 - __main__ - INFO - ✅ 정지어: 143개
2025-09-11 11:22:38,530 - __main__ - INFO - _load_data 실행완료: 0.70초
2025-09-11 11:22:38,530 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:22:38,530 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:22:38,530 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-09-11 11:22:38,530 - __main__ - INFO - ============================================================
2025-09-11 11:22:38,530 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:22:38,530 - __main__ - INFO - ============================================================
2025-09-11 11:22:38,530 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-09-11 11:22:38,530 - __main__ - INFO - 메시지 길이: 675 문자
2025-09-11 11:22:38,530 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:22:38,530 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:22:38,530 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:22:38,530 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:22:38,530 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:22:38,530 - __main__ - INFO - 상품 데이터 크기: (0, 5)
2025-09-11 11:22:38,530 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:22:38,530 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:22:38,530 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:22:38,530 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-09-11 11:22:38,530 - __main__ - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-11 11:22:38,531 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-11 11:22:38,531 - __main__ - INFO - 추출된 후보 엔티티: []
2025-09-11 11:22:38,531 - __main__ - INFO - 매칭된 상품 정보: (0, 0)
2025-09-11 11:22:38,531 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:22:38,631 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:22:38,631 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:22:38,631 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-11 11:22:38,631 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:22:38,631 - __main__ - WARNING - 후보 아이템이 없습니다!
2025-09-11 11:22:38,631 - __main__ - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-11 11:22:38,631 - __main__ - WARNING - 1. 상품 데이터 로딩 실패
2025-09-11 11:22:38,631 - __main__ - WARNING - 2. 엔티티 추출 실패
2025-09-11 11:22:38,631 - __main__ - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-11 11:22:38,631 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:22:38,631 - __main__ - INFO - 구성된 프롬프트 길이: 5837 문자
2025-09-11 11:22:38,631 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:22:38,632 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5837)
2025-09-11 11:22:38,632 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:22:38,632 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:22:45,217 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:22:45,223 - __main__ - INFO - LLM 응답 길이: 774 문자
2025-09-11 11:22:45,223 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/jAs/#74",
            "action": "추가 정보"
        },
        {
            ...
2025-09-11 11:22:45,223 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:22:45,223 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:22:45,223 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:22:45,223 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-11 11:22:45,223 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:22:45,223 - __main__ - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Wavve 콘텐츠 팩']
2025-09-11 11:22:45,240 - __main__ - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-11 11:22:45,240 - __main__ - INFO - extract_entities_by_llm 실행완료: 0.02초
2025-09-11 11:22:45,246 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:22:45,246 - __main__ - INFO - ============================================================
2025-09-11 11:22:45,246 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:22:45,247 - __main__ - INFO - ============================================================
2025-09-11 11:22:45,247 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-09-11 11:22:45,247 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-11 11:22:45,247 - __main__ - INFO - 상품 수: 2개
2025-09-11 11:22:45,247 - __main__ - INFO - 채널 수: 3개
2025-09-11 11:22:45,247 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:22:45,247 - __main__ - INFO - process_message 실행완료: 6.72초
2025-09-11 11:22:45,247 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:23:44,934 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:23:44,934 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:23:44,934 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:23:44,934 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:23:44,934 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:23:44,936 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:23:44,957 - __main__ - INFO - Using device: mps
2025-09-11 11:23:44,957 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:23:44,957 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:23:44,957 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:23:44,957 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:23:44,958 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:23:44,958 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:23:44,958 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:23:44,958 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:23:46,086 - __main__ - INFO - Model loaded on mps
2025-09-11 11:23:46,086 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.13초
2025-09-11 11:23:46,086 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:23:46,533 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:23:46,534 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 11:23:46,534 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:23:46,534 - __main__ - INFO - ============================================================
2025-09-11 11:23:46,534 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:23:46,534 - __main__ - INFO - ============================================================
2025-09-11 11:23:46,534 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:23:46,534 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:23:46,534 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:23:46,534 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:23:46,534 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:23:46,611 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:23:46,611 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:23:46,611 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:23:46,615 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:23:46,616 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:23:46,617 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:23:46,617 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:23:46,618 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:23:46,618 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:23:46,619 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:23:46,622 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:23:46,622 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:23:46,622 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:23:46,622 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:23:46,622 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:23:46,623 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:23:46,623 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:23:46,623 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:23:46,623 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:23:46,623 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:23:46,629 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:23:46,630 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:23:46,630 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:23:46,630 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:23:46,630 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:23:46,757 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:23:46,762 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:23:46,762 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 11:23:46,762 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:23:46,763 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:23:46,767 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:23:46,768 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:23:46,768 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:23:46,768 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:23:46,768 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:23:46,770 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:23:46,771 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:23:46,771 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 11:23:46,786 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:23:46,786 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:23:46,786 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:23:46,789 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:23:46,789 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:23:46,962 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:23:46,962 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:23:46,962 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:23:47,490 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-11 11:23:47,490 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-11 11:23:47,490 - __main__ - INFO - ============================================================
2025-09-11 11:23:47,490 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:23:47,490 - __main__ - INFO - ============================================================
2025-09-11 11:23:47,490 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:23:47,490 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:23:47,490 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-11 11:23:47,490 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:23:47,490 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:23:47,492 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:23:47,493 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:23:47,494 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:23:47,494 - __main__ - INFO - _load_data 실행완료: 0.96초
2025-09-11 11:23:47,494 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:23:47,494 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:23:47,494 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-09-11 11:23:47,494 - __main__ - INFO - ============================================================
2025-09-11 11:23:47,494 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:23:47,494 - __main__ - INFO - ============================================================
2025-09-11 11:23:47,494 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-09-11 11:23:47,494 - __main__ - INFO - 메시지 길이: 675 문자
2025-09-11 11:23:47,495 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:23:47,495 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:23:47,495 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:23:47,495 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:23:47,495 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:23:47,495 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:23:47,495 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:23:47,495 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:23:47,495 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:23:47,495 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-09-11 11:23:47,496 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:23:48,035 - __main__ - INFO - 분할된 문장 수: 21개
2025-09-11 11:23:48,036 - __main__ - INFO - 필터링된 문장들: [' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', '넷플릭스 웨이브 월 이게 되네 ', ' 고객님 ']...
2025-09-11 11:23:48,041 - __main__ - INFO - 전체 토큰 수: 272개
2025-09-11 11:23:48,041 - __main__ - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-11 11:23:48,041 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-11 11:23:48,041 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:23:49,094 - __main__ - INFO - 퍼지 매칭 결과 크기: (5348, 3)
2025-09-11 11:23:49,094 - __main__ - INFO - 퍼지 매칭 성공: 5348개 결과
2025-09-11 11:23:49,095 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.6956521739130435}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '밴드 데이터 세이브', 'sim': 0.4}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '다이렉트5G 76(넷플릭스)', 'sim': 0.41666666666666663}]
2025-09-11 11:23:49,095 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:23:49,191 - __main__ - INFO - 시퀀스 유사도 결과 크기: (5348, 3)
2025-09-11 11:23:49,192 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5333333333333333}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '밴드 데이터 세이브', 'sim': 0.32000000000000006}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '다이렉트5G 76(넷플릭스)', 'sim': 0.34285714285714286}]
2025-09-11 11:23:49,192 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:23:49,196 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 58개
2025-09-11 11:23:49,198 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-11 11:23:49,198 - __main__ - INFO - 통합된 후보 아이템 수: 62개
2025-09-11 11:23:49,200 - __main__ - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:23:49,203 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (25, 2)
2025-09-11 11:23:49,203 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}, {'item_nm': 'Netflix 광고형 스탠다드 이용권', 'item_id': ['PR00000418', 'PR00000418']}]
2025-09-11 11:23:49,203 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.71초
2025-09-11 11:23:49,203 - __main__ - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:23:49,203 - __main__ - INFO - 매칭된 상품 정보: (25, 2)
2025-09-11 11:23:49,203 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:23:49,306 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:23:49,306 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:23:49,306 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-11 11:23:49,306 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:23:49,306 - __main__ - INFO - 후보 아이템 리스트 크기: 34개
2025-09-11 11:23:49,306 - __main__ - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:23:49,306 - __main__ - INFO - extra_item_pdf 크기: (25, 2)
2025-09-11 11:23:49,306 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:23:49,306 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-11 11:23:49,307 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 25개
2025-09-11 11:23:49,307 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'Netflix', 'action': '기타'}]
2025-09-11 11:23:49,307 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:23:49,308 - __main__ - INFO - 구성된 프롬프트 길이: 7259 문자
2025-09-11 11:23:49,308 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:23:49,308 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7259)
2025-09-11 11:23:49,308 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:23:49,308 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:23:57,303 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:23:57,313 - __main__ - INFO - LLM 응답 길이: 1176 문자
2025-09-11 11:23:57,313 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "Netflix",
            "action": "가입"
        },
        {
            "name": "Wavve",
            "action": "가입"
        },
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
          ...
2025-09-11 11:23:57,313 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:23:57,314 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:23:57,314 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:23:57,314 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'Netflix', 'action': '가입'}, {'name': 'Wavve', 'action': '가입'}, {'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드', 'action': '가입'}, {'name': 'Netflix 프리미엄', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-11 11:23:57,314 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:23:57,314 - __main__ - INFO - LLM 추출 엔티티: ['Netflix', 'Wavve', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', 'Netflix 프리미엄']
2025-09-11 11:23:57,613 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 4224)
2025-09-11 11:23:57,613 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:23:57,613 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:23:58,623 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:23:58,985 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.67초
2025-09-11 11:23:58,989 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:23:58,989 - __main__ - INFO - ============================================================
2025-09-11 11:23:58,989 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:23:58,989 - __main__ - INFO - ============================================================
2025-09-11 11:23:58,989 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-09-11 11:23:58,989 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-11 11:23:58,989 - __main__ - INFO - 상품 수: 5개
2025-09-11 11:23:58,989 - __main__ - INFO - 채널 수: 3개
2025-09-11 11:23:58,989 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:23:58,989 - __main__ - INFO - process_message 실행완료: 11.49초
2025-09-11 11:23:58,989 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:24:27,976 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:24:27,976 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:24:27,976 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:24:27,976 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:24:27,976 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:24:27,977 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:24:27,994 - __main__ - INFO - Using device: mps
2025-09-11 11:24:27,994 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:24:27,994 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:24:27,995 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:24:27,995 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:24:27,995 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:24:27,995 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:24:27,995 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:24:27,995 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:24:28,841 - __main__ - INFO - Model loaded on mps
2025-09-11 11:24:28,841 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.85초
2025-09-11 11:24:28,841 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:24:29,270 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:24:29,270 - __main__ - INFO - _initialize_kiwi 실행완료: 0.43초
2025-09-11 11:24:29,270 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:24:29,270 - __main__ - INFO - ============================================================
2025-09-11 11:24:29,270 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:24:29,270 - __main__ - INFO - ============================================================
2025-09-11 11:24:29,270 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:24:29,270 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:24:29,270 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:24:29,270 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:24:29,270 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:24:29,340 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:24:29,340 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:24:29,341 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:24:29,344 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:24:29,345 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:24:29,345 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:24:29,345 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:24:29,346 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:24:29,346 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:24:29,348 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:24:29,350 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:24:29,350 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:24:29,350 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:24:29,350 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:24:29,350 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:24:29,350 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:24:29,350 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:24:29,350 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:24:29,351 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:24:29,351 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:24:29,352 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:24:29,352 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:24:29,352 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:24:29,352 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:24:29,352 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:24:29,478 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:24:29,482 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:24:29,483 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 11:24:29,483 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:24:29,483 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:24:29,483 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:24:29,484 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:24:29,484 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:24:29,484 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:24:29,484 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:24:29,486 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:24:29,487 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:24:29,487 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 11:24:29,503 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:24:29,503 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:24:29,503 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:24:29,505 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:24:29,505 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:24:29,677 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:24:29,677 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:24:29,677 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:24:30,165 - __main__ - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-11 11:24:30,165 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-11 11:24:30,165 - __main__ - INFO - ============================================================
2025-09-11 11:24:30,165 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:24:30,165 - __main__ - INFO - ============================================================
2025-09-11 11:24:30,165 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:24:30,165 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:24:30,165 - __main__ - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-11 11:24:30,165 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:24:30,165 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:24:30,167 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:24:30,169 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:24:30,170 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:24:30,170 - __main__ - INFO - _load_data 실행완료: 0.90초
2025-09-11 11:24:30,170 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:24:30,170 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:24:30,170 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[S...
2025-09-11 11:24:30,170 - __main__ - INFO - ============================================================
2025-09-11 11:24:30,170 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:24:30,170 - __main__ - INFO - ============================================================
2025-09-11 11:24:30,170 - __main__ - INFO - 메시지 내용: 
            '[T 우주] 넷플릭스와 웨이브를 월 9,900원에! 
(광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! __#04 고객님,_넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! __오직 T 우주에서만, _2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.__8월...
2025-09-11 11:24:30,170 - __main__ - INFO - 메시지 길이: 675 문자
2025-09-11 11:24:30,170 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:24:30,170 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:24:30,170 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:24:30,170 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:24:30,170 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:24:30,170 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:24:30,170 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:24:30,170 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:24:30,170 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:24:30,170 - __main__ - INFO - 처리할 메시지 길이: 649 문자
2025-09-11 11:24:30,172 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:24:30,652 - __main__ - INFO - 분할된 문장 수: 21개
2025-09-11 11:24:30,653 - __main__ - INFO - 필터링된 문장들: [' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', '넷플릭스 웨이브 월 이게 되네 ', ' 고객님 ']...
2025-09-11 11:24:30,657 - __main__ - INFO - 전체 토큰 수: 272개
2025-09-11 11:24:30,657 - __main__ - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-11 11:24:30,657 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-11 11:24:30,657 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:24:31,722 - __main__ - INFO - 퍼지 매칭 결과 크기: (5348, 3)
2025-09-11 11:24:31,722 - __main__ - INFO - 퍼지 매칭 성공: 5348개 결과
2025-09-11 11:24:31,723 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.6956521739130435}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '밴드 데이터 세이브', 'sim': 0.4}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '다이렉트5G 76(넷플릭스)', 'sim': 0.41666666666666663}]
2025-09-11 11:24:31,723 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:24:31,809 - __main__ - INFO - 시퀀스 유사도 결과 크기: (5348, 3)
2025-09-11 11:24:31,810 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5333333333333333}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '밴드 데이터 세이브', 'sim': 0.32000000000000006}, {'sent': ' T 우주 넷플릭스와 웨이브 월 에 광고 SKT ', 'item_nm_alias': '다이렉트5G 76(넷플릭스)', 'sim': 0.34285714285714286}]
2025-09-11 11:24:31,810 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:24:31,813 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 58개
2025-09-11 11:24:31,815 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-11 11:24:31,815 - __main__ - INFO - 통합된 후보 아이템 수: 62개
2025-09-11 11:24:31,818 - __main__ - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:24:31,821 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (25, 2)
2025-09-11 11:24:31,821 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}, {'item_nm': 'Netflix 광고형 스탠다드 이용권', 'item_id': ['PR00000418', 'PR00000418']}]
2025-09-11 11:24:31,821 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.65초
2025-09-11 11:24:31,821 - __main__ - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:24:31,821 - __main__ - INFO - 매칭된 상품 정보: (25, 2)
2025-09-11 11:24:31,821 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:24:31,922 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:24:31,922 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:24:31,922 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-11 11:24:31,922 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:24:31,922 - __main__ - INFO - 후보 아이템 리스트 크기: 34개
2025-09-11 11:24:31,922 - __main__ - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스', 'Netflix 광고형 스탠다드 이용권', 'Netflix 스탠다드 이용권', 'T 우주패스 Netflix', '우주패스 Netflix 인증', '멤버십가입', '우주패스 Netflix 추가혜택', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', 'Wavve 콘텐츠 팩_인증', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩(TV)', 'Wavve 콘텐츠 팩(티비)', '타다 쿠폰', 'Netflix 단독', 'Wavve 콘텐츠 팩_할인2', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩 이용권', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄', '멤버십 미가입자', 'Wavve 콘텐츠 팩 plus', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩 PLUS', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-11 11:24:31,922 - __main__ - INFO - extra_item_pdf 크기: (25, 2)
2025-09-11 11:24:31,922 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:24:31,923 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-11 11:24:31,924 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 25개
2025-09-11 11:24:31,924 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'Netflix', 'action': '기타'}]
2025-09-11 11:24:31,924 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:24:31,924 - __main__ - INFO - 구성된 프롬프트 길이: 7259 문자
2025-09-11 11:24:31,924 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:24:31,924 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7259)
2025-09-11 11:24:31,924 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:24:31,924 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:24:40,624 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:24:40,629 - __main__ - INFO - LLM 응답 길이: 1176 문자
2025-09-11 11:24:40,630 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T 우주] 넷플릭스와 웨이브를 월 9,900원에!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "Netflix",
            "action": "가입"
        },
        {
            "name": "Wavve",
            "action": "가입"
        },
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
          ...
2025-09-11 11:24:40,630 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:24:40,630 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:24:40,630 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:24:40,630 - __main__ - INFO - 파싱된 JSON 내용: {'title': '[T 우주] 넷플릭스와 웨이브를 월 9,900원에!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'Netflix', 'action': '가입'}, {'name': 'Wavve', 'action': '가입'}, {'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드', 'action': '가입'}, {'name': 'Netflix 프리미엄', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-11 11:24:40,630 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:24:40,630 - __main__ - INFO - LLM 추출 엔티티: ['Netflix', 'Wavve', '우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', 'Netflix 프리미엄']
2025-09-11 11:24:40,924 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 4224)
2025-09-11 11:24:40,925 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:24:40,925 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:24:41,821 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:24:42,192 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.56초
2025-09-11 11:24:42,196 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:24:42,196 - __main__ - INFO - ============================================================
2025-09-11 11:24:42,197 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:24:42,197 - __main__ - INFO - ============================================================
2025-09-11 11:24:42,197 - __main__ - INFO - 제목: [T 우주] 넷플릭스와 웨이브를 월 9,900원에!
2025-09-11 11:24:42,197 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-11 11:24:42,197 - __main__ - INFO - 상품 수: 5개
2025-09-11 11:24:42,197 - __main__ - INFO - 채널 수: 3개
2025-09-11 11:24:42,197 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:24:42,197 - __main__ - INFO - process_message 실행완료: 12.03초
2025-09-11 11:24:42,197 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:55:36,234 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:55:36,234 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:55:36,234 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:55:36,234 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:55:36,234 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:55:36,235 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:55:36,294 - __main__ - INFO - Using device: mps
2025-09-11 11:55:36,294 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-09-11 11:55:36,294 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:55:36,295 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:55:36,295 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:55:36,295 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:55:36,295 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:55:36,295 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:55:36,295 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:55:39,964 - __main__ - INFO - Model loaded on mps
2025-09-11 11:55:39,964 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.67초
2025-09-11 11:55:39,964 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:55:40,431 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:55:40,432 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-11 11:55:40,432 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:55:40,432 - __main__ - INFO - ============================================================
2025-09-11 11:55:40,432 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:55:40,432 - __main__ - INFO - ============================================================
2025-09-11 11:55:40,432 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:55:40,432 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:55:40,432 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:55:40,432 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:55:40,432 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:55:40,506 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:55:40,506 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:55:40,506 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:55:40,510 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:55:40,510 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:55:40,511 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:55:40,511 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:55:40,512 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:55:40,512 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:55:40,517 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:55:40,520 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:55:40,520 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:55:40,520 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:55:40,520 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:55:40,520 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:55:40,520 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:55:40,520 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:55:40,520 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:55:40,520 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:55:40,520 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:55:40,525 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:55:40,525 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:55:40,525 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:55:40,525 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:55:40,526 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:55:40,662 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:55:40,667 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:55:40,667 - __main__ - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-11 11:55:40,667 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:55:40,667 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:55:40,667 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:55:40,668 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:55:40,668 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:55:40,669 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:55:40,669 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:55:40,670 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:55:40,671 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:55:40,671 - __main__ - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-11 11:55:40,685 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:55:40,685 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:55:40,685 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:55:40,697 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:55:40,697 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:55:40,951 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:55:40,952 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:55:40,952 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:55:41,024 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 11:55:41,024 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 11:55:41,024 - __main__ - INFO - ============================================================
2025-09-11 11:55:41,024 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:55:41,024 - __main__ - INFO - ============================================================
2025-09-11 11:55:41,024 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:55:41,024 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:55:41,025 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 11:55:41,025 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:55:41,025 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:55:41,026 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:55:41,028 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:55:41,029 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:55:41,029 - __main__ - INFO - _load_data 실행완료: 0.60초
2025-09-11 11:55:41,029 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:55:41,029 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:55:41,029 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 11:55:41,029 - __main__ - INFO - ============================================================
2025-09-11 11:55:41,029 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:55:41,029 - __main__ - INFO - ============================================================
2025-09-11 11:55:41,029 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 11:55:41,029 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 11:55:41,029 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:55:41,029 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:55:41,029 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:55:41,029 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:55:41,029 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:55:41,029 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:55:41,029 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:55:41,029 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:55:41,029 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:55:41,029 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 11:55:41,030 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:55:41,530 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 11:55:41,531 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 11:55:41,534 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 11:55:41,534 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 11:55:41,534 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['명동', '기기값', '아이폰', '을지로입구역', '하나은행', '구매하', '갤럭시']
2025-09-11 11:55:41,534 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:55:42,337 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 11:55:42,337 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 11:55:42,338 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 11:55:42,338 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:55:42,376 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 11:55:42,377 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 11:55:42,377 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:55:42,379 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 11:55:42,381 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 11:55:42,382 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 11:55:42,383 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:55:42,385 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 11:55:42,385 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:55:42,386 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.36초
2025-09-11 11:55:42,386 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 11:55:42,386 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 11:55:42,386 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:55:42,487 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:55:42,487 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:55:42,487 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 11:55:42,487 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:55:42,487 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 11:55:42,487 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:55:42,487 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 11:55:42,487 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:55:42,487 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:55:42,488 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 11:55:42,488 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 11:55:42,488 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:55:42,488 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 11:55:42,488 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:55:42,488 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 11:55:42,488 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:55:42,489 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:55:51,093 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:55:51,101 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 11:55:51,101 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 11:55:51,101 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:55:51,101 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:55:51,101 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:55:51,101 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 11:55:51,101 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:55:51,101 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 11:55:51,309 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 11:55:51,309 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:55:51,309 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:55:51,944 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:55:52,225 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.12초
2025-09-11 11:55:52,229 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 11:55:52,229 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:55:52,229 - __main__ - INFO - ============================================================
2025-09-11 11:55:52,229 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:55:52,229 - __main__ - INFO - ============================================================
2025-09-11 11:55:52,229 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 11:55:52,229 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 11:55:52,229 - __main__ - INFO - 상품 수: 2개
2025-09-11 11:55:52,229 - __main__ - INFO - 채널 수: 5개
2025-09-11 11:55:52,229 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:55:52,229 - __main__ - INFO - process_message 실행완료: 11.20초
2025-09-11 11:55:52,229 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:56:34,817 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:56:34,817 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:56:34,817 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:56:34,817 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:56:34,817 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:56:34,818 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:56:34,838 - __main__ - INFO - Using device: mps
2025-09-11 11:56:34,838 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:56:34,838 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:56:34,839 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:56:34,839 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:56:34,839 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:56:34,839 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:56:34,839 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:56:34,839 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:56:35,703 - __main__ - INFO - Model loaded on mps
2025-09-11 11:56:35,703 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-09-11 11:56:35,703 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:56:36,154 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:56:36,154 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 11:56:36,154 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:56:36,154 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,154 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:56:36,154 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,154 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:56:36,154 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:56:36,154 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:56:36,154 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:56:36,154 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:56:36,226 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:56:36,226 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:56:36,226 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:56:36,230 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:56:36,230 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:56:36,231 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:56:36,232 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:56:36,232 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:56:36,232 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:56:36,233 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:56:36,236 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:56:36,236 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:56:36,236 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:56:36,236 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:56:36,236 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:56:36,236 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:56:36,236 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:56:36,236 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:56:36,237 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:56:36,237 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:56:36,238 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:56:36,238 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:56:36,238 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:56:36,238 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:56:36,238 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:56:36,373 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:56:36,379 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:56:36,379 - __main__ - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증']
2025-09-11 11:56:36,379 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:56:36,379 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:56:36,380 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:56:36,380 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:56:36,381 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:56:36,381 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:56:36,381 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:56:36,383 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:56:36,383 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:56:36,383 - __main__ - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증']
2025-09-11 11:56:36,397 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:56:36,398 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:56:36,398 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:56:36,399 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:56:36,399 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:56:36,571 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:56:36,571 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:56:36,571 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:56:36,645 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 11:56:36,645 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 11:56:36,645 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,645 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:56:36,645 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,645 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:56:36,645 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:56:36,645 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 11:56:36,645 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:56:36,645 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:56:36,647 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:56:36,649 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:56:36,650 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:56:36,650 - __main__ - INFO - _load_data 실행완료: 0.50초
2025-09-11 11:56:36,650 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:56:36,650 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:56:36,650 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 11:56:36,650 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,650 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:56:36,650 - __main__ - INFO - ============================================================
2025-09-11 11:56:36,650 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 11:56:36,650 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 11:56:36,650 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:56:36,650 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:56:36,650 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:56:36,650 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:56:36,650 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:56:36,650 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:56:36,650 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:56:36,650 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:56:36,650 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:56:36,650 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 11:56:36,652 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:56:37,156 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 11:56:37,157 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 11:56:37,161 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 11:56:37,161 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 11:56:37,161 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['기기값', '아이폰', '갤럭시', '하나은행', '명동', '을지로입구역', '구매하']
2025-09-11 11:56:37,161 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:56:37,954 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 11:56:37,954 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 11:56:37,955 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 11:56:37,955 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:56:37,996 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 11:56:37,997 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 11:56:37,997 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:56:37,999 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 11:56:38,001 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 11:56:38,001 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 11:56:38,003 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:56:38,005 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 11:56:38,006 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:56:38,006 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.36초
2025-09-11 11:56:38,006 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 11:56:38,006 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 11:56:38,006 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:56:38,110 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:56:38,110 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:56:38,110 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 11:56:38,110 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:56:38,110 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 11:56:38,110 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:56:38,110 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 11:56:38,110 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:56:38,110 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:56:38,111 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 11:56:38,111 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 11:56:38,111 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:56:38,111 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 11:56:38,111 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:56:38,112 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 11:56:38,112 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:56:38,112 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:56:46,724 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:56:46,736 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 11:56:46,736 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 11:56:46,736 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:56:46,737 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:56:46,737 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:56:46,737 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 11:56:46,737 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:56:46,738 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 11:56:46,938 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 11:56:46,938 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:56:46,938 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:56:47,545 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:56:47,833 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.10초
2025-09-11 11:56:47,837 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 11:56:47,837 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:56:47,837 - __main__ - INFO - ============================================================
2025-09-11 11:56:47,837 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:56:47,837 - __main__ - INFO - ============================================================
2025-09-11 11:56:47,837 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 11:56:47,837 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 11:56:47,837 - __main__ - INFO - 상품 수: 2개
2025-09-11 11:56:47,837 - __main__ - INFO - 채널 수: 5개
2025-09-11 11:56:47,837 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:56:47,837 - __main__ - INFO - process_message 실행완료: 11.19초
2025-09-11 11:56:47,837 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:57:39,216 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:57:39,216 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:57:39,216 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:57:39,216 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:57:39,216 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:57:39,217 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:57:39,234 - __main__ - INFO - Using device: mps
2025-09-11 11:57:39,234 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:57:39,234 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:57:39,234 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:57:39,234 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:57:39,234 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:57:39,234 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:57:39,235 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:57:39,235 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:57:40,085 - __main__ - INFO - Model loaded on mps
2025-09-11 11:57:40,085 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.85초
2025-09-11 11:57:40,085 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:57:40,531 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:57:40,532 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 11:57:40,532 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:57:40,532 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,532 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:57:40,532 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,532 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:57:40,532 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:57:40,532 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:57:40,532 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:57:40,532 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:57:40,598 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:57:40,598 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:57:40,598 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:57:40,601 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:57:40,602 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:57:40,602 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:57:40,603 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:57:40,603 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:57:40,603 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:57:40,605 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:57:40,607 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:57:40,607 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:57:40,607 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:57:40,607 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:57:40,607 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:57:40,608 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:57:40,608 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:57:40,608 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:57:40,608 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:57:40,608 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:57:40,609 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:57:40,609 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:57:40,609 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:57:40,610 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:57:40,610 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:57:40,740 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:57:40,745 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:57:40,746 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-11 11:57:40,746 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:57:40,746 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:57:40,746 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:57:40,747 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:57:40,747 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:57:40,747 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:57:40,747 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:57:40,749 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:57:40,750 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:57:40,750 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-11 11:57:40,763 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:57:40,763 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:57:40,763 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:57:40,765 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:57:40,765 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:57:40,921 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:57:40,921 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:57:40,921 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:57:40,991 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 11:57:40,991 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 11:57:40,991 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,991 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:57:40,991 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,991 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:57:40,991 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:57:40,991 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 11:57:40,991 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:57:40,991 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:57:40,993 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:57:40,994 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:57:40,995 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:57:40,995 - __main__ - INFO - _load_data 실행완료: 0.46초
2025-09-11 11:57:40,995 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:57:40,995 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:57:40,995 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 11:57:40,995 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,995 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:57:40,995 - __main__ - INFO - ============================================================
2025-09-11 11:57:40,996 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 11:57:40,996 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 11:57:40,996 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:57:40,996 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:57:40,996 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:57:40,996 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:57:40,996 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:57:40,996 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:57:40,996 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:57:40,996 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:57:40,996 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:57:40,996 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 11:57:40,997 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:57:41,485 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 11:57:41,485 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 11:57:41,489 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 11:57:41,489 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 11:57:41,489 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['아이폰', '갤럭시', '명동', '을지로입구역', '하나은행', '구매하', '기기값']
2025-09-11 11:57:41,489 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:57:42,306 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 11:57:42,306 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 11:57:42,306 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 11:57:42,307 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:57:42,344 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 11:57:42,345 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 11:57:42,345 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:57:42,347 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 11:57:42,349 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 11:57:42,349 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 11:57:42,351 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:57:42,352 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 11:57:42,352 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:57:42,353 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.36초
2025-09-11 11:57:42,353 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 11:57:42,353 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 11:57:42,353 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:57:42,448 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:57:42,448 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:57:42,448 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 11:57:42,448 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:57:42,448 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 11:57:42,448 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:57:42,448 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 11:57:42,448 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:57:42,449 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:57:42,450 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 11:57:42,450 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 11:57:42,450 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:57:42,450 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 11:57:42,450 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:57:42,450 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 11:57:42,450 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:57:42,450 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:57:50,885 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:57:50,893 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 11:57:50,893 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 11:57:50,893 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:57:50,894 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:57:50,894 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:57:50,894 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 11:57:50,894 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:57:50,894 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 11:57:51,092 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 11:57:51,092 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:57:51,092 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:57:51,723 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:57:52,013 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.12초
2025-09-11 11:57:52,016 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 11:57:52,016 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:57:52,016 - __main__ - INFO - ============================================================
2025-09-11 11:57:52,016 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:57:52,016 - __main__ - INFO - ============================================================
2025-09-11 11:57:52,016 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 11:57:52,016 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 11:57:52,016 - __main__ - INFO - 상품 수: 2개
2025-09-11 11:57:52,017 - __main__ - INFO - 채널 수: 5개
2025-09-11 11:57:52,017 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:57:52,017 - __main__ - INFO - process_message 실행완료: 11.02초
2025-09-11 11:57:52,017 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:58:55,832 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 11:58:55,833 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:58:55,833 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:58:55,833 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:58:55,833 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:58:55,834 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 11:58:55,849 - __main__ - INFO - Using device: mps
2025-09-11 11:58:55,849 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:58:55,849 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:58:55,849 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:58:55,849 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:58:55,849 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:58:55,849 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:58:55,849 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:58:55,849 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:58:56,647 - __main__ - INFO - Model loaded on mps
2025-09-11 11:58:56,647 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.80초
2025-09-11 11:58:56,647 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:58:57,101 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:58:57,101 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 11:58:57,101 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 11:58:57,101 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,101 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 11:58:57,101 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,101 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 11:58:57,101 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:58:57,101 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:58:57,101 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:58:57,101 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:58:57,168 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 11:58:57,168 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 11:58:57,168 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 11:58:57,172 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 11:58:57,172 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 11:58:57,173 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:58:57,173 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:58:57,174 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 11:58:57,174 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 11:58:57,175 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 11:58:57,177 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 11:58:57,177 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 11:58:57,177 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:58:57,178 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 11:58:57,178 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 11:58:57,178 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 11:58:57,178 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 11:58:57,178 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:58:57,178 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:58:57,178 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 11:58:57,179 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:58:57,179 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 11:58:57,179 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:58:57,180 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 11:58:57,180 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 11:58:57,305 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 11:58:57,310 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 11:58:57,311 - __main__ - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-11 11:58:57,311 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:58:57,311 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 11:58:57,311 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:58:57,312 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 11:58:57,312 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 11:58:57,312 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:58:57,312 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:58:57,314 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 11:58:57,314 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 11:58:57,314 - __main__ - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-11 11:58:57,328 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 11:58:57,329 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:58:57,329 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:58:57,330 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:58:57,330 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:58:57,497 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:58:57,497 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:58:57,497 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:58:57,566 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 11:58:57,567 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 11:58:57,567 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,567 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:58:57,567 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,567 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 11:58:57,567 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:58:57,567 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 11:58:57,567 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 11:58:57,567 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 11:58:57,568 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 11:58:57,570 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 11:58:57,571 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 11:58:57,571 - __main__ - INFO - _load_data 실행완료: 0.47초
2025-09-11 11:58:57,571 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:58:57,571 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 11:58:57,571 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 11:58:57,571 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,571 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:58:57,571 - __main__ - INFO - ============================================================
2025-09-11 11:58:57,571 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 11:58:57,571 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 11:58:57,571 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 11:58:57,571 - __main__ - INFO - 데이터 소스: local
2025-09-11 11:58:57,571 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 11:58:57,571 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 11:58:57,571 - __main__ - INFO - LLM 모델: ax
2025-09-11 11:58:57,571 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 11:58:57,571 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:58:57,571 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:58:57,571 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:58:57,571 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 11:58:57,573 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 11:58:58,044 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 11:58:58,045 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 11:58:58,048 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 11:58:58,048 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 11:58:58,048 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['기기값', '명동', '하나은행', '을지로입구역', '구매하', '아이폰', '갤럭시']
2025-09-11 11:58:58,048 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 11:58:58,826 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 11:58:58,827 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 11:58:58,827 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 11:58:58,827 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 11:58:58,869 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 11:58:58,870 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 11:58:58,870 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 11:58:58,872 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 11:58:58,874 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 11:58:58,874 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 11:58:58,876 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:58:58,878 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 11:58:58,879 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:58:58,879 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.31초
2025-09-11 11:58:58,879 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 11:58:58,879 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 11:58:58,879 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:58:58,989 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:58:58,989 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:58:58,989 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 11:58:58,989 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:58:58,989 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 11:58:58,989 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 11:58:58,989 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 11:58:58,989 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 11:58:58,989 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 11:58:58,990 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 11:58:58,990 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 11:58:58,990 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:58:58,991 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 11:58:58,991 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:58:58,991 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 11:58:58,991 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:58:58,991 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:59:07,908 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:59:07,917 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 11:59:07,918 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 11:59:07,918 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:59:07,918 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:59:07,918 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:59:07,918 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 11:59:07,918 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:59:07,919 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 11:59:08,118 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 11:59:08,118 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 11:59:08,118 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 11:59:08,761 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:59:09,051 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.13초
2025-09-11 11:59:09,055 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 11:59:09,055 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:59:09,055 - __main__ - INFO - ============================================================
2025-09-11 11:59:09,055 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:59:09,055 - __main__ - INFO - ============================================================
2025-09-11 11:59:09,055 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 11:59:09,055 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 11:59:09,055 - __main__ - INFO - 상품 수: 2개
2025-09-11 11:59:09,055 - __main__ - INFO - 채널 수: 5개
2025-09-11 11:59:09,055 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 11:59:09,055 - __main__ - INFO - process_message 실행완료: 11.48초
2025-09-11 11:59:09,055 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:00:26,738 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:00:26,738 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:00:26,738 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:00:26,738 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:00:26,738 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:00:26,739 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:00:26,756 - __main__ - INFO - Using device: mps
2025-09-11 12:00:26,756 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:00:26,756 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:00:26,756 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:00:26,756 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:00:26,756 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:00:26,756 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:00:26,756 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:00:26,756 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:00:27,797 - __main__ - INFO - Model loaded on mps
2025-09-11 12:00:27,797 - __main__ - INFO - _initialize_embedding_model 실행완료: 1.04초
2025-09-11 12:00:27,797 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:00:28,232 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:00:28,232 - __main__ - INFO - _initialize_kiwi 실행완료: 0.43초
2025-09-11 12:00:28,232 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:00:28,232 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,232 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:00:28,232 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,232 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:00:28,232 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:00:28,232 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:00:28,232 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:00:28,232 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:00:28,302 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:00:28,303 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:00:28,303 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:00:28,306 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:00:28,307 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:00:28,308 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:00:28,308 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:00:28,309 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:00:28,309 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:00:28,310 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:00:28,312 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:00:28,313 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:00:28,313 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:00:28,313 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:00:28,313 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:00:28,313 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:00:28,313 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:00:28,313 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:00:28,313 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:00:28,313 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:00:28,314 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:00:28,315 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:00:28,315 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:00:28,315 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:00:28,315 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:00:28,448 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:00:28,453 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:00:28,453 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:00:28,453 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:00:28,454 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:00:28,454 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:00:28,454 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:00:28,454 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:00:28,454 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:00:28,454 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:00:28,456 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:00:28,457 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:00:28,457 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:00:28,471 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:00:28,472 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:00:28,472 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:00:28,473 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:00:28,473 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:00:28,649 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:00:28,649 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:00:28,649 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:00:28,720 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:00:28,721 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:00:28,721 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,721 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:00:28,721 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,721 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:00:28,721 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:00:28,721 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:00:28,721 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:00:28,721 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:00:28,722 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:00:28,724 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:00:28,725 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:00:28,725 - __main__ - INFO - _load_data 실행완료: 0.49초
2025-09-11 12:00:28,725 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:00:28,725 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:00:28,725 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:00:28,725 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,725 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:00:28,725 - __main__ - INFO - ============================================================
2025-09-11 12:00:28,725 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:00:28,725 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:00:28,725 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:00:28,725 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:00:28,725 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:00:28,725 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:00:28,725 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:00:28,725 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:00:28,725 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:00:28,725 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:00:28,725 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:00:28,725 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:00:28,727 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:00:29,223 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:00:29,223 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:00:29,227 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:00:29,227 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:00:29,227 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['구매하', '을지로입구역', '아이폰', '갤럭시', '명동', '기기값', '하나은행']
2025-09-11 12:00:29,227 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:00:30,047 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:00:30,047 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:00:30,048 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:00:30,048 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:00:30,088 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:00:30,088 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:00:30,088 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:00:30,091 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:00:30,093 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:00:30,094 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:00:30,096 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:00:30,098 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:00:30,098 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:00:30,098 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.37초
2025-09-11 12:00:30,099 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:00:30,099 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:00:30,099 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:00:30,214 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:00:30,214 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:00:30,214 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:00:30,214 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:00:30,214 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:00:30,214 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:00:30,214 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:00:30,214 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:00:30,214 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:00:30,215 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:00:30,216 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:00:30,216 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:00:30,216 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 12:00:30,216 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:00:30,216 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 12:00:30,216 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:00:30,216 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:00:38,605 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:00:38,616 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 12:00:38,616 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:00:38,616 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:00:38,617 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:00:38,617 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:00:38,617 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:00:38,618 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:00:38,618 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:00:38,814 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:00:38,814 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:00:38,814 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:00:39,389 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:00:39,674 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.06초
2025-09-11 12:00:39,678 - __main__ - ERROR - 채널 정보 추출 실패: 'item_nm'
2025-09-11 12:00:39,678 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:00:39,678 - __main__ - INFO - ============================================================
2025-09-11 12:00:39,678 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:00:39,678 - __main__ - INFO - ============================================================
2025-09-11 12:00:39,678 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:00:39,678 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:00:39,678 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:00:39,678 - __main__ - INFO - 채널 수: 0개
2025-09-11 12:00:39,678 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:00:39,678 - __main__ - INFO - process_message 실행완료: 10.95초
2025-09-11 12:00:39,678 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:05:44,394 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:05:44,394 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:05:44,394 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:05:44,394 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:05:44,394 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:05:44,395 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:05:44,414 - __main__ - INFO - Using device: mps
2025-09-11 12:05:44,414 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:05:44,414 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:05:44,414 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:05:44,415 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:05:44,415 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:05:44,415 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:05:44,415 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:05:44,415 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:05:45,229 - __main__ - INFO - Model loaded on mps
2025-09-11 12:05:45,229 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.81초
2025-09-11 12:05:45,229 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:05:45,689 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:05:45,689 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-11 12:05:45,689 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:05:45,689 - __main__ - INFO - ============================================================
2025-09-11 12:05:45,689 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:05:45,689 - __main__ - INFO - ============================================================
2025-09-11 12:05:45,689 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:05:45,689 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:05:45,689 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:05:45,689 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:05:45,689 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:05:45,757 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:05:45,757 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:05:45,757 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:05:45,761 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:05:45,761 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:05:45,762 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:05:45,762 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:05:45,763 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:05:45,763 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:05:45,765 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:05:45,767 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:05:45,767 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:05:45,767 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:05:45,767 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:05:45,767 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:05:45,768 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:05:45,768 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:05:45,768 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:05:45,768 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:05:45,768 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:05:45,770 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:05:45,771 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:05:45,771 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:05:45,771 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:05:45,771 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:05:45,899 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:05:45,905 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:05:45,905 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:05:45,906 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:05:45,906 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:05:45,906 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:05:45,907 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:05:45,907 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:05:45,907 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:05:45,907 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:05:45,909 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:05:45,909 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:05:45,909 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:05:45,923 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:05:45,923 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:05:45,923 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:05:45,925 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:05:45,925 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:05:46,099 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:05:46,099 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:05:46,099 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:05:46,168 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:05:46,168 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:05:46,168 - __main__ - INFO - ============================================================
2025-09-11 12:05:46,168 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:05:46,168 - __main__ - INFO - ============================================================
2025-09-11 12:05:46,168 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:05:46,168 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:05:46,168 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:05:46,168 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:05:46,168 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:05:46,169 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:05:46,171 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:05:46,172 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:05:46,172 - __main__ - INFO - _load_data 실행완료: 0.48초
2025-09-11 12:05:46,172 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:05:46,172 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:05:46,172 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:05:46,172 - __main__ - INFO - ============================================================
2025-09-11 12:05:46,172 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:05:46,172 - __main__ - INFO - ============================================================
2025-09-11 12:05:46,172 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:05:46,172 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:05:46,172 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:05:46,172 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:05:46,172 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:05:46,172 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:05:46,172 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:05:46,172 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:05:46,172 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:05:46,172 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:05:46,172 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:05:46,173 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:05:46,174 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:05:46,649 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:05:46,649 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:05:46,653 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:05:46,653 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:05:46,653 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '명동', '아이폰', '을지로입구역', '구매하', '하나은행', '기기값']
2025-09-11 12:05:46,653 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:05:47,436 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:05:47,436 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:05:47,437 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:05:47,437 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:05:47,478 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:05:47,478 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:05:47,478 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:05:47,480 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:05:47,482 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:05:47,482 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:05:47,485 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:05:47,486 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:05:47,486 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:05:47,487 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.31초
2025-09-11 12:05:47,487 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:05:47,487 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:05:47,487 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:05:47,583 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:05:47,583 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:05:47,583 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:05:47,583 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:05:47,583 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:05:47,583 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:05:47,583 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:05:47,583 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:05:47,583 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:05:47,584 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:05:47,584 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:05:47,584 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:05:47,584 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 12:05:47,584 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:05:47,584 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 12:05:47,584 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:05:47,584 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:05:56,045 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:05:56,052 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 12:05:56,052 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:05:56,052 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:05:56,053 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:05:56,053 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:05:56,053 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:05:56,053 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:05:56,053 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:05:56,249 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:05:56,249 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:05:56,249 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:05:56,854 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:05:57,149 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.10초
2025-09-11 12:05:57,153 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 12:05:57,153 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:05:57,153 - __main__ - INFO - ============================================================
2025-09-11 12:05:57,153 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:05:57,153 - __main__ - INFO - ============================================================
2025-09-11 12:05:57,153 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:05:57,153 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:05:57,153 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:05:57,153 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:05:57,153 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:05:57,154 - __main__ - INFO - process_message 실행완료: 10.98초
2025-09-11 12:05:57,154 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:08:04,333 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:08:04,333 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:08:04,333 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:08:04,333 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:08:04,333 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:08:04,334 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:08:04,354 - __main__ - INFO - Using device: mps
2025-09-11 12:08:04,355 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:08:04,355 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:08:04,355 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:08:04,355 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:08:04,355 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:08:04,355 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:08:04,355 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:08:04,355 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:08:05,212 - __main__ - INFO - Model loaded on mps
2025-09-11 12:08:05,212 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-09-11 12:08:05,212 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:08:05,701 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:08:05,702 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-11 12:08:05,702 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:08:05,702 - __main__ - INFO - ============================================================
2025-09-11 12:08:05,702 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:08:05,702 - __main__ - INFO - ============================================================
2025-09-11 12:08:05,702 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:08:05,702 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:08:05,702 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:08:05,702 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:08:05,702 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:08:05,771 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:08:05,771 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:08:05,771 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:08:05,774 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:08:05,775 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:08:05,776 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:05,776 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:05,777 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:08:05,777 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:08:05,779 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:08:05,781 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:08:05,781 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:08:05,781 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:05,781 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:08:05,781 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:08:05,781 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:08:05,781 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:05,781 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:08:05,782 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:08:05,782 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:08:05,783 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:08:05,783 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:08:05,783 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:05,783 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:08:05,784 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:05,908 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:08:05,913 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:08:05,914 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 12:08:05,914 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:08:05,914 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:08:05,914 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:08:05,915 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:08:05,915 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:08:05,915 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:08:05,915 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:08:05,917 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:08:05,917 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:08:05,917 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 12:08:05,930 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:08:05,930 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:08:05,931 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:08:05,932 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:08:05,932 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:08:06,103 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:08:06,104 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:08:06,104 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:08:06,173 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:08:06,173 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:08:06,173 - __main__ - INFO - ============================================================
2025-09-11 12:08:06,173 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:08:06,173 - __main__ - INFO - ============================================================
2025-09-11 12:08:06,173 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:08:06,173 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:08:06,173 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:08:06,173 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:08:06,173 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:08:06,175 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:08:06,177 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:08:06,178 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:08:06,178 - __main__ - INFO - _load_data 실행완료: 0.48초
2025-09-11 12:08:06,178 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:08:06,178 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:08:06,178 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:08:06,178 - __main__ - INFO - ============================================================
2025-09-11 12:08:06,178 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:08:06,178 - __main__ - INFO - ============================================================
2025-09-11 12:08:06,178 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:08:06,178 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:08:06,178 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:08:06,178 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:08:06,178 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:08:06,178 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:08:06,178 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:08:06,178 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:08:06,178 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:08:06,178 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:08:06,178 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:08:06,178 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:08:06,180 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:08:06,641 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:08:06,641 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:08:06,645 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:08:06,645 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:08:06,645 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '명동', '하나은행', '을지로입구역', '구매하', '아이폰', '기기값']
2025-09-11 12:08:06,645 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:08:07,416 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:08:07,416 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:08:07,417 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:08:07,417 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:08:07,456 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:08:07,457 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:08:07,457 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:08:07,459 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:08:07,461 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:08:07,461 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:08:07,463 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:08:07,465 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:08:07,465 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:08:07,466 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.29초
2025-09-11 12:08:07,466 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:08:07,466 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:08:07,466 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:08:07,569 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:08:07,569 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:08:07,569 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:08:07,569 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:08:07,569 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:08:07,569 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:08:07,569 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:08:07,569 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:08:07,569 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:08:07,570 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:08:07,570 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:08:07,570 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:08:07,570 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 12:08:07,570 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:08:07,570 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 12:08:07,570 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:08:07,570 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:08:15,930 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:08:15,941 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 12:08:15,941 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:08:15,941 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:08:15,941 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:08:15,942 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:08:15,942 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:08:15,942 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:08:15,942 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:08:16,136 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:08:16,136 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:08:16,136 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:08:16,716 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:08:16,997 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.06초
2025-09-11 12:08:17,012 - __main__ - ERROR - 대리점 정보 매칭 실패: 'item_nm'
2025-09-11 12:08:17,012 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:08:17,012 - __main__ - INFO - ============================================================
2025-09-11 12:08:17,012 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:08:17,012 - __main__ - INFO - ============================================================
2025-09-11 12:08:17,012 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:08:17,012 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:08:17,012 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:08:17,012 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:08:17,012 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:08:17,012 - __main__ - INFO - process_message 실행완료: 10.83초
2025-09-11 12:08:17,012 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:08:57,781 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:08:57,781 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:08:57,781 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:08:57,781 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:08:57,781 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:08:57,782 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:08:57,799 - __main__ - INFO - Using device: mps
2025-09-11 12:08:57,799 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:08:57,799 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:08:57,800 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:08:57,800 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:08:57,800 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:08:57,800 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:08:57,800 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:08:57,800 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:08:58,639 - __main__ - INFO - Model loaded on mps
2025-09-11 12:08:58,639 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.84초
2025-09-11 12:08:58,639 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:08:59,087 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:08:59,087 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 12:08:59,087 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:08:59,087 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,087 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:08:59,087 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,087 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:08:59,087 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:08:59,087 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:08:59,087 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:08:59,087 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:08:59,153 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:08:59,153 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:08:59,153 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:08:59,157 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:08:59,157 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:08:59,158 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:59,158 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:59,159 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:08:59,159 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:08:59,160 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:08:59,162 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:08:59,162 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:08:59,162 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:59,162 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:08:59,163 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:08:59,163 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:08:59,163 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:08:59,163 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:08:59,163 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:08:59,163 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:08:59,164 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:08:59,165 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:08:59,165 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:59,165 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:08:59,165 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:08:59,292 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:08:59,296 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:08:59,297 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:08:59,297 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:08:59,297 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:08:59,297 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:08:59,298 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:08:59,298 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:08:59,298 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:08:59,298 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:08:59,300 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:08:59,301 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:08:59,301 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:08:59,313 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:08:59,314 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:08:59,314 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:08:59,315 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:08:59,315 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:08:59,487 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:08:59,487 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:08:59,487 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:08:59,561 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:08:59,561 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:08:59,561 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,561 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:08:59,561 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,561 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:08:59,561 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:08:59,561 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:08:59,561 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:08:59,561 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:08:59,562 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:08:59,565 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:08:59,566 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:08:59,566 - __main__ - INFO - _load_data 실행완료: 0.48초
2025-09-11 12:08:59,566 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:08:59,566 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:08:59,566 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:08:59,566 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,566 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:08:59,566 - __main__ - INFO - ============================================================
2025-09-11 12:08:59,566 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:08:59,566 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:08:59,566 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:08:59,566 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:08:59,566 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:08:59,566 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:08:59,566 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:08:59,566 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:08:59,566 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:08:59,566 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:08:59,566 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:08:59,566 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:08:59,568 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:09:00,036 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:09:00,036 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:09:00,040 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:09:00,040 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:09:00,040 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['기기값', '을지로입구역', '아이폰', '구매하', '명동', '갤럭시', '하나은행']
2025-09-11 12:09:00,040 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:09:00,826 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:09:00,826 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:09:00,827 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:09:00,827 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:09:00,868 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:09:00,868 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:09:00,868 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:09:00,870 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:09:00,872 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:09:00,872 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:09:00,875 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:09:00,877 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:09:00,877 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:09:00,878 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.31초
2025-09-11 12:09:00,878 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:09:00,878 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:09:00,878 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:09:00,981 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:09:00,981 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:09:00,981 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:09:00,981 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:09:00,981 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:09:00,981 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:09:00,981 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:09:00,981 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:09:00,981 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:09:00,982 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:09:00,982 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:09:00,982 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:09:00,983 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 12:09:00,983 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:09:00,983 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 12:09:00,983 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:09:00,983 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:09:09,786 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:09:09,792 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 12:09:09,792 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:09:09,792 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:09:09,793 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:09:09,793 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:09:09,793 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:09:09,793 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:09:09,793 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:09:09,994 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:09:09,994 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:09:09,994 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:09:10,621 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:09:10,914 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.12초
2025-09-11 12:09:11,031 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:09:11,031 - __main__ - INFO - ============================================================
2025-09-11 12:09:11,031 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:09:11,031 - __main__ - INFO - ============================================================
2025-09-11 12:09:11,031 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:09:11,031 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:09:11,031 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:09:11,031 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:09:11,031 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:09:11,031 - __main__ - INFO - process_message 실행완료: 11.47초
2025-09-11 12:09:11,031 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:10:07,798 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:10:07,798 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:10:07,798 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:10:07,798 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:10:07,798 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:10:07,799 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:10:07,821 - __main__ - INFO - Using device: mps
2025-09-11 12:10:07,821 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:10:07,821 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:10:07,821 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:10:07,821 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:10:07,821 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:10:07,821 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:10:07,822 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:10:07,822 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:10:08,697 - __main__ - INFO - Model loaded on mps
2025-09-11 12:10:08,697 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.88초
2025-09-11 12:10:08,697 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:10:09,149 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:10:09,149 - __main__ - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-11 12:10:09,149 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:10:09,149 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,149 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:10:09,149 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,149 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:10:09,149 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:10:09,149 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:10:09,149 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:10:09,149 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:10:09,219 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:10:09,219 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:10:09,220 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:10:09,223 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:10:09,223 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:10:09,224 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:10:09,224 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:10:09,225 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:10:09,225 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:10:09,226 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:10:09,228 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:10:09,228 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:10:09,228 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:10:09,229 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:10:09,229 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:10:09,229 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:10:09,229 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:10:09,229 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:10:09,229 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:10:09,229 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:10:09,230 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:10:09,230 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:10:09,231 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:10:09,231 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:10:09,231 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:10:09,357 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:10:09,363 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:10:09,363 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 12:10:09,364 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:10:09,364 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:10:09,364 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:10:09,365 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:10:09,365 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:10:09,365 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:10:09,365 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:10:09,367 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:10:09,368 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:10:09,368 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 12:10:09,382 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:10:09,382 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:10:09,382 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:10:09,384 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:10:09,384 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:10:09,552 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:10:09,552 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:10:09,552 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:10:09,623 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:10:09,624 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:10:09,624 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,624 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:10:09,624 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,624 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:10:09,624 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:10:09,624 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:10:09,624 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:10:09,624 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:10:09,625 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:10:09,627 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:10:09,628 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:10:09,628 - __main__ - INFO - _load_data 실행완료: 0.48초
2025-09-11 12:10:09,628 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:10:09,628 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:10:09,628 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:10:09,628 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,628 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:10:09,628 - __main__ - INFO - ============================================================
2025-09-11 12:10:09,628 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:10:09,628 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:10:09,628 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:10:09,628 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:10:09,628 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:10:09,628 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:10:09,628 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:10:09,628 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:10:09,628 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:10:09,628 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:10:09,628 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:10:09,628 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:10:09,629 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:10:10,106 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:10:10,107 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:10:10,110 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:10:10,110 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:10:10,110 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['아이폰', '을지로입구역', '하나은행', '구매하', '명동', '기기값', '갤럭시']
2025-09-11 12:10:10,110 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:10:10,878 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:10:10,879 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:10:10,879 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:10:10,879 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:10:10,918 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:10:10,919 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:10:10,919 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:10:10,921 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:10:10,923 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:10:10,923 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:10:10,926 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:10:10,928 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:10:10,928 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:10:10,929 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.30초
2025-09-11 12:10:10,929 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:10:10,929 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:10:10,929 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:10:11,027 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:10:11,027 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:10:11,027 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:10:11,027 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:10:11,027 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:10:11,028 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:10:11,028 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:10:11,028 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:10:11,028 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:10:11,029 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:10:11,029 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:10:11,029 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:10:11,029 - __main__ - INFO - 구성된 프롬프트 길이: 4973 문자
2025-09-11 12:10:11,029 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:10:11,029 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 4973)
2025-09-11 12:10:11,029 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:10:11,029 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:10:19,467 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:10:19,477 - __main__ - INFO - LLM 응답 길이: 1262 문자
2025-09-11 12:10:19,477 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:10:19,477 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:10:19,478 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:10:19,478 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:10:19,478 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': '을지로입구역 5번출구 하나은행 명동사옥 맞은편', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:10:19,478 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:10:19,478 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:10:19,672 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:10:19,672 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:10:19,672 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:10:20,263 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:10:20,548 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.07초
2025-09-11 12:10:20,607 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:10:20,607 - __main__ - INFO - ============================================================
2025-09-11 12:10:20,607 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:10:20,607 - __main__ - INFO - ============================================================
2025-09-11 12:10:20,607 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:10:20,607 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:10:20,607 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:10:20,607 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:10:20,607 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:10:20,607 - __main__ - INFO - process_message 실행완료: 10.98초
2025-09-11 12:10:20,607 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:28:31,309 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:28:31,309 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:28:31,309 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:28:31,309 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:28:31,309 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:28:31,310 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:28:31,371 - __main__ - INFO - Using device: mps
2025-09-11 12:28:31,371 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-09-11 12:28:31,371 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:28:31,372 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:28:31,372 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:28:31,372 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:28:31,372 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:28:31,372 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:28:31,372 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:28:36,188 - __main__ - INFO - Model loaded on mps
2025-09-11 12:28:36,188 - __main__ - INFO - _initialize_embedding_model 실행완료: 4.82초
2025-09-11 12:28:36,188 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:28:36,658 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:28:36,658 - __main__ - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-11 12:28:36,658 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:28:36,658 - __main__ - INFO - ============================================================
2025-09-11 12:28:36,658 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:28:36,658 - __main__ - INFO - ============================================================
2025-09-11 12:28:36,658 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:28:36,658 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:28:36,658 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:28:36,658 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:28:36,658 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:28:36,730 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:28:36,730 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:28:36,730 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:28:36,733 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:28:36,734 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:28:36,734 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:28:36,735 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:28:36,735 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:28:36,735 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:28:36,743 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:28:36,745 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:28:36,745 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:28:36,745 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:28:36,745 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:28:36,745 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:28:36,746 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:28:36,746 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:28:36,747 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:28:36,747 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:28:36,747 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:28:36,755 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:28:36,755 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:28:36,755 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:28:36,755 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:28:36,756 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:28:36,879 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:28:36,884 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:28:36,885 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:28:36,885 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:28:36,885 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:28:36,885 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:28:36,886 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:28:36,886 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:28:36,886 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:28:36,886 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:28:36,888 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:28:36,888 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:28:36,889 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:28:36,903 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:28:36,903 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:28:36,903 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:28:36,916 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:28:36,916 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:28:37,176 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:28:37,176 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:28:37,176 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:28:37,245 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:28:37,245 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:28:37,245 - __main__ - INFO - ============================================================
2025-09-11 12:28:37,245 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:28:37,245 - __main__ - INFO - ============================================================
2025-09-11 12:28:37,245 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:28:37,245 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:28:37,245 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:28:37,245 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:28:37,246 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:28:37,247 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:28:37,248 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:28:37,249 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:28:37,249 - __main__ - INFO - _load_data 실행완료: 0.59초
2025-09-11 12:28:37,249 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:28:37,249 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:28:37,249 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:28:37,250 - __main__ - INFO - ============================================================
2025-09-11 12:28:37,250 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:28:37,250 - __main__ - INFO - ============================================================
2025-09-11 12:28:37,250 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:28:37,250 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:28:37,250 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:28:37,250 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:28:37,250 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:28:37,250 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:28:37,250 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:28:37,250 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:28:37,250 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:28:37,250 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:28:37,250 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:28:37,250 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:28:37,251 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:28:37,730 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:28:37,730 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:28:37,733 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:28:37,733 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:28:37,733 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '기기값', '을지로입구역', '명동', '아이폰', '구매하', '하나은행']
2025-09-11 12:28:37,733 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:28:38,522 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:28:38,522 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:28:38,523 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:28:38,523 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:28:38,563 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:28:38,563 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:28:38,563 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:28:38,566 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:28:38,567 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:28:38,568 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:28:38,570 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:28:38,572 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:28:38,572 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:28:38,572 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.32초
2025-09-11 12:28:38,572 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:28:38,572 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:28:38,572 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:28:38,682 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:28:38,682 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:28:38,682 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:28:38,682 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:28:38,682 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:28:38,682 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:28:38,682 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:28:38,682 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:28:38,682 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:28:38,683 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:28:38,683 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:28:38,683 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:28:38,683 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 12:28:38,683 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:28:38,683 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 12:28:38,683 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:28:38,683 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:28:47,056 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:28:47,061 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 12:28:47,061 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:28:47,061 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:28:47,061 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:28:47,061 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:28:47,061 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:28:47,061 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:28:47,061 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:28:47,248 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:28:47,248 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:28:47,248 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:28:47,798 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:28:48,087 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.03초
2025-09-11 12:28:48,145 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:28:48,145 - __main__ - INFO - ============================================================
2025-09-11 12:28:48,145 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:28:48,145 - __main__ - INFO - ============================================================
2025-09-11 12:28:48,145 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:28:48,145 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:28:48,145 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:28:48,145 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:28:48,145 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:28:48,145 - __main__ - INFO - process_message 실행완료: 10.90초
2025-09-11 12:28:48,145 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:30:36,141 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:30:36,142 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:30:36,142 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:30:36,142 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:30:36,142 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:30:36,143 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:30:36,163 - __main__ - INFO - Using device: mps
2025-09-11 12:30:36,163 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:30:36,163 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:30:36,163 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:30:36,163 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:30:36,163 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:30:36,163 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:30:36,163 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:30:36,163 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:30:37,106 - __main__ - INFO - Model loaded on mps
2025-09-11 12:30:37,106 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.94초
2025-09-11 12:30:37,106 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:30:37,543 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:30:37,543 - __main__ - INFO - _initialize_kiwi 실행완료: 0.44초
2025-09-11 12:30:37,543 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:30:37,543 - __main__ - INFO - ============================================================
2025-09-11 12:30:37,544 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:30:37,544 - __main__ - INFO - ============================================================
2025-09-11 12:30:37,544 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:30:37,544 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:30:37,544 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:30:37,544 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:30:37,544 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:30:37,613 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:30:37,614 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:30:37,614 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:30:37,618 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:30:37,619 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:30:37,619 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:30:37,620 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:30:37,620 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:30:37,620 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:30:37,623 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:30:37,626 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:30:37,626 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:30:37,627 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:30:37,627 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:30:37,627 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:30:37,627 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:30:37,627 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:30:37,627 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:30:37,627 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:30:37,627 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:30:37,629 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:30:37,629 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:30:37,629 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:30:37,629 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:30:37,630 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:30:37,757 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:30:37,762 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:30:37,762 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:30:37,762 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:30:37,763 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:30:37,763 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:30:37,763 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:30:37,763 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:30:37,763 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:30:37,764 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:30:37,765 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:30:37,766 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:30:37,766 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:30:37,781 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:30:37,781 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:30:37,781 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:30:37,783 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:30:37,783 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:30:37,967 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:30:37,967 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:30:37,967 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:30:38,040 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:30:38,040 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:30:38,040 - __main__ - INFO - ============================================================
2025-09-11 12:30:38,040 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:30:38,040 - __main__ - INFO - ============================================================
2025-09-11 12:30:38,040 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:30:38,040 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:30:38,040 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:30:38,040 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:30:38,040 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:30:38,041 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:30:38,043 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:30:38,044 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:30:38,044 - __main__ - INFO - _load_data 실행완료: 0.50초
2025-09-11 12:30:38,044 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:30:38,044 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:30:38,044 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:30:38,044 - __main__ - INFO - ============================================================
2025-09-11 12:30:38,044 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:30:38,044 - __main__ - INFO - ============================================================
2025-09-11 12:30:38,044 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:30:38,044 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:30:38,044 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:30:38,044 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:30:38,044 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:30:38,044 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:30:38,044 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:30:38,044 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:30:38,044 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:30:38,045 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:30:38,045 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:30:38,045 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:30:38,046 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:30:38,557 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:30:38,558 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:30:38,561 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:30:38,561 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:30:38,561 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['구매하', '하나은행', '기기값', '을지로입구역', '갤럭시', '명동', '아이폰']
2025-09-11 12:30:38,561 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:30:39,336 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:30:39,336 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:30:39,337 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:30:39,337 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:30:39,378 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:30:39,379 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:30:39,379 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:30:39,381 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:30:39,382 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:30:39,383 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:30:39,385 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:30:39,387 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:30:39,388 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:30:39,388 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.34초
2025-09-11 12:30:39,388 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:30:39,388 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:30:39,388 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:30:39,485 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:30:39,485 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:30:39,485 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:30:39,485 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:30:39,485 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:30:39,485 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:30:39,485 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:30:39,485 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:30:39,485 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:30:39,486 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:30:39,486 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:30:39,486 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:30:39,486 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 12:30:39,486 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:30:39,486 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 12:30:39,486 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:30:39,486 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:30:47,836 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:30:47,845 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 12:30:47,846 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:30:47,846 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:30:47,846 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:30:47,846 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:30:47,846 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:30:47,846 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:30:47,847 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:30:48,051 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:30:48,051 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:30:48,051 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:30:48,716 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:30:48,998 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.15초
2025-09-11 12:30:49,069 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:30:49,069 - __main__ - INFO - ============================================================
2025-09-11 12:30:49,069 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:30:49,069 - __main__ - INFO - ============================================================
2025-09-11 12:30:49,069 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:30:49,069 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:30:49,069 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:30:49,069 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:30:49,069 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:30:49,069 - __main__ - INFO - process_message 실행완료: 11.03초
2025-09-11 12:30:49,070 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:31:35,362 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:31:35,362 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:31:35,362 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:31:35,363 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:31:35,363 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:31:35,364 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:31:35,383 - __main__ - INFO - Using device: mps
2025-09-11 12:31:35,383 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:31:35,383 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:31:35,383 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:31:35,383 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:31:35,383 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:31:35,383 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:31:35,383 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:31:35,383 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:31:36,240 - __main__ - INFO - Model loaded on mps
2025-09-11 12:31:36,240 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-09-11 12:31:36,240 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:31:36,668 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:31:36,668 - __main__ - INFO - _initialize_kiwi 실행완료: 0.43초
2025-09-11 12:31:36,668 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:31:36,669 - __main__ - INFO - ============================================================
2025-09-11 12:31:36,669 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:31:36,669 - __main__ - INFO - ============================================================
2025-09-11 12:31:36,669 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:31:36,669 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:31:36,669 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:31:36,669 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:31:36,669 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:31:36,734 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:31:36,734 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:31:36,734 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:31:36,738 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:31:36,739 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:31:36,739 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:31:36,740 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:31:36,740 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:31:36,740 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:31:36,741 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:31:36,743 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:31:36,744 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:31:36,744 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:31:36,744 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:31:36,744 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:31:36,744 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:31:36,744 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:31:36,744 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:31:36,744 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:31:36,744 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:31:36,745 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:31:36,745 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:31:36,745 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:31:36,746 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:31:36,746 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:31:36,871 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:31:36,875 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:31:36,876 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 12:31:36,876 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:31:36,876 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:31:36,876 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:31:36,877 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:31:36,877 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:31:36,877 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:31:36,877 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:31:36,879 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:31:36,880 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:31:36,880 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 12:31:36,893 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:31:36,894 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:31:36,894 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:31:36,895 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:31:36,895 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:31:37,067 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:31:37,067 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:31:37,067 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:31:37,138 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:31:37,138 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:31:37,138 - __main__ - INFO - ============================================================
2025-09-11 12:31:37,138 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:31:37,138 - __main__ - INFO - ============================================================
2025-09-11 12:31:37,138 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:31:37,138 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:31:37,138 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:31:37,138 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:31:37,138 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:31:37,139 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:31:37,141 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:31:37,142 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:31:37,142 - __main__ - INFO - _load_data 실행완료: 0.47초
2025-09-11 12:31:37,142 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:31:37,142 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:31:37,142 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:31:37,142 - __main__ - INFO - ============================================================
2025-09-11 12:31:37,142 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:31:37,142 - __main__ - INFO - ============================================================
2025-09-11 12:31:37,142 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:31:37,142 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:31:37,142 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:31:37,142 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:31:37,142 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:31:37,142 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:31:37,142 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:31:37,142 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:31:37,142 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:31:37,142 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:31:37,142 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:31:37,142 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:31:37,144 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:31:37,605 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:31:37,606 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:31:37,609 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:31:37,609 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:31:37,609 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['하나은행', '갤럭시', '명동', '을지로입구역', '아이폰', '기기값', '구매하']
2025-09-11 12:31:37,609 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:31:38,382 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:31:38,383 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:31:38,383 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:31:38,383 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:31:38,423 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:31:38,424 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:31:38,424 - __main__ - INFO - 사용할 유사도 임계값: 0.6
2025-09-11 12:31:38,426 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 9개
2025-09-11 12:31:38,428 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:31:38,428 - __main__ - INFO - 통합된 후보 아이템 수: 10개
2025-09-11 12:31:38,431 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:31:38,433 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (9, 2)
2025-09-11 12:31:38,433 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:31:38,434 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.29초
2025-09-11 12:31:38,434 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:31:38,434 - __main__ - INFO - 매칭된 상품 정보: (9, 2)
2025-09-11 12:31:38,434 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:31:38,523 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:31:38,523 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:31:38,523 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:31:38,523 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:31:38,523 - __main__ - INFO - 후보 아이템 리스트 크기: 9개
2025-09-11 12:31:38,523 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:31:38,524 - __main__ - INFO - extra_item_pdf 크기: (9, 2)
2025-09-11 12:31:38,524 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:31:38,524 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}]
2025-09-11 12:31:38,525 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 9개
2025-09-11 12:31:38,525 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': '6210', 'action': '기타'}, {'name': 'B tv 혜택', 'action': '기타'}]
2025-09-11 12:31:38,525 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:31:38,525 - __main__ - INFO - 구성된 프롬프트 길이: 5618 문자
2025-09-11 12:31:38,525 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:31:38,525 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5618)
2025-09-11 12:31:38,525 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:31:38,525 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:31:47,360 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:31:47,369 - __main__ - INFO - LLM 응답 길이: 1319 문자
2025-09-11 12:31:47,369 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "A36",
            "action": "구매"
        },
        {
            "name": "S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name": "SK로 통...
2025-09-11 12:31:47,369 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:31:47,370 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:31:47,370 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:31:47,370 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': 'A36', 'action': '구매'}, {'name': 'S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': 'SK로 통신사 이동', 'action': '이동'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:31:47,370 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:31:47,370 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', 'A36', 'S24 FE', '아이폰17', 'SK로 통신사 이동', '인터넷+TV']
2025-09-11 12:31:47,569 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:31:47,569 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:31:47,569 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:31:48,261 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:31:48,554 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.18초
2025-09-11 12:31:48,613 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:31:48,613 - __main__ - INFO - ============================================================
2025-09-11 12:31:48,613 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:31:48,614 - __main__ - INFO - ============================================================
2025-09-11 12:31:48,614 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:31:48,614 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:31:48,614 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:31:48,614 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:31:48,614 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:31:48,614 - __main__ - INFO - process_message 실행완료: 11.47초
2025-09-11 12:31:48,614 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:32:45,670 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:32:45,670 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:32:45,670 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:32:45,670 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:32:45,670 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:32:45,671 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:32:46,157 - __main__ - INFO - Using device: mps
2025-09-11 12:32:46,158 - __main__ - INFO - _initialize_device 실행완료: 0.49초
2025-09-11 12:32:46,158 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:32:46,158 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:32:46,158 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:32:46,158 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:32:46,158 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:32:46,159 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:32:46,159 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:32:49,695 - __main__ - INFO - Model loaded on mps
2025-09-11 12:32:49,695 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.54초
2025-09-11 12:32:49,695 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:32:50,116 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:32:50,116 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-09-11 12:32:50,116 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:32:50,116 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,116 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:32:50,116 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,116 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:32:50,116 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:32:50,116 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:32:50,116 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:32:50,116 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:32:50,181 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:32:50,181 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:32:50,181 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:32:50,185 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:32:50,185 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:32:50,186 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:32:50,186 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:32:50,187 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:32:50,187 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:32:50,188 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:32:50,190 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:32:50,190 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:32:50,190 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:32:50,190 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:32:50,190 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:32:50,191 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:32:50,191 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:32:50,191 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:32:50,191 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:32:50,191 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:32:50,193 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:32:50,193 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:32:50,193 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:32:50,193 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:32:50,194 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:32:50,317 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:32:50,322 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:32:50,322 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:32:50,322 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:32:50,323 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:32:50,323 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:32:50,324 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:32:50,324 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:32:50,324 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:32:50,324 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:32:50,326 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:32:50,326 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:32:50,326 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-11 12:32:50,340 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:32:50,340 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:32:50,340 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:32:50,341 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:32:50,341 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:32:50,511 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:32:50,512 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:32:50,512 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:32:50,584 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:32:50,584 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:32:50,584 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,584 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:32:50,584 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,584 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:32:50,584 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:32:50,584 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:32:50,584 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:32:50,584 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:32:50,585 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:32:50,587 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:32:50,588 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:32:50,588 - __main__ - INFO - _load_data 실행완료: 0.47초
2025-09-11 12:32:50,588 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:32:50,588 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:32:50,588 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:32:50,588 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,588 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:32:50,588 - __main__ - INFO - ============================================================
2025-09-11 12:32:50,588 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:32:50,589 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:32:50,589 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:32:50,589 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:32:50,589 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:32:50,589 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:32:50,589 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:32:50,589 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:32:50,589 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:32:50,589 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:32:50,589 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:32:50,589 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:32:50,590 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:32:51,080 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:32:51,081 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:32:51,086 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:32:51,086 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:32:51,086 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['을지로입구역', '기기값', '구매하', '아이폰', '갤럭시', '명동', '하나은행']
2025-09-11 12:32:51,086 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:32:51,870 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:32:51,871 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:32:51,871 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:32:51,871 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:32:51,912 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:32:51,913 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:32:51,913 - __main__ - INFO - 사용할 유사도 임계값: 0.6
2025-09-11 12:32:51,915 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 9개
2025-09-11 12:32:51,916 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:32:51,917 - __main__ - INFO - 통합된 후보 아이템 수: 10개
2025-09-11 12:32:51,919 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:32:51,921 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (9, 2)
2025-09-11 12:32:51,921 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:32:51,922 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.33초
2025-09-11 12:32:51,922 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:32:51,922 - __main__ - INFO - 매칭된 상품 정보: (9, 2)
2025-09-11 12:32:51,922 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:32:52,017 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:32:52,017 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:32:52,017 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:32:52,017 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:32:52,017 - __main__ - INFO - 후보 아이템 리스트 크기: 9개
2025-09-11 12:32:52,017 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:32:52,017 - __main__ - INFO - extra_item_pdf 크기: (9, 2)
2025-09-11 12:32:52,017 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:32:52,018 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}]
2025-09-11 12:32:52,019 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 9개
2025-09-11 12:32:52,019 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': '6210', 'action': '기타'}, {'name': 'B tv 혜택', 'action': '기타'}]
2025-09-11 12:32:52,019 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:32:52,019 - __main__ - INFO - 구성된 프롬프트 길이: 5618 문자
2025-09-11 12:32:52,019 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:32:52,019 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5618)
2025-09-11 12:32:52,019 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:32:52,019 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:33:00,395 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:33:00,405 - __main__ - INFO - LLM 응답 길이: 1237 문자
2025-09-11 12:33:00,405 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "대리점/매장 방문 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "A36",
            "action": "구매"
        },
        {
            "name": "S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name": "인터넷+T...
2025-09-11 12:33:00,405 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:33:00,406 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:33:00,406 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:33:00,406 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': 'A36', 'action': '구매'}, {'name': 'S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:33:00,406 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:33:00,406 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', 'A36', 'S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:33:00,597 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:33:00,597 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:33:00,597 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:33:01,214 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:33:01,498 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.09초
2025-09-11 12:33:01,559 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:33:01,559 - __main__ - INFO - ============================================================
2025-09-11 12:33:01,559 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:33:01,559 - __main__ - INFO - ============================================================
2025-09-11 12:33:01,559 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:33:01,559 - __main__ - INFO - 목적: ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내']
2025-09-11 12:33:01,559 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:33:01,559 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:33:01,559 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:33:01,559 - __main__ - INFO - process_message 실행완료: 10.97초
2025-09-11 12:33:01,559 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:33:30,197 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:33:30,197 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:33:30,197 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:33:30,197 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:33:30,197 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:33:30,198 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:33:30,217 - __main__ - INFO - Using device: mps
2025-09-11 12:33:30,217 - __main__ - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 12:33:30,217 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:33:30,217 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:33:30,218 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:33:30,218 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:33:30,218 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:33:30,218 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:33:30,218 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:33:31,039 - __main__ - INFO - Model loaded on mps
2025-09-11 12:33:31,039 - __main__ - INFO - _initialize_embedding_model 실행완료: 0.82초
2025-09-11 12:33:31,040 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:33:31,449 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:33:31,449 - __main__ - INFO - _initialize_kiwi 실행완료: 0.41초
2025-09-11 12:33:31,450 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:33:31,450 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,450 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:33:31,450 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,450 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:33:31,450 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:33:31,450 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:33:31,450 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:33:31,450 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:33:31,514 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:33:31,515 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:33:31,515 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:33:31,518 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:33:31,519 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:33:31,519 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:33:31,520 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:33:31,520 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:33:31,520 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:33:31,521 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:33:31,523 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:33:31,524 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:33:31,524 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:33:31,524 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:33:31,524 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:33:31,524 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:33:31,524 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:33:31,524 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:33:31,524 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:33:31,524 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:33:31,525 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:33:31,525 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:33:31,525 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:33:31,526 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:33:31,526 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:33:31,652 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:33:31,657 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:33:31,657 - __main__ - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 12:33:31,657 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:33:31,657 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:33:31,657 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:33:31,658 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:33:31,659 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:33:31,659 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:33:31,659 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:33:31,660 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:33:31,661 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:33:31,661 - __main__ - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-11 12:33:31,674 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:33:31,674 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:33:31,675 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:33:31,676 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:33:31,676 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:33:31,829 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:33:31,830 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:33:31,830 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:33:31,899 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:33:31,899 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:33:31,899 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,899 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:33:31,899 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,899 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:33:31,899 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:33:31,899 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:33:31,900 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:33:31,900 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:33:31,901 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:33:31,903 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:33:31,904 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:33:31,904 - __main__ - INFO - _load_data 실행완료: 0.45초
2025-09-11 12:33:31,904 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:33:31,904 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:33:31,904 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:33:31,904 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,904 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:33:31,904 - __main__ - INFO - ============================================================
2025-09-11 12:33:31,904 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:33:31,904 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:33:31,904 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:33:31,904 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:33:31,904 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:33:31,904 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:33:31,904 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:33:31,904 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:33:31,904 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:33:31,904 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:33:31,904 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:33:31,904 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:33:31,905 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:33:32,366 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:33:32,366 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:33:32,369 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:33:32,369 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:33:32,369 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['명동', '기기값', '을지로입구역', '구매하', '갤럭시', '하나은행', '아이폰']
2025-09-11 12:33:32,369 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:33:33,133 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:33:33,133 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:33:33,134 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:33:33,134 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:33:33,172 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:33:33,173 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:33:33,173 - __main__ - INFO - 사용할 유사도 임계값: 0.6
2025-09-11 12:33:33,175 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 9개
2025-09-11 12:33:33,177 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:33:33,177 - __main__ - INFO - 통합된 후보 아이템 수: 10개
2025-09-11 12:33:33,180 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:33:33,182 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (9, 2)
2025-09-11 12:33:33,182 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:33:33,183 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.28초
2025-09-11 12:33:33,183 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:33:33,183 - __main__ - INFO - 매칭된 상품 정보: (9, 2)
2025-09-11 12:33:33,183 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:33:33,272 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:33:33,272 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:33:33,272 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:33:33,273 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:33:33,273 - __main__ - INFO - 후보 아이템 리스트 크기: 9개
2025-09-11 12:33:33,273 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시', 'B tv 혜택', 'T 탭 9', '6210', 'SP24', '무선해지', '발신금지', '이마트24 할인', '특가기변']
2025-09-11 12:33:33,273 - __main__ - INFO - extra_item_pdf 크기: (9, 2)
2025-09-11 12:33:33,273 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:33:33,273 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': '6210', 'item_id': ['NKW2']}, {'item_nm': 'B tv 혜택', 'item_id': ['PR00000374']}]
2025-09-11 12:33:33,274 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 9개
2025-09-11 12:33:33,274 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': '6210', 'action': '기타'}, {'name': 'B tv 혜택', 'action': '기타'}]
2025-09-11 12:33:33,274 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:33:33,274 - __main__ - INFO - 구성된 프롬프트 길이: 5618 문자
2025-09-11 12:33:33,274 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:33:33,274 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5618)
2025-09-11 12:33:33,274 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:33:33,274 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:33:41,475 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:33:41,486 - __main__ - INFO - LLM 응답 길이: 1237 문자
2025-09-11 12:33:41,486 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "대리점/매장 방문 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "A36",
            "action": "구매"
        },
        {
            "name": "S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name": "인터넷+T...
2025-09-11 12:33:41,486 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:33:41,487 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:33:41,487 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:33:41,487 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': 'A36', 'action': '구매'}, {'name': 'S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:33:41,487 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:33:41,487 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', 'A36', 'S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:33:41,688 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:33:41,688 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:33:41,688 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:33:42,291 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:33:42,585 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.10초
2025-09-11 12:33:42,643 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:33:42,643 - __main__ - INFO - ============================================================
2025-09-11 12:33:42,643 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:33:42,643 - __main__ - INFO - ============================================================
2025-09-11 12:33:42,643 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:33:42,643 - __main__ - INFO - 목적: ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내']
2025-09-11 12:33:42,643 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:33:42,643 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:33:42,643 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:33:42,643 - __main__ - INFO - process_message 실행완료: 10.74초
2025-09-11 12:33:42,643 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:36:44,722 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:36:44,723 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:36:44,723 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:36:44,723 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:36:44,723 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:36:44,724 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:36:44,772 - __main__ - INFO - Using device: mps
2025-09-11 12:36:44,772 - __main__ - INFO - _initialize_device 실행완료: 0.05초
2025-09-11 12:36:44,772 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:36:44,773 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:36:44,773 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:36:44,773 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:36:44,773 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:36:44,773 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:36:44,773 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:36:48,441 - __main__ - INFO - Model loaded on mps
2025-09-11 12:36:48,441 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.67초
2025-09-11 12:36:48,441 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:36:48,902 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:36:48,902 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-11 12:36:48,902 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:36:48,902 - __main__ - INFO - ============================================================
2025-09-11 12:36:48,902 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:36:48,902 - __main__ - INFO - ============================================================
2025-09-11 12:36:48,902 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:36:48,902 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:36:48,902 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:36:48,902 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:36:48,902 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:36:48,972 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:36:48,972 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:36:48,972 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:36:48,976 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:36:48,976 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:36:48,977 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:36:48,977 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:36:48,978 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:36:48,978 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:36:48,984 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:36:48,986 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:36:48,986 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:36:48,986 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:36:48,987 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:36:48,987 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:36:48,987 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:36:48,987 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:36:48,987 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:36:48,987 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:36:48,987 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:36:48,994 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:36:48,994 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:36:48,994 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:36:48,994 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:36:48,995 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:36:49,117 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:36:49,122 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:36:49,122 - __main__ - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:36:49,122 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:36:49,123 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:36:49,123 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:36:49,124 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:36:49,124 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:36:49,124 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:36:49,124 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:36:49,125 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:36:49,126 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:36:49,126 - __main__ - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-09-11 12:36:49,142 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:36:49,142 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:36:49,142 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:36:49,154 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:36:49,154 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:36:49,347 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:36:49,348 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:36:49,348 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:36:49,415 - __main__ - INFO - 조직 정보 로드 완료: 5765개 조직
2025-09-11 12:36:49,415 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:36:49,415 - __main__ - INFO - ============================================================
2025-09-11 12:36:49,415 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:36:49,415 - __main__ - INFO - ============================================================
2025-09-11 12:36:49,415 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:36:49,415 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:36:49,415 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:36:49,415 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:36:49,415 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:36:49,416 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:36:49,418 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:36:49,419 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:36:49,419 - __main__ - INFO - _load_data 실행완료: 0.52초
2025-09-11 12:36:49,419 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:36:49,419 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:36:49,419 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:36:49,419 - __main__ - INFO - ============================================================
2025-09-11 12:36:49,419 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:36:49,419 - __main__ - INFO - ============================================================
2025-09-11 12:36:49,419 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:36:49,419 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:36:49,419 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:36:49,419 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:36:49,419 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:36:49,419 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:36:49,419 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:36:49,419 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:36:49,419 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:36:49,419 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:36:49,419 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:36:49,419 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:36:49,420 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:36:49,899 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:36:49,899 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:36:49,904 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:36:49,904 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:36:49,904 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '을지로입구역', '기기값', '명동', '구매하', '아이폰', '하나은행']
2025-09-11 12:36:49,904 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:36:52,006 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:36:52,006 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:36:52,007 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:36:52,007 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:36:52,046 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:36:52,047 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:36:52,047 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:36:52,049 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:36:52,051 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:36:52,051 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:36:52,054 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:36:52,056 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:36:52,056 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:36:52,056 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 2.64초
2025-09-11 12:36:52,056 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:36:52,057 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:36:52,057 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:36:52,159 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:36:52,159 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:36:52,159 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:36:52,159 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:36:52,159 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:36:52,159 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:36:52,159 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:36:52,159 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:36:52,159 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:36:52,160 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:36:52,160 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:36:52,160 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:36:52,160 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 12:36:52,160 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:36:52,160 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 12:36:52,160 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:36:52,160 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:37:00,535 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:37:00,545 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 12:37:00,545 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:37:00,545 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:37:00,545 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:37:00,545 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:37:00,546 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:37:00,546 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:37:00,546 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:37:00,742 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:37:00,743 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:37:00,743 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:37:01,432 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:37:01,723 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.18초
2025-09-11 12:37:01,795 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:37:01,795 - __main__ - INFO - ============================================================
2025-09-11 12:37:01,795 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:37:01,795 - __main__ - INFO - ============================================================
2025-09-11 12:37:01,795 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:37:01,795 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:37:01,795 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:37:01,795 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:37:01,795 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:37:01,795 - __main__ - INFO - process_message 실행완료: 12.38초
2025-09-11 12:37:01,795 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 12:52:29,784 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 12:52:29,785 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 12:52:29,785 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 12:52:29,785 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 12:52:29,785 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 12:52:29,793 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 12:52:30,203 - __main__ - INFO - Using device: mps
2025-09-11 12:52:30,203 - __main__ - INFO - _initialize_device 실행완료: 0.41초
2025-09-11 12:52:30,203 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 12:52:30,204 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 12:52:30,204 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 12:52:30,204 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 12:52:30,204 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 12:52:30,204 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 12:52:30,205 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 12:52:33,990 - __main__ - INFO - Model loaded on mps
2025-09-11 12:52:33,991 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.79초
2025-09-11 12:52:33,991 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 12:52:34,409 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 12:52:34,409 - __main__ - INFO - _initialize_kiwi 실행완료: 0.42초
2025-09-11 12:52:34,409 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 12:52:34,409 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,409 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 12:52:34,409 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,409 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 12:52:34,409 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 12:52:34,409 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 12:52:34,409 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 12:52:34,409 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:52:34,482 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 12:52:34,483 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:52:34,483 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 12:52:34,486 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 12:52:34,486 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 12:52:34,487 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:52:34,488 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:52:34,488 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 12:52:34,488 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 12:52:34,490 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 12:52:34,492 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 12:52:34,492 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 12:52:34,492 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:52:34,492 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 12:52:34,492 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 12:52:34,493 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 12:52:34,493 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:52:34,493 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 12:52:34,493 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 12:52:34,493 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 12:52:34,501 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 12:52:34,501 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 12:52:34,501 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:52:34,502 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 12:52:34,502 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 12:52:34,629 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 12:52:34,634 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 12:52:34,635 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-09-11 12:52:34,635 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 12:52:34,635 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 12:52:34,635 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 12:52:34,636 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 12:52:34,636 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 12:52:34,636 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 12:52:34,636 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 12:52:34,638 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 12:52:34,639 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 12:52:34,639 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-09-11 12:52:34,652 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 12:52:34,653 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 12:52:34,653 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 12:52:34,657 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 12:52:34,657 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 12:52:34,819 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 12:52:34,820 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 12:52:34,820 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 12:52:34,820 - __main__ - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-11 12:52:34,820 - __main__ - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-11 12:52:34,820 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 12:52:34,885 - __main__ - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-11 12:52:34,886 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 12:52:34,888 - __main__ - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-11 12:52:34,888 - __main__ - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-11 12:52:34,888 - __main__ - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-11 12:52:34,888 - __main__ - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 12:52:34,888 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 12:52:34,888 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,888 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 12:52:34,888 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,888 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 12:52:34,889 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 12:52:34,889 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 12:52:34,889 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 12:52:34,889 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 12:52:34,890 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 12:52:34,892 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 12:52:34,893 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 12:52:34,893 - __main__ - INFO - _load_data 실행완료: 0.48초
2025-09-11 12:52:34,893 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 12:52:34,893 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 12:52:34,893 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 12:52:34,893 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,893 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 12:52:34,893 - __main__ - INFO - ============================================================
2025-09-11 12:52:34,893 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 12:52:34,893 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 12:52:34,893 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 12:52:34,893 - __main__ - INFO - 데이터 소스: local
2025-09-11 12:52:34,893 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 12:52:34,893 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 12:52:34,893 - __main__ - INFO - LLM 모델: ax
2025-09-11 12:52:34,893 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 12:52:34,893 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 12:52:34,893 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 12:52:34,893 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 12:52:34,893 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 12:52:34,895 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 12:52:35,363 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 12:52:35,363 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 12:52:35,367 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 12:52:35,367 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 12:52:35,367 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '기기값', '아이폰', '구매하', '을지로입구역', '하나은행', '명동']
2025-09-11 12:52:35,367 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 12:52:36,169 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 12:52:36,169 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 12:52:36,170 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 12:52:36,170 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 12:52:36,211 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 12:52:36,211 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 12:52:36,211 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 12:52:36,214 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 12:52:36,215 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 12:52:36,216 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 12:52:36,218 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:52:36,220 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 12:52:36,220 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:52:36,220 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.33초
2025-09-11 12:52:36,220 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 12:52:36,220 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 12:52:36,220 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 12:52:36,323 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 12:52:36,323 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 12:52:36,323 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 12:52:36,323 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 12:52:36,323 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 12:52:36,323 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 12:52:36,323 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 12:52:36,323 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 12:52:36,323 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 12:52:36,324 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 12:52:36,324 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 12:52:36,324 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 12:52:36,324 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 12:52:36,324 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 12:52:36,325 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 12:52:36,325 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 12:52:36,325 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 12:52:44,535 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:52:44,545 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 12:52:44,545 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 12:52:44,545 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 12:52:44,545 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 12:52:44,546 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 12:52:44,546 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 12:52:44,546 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 12:52:44,546 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 12:52:44,747 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 12:52:44,747 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 12:52:44,747 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 12:52:45,361 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 12:52:45,692 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.15초
2025-09-11 12:52:45,766 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 12:52:45,766 - __main__ - INFO - ============================================================
2025-09-11 12:52:45,766 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 12:52:45,766 - __main__ - INFO - ============================================================
2025-09-11 12:52:45,766 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 12:52:45,766 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 12:52:45,766 - __main__ - INFO - 상품 수: 2개
2025-09-11 12:52:45,766 - __main__ - INFO - 채널 수: 5개
2025-09-11 12:52:45,766 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 12:52:45,766 - __main__ - INFO - process_message 실행완료: 10.87초
2025-09-11 12:52:45,766 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 13:08:42,520 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 13:08:42,520 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 13:08:42,520 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 13:08:42,520 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 13:08:42,520 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 13:08:42,521 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 13:08:42,583 - __main__ - INFO - Using device: mps
2025-09-11 13:08:42,583 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-09-11 13:08:42,583 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 13:08:42,584 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 13:08:42,584 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 13:08:42,584 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 13:08:42,584 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 13:08:42,584 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 13:08:42,584 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 13:08:46,139 - __main__ - INFO - Model loaded on mps
2025-09-11 13:08:46,139 - __main__ - INFO - _initialize_embedding_model 실행완료: 3.56초
2025-09-11 13:08:46,139 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 13:08:46,632 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 13:08:46,632 - __main__ - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-11 13:08:46,632 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 13:08:46,632 - __main__ - INFO - ============================================================
2025-09-11 13:08:46,632 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 13:08:46,632 - __main__ - INFO - ============================================================
2025-09-11 13:08:46,632 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 13:08:46,632 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 13:08:46,632 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 13:08:46,632 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 13:08:46,632 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 13:08:46,704 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 13:08:46,704 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 13:08:46,704 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 13:08:46,708 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 13:08:46,708 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 13:08:46,709 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:08:46,710 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:08:46,710 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 13:08:46,710 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 13:08:46,717 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 13:08:46,720 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 13:08:46,720 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 13:08:46,720 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:08:46,720 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 13:08:46,720 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 13:08:46,720 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 13:08:46,720 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:08:46,720 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 13:08:46,720 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 13:08:46,720 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 13:08:46,726 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 13:08:46,727 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 13:08:46,727 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:08:46,727 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 13:08:46,727 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:08:46,854 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 13:08:46,859 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 13:08:46,860 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 13:08:46,860 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 13:08:46,860 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 13:08:46,860 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 13:08:46,861 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 13:08:46,861 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 13:08:46,861 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 13:08:46,861 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 13:08:46,863 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 13:08:46,863 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 13:08:46,864 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-11 13:08:46,878 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 13:08:46,878 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 13:08:46,878 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 13:08:46,887 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 13:08:46,887 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 13:08:47,128 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 13:08:47,128 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 13:08:47,128 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 13:08:47,128 - __main__ - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-11 13:08:47,128 - __main__ - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-11 13:08:47,128 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 13:08:47,194 - __main__ - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-11 13:08:47,194 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 13:08:47,197 - __main__ - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-11 13:08:47,197 - __main__ - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-11 13:08:47,197 - __main__ - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-11 13:08:47,197 - __main__ - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:08:47,197 - __main__ - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-11 13:08:47,198 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 13:08:47,198 - __main__ - INFO - ============================================================
2025-09-11 13:08:47,198 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 13:08:47,198 - __main__ - INFO - ============================================================
2025-09-11 13:08:47,198 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 13:08:47,198 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 13:08:47,198 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 13:08:47,198 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 13:08:47,198 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 13:08:47,199 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 13:08:47,201 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 13:08:47,202 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 13:08:47,202 - __main__ - INFO - _load_data 실행완료: 0.57초
2025-09-11 13:08:47,202 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 13:08:47,202 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 13:08:47,202 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 13:08:47,202 - __main__ - INFO - ============================================================
2025-09-11 13:08:47,202 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 13:08:47,202 - __main__ - INFO - ============================================================
2025-09-11 13:08:47,202 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 13:08:47,202 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 13:08:47,202 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 13:08:47,202 - __main__ - INFO - 데이터 소스: local
2025-09-11 13:08:47,202 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 13:08:47,202 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 13:08:47,202 - __main__ - INFO - LLM 모델: ax
2025-09-11 13:08:47,202 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 13:08:47,202 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 13:08:47,202 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 13:08:47,202 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 13:08:47,202 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 13:08:47,204 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 13:08:47,686 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 13:08:47,687 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 13:08:47,690 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 13:08:47,690 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 13:08:47,690 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['명동', '아이폰', '하나은행', '기기값', '을지로입구역', '갤럭시', '구매하']
2025-09-11 13:08:47,690 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 13:08:48,502 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 13:08:48,502 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 13:08:48,503 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 13:08:48,503 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 13:08:48,541 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 13:08:48,542 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 13:08:48,542 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 13:08:48,544 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 13:08:48,546 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 13:08:48,546 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 13:08:48,549 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 13:08:48,551 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 13:08:48,551 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 13:08:48,551 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.35초
2025-09-11 13:08:48,551 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 13:08:48,551 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 13:08:48,551 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 13:08:48,645 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 13:08:48,645 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 13:08:48,645 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 13:08:48,645 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 13:08:48,645 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 13:08:48,645 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 13:08:48,645 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 13:08:48,645 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 13:08:48,645 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 13:08:48,646 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 13:08:48,646 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 13:08:48,646 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 13:08:48,646 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 13:08:48,646 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 13:08:48,646 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 13:08:48,646 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 13:08:48,647 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 13:08:57,008 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 13:08:57,020 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 13:08:57,020 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 13:08:57,020 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 13:08:57,020 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 13:08:57,021 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 13:08:57,021 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 13:08:57,021 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 13:08:57,021 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 13:08:57,224 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3050)
2025-09-11 13:08:57,224 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 13:08:57,224 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 13:08:57,916 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 13:08:58,195 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.17초
2025-09-11 13:08:58,255 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 13:08:58,255 - __main__ - INFO - ============================================================
2025-09-11 13:08:58,255 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 13:08:58,255 - __main__ - INFO - ============================================================
2025-09-11 13:08:58,255 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 13:08:58,255 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 13:08:58,256 - __main__ - INFO - 상품 수: 2개
2025-09-11 13:08:58,256 - __main__ - INFO - 채널 수: 5개
2025-09-11 13:08:58,256 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 13:08:58,256 - __main__ - INFO - process_message 실행완료: 11.05초
2025-09-11 13:08:58,256 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 13:35:30,800 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 13:35:30,801 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 13:35:30,801 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 13:35:30,801 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 13:35:30,801 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 13:35:30,803 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 13:35:30,863 - __main__ - INFO - Using device: mps
2025-09-11 13:35:30,863 - __main__ - INFO - _initialize_device 실행완료: 0.06초
2025-09-11 13:35:30,863 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 13:35:30,863 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 13:35:30,863 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 13:35:30,863 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 13:35:30,864 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 13:35:30,864 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 13:35:30,864 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 13:35:38,838 - __main__ - INFO - Model loaded on mps
2025-09-11 13:35:38,838 - __main__ - INFO - _initialize_embedding_model 실행완료: 7.97초
2025-09-11 13:35:38,838 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 13:35:39,301 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 13:35:39,301 - __main__ - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-11 13:35:39,301 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 13:35:39,301 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,301 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 13:35:39,301 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,301 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 13:35:39,301 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 13:35:39,301 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 13:35:39,301 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 13:35:39,301 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 13:35:39,374 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 13:35:39,374 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 13:35:39,374 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 13:35:39,378 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 13:35:39,378 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 13:35:39,379 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:35:39,379 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:35:39,380 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 13:35:39,380 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 13:35:39,386 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 13:35:39,388 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 13:35:39,388 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 13:35:39,388 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:35:39,388 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 13:35:39,388 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 13:35:39,389 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 13:35:39,389 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:35:39,389 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 13:35:39,389 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 13:35:39,389 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 13:35:39,395 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 13:35:39,395 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 13:35:39,396 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:35:39,396 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 13:35:39,396 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 13:35:39,520 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 13:35:39,525 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 13:35:39,526 - __main__ - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 13:35:39,526 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 13:35:39,526 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 13:35:39,526 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 13:35:39,527 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 13:35:39,527 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 13:35:39,527 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 13:35:39,527 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 13:35:39,529 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 13:35:39,530 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 13:35:39,530 - __main__ - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 13:35:39,543 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 13:35:39,544 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 13:35:39,544 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 13:35:39,556 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 13:35:39,556 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 13:35:39,789 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 13:35:39,789 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 13:35:39,789 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 13:35:39,789 - __main__ - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-11 13:35:39,789 - __main__ - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-11 13:35:39,789 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 13:35:39,857 - __main__ - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-11 13:35:39,857 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 13:35:39,859 - __main__ - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-11 13:35:39,859 - __main__ - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-11 13:35:39,859 - __main__ - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-11 13:35:39,859 - __main__ - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 13:35:39,859 - __main__ - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-11 13:35:39,860 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 13:35:39,860 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,860 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 13:35:39,860 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,860 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 13:35:39,860 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 13:35:39,860 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 13:35:39,860 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 13:35:39,860 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 13:35:39,861 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 13:35:39,863 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 13:35:39,864 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 13:35:39,864 - __main__ - INFO - _load_data 실행완료: 0.56초
2025-09-11 13:35:39,864 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 13:35:39,864 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 13:35:39,864 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 13:35:39,864 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,864 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 13:35:39,864 - __main__ - INFO - ============================================================
2025-09-11 13:35:39,864 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 13:35:39,864 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 13:35:39,864 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 13:35:39,864 - __main__ - INFO - 데이터 소스: local
2025-09-11 13:35:39,864 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 13:35:39,864 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 13:35:39,864 - __main__ - INFO - LLM 모델: ax
2025-09-11 13:35:39,864 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 13:35:39,864 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 13:35:39,864 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 13:35:39,864 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 13:35:39,864 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 13:35:39,866 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 13:35:40,331 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 13:35:40,331 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 13:35:40,335 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 13:35:40,335 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 13:35:40,335 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['아이폰', '갤럭시', '기기값', '구매하', '하나은행', '명동', '을지로입구역']
2025-09-11 13:35:40,335 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 13:35:41,134 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 13:35:41,134 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 13:35:41,135 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 13:35:41,135 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 13:35:41,175 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 13:35:41,176 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 13:35:41,176 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 13:35:41,178 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 13:35:41,180 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 13:35:41,181 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 13:35:41,183 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 13:35:41,185 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 13:35:41,185 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 13:35:41,185 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.32초
2025-09-11 13:35:41,185 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 13:35:41,185 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 13:35:41,185 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 13:35:41,277 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 13:35:41,277 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 13:35:41,277 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 13:35:41,277 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 13:35:41,277 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 13:35:41,277 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 13:35:41,277 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 13:35:41,278 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 13:35:41,278 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 13:35:41,279 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 13:35:41,279 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 13:35:41,279 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 13:35:41,279 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 13:35:41,279 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 13:35:41,279 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 13:35:41,279 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 13:35:41,279 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 13:35:49,867 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 13:35:49,871 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 13:35:49,871 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 13:35:49,871 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 13:35:49,872 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 13:35:49,872 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 13:35:49,872 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 13:35:49,872 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 13:35:49,872 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 13:35:50,380 - __main__ - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-11 13:35:50,380 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 17480)
2025-09-11 13:35:50,380 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 13:35:50,380 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 13:35:51,987 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 13:35:52,246 - __main__ - INFO - extract_entities_by_llm 실행완료: 2.37초
2025-09-11 13:35:52,306 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 13:35:52,306 - __main__ - INFO - ============================================================
2025-09-11 13:35:52,306 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 13:35:52,306 - __main__ - INFO - ============================================================
2025-09-11 13:35:52,306 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 13:35:52,306 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 13:35:52,306 - __main__ - INFO - 상품 수: 1개
2025-09-11 13:35:52,306 - __main__ - INFO - 채널 수: 5개
2025-09-11 13:35:52,306 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 13:35:52,307 - __main__ - INFO - process_message 실행완료: 12.44초
2025-09-11 13:35:52,307 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 15:02:35,277 - __main__ - INFO - MMS 추출기 초기화 중...
2025-09-11 15:02:35,278 - __main__ - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 15:02:35,278 - __main__ - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 15:02:35,278 - __main__ - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 15:02:35,278 - __main__ - INFO - 🔑 환경변수 로드 중...
2025-09-11 15:02:35,279 - __main__ - INFO - 💻 디바이스 설정 중...
2025-09-11 15:02:35,492 - __main__ - INFO - Using device: mps
2025-09-11 15:02:35,493 - __main__ - INFO - _initialize_device 실행완료: 0.21초
2025-09-11 15:02:35,493 - __main__ - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 15:02:35,493 - __main__ - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 15:02:35,493 - __main__ - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 15:02:35,493 - __main__ - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 15:02:35,493 - __main__ - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 15:02:35,494 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 15:02:35,494 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 15:02:41,949 - __main__ - INFO - Model loaded on mps
2025-09-11 15:02:41,950 - __main__ - INFO - _initialize_embedding_model 실행완료: 6.46초
2025-09-11 15:02:41,950 - __main__ - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 15:02:42,489 - __main__ - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 15:02:42,489 - __main__ - INFO - _initialize_kiwi 실행완료: 0.54초
2025-09-11 15:02:42,489 - __main__ - INFO - 📁 데이터 로드 중...
2025-09-11 15:02:42,489 - __main__ - INFO - ============================================================
2025-09-11 15:02:42,489 - __main__ - INFO - 📊 데이터 로딩 시작
2025-09-11 15:02:42,489 - __main__ - INFO - ============================================================
2025-09-11 15:02:42,489 - __main__ - INFO - 데이터 소스 모드: local
2025-09-11 15:02:42,489 - __main__ - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 15:02:42,489 - __main__ - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 15:02:42,489 - __main__ - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 15:02:42,489 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 15:02:42,567 - __main__ - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-11 15:02:42,567 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 15:02:42,567 - __main__ - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-11 15:02:42,572 - __main__ - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-11 15:02:42,573 - __main__ - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-11 15:02:42,574 - __main__ - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 15:02:42,574 - __main__ - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 15:02:42,575 - __main__ - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-11 15:02:42,575 - __main__ - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-11 15:02:42,581 - __main__ - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-11 15:02:42,584 - __main__ - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-11 15:02:42,584 - __main__ - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-11 15:02:42,584 - __main__ - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 15:02:42,584 - __main__ - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-11 15:02:42,584 - __main__ - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-11 15:02:42,584 - __main__ - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-11 15:02:42,584 - __main__ - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 15:02:42,584 - __main__ - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 15:02:42,584 - __main__ - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 15:02:42,585 - __main__ - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-11 15:02:42,591 - __main__ - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 15:02:42,592 - __main__ - INFO - null이 아닌 상품명 수: 10551개
2025-09-11 15:02:42,592 - __main__ - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 15:02:42,592 - __main__ - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-11 15:02:42,592 - __main__ - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-11 15:02:42,719 - __main__ - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-11 15:02:42,723 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-11 15:02:42,724 - __main__ - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 15:02:42,724 - __main__ - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 15:02:42,725 - __main__ - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-11 15:02:42,725 - __main__ - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 15:02:42,726 - __main__ - INFO - 정지어 로드 완료: 166개
2025-09-11 15:02:42,726 - __main__ - INFO - 로드된 정지어 수: 166개
2025-09-11 15:02:42,726 - __main__ - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 15:02:42,726 - __main__ - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 15:02:42,728 - __main__ - INFO - 등록할 고유 별칭 수: 16403개
2025-09-11 15:02:42,729 - __main__ - INFO - 유효한 별칭 수: 16403개
2025-09-11 15:02:42,729 - __main__ - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-11 15:02:42,743 - __main__ - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-11 15:02:42,743 - __main__ - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 15:02:42,743 - __main__ - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 15:02:42,751 - __main__ - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 15:02:42,751 - __main__ - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 15:02:42,990 - __main__ - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 15:02:42,990 - __main__ - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 15:02:42,990 - __main__ - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 15:02:42,990 - __main__ - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-11 15:02:42,990 - __main__ - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-11 15:02:42,990 - __main__ - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 15:02:43,059 - __main__ - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-11 15:02:43,060 - __main__ - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-11 15:02:43,062 - __main__ - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-11 15:02:43,062 - __main__ - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-11 15:02:43,062 - __main__ - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-11 15:02:43,062 - __main__ - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-11 15:02:43,062 - __main__ - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-11 15:02:43,063 - __main__ - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-11 15:02:43,063 - __main__ - INFO - ============================================================
2025-09-11 15:02:43,063 - __main__ - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 15:02:43,063 - __main__ - INFO - ============================================================
2025-09-11 15:02:43,063 - __main__ - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-11 15:02:43,063 - __main__ - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 15:02:43,063 - __main__ - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-11 15:02:43,063 - __main__ - INFO - ✅ 정지어: 166개
2025-09-11 15:02:43,063 - __main__ - INFO - === 상품 데이터 상세 정보 ===
2025-09-11 15:02:43,064 - __main__ - INFO - 고유 상품명 수: 6847개
2025-09-11 15:02:43,066 - __main__ - INFO - 고유 별칭 수: 16403개
2025-09-11 15:02:43,067 - __main__ - INFO - 고유 상품ID 수: 10551개
2025-09-11 15:02:43,067 - __main__ - INFO - _load_data 실행완료: 0.58초
2025-09-11 15:02:43,067 - __main__ - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 15:02:43,067 - __main__ - INFO - 단일 메시지 처리 시작 (멀티스레드)
2025-09-11 15:02:43,067 - __main__ - INFO - 워커 프로세스에서 메시지 처리 시작: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 ...
2025-09-11 15:02:43,067 - __main__ - INFO - ============================================================
2025-09-11 15:02:43,067 - __main__ - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 15:02:43,067 - __main__ - INFO - ============================================================
2025-09-11 15:02:43,067 - __main__ - INFO - 메시지 내용: 
[Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV ...
2025-09-11 15:02:43,067 - __main__ - INFO - 메시지 길이: 420 문자
2025-09-11 15:02:43,067 - __main__ - INFO - === 현재 추출기 설정 ===
2025-09-11 15:02:43,067 - __main__ - INFO - 데이터 소스: local
2025-09-11 15:02:43,067 - __main__ - INFO - 상품 정보 추출 모드: nlp
2025-09-11 15:02:43,067 - __main__ - INFO - 엔티티 추출 모드: llm
2025-09-11 15:02:43,067 - __main__ - INFO - LLM 모델: ax
2025-09-11 15:02:43,067 - __main__ - INFO - 상품 데이터 크기: (21522, 9)
2025-09-11 15:02:43,067 - __main__ - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 15:02:43,067 - __main__ - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 15:02:43,067 - __main__ - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 15:02:43,067 - __main__ - INFO - 처리할 메시지 길이: 407 문자
2025-09-11 15:02:43,068 - __main__ - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-11 15:02:43,553 - __main__ - INFO - 분할된 문장 수: 7개
2025-09-11 15:02:43,553 - __main__ - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-11 15:02:43,557 - __main__ - INFO - 전체 토큰 수: 155개
2025-09-11 15:02:43,557 - __main__ - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-11 15:02:43,557 - __main__ - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '기기값', '을지로입구역', '하나은행', '아이폰', '구매하', '명동']
2025-09-11 15:02:43,557 - __main__ - INFO - 퍼지 매칭 시작...
2025-09-11 15:02:44,363 - __main__ - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-11 15:02:44,363 - __main__ - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-11 15:02:44,364 - __main__ - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-11 15:02:44,364 - __main__ - INFO - 시퀀스 유사도 계산 시작...
2025-09-11 15:02:44,404 - __main__ - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-11 15:02:44,404 - __main__ - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-11 15:02:44,404 - __main__ - INFO - 사용할 유사도 임계값: 0.7
2025-09-11 15:02:44,406 - __main__ - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-11 15:02:44,408 - __main__ - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-11 15:02:44,408 - __main__ - INFO - 통합된 후보 아이템 수: 2개
2025-09-11 15:02:44,411 - __main__ - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-11 15:02:44,413 - __main__ - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-11 15:02:44,413 - __main__ - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 15:02:44,414 - __main__ - INFO - extract_entities_from_kiwi 실행완료: 1.35초
2025-09-11 15:02:44,414 - __main__ - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-11 15:02:44,414 - __main__ - INFO - 매칭된 상품 정보: (1, 2)
2025-09-11 15:02:44,414 - __main__ - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 15:02:44,512 - __main__ - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 15:02:44,512 - __main__ - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 15:02:44,512 - __main__ - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-11 15:02:44,512 - __main__ - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 15:02:44,512 - __main__ - INFO - 후보 아이템 리스트 크기: 1개
2025-09-11 15:02:44,512 - __main__ - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-11 15:02:44,512 - __main__ - INFO - extra_item_pdf 크기: (1, 2)
2025-09-11 15:02:44,512 - __main__ - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-11 15:02:44,513 - __main__ - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-11 15:02:44,514 - __main__ - INFO - NLP 모드: 제품 요소 준비 완료 - 1개
2025-09-11 15:02:44,514 - __main__ - INFO - NLP 모드 제품 요소 샘플: [{'name': 'GALAXY', 'action': '기타'}]
2025-09-11 15:02:44,514 - __main__ - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 15:02:44,514 - __main__ - INFO - 구성된 프롬프트 길이: 5000 문자
2025-09-11 15:02:44,514 - __main__ - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 15:02:44,514 - __main__ - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5000)
2025-09-11 15:02:44,514 - __main__ - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 15:02:44,514 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 15:02:53,780 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 15:02:53,794 - __main__ - INFO - LLM 응답 길이: 1245 문자
2025-09-11 15:02:53,794 - __main__ - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        },
        {
            "name"...
2025-09-11 15:02:53,794 - __main__ - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 15:02:53,794 - __main__ - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 15:02:53,794 - __main__ - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 15:02:53,795 - __main__ - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '가입'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-11 15:02:53,795 - __main__ - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 15:02:53,795 - __main__ - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-11 15:02:54,297 - __main__ - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-11 15:02:54,297 - __main__ - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 17480)
2025-09-11 15:02:54,297 - __main__ - INFO - 현재 저장된 프롬프트 수: 2
2025-09-11 15:02:54,297 - __main__ - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-11 15:02:54,934 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 15:02:55,179 - __main__ - INFO - extract_entities_by_llm 실행완료: 1.38초
2025-09-11 15:02:55,235 - __main__ - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 15:02:55,235 - __main__ - INFO - ============================================================
2025-09-11 15:02:55,235 - __main__ - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 15:02:55,235 - __main__ - INFO - ============================================================
2025-09-11 15:02:55,235 - __main__ - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-11 15:02:55,235 - __main__ - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-11 15:02:55,235 - __main__ - INFO - 상품 수: 1개
2025-09-11 15:02:55,235 - __main__ - INFO - 채널 수: 5개
2025-09-11 15:02:55,235 - __main__ - INFO - 프로그램 수: 2개
2025-09-11 15:02:55,235 - __main__ - INFO - process_message 실행완료: 12.17초
2025-09-11 15:02:55,235 - __main__ - INFO - 워커 프로세스에서 메시지 처리 완료
