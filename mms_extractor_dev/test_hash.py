#!/usr/bin/env python3
"""
DAG ì´ë¯¸ì§€ í•´ì‹œ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
==============================

ìƒ˜í”Œ ë©”ì‹œì§€ë“¤ì˜ í•´ì‹œê°’ì„ ê³„ì‚°í•˜ê³  í•´ë‹¹ DAG ì´ë¯¸ì§€ íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
"""

import os
import hashlib
from pathlib import Path

def sha256_hash(text):
    """utils.pyì™€ ë™ì¼í•œ í•´ì‹œ í•¨ìˆ˜"""
    return hashlib.sha256(text.encode('utf-8')).hexdigest()

# ìƒ˜í”Œ ë©”ì‹œì§€ë“¤ (demo.htmlê³¼ ë™ì¼)
sample_messages = [
    """[SKí…”ë ˆì½¤] ZEMí° í¬ì¼“ëª¬ì—ë””ì…˜3 ì•ˆë‚´
(ê´‘ê³ )[SKT] ìš°ë¦¬ ì•„ì´ ì²« ë²ˆì§¸ ìŠ¤ë§ˆíŠ¸í°, ZEM í‚¤ì¦ˆí°__#04 ê³ ê°ë‹˜, ì•ˆë…•í•˜ì„¸ìš”!
ìš°ë¦¬ ì•„ì´ ìŠ¤ë§ˆíŠ¸í° ê³ ë¯¼ ì¤‘ì´ì…¨ë‹¤ë©´, ìë…€ ìŠ¤ë§ˆíŠ¸í° ê´€ë¦¬ ì•± ZEMì´ ì„¤ì¹˜ëœ SKTë§Œì˜ ì•ˆì „í•œ í‚¤ì¦ˆí°,
ZEMí° í¬ì¼“ëª¬ì—ë””ì…˜3ìœ¼ë¡œ ìš°ë¦¬ ì•„ì´ ì·¨í–¥ì„ ì €ê²©í•´ ë³´ì„¸ìš”!

âœ¨ íŠ¹ë³„ í˜œíƒ
- ì›” ìš”ê¸ˆ 20% í• ì¸ (ì²« 6ê°œì›”)
- í¬ì¼“ëª¬ ì¼€ì´ìŠ¤ ë¬´ë£Œ ì¦ì •
- ZEM í”„ë¦¬ë¯¸ì—„ ì„œë¹„ìŠ¤ 3ê°œì›” ë¬´ë£Œ

ğŸ“ ë¬¸ì˜: 1588-0011 (í‰ì¼ 9ì‹œ-18ì‹œ)
ğŸª ê°€ê¹Œìš´ T world ë§¤ì¥ ë°©ë¬¸
ğŸŒ www.tworld.co.kr

ìˆ˜ì‹ ê±°ë¶€ 080-011-0000""",

    """[T world] 5G ìš”ê¸ˆì œ íŠ¹ê°€ í˜œíƒ
(ê´‘ê³ ) 5G ìŠˆí¼í”Œëœ íŠ¹ê°€ ì´ë²¤íŠ¸ ì§„í–‰ ì¤‘!

ğŸ¯ ì´ë‹¬ì˜ íŠ¹ê°€
- 5G ìŠˆí¼í”Œëœ (ë°ì´í„° ë¬´ì œí•œ): ì›” 79,000ì› â†’ 39,000ì› (50% í• ì¸)
- ê°€ì¡± ì¶”ê°€ íšŒì„ : ì›” 29,000ì›
- YouTube Premium 6ê°œì›” ë¬´ë£Œ

ğŸ“… ì´ë²¤íŠ¸ ê¸°ê°„: 2024.01.01 ~ 2024.01.31
ğŸ ì‹ ê·œ ê°€ì… ì‹œ ê°¤ëŸ­ì‹œ ë²„ì¦ˆ ì¦ì •

ì˜¨ë¼ì¸ ê°€ì…: m.tworld.co.kr
ë§¤ì¥ ë°©ë¬¸: ì „êµ­ T world ë§¤ì¥
ê³ ê°ì„¼í„°: 114

ìˆ˜ì‹ ê±°ë¶€ 080-011-0000""",

    """[SKí…”ë ˆì½¤] ê°¤ëŸ­ì‹œ S24 ì‚¬ì „ì˜ˆì•½
(ê´‘ê³ ) ê°¤ëŸ­ì‹œ S24 ì‹œë¦¬ì¦ˆ ì‚¬ì „ì˜ˆì•½ ì‹œì‘!

ğŸŒŸ ì‚¬ì „ì˜ˆì•½ í˜œíƒ
- ê°¤ëŸ­ì‹œ S24 Ultra: ìµœëŒ€ 30ë§Œì› í• ì¸
- ê°¤ëŸ­ì‹œ S24+: ìµœëŒ€ 25ë§Œì› í• ì¸  
- ê°¤ëŸ­ì‹œ S24: ìµœëŒ€ 20ë§Œì› í• ì¸

ğŸ ì¶”ê°€ í˜œíƒ
- ê°¤ëŸ­ì‹œ ì›Œì¹˜6 50% í• ì¸
- ë¬´ì„ ì¶©ì „ê¸° ë¬´ë£Œ ì¦ì •
- ì¼€ì–´í”ŒëŸ¬ìŠ¤ 6ê°œì›” ë¬´ë£Œ

ğŸ“… ì‚¬ì „ì˜ˆì•½: 2024.01.10 ~ 2024.01.24
ğŸ“± ì¶œì‹œì¼: 2024.01.31

T world ì•±ì—ì„œ ê°„í¸ ì˜ˆì•½
ë§¤ì¥ ì˜ˆì•½: tworldfriends.co.kr/D123456789
ë¬¸ì˜: 1588-0011

ìˆ˜ì‹ ê±°ë¶€ 080-011-0000"""
]

def main():
    print("=" * 80)
    print("ğŸ” DAG ì´ë¯¸ì§€ í•´ì‹œ í…ŒìŠ¤íŠ¸")
    print("=" * 80)
    
    dag_images_dir = Path('./dag_images')
    
    if not dag_images_dir.exists():
        print("âŒ dag_images ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
        return
    
    # ê¸°ì¡´ DAG íŒŒì¼ë“¤ ë‚˜ì—´
    existing_files = list(dag_images_dir.glob('dag_*.png'))
    print(f"ğŸ“ ê¸°ì¡´ DAG ì´ë¯¸ì§€ íŒŒì¼ ìˆ˜: {len(existing_files)}")
    
    if existing_files:
        print("\nğŸ“‹ ê¸°ì¡´ DAG ì´ë¯¸ì§€ íŒŒì¼ë“¤:")
        for i, file_path in enumerate(sorted(existing_files, key=lambda x: x.stat().st_mtime, reverse=True)[:5]):
            size_kb = file_path.stat().st_size / 1024
            mtime = file_path.stat().st_mtime
            print(f"  {i+1}. {file_path.name} ({size_kb:.1f} KB)")
    
    print("\n" + "=" * 80)
    print("ğŸ§ª ìƒ˜í”Œ ë©”ì‹œì§€ í•´ì‹œ í…ŒìŠ¤íŠ¸")
    print("=" * 80)
    
    for i, message in enumerate(sample_messages, 1):
        print(f"\nğŸ“ ìƒ˜í”Œ ë©”ì‹œì§€ {i}:")
        print(f"   ì œëª©: {message.split(chr(10))[0]}")
        
        # í•´ì‹œ ê³„ì‚°
        hash_value = sha256_hash(message)
        expected_filename = f"dag_{hash_value}.png"
        expected_path = dag_images_dir / expected_filename
        
        print(f"   í•´ì‹œ: {hash_value}")
        print(f"   ì˜ˆìƒ íŒŒì¼ëª…: {expected_filename}")
        
        # íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
        if expected_path.exists():
            size_kb = expected_path.stat().st_size / 1024
            print(f"   âœ… ì´ë¯¸ì§€ ì¡´ì¬: {size_kb:.1f} KB")
        else:
            print(f"   âŒ ì´ë¯¸ì§€ ì—†ìŒ")
    
    print("\n" + "=" * 80)
    print("ğŸ’¡ í…ŒìŠ¤íŠ¸ ì™„ë£Œ")
    print("=" * 80)
    print("ğŸ“Œ ë°ëª¨ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ìƒ˜í”Œ ë©”ì‹œì§€ë¥¼ í´ë¦­í•˜ê³  DAG ì¶”ì¶œì„ í™œì„±í™”í•˜ì—¬")
    print("   í•´ë‹¹ ë©”ì‹œì§€ì˜ DAG ì´ë¯¸ì§€ê°€ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.")

if __name__ == "__main__":
    main()
