2025-09-10 11:09:22,480 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-10 11:09:22,480 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-10 11:09:22,480 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-10 11:09:22,480 - mms_extractor - INFO - MMSExtractor 초기화 시작
2025-09-10 11:09:22,480 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-10 11:09:22,508 - mms_extractor - INFO - Using device: mps
2025-09-10 11:09:22,508 - mms_extractor - INFO - _initialize_device 실행완료: 0.03초
2025-09-10 11:09:22,508 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-10 11:09:22,508 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-10 11:09:22,508 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-10 11:09:22,509 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-10 11:09:22,509 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-10 11:09:24,111 - mms_extractor - INFO - Model loaded on mps
2025-09-10 11:09:24,111 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.60초
2025-09-10 11:09:24,609 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-10 11:09:24,609 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.50초
2025-09-10 11:09:24,609 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:24,609 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-10 11:09:24,609 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:24,609 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-10 11:09:24,609 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-10 11:09:24,609 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-10 11:09:24,609 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-10 11:09:24,609 - mms_extractor - INFO - CSV 파일 경로: ./data/item_info_all_250527.csv
2025-09-10 11:09:24,736 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (44275, 7)
2025-09-10 11:09:24,736 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'start_dt', 'end_dt', 'rank']
2025-09-10 11:09:24,746 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (44275, 4)
2025-09-10 11:09:24,751 - mms_extractor - INFO - 로컬 모드 컬럼명 변환: {'item_nm': 'item_nm', 'item_id': 'item_id', 'item_desc': 'item_desc', 'item_dmn': 'item_dmn', 'item_ctg': 'item_ctg', 'item_emb_vec': 'item_emb_vec', 'ofer_cd': 'ofer_cd', 'oper_dt_hms': 'oper_dt_hms'}
2025-09-10 11:09:24,752 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-09-10 11:09:24,757 - mms_extractor - INFO - 도메인 필터링: 44275 -> 44275 (제외된 도메인: ['R'])
2025-09-10 11:09:24,757 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 44275개 상품 ===
2025-09-10 11:09:24,758 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (44275, 8)
2025-09-10 11:09:24,758 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-10 11:09:24,758 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-10 11:09:24,758 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-10 11:09:24,758 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (44275, 8)
2025-09-10 11:09:24,762 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-10 11:09:24,763 - mms_extractor - INFO - null이 아닌 상품명 수: 44275개
2025-09-10 11:09:24,763 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['#', '#', 'EHI-CADW']
2025-09-10 11:09:25,130 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 44275 -> 94279
2025-09-10 11:09:25,132 - mms_extractor - INFO - 별칭 적용 후 샘플: ['#', '#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2']
2025-09-10 11:09:25,132 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-10 11:09:25,132 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (94279, 9)
2025-09-10 11:09:25,132 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-10 11:09:25,134 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-10 11:09:25,134 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-10 11:09:25,134 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-10 11:09:25,134 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-10 11:09:25,142 - mms_extractor - INFO - 등록할 고유 별칭 수: 65154개
2025-09-10 11:09:25,146 - mms_extractor - INFO - 유효한 별칭 수: 65154개
2025-09-10 11:09:25,146 - mms_extractor - INFO - 등록할 별칭 샘플: ['#', 'EHI-CADW', 'IPAD 10.2', '아이패드 10.2', 'KTF_IPAD PRO 12.9 5세대 2T(리퍼단말)']
2025-09-10 11:09:25,199 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 65154개 성공, 0개 실패
2025-09-10 11:09:25,200 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-10 11:09:25,200 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-10 11:09:25,204 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-10 11:09:25,204 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-10 11:09:27,164 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-10 11:09:27,165 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-10 11:09:27,165 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-10 11:09:27,702 - mms_extractor - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-10 11:09:27,702 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-10 11:09:27,702 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:27,702 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-10 11:09:27,702 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:27,702 - mms_extractor - INFO - ✅ 상품 데이터: (94279, 9)
2025-09-10 11:09:27,702 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-10 11:09:27,702 - mms_extractor - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-10 11:09:27,702 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-10 11:09:27,702 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-10 11:09:27,708 - mms_extractor - INFO - 고유 상품명 수: 32157개
2025-09-10 11:09:27,716 - mms_extractor - INFO - 고유 별칭 수: 65154개
2025-09-10 11:09:27,720 - mms_extractor - INFO - 고유 상품ID 수: 44186개
2025-09-10 11:09:27,720 - mms_extractor - INFO - _load_data 실행완료: 3.11초
2025-09-10 11:09:27,720 - mms_extractor - INFO - MMSExtractor 초기화 완료
2025-09-10 11:09:27,720 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-10 11:09:27,720 - __main__ - INFO - 파싱된 인자: host=127.0.0.1, port=8081, debug=False
2025-09-10 11:09:27,720 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-10 11:09:27,721 - __main__ - INFO - MMS 추출기 API 서버를 127.0.0.1:8081에서 시작합니다
2025-09-10 11:09:27,721 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-10 11:09:27,721 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-10 11:09:27,721 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-10 11:09:27,721 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-10 11:09:27,721 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-10 11:09:27,721 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-10 11:09:27,729 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:8081
2025-09-10 11:09:27,729 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-10 11:09:39,167 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-10 11:09:39,167 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-10 11:09:39,167 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-10 11:09:39,167 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-10 11:09:39,167 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-10 11:09:39,167 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:39,167 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-10 11:09:39,167 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:39,168 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-10 11:09:39,168 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-10 11:09:39,168 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-10 11:09:39,168 - mms_extractor - INFO - 데이터 소스: local
2025-09-10 11:09:39,168 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-10 11:09:39,168 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-10 11:09:39,168 - mms_extractor - INFO - LLM 모델: ax
2025-09-10 11:09:39,168 - mms_extractor - INFO - 상품 데이터 크기: (94279, 9)
2025-09-10 11:09:39,168 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-10 11:09:39,168 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-10 11:09:39,168 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-10 11:09:39,168 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-10 11:09:39,174 - mms_extractor - INFO - 매칭할 상품 별칭 수: 65154개
2025-09-10 11:09:39,741 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-10 11:09:39,741 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-10 11:09:39,743 - mms_extractor - INFO - 전체 토큰 수: 134개
2025-09-10 11:09:39,743 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '0 day', '광고', '0 day', '베어유', '에이닷', '시크릿', '이벤트', '에이닷', '쿠폰', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '쿠폰', '시크릿', '수신거부']
2025-09-10 11:09:39,743 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '베어유', '뚜레쥬르', '시크릿', '0 day', '에이닷이빵쏜닷']
2025-09-10 11:09:39,743 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-10 11:09:47,776 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (14323, 3)
2025-09-10 11:09:47,777 - mms_extractor - INFO - 퍼지 매칭 성공: 14323개 결과
2025-09-10 11:09:47,779 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'Galaxy 탭 S6', 'sim': 0.42105263157894735}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'galaxy 탭 S6', 'sim': 0.42105263157894735}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '특별한혜택충전 개편', 'sim': 0.4}]
2025-09-10 11:09:47,779 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-10 11:09:47,896 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (14323, 3)
2025-09-10 11:09:47,897 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'Galaxy 탭 S6', 'sim': 0.2909090909090909}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'galaxy 탭 S6', 'sim': 0.2909090909090909}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '특별한혜택충전 개편', 'sim': 0.24}]
2025-09-10 11:09:47,897 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-10 11:09:47,901 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-09-10 11:09:47,907 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-10 11:09:47,907 - mms_extractor - INFO - 통합된 후보 아이템 수: 15개
2025-09-10 11:09:47,911 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['0 day', '뚜레쥬르', '베어유', '시크릿', 'T쿠폰', 'data', '우드', 'T 에이스', 'CU(0 day)', 'LTE 혜택 안내']
2025-09-10 11:09:47,916 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-10 11:09:47,916 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0 day', 'item_id': ['9301']}, {'item_nm': 'CU(0 day)', 'item_id': ['V861']}, {'item_nm': 'LTE 혜택 안내', 'item_id': ['NA00004316']}]
2025-09-10 11:09:47,916 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.75초
2025-09-10 11:09:47,917 - mms_extractor - INFO - 추출된 후보 엔티티: ['0 day', '뚜레쥬르', '베어유', '시크릿', 'T쿠폰', 'data', '우드', 'T 에이스', 'CU(0 day)', 'LTE 혜택 안내']
2025-09-10 11:09:47,917 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-10 11:09:47,917 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-10 11:09:49,255 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-10 11:09:49,255 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-10 11:09:49,255 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-10 11:09:49,255 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-10 11:09:49,255 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-10 11:09:49,255 - mms_extractor - INFO - 후보 아이템 리스트: ['0 day', '뚜레쥬르', '베어유', '시크릿', 'T쿠폰', 'data', '우드', 'T 에이스', 'CU(0 day)', 'LTE 혜택 안내']
2025-09-10 11:09:49,255 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-10 11:09:49,255 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-10 11:09:49,255 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0 day', 'item_id': ['9301']}, {'item_nm': 'CU(0 day)', 'item_id': ['V861']}]
2025-09-10 11:09:49,255 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-10 11:09:49,255 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-10 11:09:49,256 - mms_extractor - INFO - 구성된 프롬프트 길이: 6217 문자
2025-09-10 11:09:49,256 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-10 11:09:49,256 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6217)
2025-09-10 11:09:49,256 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-10 11:09:49,256 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-10 11:09:56,131 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-10 11:09:56,138 - mms_extractor - INFO - LLM 응답 길이: 942 문자
2025-09-10 11:09:56,138 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵",
            "action": "구매"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action"...
2025-09-10 11:09:56,138 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-10 11:09:56,139 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-10 11:09:56,139 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-10 11:09:56,139 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵', 'action': '구매'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-10 11:09:56,139 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-10 11:09:56,139 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-09-10 11:09:56,404 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 3118)
2025-09-10 11:09:56,404 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-10 11:09:56,404 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-10 11:09:57,179 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-10 11:09:58,130 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.99초
2025-09-10 11:09:58,144 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-10 11:09:58,144 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:58,144 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-10 11:09:58,144 - mms_extractor - INFO - ============================================================
2025-09-10 11:09:58,144 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-10 11:09:58,144 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-10 11:09:58,144 - mms_extractor - INFO - 상품 수: 4개
2025-09-10 11:09:58,144 - mms_extractor - INFO - 채널 수: 4개
2025-09-10 11:09:58,144 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-10 11:09:58,145 - mms_extractor - INFO - process_message 실행완료: 18.98초
2025-09-10 11:09:58,145 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-10 11:09:58,145 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-10 11:09:58,145 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-10 11:09:58,145 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x129a067b0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x129a06b10> root_client=<openai.OpenAI object at 0x129a1de10> root_async_client=<openai.AsyncOpenAI object at 0x129a068d0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-10 11:09:58,145 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-10 11:09:58,145 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-10 11:10:15,008 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1824자
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-10 11:10:15,009 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-10 11:10:15,010 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-10 11:10:15,010 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-10 11:10:15,010 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-10 11:10:15,250 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-10 11:10:15,250 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-10 11:10:15,250 - mms_extractor - INFO - 🕒 DAG 처리 시간: 17.106초
2025-09-10 11:10:15,250 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-10 11:10:15,250 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-10 11:10:15,250 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-10 11:10:15,251 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-10 11:10:15,251 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-10 11:10:15,251 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-10 11:10:15,251 - __main__ - INFO - 추출 완료: 36.083초
2025-09-10 11:10:15,252 - werkzeug - INFO - 127.0.0.1 - - [10/Sep/2025 11:10:15] "POST /extract HTTP/1.1" 200 -
2025-09-11 11:04:34,423 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-11 11:04:34,423 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-11 11:04:34,423 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-11 11:04:34,423 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-11 11:04:34,423 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-11 11:04:34,423 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-11 11:04:34,423 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-11 11:04:34,424 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-11 11:04:34,441 - mms_extractor - INFO - Using device: mps
2025-09-11 11:04:34,441 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-11 11:04:34,441 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-11 11:04:34,441 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-11 11:04:34,442 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-11 11:04:34,442 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-11 11:04:34,442 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-11 11:04:34,442 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-11 11:04:34,442 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-11 11:04:35,442 - mms_extractor - INFO - Model loaded on mps
2025-09-11 11:04:35,442 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.00초
2025-09-11 11:04:35,442 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-11 11:04:35,847 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-11 11:04:35,847 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.40초
2025-09-11 11:04:35,847 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-11 11:04:35,847 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:35,847 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-11 11:04:35,847 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:35,847 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-11 11:04:35,847 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-11 11:04:35,847 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-11 11:04:35,847 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-11 11:04:35,847 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-11 11:04:35,847 - mms_extractor - ERROR - 상품 정보 로드 실패: [Errno 2] No such file or directory: './data/offer_master_data.csv'
2025-09-11 11:04:35,849 - mms_extractor - ERROR - 오류 상세: Traceback (most recent call last):
  File "/Users/1110566/workspace/AgenticWorkflow/mms_extractor_prd/mms_extractor.py", line 990, in _load_item_data
    item_pdf_raw = pd.read_csv(csv_path)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './data/offer_master_data.csv'

2025-09-11 11:04:35,850 - mms_extractor - WARNING - 빈 DataFrame으로 fallback 설정됨
2025-09-11 11:04:35,850 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (0, 4)
2025-09-11 11:04:35,850 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn']
2025-09-11 11:04:35,850 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-11 11:04:35,850 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-11 11:04:35,850 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (0, 4)
2025-09-11 11:04:35,851 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-11 11:04:35,851 - mms_extractor - INFO - null이 아닌 상품명 수: 0개
2025-09-11 11:04:35,852 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 0 -> 0
2025-09-11 11:04:35,852 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-11 11:04:35,852 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (0, 5)
2025-09-11 11:04:35,852 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-11 11:04:35,853 - mms_extractor - INFO - 정지어 로드 완료: 143개
2025-09-11 11:04:35,853 - mms_extractor - INFO - 로드된 정지어 수: 143개
2025-09-11 11:04:35,853 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-11 11:04:35,853 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-11 11:04:35,853 - mms_extractor - INFO - 등록할 고유 별칭 수: 0개
2025-09-11 11:04:35,853 - mms_extractor - INFO - 유효한 별칭 수: 0개
2025-09-11 11:04:35,853 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 0개 성공, 0개 실패
2025-09-11 11:04:35,853 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-11 11:04:35,853 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-11 11:04:35,854 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-11 11:04:35,854 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-11 11:04:36,004 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-11 11:04:36,004 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-11 11:04:36,004 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-11 11:04:36,475 - mms_extractor - INFO - 조직 정보 로드 완료: 259233개 조직
2025-09-11 11:04:36,475 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (259233, 8)
2025-09-11 11:04:36,475 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:36,475 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-11 11:04:36,475 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:36,475 - mms_extractor - INFO - ✅ 상품 데이터: (0, 5)
2025-09-11 11:04:36,475 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-11 11:04:36,475 - mms_extractor - INFO - ✅ 조직 데이터: (259233, 8)
2025-09-11 11:04:36,475 - mms_extractor - INFO - ✅ 정지어: 143개
2025-09-11 11:04:36,475 - mms_extractor - INFO - _load_data 실행완료: 0.63초
2025-09-11 11:04:36,475 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-11 11:04:36,475 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-11 11:04:36,475 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-11 11:04:36,475 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-11 11:04:36,475 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-11 11:04:36,475 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-11 11:04:36,475 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-11 11:04:36,475 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-11 11:04:36,475 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-11 11:04:36,475 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-11 11:04:36,475 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-11 11:04:36,484 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.25.54:8000
2025-09-11 11:04:36,484 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-11 11:04:40,039 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-11 11:04:40,039 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-11 11:04:40,039 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-11 11:04:40,040 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-11 11:04:40,040 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-11 11:04:40,040 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:40,040 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-11 11:04:40,040 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:40,040 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-11 11:04:40,040 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-11 11:04:40,040 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-11 11:04:40,040 - mms_extractor - INFO - 데이터 소스: local
2025-09-11 11:04:40,040 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-11 11:04:40,040 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-11 11:04:40,040 - mms_extractor - INFO - LLM 모델: ax
2025-09-11 11:04:40,040 - mms_extractor - INFO - 상품 데이터 크기: (0, 5)
2025-09-11 11:04:40,040 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-11 11:04:40,040 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-11 11:04:40,040 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-11 11:04:40,040 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-11 11:04:40,040 - mms_extractor - ERROR - 상품 데이터가 비어있습니다! 엔티티 추출 불가
2025-09-11 11:04:40,040 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.00초
2025-09-11 11:04:40,040 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-11 11:04:40,040 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-11 11:04:40,040 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-11 11:04:40,188 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-11 11:04:40,189 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-11 11:04:40,189 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-11 11:04:40,189 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-11 11:04:40,189 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-11 11:04:40,189 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-11 11:04:40,189 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-11 11:04:40,189 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-11 11:04:40,189 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-11 11:04:40,189 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-11 11:04:40,189 - mms_extractor - INFO - 구성된 프롬프트 길이: 5790 문자
2025-09-11 11:04:40,189 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-11 11:04:40,189 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5790)
2025-09-11 11:04:40,189 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-11 11:04:40,189 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-11 11:04:47,548 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:04:47,559 - mms_extractor - INFO - LLM 응답 길이: 921 문자
2025-09-11 11:04:47,559 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵",
            "action": "구매"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
        },
...
2025-09-11 11:04:47,559 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-11 11:04:47,559 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-11 11:04:47,559 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-11 11:04:47,559 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵', 'action': '구매'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-11 11:04:47,559 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-11 11:04:47,559 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵']
2025-09-11 11:04:47,571 - mms_extractor - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-09-11 11:04:47,572 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 0.01초
2025-09-11 11:04:47,575 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-11 11:04:47,575 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:47,575 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-11 11:04:47,575 - mms_extractor - INFO - ============================================================
2025-09-11 11:04:47,575 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-11 11:04:47,575 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-11 11:04:47,575 - mms_extractor - INFO - 상품 수: 2개
2025-09-11 11:04:47,575 - mms_extractor - INFO - 채널 수: 4개
2025-09-11 11:04:47,576 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-11 11:04:47,576 - mms_extractor - INFO - process_message 실행완료: 7.54초
2025-09-11 11:04:47,576 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-11 11:04:47,576 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-11 11:04:47,576 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-11 11:04:47,576 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x3283b71a0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x3283b7140> root_client=<openai.OpenAI object at 0x3283b77d0> root_async_client=<openai.AsyncOpenAI object at 0x3283b71d0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-11 11:04:47,576 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-11 11:04:47,576 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-11 11:05:05,749 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-11 11:05:05,751 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1878자
2025-09-11 11:05:05,751 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택을 통해 만 13~34세 고객에게 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하고, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록...
2025-09-11 11:05:05,751 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-11 11:05:05,752 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-11 11:05:05,752 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-11 11:05:05,753 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-11 11:05:05,753 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-11 11:05:05,753 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-11 11:05:05,753 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-11 11:05:05,753 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-11 11:05:05,753 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-11 11:05:05,754 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-11 11:05:05,961 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-11 11:05:05,961 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-11 11:05:05,961 - mms_extractor - INFO - 🕒 DAG 처리 시간: 18.385초
2025-09-11 11:05:05,961 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-11 11:05:05,961 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-11 11:05:05,961 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-11 11:05:05,961 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-11 11:05:05,961 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-11 11:05:05,961 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-11 11:05:05,961 - __main__ - INFO - 추출 완료: 25.922초
2025-09-11 11:05:05,962 - werkzeug - INFO - 127.0.0.1 - - [11/Sep/2025 11:05:05] "POST /extract HTTP/1.1" 200 -
2025-09-17 11:29:07,883 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-17 11:29:07,885 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-17 11:29:07,885 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-17 11:29:07,885 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-17 11:29:07,885 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-17 11:29:07,885 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-17 11:29:07,885 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-17 11:29:07,886 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-17 11:29:07,947 - mms_extractor - INFO - Using device: mps
2025-09-17 11:29:07,947 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-09-17 11:29:07,947 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-17 11:29:07,947 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-17 11:29:07,947 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-17 11:29:07,947 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-17 11:29:07,947 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-17 11:29:07,948 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-17 11:29:07,948 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-17 11:29:10,075 - mms_extractor - INFO - Model loaded on mps
2025-09-17 11:29:10,075 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 2.13초
2025-09-17 11:29:10,075 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-17 11:29:10,538 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-17 11:29:10,538 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-17 11:29:10,538 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-17 11:29:10,538 - mms_extractor - INFO - ============================================================
2025-09-17 11:29:10,538 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-17 11:29:10,538 - mms_extractor - INFO - ============================================================
2025-09-17 11:29:10,538 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-17 11:29:10,538 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-17 11:29:10,538 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-17 11:29:10,538 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-17 11:29:10,538 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 11:29:10,608 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-17 11:29:10,608 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 11:29:10,608 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-17 11:29:10,611 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-17 11:29:10,612 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-17 11:29:10,613 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 11:29:10,613 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 11:29:10,613 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-17 11:29:10,613 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-17 11:29:10,618 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-17 11:29:10,620 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-17 11:29:10,620 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-17 11:29:10,620 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 11:29:10,620 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-17 11:29:10,620 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-17 11:29:10,621 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-17 11:29:10,621 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 11:29:10,621 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-17 11:29:10,621 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-17 11:29:10,621 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-17 11:29:10,625 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-17 11:29:10,625 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-17 11:29:10,625 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 11:29:10,626 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-17 11:29:10,626 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 11:29:10,760 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-17 11:29:10,764 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-17 11:29:10,765 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증']
2025-09-17 11:29:10,765 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-17 11:29:10,765 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-17 11:29:10,765 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-17 11:29:10,767 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-17 11:29:10,767 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-17 11:29:10,767 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-17 11:29:10,767 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-17 11:29:10,769 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-17 11:29:10,769 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-17 11:29:10,769 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증']
2025-09-17 11:29:10,782 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-17 11:29:10,782 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-17 11:29:10,782 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-17 11:29:10,795 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-17 11:29:10,795 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-17 11:29:10,945 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-17 11:29:10,945 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-17 11:29:10,946 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-17 11:29:10,946 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-17 11:29:10,946 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-17 11:29:10,946 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 11:29:11,013 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-17 11:29:11,013 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 11:29:11,015 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-17 11:29:11,016 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-17 11:29:11,016 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-17 11:29:11,016 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 11:29:11,016 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-17 11:29:11,016 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-17 11:29:11,016 - mms_extractor - INFO - ============================================================
2025-09-17 11:29:11,016 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-17 11:29:11,016 - mms_extractor - INFO - ============================================================
2025-09-17 11:29:11,016 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-17 11:29:11,016 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-17 11:29:11,016 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-17 11:29:11,016 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-17 11:29:11,016 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-17 11:29:11,017 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-17 11:29:11,019 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-17 11:29:11,020 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-17 11:29:11,020 - mms_extractor - INFO - _load_data 실행완료: 0.48초
2025-09-17 11:29:11,020 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-17 11:29:11,020 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-17 11:29:11,020 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-17 11:29:11,020 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-17 11:29:11,020 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-17 11:29:11,020 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-17 11:29:11,020 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-17 11:29:11,020 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-17 11:29:11,020 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-17 11:29:11,021 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-17 11:29:11,021 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-17 11:29:11,047 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.54:8000
2025-09-17 11:29:11,047 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-17 11:30:06,316 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:30:06] "GET /health HTTP/1.1" 200 -
2025-09-17 11:30:06,350 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:30:06] "GET /health HTTP/1.1" 200 -
2025-09-17 11:30:08,009 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:30:08] "GET /health HTTP/1.1" 200 -
2025-09-17 11:30:08,018 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-17 11:30:08,018 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 11:30:08,018 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 11:30:08,018 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-17 11:30:08,018 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 11:30:08,018 - mms_extractor - INFO - ============================================================
2025-09-17 11:30:08,018 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 11:30:08,019 - mms_extractor - INFO - ============================================================
2025-09-17 11:30:08,019 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-17 11:30:08,019 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-17 11:30:08,019 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 11:30:08,019 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 11:30:08,019 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-17 11:30:08,019 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 11:30:08,019 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 11:30:08,019 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 11:30:08,019 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 11:30:08,019 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 11:30:08,019 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 11:30:08,019 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-17 11:30:08,020 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 11:30:08,495 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-17 11:30:08,496 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-17 11:30:08,499 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-17 11:30:08,499 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-17 11:30:08,499 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-17 11:30:08,499 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 11:30:14,587 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-17 11:30:14,587 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-17 11:30:14,588 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-17 11:30:14,588 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 11:30:14,667 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-17 11:30:14,668 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-17 11:30:14,668 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 11:30:14,670 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-17 11:30:14,672 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-17 11:30:14,672 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-17 11:30:14,674 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:30:14,676 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-17 11:30:14,676 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-17 11:30:14,677 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 6.66초
2025-09-17 11:30:14,677 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:30:14,677 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-17 11:30:14,677 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 11:30:14,810 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 11:30:14,810 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 11:30:14,810 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-17 11:30:14,810 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 11:30:14,811 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-17 11:30:14,811 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:30:14,811 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-17 11:30:14,811 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 11:30:14,811 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-17 11:30:14,812 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-17 11:30:14,812 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-17 11:30:14,812 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 11:30:14,812 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-17 11:30:14,812 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-17 11:30:14,812 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-17 11:30:14,812 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 11:30:14,812 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 11:30:21,316 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:30:21,329 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-17 11:30:21,329 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-17 11:30:21,329 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 11:30:21,329 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 11:30:21,330 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 11:30:21,330 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-17 11:30:21,330 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 11:30:21,330 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-17 11:30:21,429 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 11:30:21,429 - mms_extractor - INFO - ============================================================
2025-09-17 11:30:21,429 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 11:30:21,429 - mms_extractor - INFO - ============================================================
2025-09-17 11:30:21,429 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-17 11:30:21,429 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-17 11:30:21,429 - mms_extractor - INFO - 상품 수: 3개
2025-09-17 11:30:21,429 - mms_extractor - INFO - 채널 수: 3개
2025-09-17 11:30:21,429 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 11:30:21,430 - mms_extractor - INFO - process_message 실행완료: 13.41초
2025-09-17 11:30:21,430 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 11:30:21,430 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 11:30:21,430 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-17 11:30:21,430 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 11:30:21,430 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 11:30:21,430 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-17 11:30:43,891 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:30:43,893 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2501자
2025-09-17 11:30:43,894 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 8월 31일까지 2개월 동안 월 9,900원에 넷플릭스와 웨이브 콘텐츠를 모두 이용할 수 있는 쿠폰을 제공하며, 이를 통해 고객의 구독 서비스 가입을 유도하고 있습니다.

[식별...
2025-09-17 11:30:43,894 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 11:30:43,895 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 282자
2025-09-17 11:30:43,895 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 11:30:43,896 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 8, 엣지 수: 7
2025-09-17 11:30:43,896 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '프로모션:확인', '쿠폰:다운로드', '우주패스Netflix:가입', '넷플릭스광고형스탠다드:사용', '웨이브콘텐츠팩:사용', '할인혜택:수령', '추가요금:결제']
2025-09-17 11:30:43,896 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '프로모션:확인'), ('프로모션:확인', '쿠폰:다운로드'), ('쿠폰:다운로드', '우주패스Netflix:가입'), ('우주패스Netflix:가입', '넷플릭스광고형스탠다드:사용'), ('우주패스Netflix:가입', '웨이브콘텐츠팩:사용'), ('우주패스Netflix:가입', '할인혜택:수령'), ('우주패스Netflix:가입', '추가요금:결제')]
2025-09-17 11:30:43,897 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 11:30:43,897 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:30:43,898 - utils - INFO - 📊 입력 그래프 - 노드 수: 8, 엣지 수: 7
2025-09-17 11:30:43,899 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 11:30:44,156 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-17 11:30:44,156 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:30:44,156 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.726초
2025-09-17 11:30:44,156 - mms_extractor - INFO - 📏 DAG 섹션 길이: 282자
2025-09-17 11:30:44,156 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (프로모션:확인)
(프로모션:확인) -[확인후]-> (쿠폰:다운로드)
(쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)
(우주패스Netflix:가입) -[가입하면]-> (넷플릭스광고형스탠다드:사용)
(우주패스Netflix:가입) -[가입하면]-> (웨이브콘텐츠팩:사용)
(우주패스Netflix:가입) -[...
2025-09-17 11:30:44,156 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 11:30:44,156 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 11:30:44,156 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 7자
2025-09-17 11:30:44,156 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스Netflix:가입) -[가입하면]-> (넷플릭스광고형스탠다드:사용)', '(우주패스Netflix:가입) -[가입하면]-> (웨이브콘텐츠팩:사용)', '(우주패스Netflix:가입) -[가입하면]-> (할인혜택:수령)', '(우주패스Netflix:가입) -[가입후]-> (추가요금:결제) -[결제하면]-> (넷플릭스스탠다드/프리미엄:사용)', '(웹사이트:접속) -[접속하면]-> (프로모션:확인)', '(쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)', '(프로모션:확인) -[확인후]-> (쿠폰:다운로드)']...
2025-09-17 11:30:44,156 - __main__ - INFO - 추출 완료: 36.138초
2025-09-17 11:30:44,157 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:30:44] "POST /extract HTTP/1.1" 200 -
2025-09-17 11:30:44,180 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:30:44] "GET /health HTTP/1.1" 200 -
2025-09-17 11:38:13,631 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:38:13] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:37,625 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:37] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:41,018 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:41] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:49,466 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:49] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:52,665 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:52] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:52,699 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:52] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:54,574 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:39:54] "GET /health HTTP/1.1" 200 -
2025-09-17 11:39:54,591 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-17 11:39:54,591 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 11:39:54,591 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 11:39:54,591 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-17 11:39:54,591 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 11:39:54,591 - mms_extractor - INFO - ============================================================
2025-09-17 11:39:54,591 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 11:39:54,591 - mms_extractor - INFO - ============================================================
2025-09-17 11:39:54,591 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-17 11:39:54,591 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-17 11:39:54,591 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 11:39:54,591 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 11:39:54,592 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 11:39:54,592 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 11:39:54,592 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 11:39:54,592 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 11:39:54,592 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 11:39:54,592 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 11:39:54,592 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 11:39:54,592 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-17 11:39:54,594 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 11:39:54,617 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-17 11:39:54,617 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-17 11:39:54,621 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-17 11:39:54,621 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-17 11:39:54,621 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-17 11:39:54,621 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 11:40:11,739 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-17 11:40:11,739 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-17 11:40:11,740 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-17 11:40:11,740 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 11:40:11,820 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-17 11:40:11,820 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-17 11:40:11,820 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 11:40:11,822 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-17 11:40:11,823 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-17 11:40:11,824 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-17 11:40:11,825 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:40:11,826 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-17 11:40:11,827 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-17 11:40:11,827 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 17.24초
2025-09-17 11:40:11,827 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:40:11,827 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-17 11:40:11,827 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 11:40:11,982 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 11:40:11,982 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 11:40:11,982 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-17 11:40:11,982 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 11:40:11,982 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-17 11:40:11,982 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:40:11,982 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-17 11:40:11,982 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 11:40:11,982 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-17 11:40:11,982 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 11:40:11,982 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 11:40:11,982 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-17 11:40:11,983 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 11:40:11,983 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-17 11:40:11,983 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 11:40:11,983 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 11:40:18,314 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:40:18,316 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-17 11:40:18,316 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-17 11:40:18,316 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 11:40:18,317 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 11:40:18,317 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 11:40:18,317 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-17 11:40:18,317 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 11:40:18,317 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-17 11:40:18,419 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 11:40:18,420 - mms_extractor - INFO - ============================================================
2025-09-17 11:40:18,420 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 11:40:18,420 - mms_extractor - INFO - ============================================================
2025-09-17 11:40:18,420 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-17 11:40:18,420 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-17 11:40:18,420 - mms_extractor - INFO - 상품 수: 3개
2025-09-17 11:40:18,420 - mms_extractor - INFO - 채널 수: 3개
2025-09-17 11:40:18,420 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 11:40:18,420 - mms_extractor - INFO - process_message 실행완료: 23.83초
2025-09-17 11:40:18,420 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 11:40:18,420 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 11:40:18,420 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-17 11:40:18,420 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 11:40:18,420 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 11:40:18,420 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-17 11:40:42,366 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:40:42,369 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2663자
2025-09-17 11:40:42,369 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 8월 31일까지 2개월 동안 월 9,900원에 넷플릭스와 웨이브 콘텐츠를 모두 이용할 수 있는 쿠폰을 제공하며, 이를 통해 고객의 구독 서비스 가입을 유도하고 있습니다.

[식별...
2025-09-17 11:40:42,369 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 11:40:42,369 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 325자
2025-09-17 11:40:42,369 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 11:40:42,370 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 9, 엣지 수: 8
2025-09-17 11:40:42,370 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '프로모션확인및쿠폰다운로드:수행', '우주패스Netflix:가입', '넷플릭스광고형스탠다드:이용', '웨이브콘텐츠팩:이용', '할인혜택:수령', '넷플릭스콘텐츠:시청', '웨이브콘텐츠:시청', '넷플릭스스탠다드프리미엄:선택가능']
2025-09-17 11:40:42,370 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '프로모션확인및쿠폰다운로드:수행'), ('프로모션확인및쿠폰다운로드:수행', '우주패스Netflix:가입'), ('우주패스Netflix:가입', '넷플릭스광고형스탠다드:이용'), ('우주패스Netflix:가입', '웨이브콘텐츠팩:이용'), ('우주패스Netflix:가입', '할인혜택:수령'), ('우주패스Netflix:가입', '넷플릭스스탠다드프리미엄:선택가능'), ('넷플릭스광고형스탠다드:이용', '넷플릭스콘텐츠:시청'), ('웨이브콘텐츠팩:이용', '웨이브콘텐츠:시청')]
2025-09-17 11:40:42,370 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 11:40:42,370 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:40:42,370 - utils - INFO - 📊 입력 그래프 - 노드 수: 9, 엣지 수: 8
2025-09-17 11:40:42,371 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 11:40:42,748 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-17 11:40:42,748 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:40:42,748 - mms_extractor - INFO - 🕒 DAG 처리 시간: 24.329초
2025-09-17 11:40:42,748 - mms_extractor - INFO - 📏 DAG 섹션 길이: 325자
2025-09-17 11:40:42,748 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (프로모션확인및쿠폰다운로드:수행)
(프로모션확인및쿠폰다운로드:수행) -[수행후]-> (우주패스Netflix:가입)
(우주패스Netflix:가입) -[가입하면]-> (넷플릭스광고형스탠다드:이용)
(우주패스Netflix:가입) -[가입하면]-> (웨이브콘텐츠팩:이용)
(우주패스Netflix:가입) -[가입하면]-> (할인혜택...
2025-09-17 11:40:42,748 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 11:40:42,748 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 11:40:42,749 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 8자
2025-09-17 11:40:42,749 - __main__ - INFO - DAG 내용 미리보기: ['(넷플릭스광고형스탠다드:이용) -[이용하면]-> (넷플릭스콘텐츠:시청)', '(우주패스Netflix:가입) -[가입하면]-> (넷플릭스광고형스탠다드:이용)', '(우주패스Netflix:가입) -[가입하면]-> (웨이브콘텐츠팩:이용)', '(우주패스Netflix:가입) -[가입하면]-> (할인혜택:수령)', '(우주패스Netflix:가입) -[가입후]-> (넷플릭스스탠다드프리미엄:선택가능)', '(웨이브콘텐츠팩:이용) -[이용하면]-> (웨이브콘텐츠:시청)', '(웹사이트:접속) -[접속하면]-> (프로모션확인및쿠폰다운로드:수행)', '(프로모션확인및쿠폰다운로드:수행) -[수행후]-> (우주패스Netflix:가입)']...
2025-09-17 11:40:42,749 - __main__ - INFO - 추출 완료: 48.157초
2025-09-17 11:40:42,749 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:40:42] "POST /extract HTTP/1.1" 200 -
2025-09-17 11:40:42,776 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:40:42] "GET /health HTTP/1.1" 200 -
2025-09-17 11:42:18,884 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:42:18] "GET /health HTTP/1.1" 200 -
2025-09-17 11:42:54,271 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:42:54] "GET /health HTTP/1.1" 200 -
2025-09-17 11:42:54,306 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:42:54] "GET /health HTTP/1.1" 200 -
2025-09-17 11:42:55,678 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:42:55] "GET /health HTTP/1.1" 200 -
2025-09-17 11:42:55,692 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-17 11:42:55,693 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 11:42:55,693 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 11:42:55,693 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-17 11:42:55,693 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 11:42:55,693 - mms_extractor - INFO - ============================================================
2025-09-17 11:42:55,693 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 11:42:55,693 - mms_extractor - INFO - ============================================================
2025-09-17 11:42:55,693 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-17 11:42:55,693 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-17 11:42:55,693 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 11:42:55,693 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 11:42:55,693 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 11:42:55,693 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 11:42:55,693 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 11:42:55,693 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 11:42:55,693 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 11:42:55,693 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 11:42:55,693 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 11:42:55,693 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-17 11:42:55,695 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 11:42:55,700 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-17 11:42:55,701 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-17 11:42:55,706 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-17 11:42:55,706 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-17 11:42:55,706 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-17 11:42:55,706 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 11:42:55,909 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-17 11:42:55,909 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-17 11:42:55,909 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-17 11:42:55,910 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 11:42:55,976 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-17 11:42:55,977 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-17 11:42:55,977 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 11:42:55,978 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-17 11:42:55,980 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-17 11:42:55,980 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-17 11:42:55,981 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:42:55,983 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-17 11:42:55,983 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-17 11:42:55,983 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.29초
2025-09-17 11:42:55,983 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:42:55,983 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-17 11:42:55,983 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 11:42:56,021 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 11:42:56,021 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 11:42:56,021 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-17 11:42:56,021 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 11:42:56,021 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-17 11:42:56,021 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-17 11:42:56,021 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-17 11:42:56,021 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 11:42:56,021 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-17 11:42:56,021 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 11:42:56,021 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 11:42:56,021 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-17 11:42:56,021 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 11:42:56,021 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-17 11:42:56,021 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 11:42:56,021 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 11:43:02,025 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:43:02,028 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-17 11:43:02,028 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-17 11:43:02,028 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 11:43:02,029 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 11:43:02,029 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 11:43:02,029 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-17 11:43:02,029 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 11:43:02,029 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-17 11:43:02,129 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 11:43:02,129 - mms_extractor - INFO - ============================================================
2025-09-17 11:43:02,129 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 11:43:02,129 - mms_extractor - INFO - ============================================================
2025-09-17 11:43:02,129 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-17 11:43:02,129 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-17 11:43:02,129 - mms_extractor - INFO - 상품 수: 3개
2025-09-17 11:43:02,129 - mms_extractor - INFO - 채널 수: 3개
2025-09-17 11:43:02,129 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 11:43:02,129 - mms_extractor - INFO - process_message 실행완료: 6.44초
2025-09-17 11:43:02,129 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 11:43:02,129 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 11:43:02,129 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-17 11:43:02,130 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 11:43:02,130 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 11:43:02,130 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-17 11:43:21,085 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 11:43:21,088 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2264자
2025-09-17 11:43:21,088 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브 콘텐츠를 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 '우주패스 Netflix'에 가입하도록 유도하는 것입니다. 8월 31일까지 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용할 수 있는 혜택을 제공...
2025-09-17 11:43:21,088 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 11:43:21,089 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 249자
2025-09-17 11:43:21,089 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 11:43:21,089 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-17 11:43:21,089 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 쿠폰:다운로드', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용', '웨이브 콘텐츠 팩:사용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-17 11:43:21,090 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 쿠폰:다운로드', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:사용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-17 11:43:21,090 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 11:43:21,090 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:43:21,090 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-17 11:43:21,092 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 11:43:21,352 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-17 11:43:21,352 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-17 11:43:21,352 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.223초
2025-09-17 11:43:21,352 - mms_extractor - INFO - 📏 DAG 섹션 길이: 249자
2025-09-17 11:43:21,352 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 쿠폰:다운로드) -[다운로드후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)
(우주패스 Netflix:가입) -[가입후]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) ...
2025-09-17 11:43:21,352 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 11:43:21,352 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 11:43:21,352 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-17 11:43:21,352 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)', '(우주패스 Netflix:가입) -[가입후]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:선택)', '(프로모션 쿠폰:다운로드) -[다운로드후]-> (우주패스 Netflix:가입)']...
2025-09-17 11:43:21,352 - __main__ - INFO - 추출 완료: 25.660초
2025-09-17 11:43:21,353 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:43:21] "POST /extract HTTP/1.1" 200 -
2025-09-17 11:43:21,380 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 11:43:21] "GET /health HTTP/1.1" 200 -
2025-09-17 12:42:57,263 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:42:57] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:00,720 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:00] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:05,621 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:05] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:09,956 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:09] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:09,999 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:09] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:11,866 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:11] "GET /health HTTP/1.1" 200 -
2025-09-17 12:44:11,878 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 323자
2025-09-17 12:44:11,879 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:44:11,879 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:44:11,879 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰,...
2025-09-17 12:44:11,879 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:44:11,879 - mms_extractor - INFO - ============================================================
2025-09-17 12:44:11,879 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:44:11,879 - mms_extractor - INFO - ============================================================
2025-09-17 12:44:11,879 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!

✨ 특별 혜택
- 월 요금 20% 할인 (첫 6개월)
-...
2025-09-17 12:44:11,879 - mms_extractor - INFO - 메시지 길이: 323 문자
2025-09-17 12:44:11,879 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:44:11,879 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:44:11,879 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-17 12:44:11,879 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:44:11,879 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:44:11,879 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:44:11,879 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:44:11,879 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:44:11,879 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:44:11,879 - mms_extractor - INFO - 처리할 메시지 길이: 323 문자
2025-09-17 12:44:11,883 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:44:11,895 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-17 12:44:11,896 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-09-17 12:44:11,898 - mms_extractor - INFO - 전체 토큰 수: 129개
2025-09-17 12:44:11,899 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '포켓몬', '에디션', '스마트폰', '포켓몬', '에디션', '포켓몬']
2025-09-17 12:44:11,899 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에디션', '포켓몬']
2025-09-17 12:44:11,899 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:44:18,620 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1354, 3)
2025-09-17 12:44:18,620 - mms_extractor - INFO - 퍼지 매칭 성공: 1354개 결과
2025-09-17 12:44:18,622 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.5}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4444444444444444}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.4}]
2025-09-17 12:44:18,622 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:44:18,661 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1354, 3)
2025-09-17 12:44:18,661 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.4}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.35555555555555557}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.32000000000000006}]
2025-09-17 12:44:18,661 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:44:18,663 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 6개
2025-09-17 12:44:18,665 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-17 12:44:18,665 - mms_extractor - INFO - 통합된 후보 아이템 수: 6개
2025-09-17 12:44:18,666 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-17 12:44:18,668 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (5, 2)
2025-09-17 12:44:18,668 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'K3', 'item_id': ['XXC5']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}]
2025-09-17 12:44:18,668 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 6.79초
2025-09-17 12:44:18,668 - mms_extractor - INFO - 추출된 후보 엔티티: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-17 12:44:18,668 - mms_extractor - INFO - 매칭된 상품 정보: (5, 2)
2025-09-17 12:44:18,669 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:44:18,774 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:44:18,774 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:44:18,774 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-09-17 12:44:18,774 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:44:18,774 - mms_extractor - INFO - 후보 아이템 리스트 크기: 5개
2025-09-17 12:44:18,774 - mms_extractor - INFO - 후보 아이템 리스트: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-17 12:44:18,774 - mms_extractor - INFO - extra_item_pdf 크기: (5, 2)
2025-09-17 12:44:18,774 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:44:18,774 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:44:18,775 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 5개
2025-09-17 12:44:18,775 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '0서비스', 'action': '기타'}, {'name': 'K3', 'action': '기타'}]
2025-09-17 12:44:18,775 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:44:18,775 - mms_extractor - INFO - 구성된 프롬프트 길이: 5197 문자
2025-09-17 12:44:18,775 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-17 12:44:18,775 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5197)
2025-09-17 12:44:18,775 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:44:18,775 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:44:25,206 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:44:25,210 - mms_extractor - INFO - LLM 응답 길이: 939 문자
2025-09-17 12:44:25,210 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 프리미엄 서비스",
            "action": "가입"
        },
        {
            "name": "포켓몬 케이스",
            "action": "증정"
        }
    ],
    "channel": [
        {
            "type": "전화번호",
            "value": "1588-0011",
            "action": "문의"
    ...
2025-09-17 12:44:25,210 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:44:25,211 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:44:25,211 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:44:25,211 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 프리미엄 서비스', 'action': '가입'}, {'name': '포켓몬 케이스', 'action': '증정'}], 'channel': [{'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '대리점', 'value': '가까운 T world 매장', 'action': '가입'}, {'type': 'URL', 'value': 'www.tworld.co.kr', 'action': '추가 정보'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:44:25,211 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:44:25,212 - mms_extractor - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 프리미엄 서비스', '포켓몬 케이스']
2025-09-17 12:44:25,345 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:44:25,345 - mms_extractor - INFO - ============================================================
2025-09-17 12:44:25,345 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:44:25,345 - mms_extractor - INFO - ============================================================
2025-09-17 12:44:25,345 - mms_extractor - INFO - 제목: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
2025-09-17 12:44:25,345 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:44:25,345 - mms_extractor - INFO - 상품 수: 0개
2025-09-17 12:44:25,345 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:44:25,345 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:44:25,345 - mms_extractor - INFO - process_message 실행완료: 13.47초
2025-09-17 12:44:25,345 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:44:25,345 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:44:25,345 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 323자
2025-09-17 12:44:25,345 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:44:25,345 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:44:25,345 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3308자
2025-09-17 12:44:47,520 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:44:47,522 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2511자
2025-09-17 12:44:47,522 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 자녀의 첫 스마트폰으로 ZEM폰 포켓몬에디션3을 추천하며, 안전한 사용 환경과 다양한 특별 혜택을 강조합니다. 주요 혜택으로는 월 요금 20% 할인(첫 6개월), 포켓몬 케이스 무료 증정, ZEM 프리미엄 서비스 3개월 무료 이용이 제공됩니다.

[식별된 가치 제안 목록]
- ZEM...
2025-09-17 12:44:47,522 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:44:47,523 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 228자
2025-09-17 12:44:47,523 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:44:47,524 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-17 12:44:47,524 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령', '포켓몬 케이스:수령', 'ZEM 프리미엄 서비스 3개월 무료:수령', 'ZEM 프리미엄 서비스:사용']
2025-09-17 12:44:47,524 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매'), ('ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령'), ('ZEM폰 포켓몬에디션3:구매', '포켓몬 케이스:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 프리미엄 서비스 3개월 무료:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 프리미엄 서비스:사용')]
2025-09-17 12:44:47,524 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:44:47,525 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-09-17 12:44:47,525 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-17 12:44:47,526 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:44:48,724 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be.png
2025-09-17 12:44:48,724 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-09-17 12:44:48,724 - mms_extractor - INFO - 🕒 DAG 처리 시간: 23.379초
2025-09-17 12:44:48,724 - mms_extractor - INFO - 📏 DAG 섹션 길이: 228자
2025-09-17 12:44:48,724 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)
(ZEM폰 포켓몬에디션3:구매)...
2025-09-17 12:44:48,724 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:44:48,724 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:44:48,724 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-17 12:44:48,724 - __main__ - INFO - DAG 내용 미리보기: ['(T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스:사용)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)']...
2025-09-17 12:44:48,724 - __main__ - INFO - 추출 완료: 36.845초
2025-09-17 12:44:48,725 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:48] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:44:48,747 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:44:48] "GET /health HTTP/1.1" 200 -
2025-09-17 12:45:36,428 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:45:36] "GET /health HTTP/1.1" 200 -
2025-09-17 12:45:37,712 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:45:37] "GET /health HTTP/1.1" 200 -
2025-09-17 12:45:37,764 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:45:37] "GET /health HTTP/1.1" 200 -
2025-09-17 12:45:40,921 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:45:40] "GET /health HTTP/1.1" 200 -
2025-09-17 12:45:40,939 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:45:40,939 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:45:40,939 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:45:40,940 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:45:40,940 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:45:40,940 - mms_extractor - INFO - ============================================================
2025-09-17 12:45:40,940 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:45:40,940 - mms_extractor - INFO - ============================================================
2025-09-17 12:45:40,940 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:45:40,940 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:45:40,940 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:45:40,940 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:45:40,940 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:45:40,940 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:45:40,940 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:45:40,940 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:45:40,940 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:45:40,940 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:45:40,940 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:45:40,940 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:45:40,943 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:45:40,947 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:45:40,947 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:45:40,950 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:45:40,950 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:45:40,950 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:45:40,950 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:45:41,066 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:45:41,066 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:45:41,066 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:45:41,066 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:45:41,107 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:45:41,108 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:45:41,108 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:45:41,109 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:45:41,111 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:45:41,111 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:45:41,112 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:45:41,114 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:45:41,114 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:45:41,114 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.17초
2025-09-17 12:45:41,114 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:45:41,114 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:45:41,114 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:45:41,146 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:45:41,146 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:45:41,146 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:45:41,146 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:45:41,146 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:45:41,146 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:45:41,146 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:45:41,146 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:45:41,146 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:45:41,146 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:45:41,146 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:45:41,146 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:45:41,146 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:45:41,146 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:45:41,146 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:45:41,146 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:45:47,618 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:45:47,619 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 12:45:47,619 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 12:45:47,619 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:45:47,620 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:45:47,620 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:45:47,620 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:45:47,620 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:45:47,620 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:45:47,749 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:45:47,749 - mms_extractor - INFO - ============================================================
2025-09-17 12:45:47,749 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:45:47,749 - mms_extractor - INFO - ============================================================
2025-09-17 12:45:47,749 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:45:47,749 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:45:47,749 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:45:47,749 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:45:47,749 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:45:47,750 - mms_extractor - INFO - process_message 실행완료: 6.81초
2025-09-17 12:45:47,750 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:45:47,750 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:45:47,750 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:45:47,750 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:45:47,750 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:45:47,750 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:46:14,582 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:46:14,584 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2962자
2025-09-17 12:46:14,585 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 주요 혜택으로는 기기별 최대 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 서비스가 포함됩니다. 고객은 T world 앱이나 공식 웹사이트...
2025-09-17 12:46:14,585 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:46:14,586 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 254자
2025-09-17 12:46:14,586 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:46:14,586 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 8, 엣지 수: 7
2025-09-17 12:46:14,587 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:접속', '갤럭시 S24:사전예약', '매장:방문', '갤럭시 S24:구매', '할인:수령', '갤럭시 워치6:할인', '무선충전기:수령', '케어플러스:6개월 무료 이용']
2025-09-17 12:46:14,587 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:접속', '갤럭시 S24:사전예약'), ('갤럭시 S24:사전예약', '갤럭시 S24:구매'), ('매장:방문', '갤럭시 S24:사전예약'), ('갤럭시 S24:구매', '할인:수령'), ('갤럭시 S24:구매', '갤럭시 워치6:할인'), ('갤럭시 S24:구매', '무선충전기:수령'), ('갤럭시 S24:구매', '케어플러스:6개월 무료 이용')]
2025-09-17 12:46:14,587 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:46:14,587 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:46:14,588 - utils - INFO - 📊 입력 그래프 - 노드 수: 8, 엣지 수: 7
2025-09-17 12:46:14,589 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:46:14,996 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:46:14,996 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:46:14,996 - mms_extractor - INFO - 🕒 DAG 처리 시간: 27.247초
2025-09-17 12:46:14,996 - mms_extractor - INFO - 📏 DAG 섹션 길이: 254자
2025-09-17 12:46:14,996 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:접속) -[접속하면]-> (갤럭시 S24:사전예약)
(매장:방문) -[방문하면]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)
(갤럭시 S24:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24:구매) -[구매하면]-> (갤럭시 워치6:할인)
(갤럭시 S24:구매) -[구매하면]...
2025-09-17 12:46:14,996 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:46:14,996 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:46:14,996 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 7자
2025-09-17 12:46:14,996 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:접속) -[접속하면]-> (갤럭시 S24:사전예약)', '(갤럭시 S24:구매) -[구매하면]-> (갤럭시 워치6:할인)', '(갤럭시 S24:구매) -[구매하면]-> (무선충전기:수령)', '(갤럭시 S24:구매) -[구매하면]-> (케어플러스:6개월 무료 이용)', '(갤럭시 S24:구매) -[구매하면]-> (할인:수령)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)', '(매장:방문) -[방문하면]-> (갤럭시 S24:사전예약)']...
2025-09-17 12:46:14,996 - __main__ - INFO - 추출 완료: 34.057초
2025-09-17 12:46:14,997 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:46:14] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:46:15,023 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:46:15] "GET /health HTTP/1.1" 200 -
2025-09-17 12:51:03,422 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:51:03] "GET /health HTTP/1.1" 200 -
2025-09-17 12:51:03,435 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:51:03,435 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:51:03,436 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:51:03,436 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:51:03,436 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:51:03,436 - mms_extractor - INFO - ============================================================
2025-09-17 12:51:03,436 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:51:03,436 - mms_extractor - INFO - ============================================================
2025-09-17 12:51:03,436 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:51:03,436 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:51:03,436 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:51:03,436 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:51:03,436 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:51:03,436 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:51:03,436 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:51:03,436 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:51:03,436 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:51:03,436 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:51:03,436 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:51:03,436 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:51:03,439 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:51:03,441 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:51:03,442 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:51:03,443 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:51:03,443 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:51:03,443 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:51:03,443 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:51:27,894 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:51:27,895 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:51:27,896 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:51:27,896 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:51:27,936 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:51:27,936 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:51:27,936 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:51:27,938 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:51:27,939 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:51:27,940 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:51:27,941 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:51:27,943 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:51:27,943 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:51:27,943 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 24.51초
2025-09-17 12:51:27,943 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:51:27,943 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:51:27,943 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:51:27,993 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:51:27,993 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:51:27,993 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:51:27,993 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:51:27,993 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:51:27,993 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:51:27,993 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:51:27,993 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:51:27,993 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:51:27,993 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:51:27,993 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:51:27,993 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:51:27,993 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:51:27,993 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:51:27,993 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:51:27,993 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:51:34,126 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:51:34,127 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 12:51:34,127 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 12:51:34,128 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:51:34,128 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:51:34,128 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:51:34,128 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:51:34,128 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:51:34,128 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:51:34,245 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:51:34,246 - mms_extractor - INFO - ============================================================
2025-09-17 12:51:34,246 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:51:34,246 - mms_extractor - INFO - ============================================================
2025-09-17 12:51:34,246 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:51:34,246 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:51:34,246 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:51:34,246 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:51:34,246 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:51:34,246 - mms_extractor - INFO - process_message 실행완료: 30.81초
2025-09-17 12:51:34,246 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:51:34,246 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:51:34,246 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:51:34,246 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:51:34,246 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:51:34,246 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:51:54,950 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:51:54,950 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2368자
2025-09-17 12:51:54,950 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인과 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱과 온라인 매장 예약 링...
2025-09-17 12:51:54,950 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:51:54,950 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 259자
2025-09-17 12:51:54,951 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:51:54,951 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 8, 엣지 수: 7
2025-09-17 12:51:54,951 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:접속', '갤럭시 S24:사전예약', '온라인 매장:방문', '갤럭시 S24:구매', '할인:수령', '갤럭시 워치6:50% 할인', '무선충전기:수령', '케어플러스:6개월 무료']
2025-09-17 12:51:54,951 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:접속', '갤럭시 S24:사전예약'), ('갤럭시 S24:사전예약', '갤럭시 S24:구매'), ('갤럭시 S24:사전예약', '갤럭시 워치6:50% 할인'), ('갤럭시 S24:사전예약', '무선충전기:수령'), ('갤럭시 S24:사전예약', '케어플러스:6개월 무료'), ('온라인 매장:방문', '갤럭시 S24:사전예약'), ('갤럭시 S24:구매', '할인:수령')]
2025-09-17 12:51:54,951 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:51:54,951 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:51:54,951 - utils - INFO - 📊 입력 그래프 - 노드 수: 8, 엣지 수: 7
2025-09-17 12:51:54,951 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:51:55,177 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:51:55,177 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:51:55,177 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.931초
2025-09-17 12:51:55,177 - mms_extractor - INFO - 📏 DAG 섹션 길이: 259자
2025-09-17 12:51:55,177 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약)
(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[가입하면]-> (갤럭시 S24:구매)
(갤럭시 S24:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24:사전예약) -[가입하면]-> (갤럭시 워치6:50% 할인)
(갤럭시 S24:사전예약) -...
2025-09-17 12:51:55,177 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:51:55,177 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:51:55,177 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 7자
2025-09-17 12:51:55,177 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약)', '(갤럭시 S24:구매) -[구매하면]-> (할인:수령)', '(갤럭시 S24:사전예약) -[가입하면]-> (갤럭시 S24:구매)', '(갤럭시 S24:사전예약) -[가입하면]-> (갤럭시 워치6:50% 할인)', '(갤럭시 S24:사전예약) -[가입하면]-> (무선충전기:수령)', '(갤럭시 S24:사전예약) -[가입하면]-> (케어플러스:6개월 무료)', '(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약)']...
2025-09-17 12:51:55,177 - __main__ - INFO - 추출 완료: 51.742초
2025-09-17 12:51:55,178 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:51:55] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:51:55,205 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:51:55] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:07,861 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:07] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:15,251 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:15] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:15,286 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:15] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:18,237 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:18] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:18,250 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:54:18,250 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:54:18,250 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:54:18,251 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:54:18,251 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:54:18,251 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:18,251 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:54:18,251 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:18,251 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:54:18,251 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:54:18,251 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:54:18,251 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:54:18,251 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-17 12:54:18,251 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:54:18,251 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:54:18,251 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:54:18,251 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:54:18,251 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:54:18,251 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:54:18,251 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:54:18,254 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:54:18,256 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:54:18,257 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:54:18,258 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:54:18,258 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:54:18,258 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:54:18,258 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:54:18,365 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:54:18,365 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:54:18,366 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:54:18,366 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:54:18,408 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:54:18,408 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:54:18,408 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:54:18,410 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:54:18,411 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:54:18,412 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:54:18,413 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:18,414 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:54:18,414 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:54:18,414 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.16초
2025-09-17 12:54:18,414 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:18,414 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:54:18,414 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:54:18,464 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:54:18,464 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:54:18,464 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:54:18,464 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:54:18,464 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:54:18,464 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:18,464 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:54:18,464 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:54:18,465 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:54:18,466 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-09-17 12:54:18,466 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'CU 할인', 'action': '기타'}, {'name': 'GALAXY', 'action': '기타'}]
2025-09-17 12:54:18,466 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:54:18,466 - mms_extractor - INFO - 구성된 프롬프트 길이: 5621 문자
2025-09-17 12:54:18,466 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-17 12:54:18,466 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5621)
2025-09-17 12:54:18,466 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:54:18,466 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:54:24,773 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:24] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:26,452 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:54:26,453 - mms_extractor - INFO - LLM 응답 길이: 1173 문자
2025-09-17 12:54:26,453 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 S24 Ultra",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24+",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24",
            "action": "구매"
        },
        {
            "name": "갤럭시 워치6",
            "action": "구매"
        },
        {
            "name": "무선충전기",
            "a...
2025-09-17 12:54:26,453 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:54:26,454 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:54:26,454 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:54:26,454 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '증정'}, {'name': '케어플러스', 'action': '무료 이용'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '가입'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '가입'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:54:26,454 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:54:26,454 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:54:26,568 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:54:26,568 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:26,568 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:54:26,568 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:26,568 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:54:26,568 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:54:26,568 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:54:26,568 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:54:26,568 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:54:26,568 - mms_extractor - INFO - process_message 실행완료: 8.32초
2025-09-17 12:54:26,568 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:54:26,568 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:54:26,568 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:54:26,569 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:54:26,569 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:54:26,569 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:54:39,602 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:39] "GET /health HTTP/1.1" 200 -
2025-09-17 12:54:39,614 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:54:39,614 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:54:39,614 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:54:39,614 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:54:39,614 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:54:39,614 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:39,614 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:54:39,614 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:39,614 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:54:39,614 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:54:39,614 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:54:39,614 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:54:39,614 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:54:39,614 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:54:39,614 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:54:39,614 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:54:39,614 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:54:39,614 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:54:39,614 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:54:39,614 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:54:39,616 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:54:39,618 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:54:39,619 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:54:39,620 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:54:39,620 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:54:39,620 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:54:39,620 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:54:39,732 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:54:39,732 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:54:39,733 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:54:39,733 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:54:39,773 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:54:39,773 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:54:39,773 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:54:39,775 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:54:39,776 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:54:39,776 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:54:39,777 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:39,779 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:54:39,779 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:54:39,779 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.16초
2025-09-17 12:54:39,779 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:39,779 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:54:39,779 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:54:39,815 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:54:39,815 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:54:39,815 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:54:39,815 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:54:39,815 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:54:39,816 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:54:39,816 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:54:39,816 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:54:39,816 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:54:39,816 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:54:39,816 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:54:39,816 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:54:39,816 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:54:39,816 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:54:39,816 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:54:39,816 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:54:45,899 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:54:45,902 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 12:54:45,902 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 12:54:45,902 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:54:45,903 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:54:45,904 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:54:45,904 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:54:45,905 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:54:45,905 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:54:46,040 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:54:46,040 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:46,040 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:54:46,040 - mms_extractor - INFO - ============================================================
2025-09-17 12:54:46,040 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:54:46,040 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:54:46,040 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:54:46,040 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:54:46,040 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:54:46,040 - mms_extractor - INFO - process_message 실행완료: 6.43초
2025-09-17 12:54:46,040 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:54:46,040 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:54:46,040 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:54:46,040 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:54:46,040 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:54:46,040 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:54:48,849 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:54:48,851 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2552자
2025-09-17 12:54:48,851 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 온라인 매장 예...
2025-09-17 12:54:48,852 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:54:48,852 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 237자
2025-09-17 12:54:48,852 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:54:48,853 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 12:54:48,853 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['예약 채널:접속', '갤럭시 S24:사전예약', '갤럭시 S24:구매', '갤럭시 S24:할인', '갤럭시 워치6:50%할인', '무선충전기:무료증정', '케어플러스:6개월무료']
2025-09-17 12:54:48,853 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('예약 채널:접속', '갤럭시 S24:사전예약'), ('갤럭시 S24:사전예약', '갤럭시 S24:구매'), ('갤럭시 S24:사전예약', '갤럭시 S24:할인'), ('갤럭시 S24:사전예약', '갤럭시 워치6:50%할인'), ('갤럭시 S24:사전예약', '무선충전기:무료증정'), ('갤럭시 S24:사전예약', '케어플러스:6개월무료')]
2025-09-17 12:54:48,853 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:54:48,853 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:54:48,854 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 12:54:48,855 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:54:49,053 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:54:49,054 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:54:49,054 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.485초
2025-09-17 12:54:49,054 - mms_extractor - INFO - 📏 DAG 섹션 길이: 237자
2025-09-17 12:54:49,054 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)
(갤럭...
2025-09-17 12:54:49,054 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:54:49,054 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:54:49,054 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 12:54:49,054 - __main__ - INFO - DAG 내용 미리보기: ['(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월무료)', '(예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)']...
2025-09-17 12:54:49,054 - __main__ - INFO - 추출 완료: 30.803초
2025-09-17 12:54:49,055 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:54:49] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:55:09,014 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:55:09,017 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2686자
2025-09-17 12:55:09,017 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 매장 예약 웹사...
2025-09-17 12:55:09,017 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 235자
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:예약', '갤럭시 S24 시리즈:구매', '매장:방문', '할인:수령', '갤럭시 워치6:50% 할인', '무선충전기:수령', '케어플러스:6개월 무료']
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:예약', '갤럭시 S24 시리즈:구매'), ('갤럭시 S24 시리즈:구매', '할인:수령'), ('갤럭시 S24 시리즈:구매', '갤럭시 워치6:50% 할인'), ('갤럭시 S24 시리즈:구매', '무선충전기:수령'), ('갤럭시 S24 시리즈:구매', '케어플러스:6개월 무료'), ('매장:방문', '갤럭시 S24 시리즈:구매')]
2025-09-17 12:55:09,018 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:55:09,018 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:55:09,019 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 12:55:09,020 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:55:09,253 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:55:09,254 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:55:09,254 - mms_extractor - INFO - 🕒 DAG 처리 시간: 23.213초
2025-09-17 12:55:09,254 - mms_extractor - INFO - 📏 DAG 섹션 길이: 235자
2025-09-17 12:55:09,254 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)
(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)
(갤럭시 S...
2025-09-17 12:55:09,254 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:55:09,254 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:55:09,254 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 12:55:09,254 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (케어플러스:6개월 무료)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)', '(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)']...
2025-09-17 12:55:09,254 - __main__ - INFO - 추출 완료: 29.640초
2025-09-17 12:55:09,254 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:55:09] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:55:09,278 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:55:09] "GET /health HTTP/1.1" 200 -
2025-09-17 12:56:35,631 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:56:35] "GET /health HTTP/1.1" 200 -
2025-09-17 12:56:35,649 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:56:35,650 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:56:35,650 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:56:35,650 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:56:35,650 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:56:35,650 - mms_extractor - INFO - ============================================================
2025-09-17 12:56:35,650 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:56:35,650 - mms_extractor - INFO - ============================================================
2025-09-17 12:56:35,650 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:56:35,650 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:56:35,650 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:56:35,650 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:56:35,650 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:56:35,650 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:56:35,650 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:56:35,650 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:56:35,650 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:56:35,650 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:56:35,650 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:56:35,650 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:56:35,652 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:56:35,655 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:56:35,655 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:56:35,657 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:56:35,657 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:56:35,657 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:56:35,657 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:56:35,788 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:56:35,788 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:56:35,789 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:56:35,789 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:56:35,831 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:56:35,831 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:56:35,831 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:56:35,833 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:56:35,834 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:56:35,835 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:56:35,835 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:56:35,837 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:56:35,837 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:56:35,838 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.19초
2025-09-17 12:56:35,838 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:56:35,838 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:56:35,838 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:56:35,879 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:56:35,879 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:56:35,880 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:56:35,880 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:56:35,880 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:56:35,880 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:56:35,880 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:56:35,880 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:56:35,880 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:56:35,880 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:56:35,880 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:56:35,880 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:56:35,880 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:56:35,880 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:56:35,880 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:56:35,880 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:56:41,847 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:56:41,848 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 12:56:41,848 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 12:56:41,848 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:56:41,849 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:56:41,849 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:56:41,849 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:56:41,849 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:56:41,849 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:56:41,972 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:56:41,972 - mms_extractor - INFO - ============================================================
2025-09-17 12:56:41,972 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:56:41,972 - mms_extractor - INFO - ============================================================
2025-09-17 12:56:41,972 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:56:41,972 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:56:41,972 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:56:41,972 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:56:41,972 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:56:41,972 - mms_extractor - INFO - process_message 실행완료: 6.32초
2025-09-17 12:56:41,972 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:56:41,972 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:56:41,972 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:56:41,972 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:56:41,972 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:56:41,972 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:57:04,128 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:57:04,131 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2552자
2025-09-17 12:57:04,131 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 온라인 매장 예...
2025-09-17 12:57:04,131 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:57:04,131 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 237자
2025-09-17 12:57:04,132 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:57:04,132 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 12:57:04,132 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['예약 채널:접속', '갤럭시 S24:사전예약', '갤럭시 S24:구매', '갤럭시 S24:할인', '갤럭시 워치6:50%할인', '무선충전기:무료증정', '케어플러스:6개월무료']
2025-09-17 12:57:04,132 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('예약 채널:접속', '갤럭시 S24:사전예약'), ('갤럭시 S24:사전예약', '갤럭시 S24:구매'), ('갤럭시 S24:사전예약', '갤럭시 S24:할인'), ('갤럭시 S24:사전예약', '갤럭시 워치6:50%할인'), ('갤럭시 S24:사전예약', '무선충전기:무료증정'), ('갤럭시 S24:사전예약', '케어플러스:6개월무료')]
2025-09-17 12:57:04,132 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:57:04,132 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:57:04,133 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 12:57:04,134 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:57:04,357 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:57:04,357 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:57:04,357 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.385초
2025-09-17 12:57:04,357 - mms_extractor - INFO - 📏 DAG 섹션 길이: 237자
2025-09-17 12:57:04,357 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)
(갤럭...
2025-09-17 12:57:04,357 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:57:04,357 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:57:04,357 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 12:57:04,357 - __main__ - INFO - DAG 내용 미리보기: ['(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월무료)', '(예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)']...
2025-09-17 12:57:04,358 - __main__ - INFO - 추출 완료: 28.708초
2025-09-17 12:57:04,358 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:57:04] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:57:04,380 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:57:04] "GET /health HTTP/1.1" 200 -
2025-09-17 12:58:25,165 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:58:25] "GET /health HTTP/1.1" 200 -
2025-09-17 12:58:29,981 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:58:29] "GET /health HTTP/1.1" 200 -
2025-09-17 12:58:30,018 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:58:30] "GET /health HTTP/1.1" 200 -
2025-09-17 12:58:31,293 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:58:31] "GET /health HTTP/1.1" 200 -
2025-09-17 12:58:31,307 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:58:31,307 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:58:31,307 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:58:31,307 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:58:31,307 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:58:31,307 - mms_extractor - INFO - ============================================================
2025-09-17 12:58:31,308 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:58:31,308 - mms_extractor - INFO - ============================================================
2025-09-17 12:58:31,308 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:58:31,308 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:58:31,308 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:58:31,308 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:58:31,308 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-17 12:58:31,308 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:58:31,308 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:58:31,308 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:58:31,308 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:58:31,308 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:58:31,308 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:58:31,308 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:58:31,310 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:58:31,313 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:58:31,313 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:58:31,314 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:58:31,315 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:58:31,315 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:58:31,315 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:58:31,430 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:58:31,430 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:58:31,431 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:58:31,431 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:58:31,471 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:58:31,472 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:58:31,472 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:58:31,474 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:58:31,475 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:58:31,475 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:58:31,476 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:58:31,478 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:58:31,478 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:58:31,478 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.17초
2025-09-17 12:58:31,478 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:58:31,478 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:58:31,478 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:58:31,519 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:58:31,519 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:58:31,519 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:58:31,519 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:58:31,519 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:58:31,519 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:58:31,519 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:58:31,519 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:58:31,519 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:58:31,520 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-09-17 12:58:31,520 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'CU 할인', 'action': '기타'}, {'name': 'GALAXY', 'action': '기타'}]
2025-09-17 12:58:31,520 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:58:31,520 - mms_extractor - INFO - 구성된 프롬프트 길이: 5621 문자
2025-09-17 12:58:31,520 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-17 12:58:31,520 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5621)
2025-09-17 12:58:31,520 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:58:31,520 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:58:39,142 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:58:39,145 - mms_extractor - INFO - LLM 응답 길이: 1170 문자
2025-09-17 12:58:39,145 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 S24 Ultra",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24+",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24",
            "action": "구매"
        },
        {
            "name": "갤럭시 워치6",
            "action": "구매"
        },
        {
            "name": "무선충전기",
            "a...
2025-09-17 12:58:39,145 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:58:39,146 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:58:39,146 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:58:39,146 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '증정'}, {'name': '케어플러스', 'action': '무료'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '가입'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '가입'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:58:39,146 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:58:39,146 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:58:39,278 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:58:39,278 - mms_extractor - INFO - ============================================================
2025-09-17 12:58:39,278 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:58:39,278 - mms_extractor - INFO - ============================================================
2025-09-17 12:58:39,278 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:58:39,278 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:58:39,279 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:58:39,279 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:58:39,279 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:58:39,279 - mms_extractor - INFO - process_message 실행완료: 7.97초
2025-09-17 12:58:39,279 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:58:39,279 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:58:39,279 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:58:39,279 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:58:39,279 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:58:39,279 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:58:56,182 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:58:56] "GET /health HTTP/1.1" 200 -
2025-09-17 12:59:01,518 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:59:01,520 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2552자
2025-09-17 12:59:01,521 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 온라인 매장 예...
2025-09-17 12:59:01,521 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:59:01,521 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 237자
2025-09-17 12:59:01,521 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:59:01,522 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 12:59:01,522 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['예약 채널:접속', '갤럭시 S24:사전예약', '갤럭시 S24:구매', '갤럭시 S24:할인', '갤럭시 워치6:50%할인', '무선충전기:무료증정', '케어플러스:6개월무료']
2025-09-17 12:59:01,522 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('예약 채널:접속', '갤럭시 S24:사전예약'), ('갤럭시 S24:사전예약', '갤럭시 S24:구매'), ('갤럭시 S24:사전예약', '갤럭시 S24:할인'), ('갤럭시 S24:사전예약', '갤럭시 워치6:50%할인'), ('갤럭시 S24:사전예약', '무선충전기:무료증정'), ('갤럭시 S24:사전예약', '케어플러스:6개월무료')]
2025-09-17 12:59:01,522 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:59:01,522 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:59:01,522 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 12:59:01,523 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:59:01,757 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:59:01,758 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:59:01,758 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.479초
2025-09-17 12:59:01,758 - mms_extractor - INFO - 📏 DAG 섹션 길이: 237자
2025-09-17 12:59:01,758 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)
(갤럭...
2025-09-17 12:59:01,758 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:59:01,758 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:59:01,758 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 12:59:01,758 - __main__ - INFO - DAG 내용 미리보기: ['(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:구매)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 S24:할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월무료)', '(예약 채널:접속) -[통해]-> (갤럭시 S24:사전예약)']...
2025-09-17 12:59:01,758 - __main__ - INFO - 추출 완료: 30.451초
2025-09-17 12:59:01,759 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:01] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:59:05,357 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:05] "GET /health HTTP/1.1" 200 -
2025-09-17 12:59:05,373 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:59:05,374 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:59:05,374 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:59:05,374 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:59:05,374 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:59:05,374 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:05,374 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:59:05,374 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:05,374 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:59:05,374 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:59:05,374 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:59:05,374 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:59:05,374 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:59:05,374 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 12:59:05,374 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:59:05,374 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:59:05,374 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:59:05,374 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:59:05,374 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:59:05,374 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:59:05,377 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:59:05,380 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:59:05,381 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:59:05,382 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:59:05,382 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:59:05,382 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:59:05,382 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:59:05,494 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:59:05,494 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:59:05,495 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:59:05,495 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:59:05,536 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:59:05,537 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:59:05,537 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:59:05,538 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:59:05,539 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:59:05,540 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:59:05,541 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:05,542 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:59:05,543 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:59:05,543 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.17초
2025-09-17 12:59:05,543 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:05,543 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:59:05,543 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:59:05,580 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:59:05,580 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:59:05,580 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:59:05,580 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:59:05,580 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:59:05,580 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:05,580 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:59:05,580 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:59:05,580 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:59:05,580 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:59:05,580 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:59:05,580 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:59:05,580 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:59:05,580 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:59:05,580 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:59:05,580 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 12:59:11,805 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:59:11,809 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 12:59:11,809 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 12:59:11,809 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 12:59:11,810 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 12:59:11,810 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 12:59:11,811 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 12:59:11,811 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 12:59:11,812 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 12:59:11,946 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 12:59:11,947 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:11,947 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 12:59:11,947 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:11,947 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 12:59:11,947 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 12:59:11,947 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 12:59:11,947 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 12:59:11,947 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 12:59:11,947 - mms_extractor - INFO - process_message 실행완료: 6.57초
2025-09-17 12:59:11,947 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 12:59:11,947 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 12:59:11,947 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 12:59:11,947 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 12:59:11,947 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 12:59:11,947 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 12:59:35,019 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 12:59:35,021 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2686자
2025-09-17 12:59:35,022 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 매장 예약 웹사...
2025-09-17 12:59:35,022 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 12:59:35,022 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 235자
2025-09-17 12:59:35,023 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 12:59:35,023 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 12:59:35,024 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:예약', '갤럭시 S24 시리즈:구매', '매장:방문', '할인:수령', '갤럭시 워치6:50% 할인', '무선충전기:수령', '케어플러스:6개월 무료']
2025-09-17 12:59:35,024 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:예약', '갤럭시 S24 시리즈:구매'), ('갤럭시 S24 시리즈:구매', '할인:수령'), ('갤럭시 S24 시리즈:구매', '갤럭시 워치6:50% 할인'), ('갤럭시 S24 시리즈:구매', '무선충전기:수령'), ('갤럭시 S24 시리즈:구매', '케어플러스:6개월 무료'), ('매장:방문', '갤럭시 S24 시리즈:구매')]
2025-09-17 12:59:35,024 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 12:59:35,024 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:59:35,024 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 12:59:35,025 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 12:59:35,258 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 12:59:35,258 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 12:59:35,259 - mms_extractor - INFO - 🕒 DAG 처리 시간: 23.312초
2025-09-17 12:59:35,259 - mms_extractor - INFO - 📏 DAG 섹션 길이: 235자
2025-09-17 12:59:35,259 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)
(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)
(갤럭시 S...
2025-09-17 12:59:35,259 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 12:59:35,259 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 12:59:35,259 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 12:59:35,259 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (케어플러스:6개월 무료)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)', '(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)']...
2025-09-17 12:59:35,259 - __main__ - INFO - 추출 완료: 29.885초
2025-09-17 12:59:35,259 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:35] "POST /extract HTTP/1.1" 200 -
2025-09-17 12:59:35,282 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:35] "GET /health HTTP/1.1" 200 -
2025-09-17 12:59:53,073 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:53] "GET /health HTTP/1.1" 200 -
2025-09-17 12:59:56,896 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 12:59:56] "GET /health HTTP/1.1" 200 -
2025-09-17 12:59:56,908 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-17 12:59:56,908 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 12:59:56,908 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 12:59:56,908 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-17 12:59:56,908 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 12:59:56,908 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:56,908 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 12:59:56,908 - mms_extractor - INFO - ============================================================
2025-09-17 12:59:56,908 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-17 12:59:56,908 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-17 12:59:56,908 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 12:59:56,908 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 12:59:56,908 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 12:59:56,908 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-17 12:59:56,908 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 12:59:56,908 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 12:59:56,908 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 12:59:56,909 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 12:59:56,909 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 12:59:56,909 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-17 12:59:56,910 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 12:59:56,912 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-17 12:59:56,913 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-17 12:59:56,914 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-17 12:59:56,914 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-17 12:59:56,914 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-17 12:59:56,914 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 12:59:57,032 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-17 12:59:57,032 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-17 12:59:57,033 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-17 12:59:57,033 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 12:59:57,073 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-17 12:59:57,074 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-17 12:59:57,074 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 12:59:57,075 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-17 12:59:57,077 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 12:59:57,077 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-17 12:59:57,078 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:57,079 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-17 12:59:57,080 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-17 12:59:57,080 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.17초
2025-09-17 12:59:57,080 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:57,080 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-17 12:59:57,080 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 12:59:57,115 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 12:59:57,115 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 12:59:57,115 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-17 12:59:57,115 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 12:59:57,115 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-17 12:59:57,115 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-17 12:59:57,115 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-17 12:59:57,115 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 12:59:57,115 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 12:59:57,115 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 12:59:57,115 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 12:59:57,115 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-17 12:59:57,115 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 12:59:57,115 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-17 12:59:57,115 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 12:59:57,115 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 13:00:03,127 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 13:00:03,131 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-17 13:00:03,132 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-17 13:00:03,132 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 13:00:03,134 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 13:00:03,134 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 13:00:03,134 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-17 13:00:03,135 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 13:00:03,135 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-17 13:00:03,459 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-17 13:00:03,459 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 21696)
2025-09-17 13:00:03,459 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-17 13:00:03,459 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-17 13:00:04,344 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 13:00:04,492 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.36초
2025-09-17 13:00:04,495 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 13:00:04,495 - mms_extractor - INFO - ============================================================
2025-09-17 13:00:04,495 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 13:00:04,495 - mms_extractor - INFO - ============================================================
2025-09-17 13:00:04,495 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-17 13:00:04,495 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-17 13:00:04,495 - mms_extractor - INFO - 상품 수: 6개
2025-09-17 13:00:04,495 - mms_extractor - INFO - 채널 수: 4개
2025-09-17 13:00:04,495 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 13:00:04,495 - mms_extractor - INFO - process_message 실행완료: 7.59초
2025-09-17 13:00:04,495 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 13:00:04,495 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 13:00:04,495 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-17 13:00:04,496 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x12767a8d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x12767ac30> root_client=<openai.OpenAI object at 0x127692140> root_async_client=<openai.AsyncOpenAI object at 0x12767a9f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 13:00:04,496 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 13:00:04,496 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-17 13:00:27,497 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 13:00:27,500 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2686자
2025-09-17 13:00:27,500 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 매장 예약 웹사...
2025-09-17 13:00:27,500 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 13:00:27,501 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 235자
2025-09-17 13:00:27,501 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 13:00:27,501 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-17 13:00:27,502 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:예약', '갤럭시 S24 시리즈:구매', '매장:방문', '할인:수령', '갤럭시 워치6:50% 할인', '무선충전기:수령', '케어플러스:6개월 무료']
2025-09-17 13:00:27,502 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:예약', '갤럭시 S24 시리즈:구매'), ('갤럭시 S24 시리즈:구매', '할인:수령'), ('갤럭시 S24 시리즈:구매', '갤럭시 워치6:50% 할인'), ('갤럭시 S24 시리즈:구매', '무선충전기:수령'), ('갤럭시 S24 시리즈:구매', '케어플러스:6개월 무료'), ('매장:방문', '갤럭시 S24 시리즈:구매')]
2025-09-17 13:00:27,502 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 13:00:27,502 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 13:00:27,502 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-17 13:00:27,504 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 13:00:27,765 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-17 13:00:27,765 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-17 13:00:27,765 - mms_extractor - INFO - 🕒 DAG 처리 시간: 23.270초
2025-09-17 13:00:27,765 - mms_extractor - INFO - 📏 DAG 섹션 길이: 235자
2025-09-17 13:00:27,765 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)
(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)
(갤럭시 S...
2025-09-17 13:00:27,765 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 13:00:27,765 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-17 13:00:27,765 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-17 13:00:27,765 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:50% 할인)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (케어플러스:6개월 무료)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)', '(매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)']...
2025-09-17 13:00:27,765 - __main__ - INFO - 추출 완료: 30.857초
2025-09-17 13:00:27,766 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 13:00:27] "POST /extract HTTP/1.1" 200 -
2025-09-17 13:00:27,792 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 13:00:27] "GET /health HTTP/1.1" 200 -
2025-09-17 16:48:06,430 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-17 16:48:06,430 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-17 16:48:06,430 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-17 16:48:06,430 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-17 16:48:06,430 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-17 16:48:06,430 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-17 16:48:06,430 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-17 16:48:06,431 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-17 16:48:06,451 - mms_extractor - INFO - Using device: mps
2025-09-17 16:48:06,451 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-17 16:48:06,451 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-17 16:48:06,451 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-17 16:48:06,451 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-17 16:48:06,451 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-17 16:48:06,451 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-17 16:48:06,451 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-17 16:48:06,451 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-17 16:48:07,309 - mms_extractor - INFO - Model loaded on mps
2025-09-17 16:48:07,310 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-09-17 16:48:07,310 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-17 16:48:07,760 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-17 16:48:07,760 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.45초
2025-09-17 16:48:07,760 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-17 16:48:07,760 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:07,760 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-17 16:48:07,760 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:07,760 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-17 16:48:07,760 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-17 16:48:07,760 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-17 16:48:07,760 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-17 16:48:07,760 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 16:48:07,825 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-17 16:48:07,825 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 16:48:07,825 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-17 16:48:07,829 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-17 16:48:07,830 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-17 16:48:07,830 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 16:48:07,831 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 16:48:07,831 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-17 16:48:07,831 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-17 16:48:07,833 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-17 16:48:07,835 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-17 16:48:07,835 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-17 16:48:07,835 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 16:48:07,835 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-17 16:48:07,835 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-17 16:48:07,835 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-17 16:48:07,835 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 16:48:07,835 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-17 16:48:07,835 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-17 16:48:07,835 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-17 16:48:07,836 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-17 16:48:07,837 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-17 16:48:07,837 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 16:48:07,837 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-17 16:48:07,837 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 16:48:07,968 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-17 16:48:07,973 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-17 16:48:07,974 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-17 16:48:07,974 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-17 16:48:07,974 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-17 16:48:07,974 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-17 16:48:07,975 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-17 16:48:07,975 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-17 16:48:07,975 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-17 16:48:07,975 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-17 16:48:07,977 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-17 16:48:07,978 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-17 16:48:07,978 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-17 16:48:07,990 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-17 16:48:07,990 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-17 16:48:07,990 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-17 16:48:07,991 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-17 16:48:07,991 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-17 16:48:08,123 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-17 16:48:08,123 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-17 16:48:08,123 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-17 16:48:08,123 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-17 16:48:08,123 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-17 16:48:08,123 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 16:48:08,190 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-17 16:48:08,190 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 16:48:08,191 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-17 16:48:08,192 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-17 16:48:08,192 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-17 16:48:08,192 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 16:48:08,192 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-17 16:48:08,192 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-17 16:48:08,192 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:08,192 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-17 16:48:08,192 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:08,192 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-17 16:48:08,192 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-17 16:48:08,192 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-17 16:48:08,192 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-17 16:48:08,192 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-17 16:48:08,194 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-17 16:48:08,196 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-17 16:48:08,196 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-17 16:48:08,196 - mms_extractor - INFO - _load_data 실행완료: 0.44초
2025-09-17 16:48:08,196 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-17 16:48:08,197 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-17 16:48:08,197 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-17 16:48:08,197 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-17 16:48:08,197 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-17 16:48:08,197 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-17 16:48:08,197 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-17 16:48:08,197 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-17 16:48:08,197 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-17 16:48:08,197 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-17 16:48:08,197 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-17 16:48:08,225 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.54:8000
2025-09-17 16:48:08,225 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-17 16:48:18,657 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:48:18] "GET /health HTTP/1.1" 200 -
2025-09-17 16:48:39,732 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:48:39] "GET /health HTTP/1.1" 200 -
2025-09-17 16:48:41,288 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:48:41] "GET /health HTTP/1.1" 200 -
2025-09-17 16:48:49,930 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:48:49] "GET /health HTTP/1.1" 200 -
2025-09-17 16:48:49,946 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 412자
2025-09-17 16:48:49,947 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-17 16:48:49,947 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-17 16:48:49,947 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜...
2025-09-17 16:48:49,947 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-17 16:48:49,947 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:49,947 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-17 16:48:49,947 - mms_extractor - INFO - ============================================================
2025-09-17 16:48:49,947 - mms_extractor - INFO - 메시지 내용: [Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV 가...
2025-09-17 16:48:49,947 - mms_extractor - INFO - 메시지 길이: 412 문자
2025-09-17 16:48:49,947 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-17 16:48:49,947 - mms_extractor - INFO - 데이터 소스: local
2025-09-17 16:48:49,947 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-17 16:48:49,947 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-17 16:48:49,947 - mms_extractor - INFO - LLM 모델: ax
2025-09-17 16:48:49,947 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-17 16:48:49,947 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-17 16:48:49,947 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-17 16:48:49,947 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-17 16:48:49,947 - mms_extractor - INFO - 처리할 메시지 길이: 407 문자
2025-09-17 16:48:49,949 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-17 16:48:50,419 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-17 16:48:50,419 - mms_extractor - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-17 16:48:50,423 - mms_extractor - INFO - 전체 토큰 수: 155개
2025-09-17 16:48:50,423 - mms_extractor - INFO - NNP 태그 토큰들: ['을지로', '구매하', '갤럭시', 'A', '기기값', '아이폰', '을지로입구역', '하나은행', '명동']
2025-09-17 16:48:50,423 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['하나은행', '구매하', '명동', '을지로입구역', '기기값', '아이폰', '갤럭시']
2025-09-17 16:48:50,423 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-17 16:48:56,943 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1047, 3)
2025-09-17 16:48:56,943 - mms_extractor - INFO - 퍼지 매칭 성공: 1047개 결과
2025-09-17 16:48:56,944 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-17 16:48:56,944 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-17 16:48:56,972 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1047, 3)
2025-09-17 16:48:56,973 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-17 16:48:56,973 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-17 16:48:56,974 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 1개
2025-09-17 16:48:56,976 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-17 16:48:56,976 - mms_extractor - INFO - 통합된 후보 아이템 수: 2개
2025-09-17 16:48:56,978 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시']
2025-09-17 16:48:56,979 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (1, 2)
2025-09-17 16:48:56,979 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 16:48:56,979 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.03초
2025-09-17 16:48:56,979 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시']
2025-09-17 16:48:56,979 - mms_extractor - INFO - 매칭된 상품 정보: (1, 2)
2025-09-17 16:48:56,979 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-17 16:48:57,245 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-17 16:48:57,245 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-17 16:48:57,245 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-17 16:48:57,245 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-17 16:48:57,245 - mms_extractor - INFO - 후보 아이템 리스트 크기: 1개
2025-09-17 16:48:57,245 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시']
2025-09-17 16:48:57,245 - mms_extractor - INFO - extra_item_pdf 크기: (1, 2)
2025-09-17 16:48:57,245 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-17 16:48:57,245 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-17 16:48:57,245 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-17 16:48:57,245 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-17 16:48:57,245 - mms_extractor - INFO - 구성된 프롬프트 길이: 6230 문자
2025-09-17 16:48:57,245 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-17 16:48:57,246 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6230)
2025-09-17 16:48:57,246 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-17 16:48:57,246 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-17 16:49:12,938 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 16:49:12,955 - mms_extractor - INFO - LLM 응답 길이: 864 문자
2025-09-17 16:49:12,955 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "대리점/매장 방문 유도",
        "혜택 안내",
        "웹/앱 접속 유도"
    ],
    "product": [
        {"name": "갤럭시 와이드8", "action": "구매"},
        {"name": "갤럭시 A36", "action": "구매"},
        {"name": "갤럭시 S24 FE", "action": "구매"},
        {"name": "아이폰17", "action": "구매"},
        {"name": "인터넷+TV", "action": "가입"}
    ],
    "channel": [
        {"type": "URL", "value": "https://naver.me/FTM8rdfj", "action": "추가 정보...
2025-09-17 16:49:12,956 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-17 16:49:12,956 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-17 16:49:12,956 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-17 16:49:12,956 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내', '웹/앱 접속 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': '갤럭시 S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '구매'}, {'name': '인터넷+TV', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-17 16:49:12,956 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-17 16:49:12,956 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', '갤럭시 S24 FE', '아이폰17', '인터넷+TV']
2025-09-17 16:49:13,086 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-17 16:49:13,086 - mms_extractor - INFO - ============================================================
2025-09-17 16:49:13,086 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-17 16:49:13,086 - mms_extractor - INFO - ============================================================
2025-09-17 16:49:13,086 - mms_extractor - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-17 16:49:13,086 - mms_extractor - INFO - 목적: ['상품 가입 유도', '대리점/매장 방문 유도', '혜택 안내', '웹/앱 접속 유도']
2025-09-17 16:49:13,086 - mms_extractor - INFO - 상품 수: 3개
2025-09-17 16:49:13,086 - mms_extractor - INFO - 채널 수: 5개
2025-09-17 16:49:13,086 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-17 16:49:13,086 - mms_extractor - INFO - process_message 실행완료: 23.14초
2025-09-17 16:49:13,086 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-17 16:49:13,086 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-17 16:49:13,086 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 412자
2025-09-17 16:49:13,086 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1268d6c30> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1268d6f90> root_client=<openai.OpenAI object at 0x126ac2360> root_async_client=<openai.AsyncOpenAI object at 0x1268d6d50> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-17 16:49:13,086 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-17 16:49:13,086 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3397자
2025-09-17 16:50:02,577 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-17 16:50:02,581 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 3140자
2025-09-17 16:50:02,581 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT 을지로점에서 9월 중 갤럭시 시리즈와 아이폰17에 대한 특별 할인 및 혜택을 제공하며, SK로 통신사 이동 시 추가 혜택을 안내함. 매장 방문과 온라인 사전예약을 통해 기기 구매 및 통신사 이동을 유도하고 있음.

[식별된 가치 제안 목록]
- 갤럭시 시리즈(와이드8, A36, S24 F...
2025-09-17 16:50:02,581 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-17 16:50:02,582 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 300자
2025-09-17 16:50:02,582 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-17 16:50:02,584 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 12, 엣지 수: 10
2025-09-17 16:50:02,584 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['을지로점:방문', '갤럭시:구매', '기기값할인:수령', '제휴카드:사용', '추가할인:수령', '통신사:이동', '상품권:수령', '인터넷TV:가입', '현금지원:수령', '온라인링크:접속', '아이폰17:사전예약', '바로개통:사용']
2025-09-17 16:50:02,585 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('을지로점:방문', '갤럭시:구매'), ('을지로점:방문', '통신사:이동'), ('갤럭시:구매', '기기값할인:수령'), ('갤럭시:구매', '제휴카드:사용'), ('제휴카드:사용', '추가할인:수령'), ('통신사:이동', '상품권:수령'), ('통신사:이동', '인터넷TV:가입'), ('인터넷TV:가입', '현금지원:수령'), ('온라인링크:접속', '아이폰17:사전예약'), ('아이폰17:사전예약', '바로개통:사용')]
2025-09-17 16:50:02,585 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-17 16:50:02,585 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_b4ca92cd89f98ddb5e435b081ef0da3f1a1ff16088b4c43567e6fce62e20837a
2025-09-17 16:50:02,585 - utils - INFO - 📊 입력 그래프 - 노드 수: 12, 엣지 수: 10
2025-09-17 16:50:02,587 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-17 16:50:02,835 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_b4ca92cd89f98ddb5e435b081ef0da3f1a1ff16088b4c43567e6fce62e20837a.png
2025-09-17 16:50:02,835 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_b4ca92cd89f98ddb5e435b081ef0da3f1a1ff16088b4c43567e6fce62e20837a
2025-09-17 16:50:02,835 - mms_extractor - INFO - 🕒 DAG 처리 시간: 49.749초
2025-09-17 16:50:02,835 - mms_extractor - INFO - 📏 DAG 섹션 길이: 300자
2025-09-17 16:50:02,835 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (을지로점:방문) -[방문하면]-> (갤럭시:구매)
(갤럭시:구매) -[구매하면]-> (기기값할인:수령)
(갤럭시:구매) -[구매시]-> (제휴카드:사용)
(제휴카드:사용) -[사용하면]-> (추가할인:수령)
(을지로점:방문) -[방문하면]-> (통신사:이동)
(통신사:이동) -[이동하면]-> (상품권:수령)
(통신사:이동) -[이동후]-> (인터넷TV:가...
2025-09-17 16:50:02,835 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-17 16:50:02,835 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-17 16:50:02,835 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 10자
2025-09-17 16:50:02,835 - __main__ - INFO - DAG 내용 미리보기: ['(갤럭시:구매) -[구매시]-> (제휴카드:사용)', '(갤럭시:구매) -[구매하면]-> (기기값할인:수령)', '(아이폰17:사전예약) -[예약하면]-> (바로개통:사용)', '(온라인링크:접속) -[접속하면]-> (아이폰17:사전예약)', '(을지로점:방문) -[방문하면]-> (갤럭시:구매)', '(을지로점:방문) -[방문하면]-> (통신사:이동)', '(인터넷TV:가입) -[가입하면]-> (현금지원:수령)', '(제휴카드:사용) -[사용하면]-> (추가할인:수령)', '(통신사:이동) -[이동하면]-> (상품권:수령)', '(통신사:이동) -[이동후]-> (인터넷TV:가입)']...
2025-09-17 16:50:02,835 - __main__ - INFO - 추출 완료: 72.888초
2025-09-17 16:50:02,836 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:50:02] "POST /extract HTTP/1.1" 200 -
2025-09-17 16:50:02,860 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 16:50:02] "GET /health HTTP/1.1" 200 -
2025-09-17 17:33:31,916 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-17 17:33:31,916 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-17 17:33:31,916 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-17 17:33:31,916 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-17 17:33:31,916 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-17 17:33:31,916 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-17 17:33:31,916 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-17 17:33:31,917 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-17 17:33:31,939 - mms_extractor - INFO - Using device: mps
2025-09-17 17:33:31,939 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-17 17:33:31,939 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-17 17:33:31,939 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-17 17:33:31,939 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-17 17:33:31,939 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-17 17:33:31,939 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-17 17:33:31,940 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-17 17:33:31,940 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-17 17:33:33,074 - mms_extractor - INFO - Model loaded on mps
2025-09-17 17:33:33,074 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.13초
2025-09-17 17:33:33,074 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-17 17:33:33,542 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-17 17:33:33,542 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-17 17:33:33,542 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-17 17:33:33,542 - mms_extractor - INFO - ============================================================
2025-09-17 17:33:33,542 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-17 17:33:33,542 - mms_extractor - INFO - ============================================================
2025-09-17 17:33:33,543 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-17 17:33:33,543 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-17 17:33:33,543 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-17 17:33:33,543 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-17 17:33:33,543 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 17:33:33,621 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-17 17:33:33,621 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 17:33:33,621 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-17 17:33:33,625 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-17 17:33:33,626 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-17 17:33:33,627 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:33:33,627 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:33:33,628 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-17 17:33:33,628 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-17 17:33:33,629 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-17 17:33:33,632 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-17 17:33:33,632 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-17 17:33:33,632 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:33:33,632 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-17 17:33:33,632 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-17 17:33:33,632 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-17 17:33:33,632 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:33:33,632 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-17 17:33:33,632 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-17 17:33:33,632 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-17 17:33:33,635 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-17 17:33:33,635 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-17 17:33:33,635 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:33:33,635 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-17 17:33:33,636 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:33:33,774 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-17 17:33:33,778 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-17 17:33:33,778 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-17 17:33:33,778 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-17 17:33:33,779 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-17 17:33:33,779 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-17 17:33:33,780 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-17 17:33:33,780 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-17 17:33:33,780 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-17 17:33:33,780 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-17 17:33:33,782 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-17 17:33:33,783 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-17 17:33:33,783 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-17 17:33:33,795 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-17 17:33:33,795 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-17 17:33:33,795 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-17 17:33:33,797 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-17 17:33:33,797 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-17 17:33:33,941 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-17 17:33:33,941 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-17 17:33:33,941 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-17 17:33:33,941 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-17 17:33:33,941 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-17 17:33:33,941 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 17:33:34,009 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-17 17:33:34,009 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 17:33:34,011 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-17 17:33:34,011 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-17 17:33:34,011 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-17 17:33:34,011 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:33:34,011 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-17 17:33:34,011 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-17 17:33:34,012 - mms_extractor - INFO - ============================================================
2025-09-17 17:33:34,012 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-17 17:33:34,012 - mms_extractor - INFO - ============================================================
2025-09-17 17:33:34,012 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-17 17:33:34,012 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-17 17:33:34,012 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-17 17:33:34,012 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-17 17:33:34,012 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-17 17:33:34,013 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-17 17:33:34,015 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-17 17:33:34,016 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-17 17:33:34,016 - mms_extractor - INFO - _load_data 실행완료: 0.47초
2025-09-17 17:33:34,016 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-17 17:33:34,016 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-17 17:33:34,016 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-17 17:33:34,016 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-17 17:33:34,016 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-17 17:33:34,016 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-17 17:33:34,016 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-17 17:33:34,016 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-17 17:33:34,016 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-17 17:33:34,016 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-17 17:33:34,016 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-17 17:33:34,037 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.54:8000
2025-09-17 17:33:34,037 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-17 17:38:19,643 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-17 17:38:19,643 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-17 17:38:19,643 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-17 17:38:19,643 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-17 17:38:19,643 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-17 17:38:19,643 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-17 17:38:19,643 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-17 17:38:19,644 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-17 17:38:19,662 - mms_extractor - INFO - Using device: mps
2025-09-17 17:38:19,662 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-17 17:38:19,662 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-17 17:38:19,662 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-17 17:38:19,662 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-17 17:38:19,662 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-17 17:38:19,662 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-17 17:38:19,662 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-17 17:38:19,662 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-17 17:38:20,774 - mms_extractor - INFO - Model loaded on mps
2025-09-17 17:38:20,774 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.11초
2025-09-17 17:38:20,774 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-17 17:38:21,242 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-17 17:38:21,242 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-17 17:38:21,242 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-17 17:38:21,242 - mms_extractor - INFO - ============================================================
2025-09-17 17:38:21,242 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-17 17:38:21,242 - mms_extractor - INFO - ============================================================
2025-09-17 17:38:21,242 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-17 17:38:21,242 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-17 17:38:21,242 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-17 17:38:21,242 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-17 17:38:21,242 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 17:38:21,310 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-17 17:38:21,310 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 17:38:21,310 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-17 17:38:21,314 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-17 17:38:21,314 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-17 17:38:21,315 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:38:21,315 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:38:21,316 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-17 17:38:21,316 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-17 17:38:21,317 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-17 17:38:21,318 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-17 17:38:21,318 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-17 17:38:21,318 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:38:21,319 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-17 17:38:21,319 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-17 17:38:21,319 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-17 17:38:21,319 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:38:21,319 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-17 17:38:21,319 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-17 17:38:21,319 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-17 17:38:21,320 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-17 17:38:21,320 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-17 17:38:21,320 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:38:21,320 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-17 17:38:21,321 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-17 17:38:21,454 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-17 17:38:21,459 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-17 17:38:21,459 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-17 17:38:21,459 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-17 17:38:21,459 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-17 17:38:21,459 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-17 17:38:21,460 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-17 17:38:21,460 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-17 17:38:21,460 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-17 17:38:21,460 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-17 17:38:21,462 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-17 17:38:21,463 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-17 17:38:21,463 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-17 17:38:21,476 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-17 17:38:21,476 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-17 17:38:21,476 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-17 17:38:21,477 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-17 17:38:21,477 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-17 17:38:21,655 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-17 17:38:21,656 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-17 17:38:21,656 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-17 17:38:21,656 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-17 17:38:21,656 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-17 17:38:21,656 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-17 17:38:21,726 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-17 17:38:21,726 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-17 17:38:21,728 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-17 17:38:21,728 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-17 17:38:21,728 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-17 17:38:21,728 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-17 17:38:21,728 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-17 17:38:21,729 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-17 17:38:21,729 - mms_extractor - INFO - ============================================================
2025-09-17 17:38:21,729 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-17 17:38:21,729 - mms_extractor - INFO - ============================================================
2025-09-17 17:38:21,729 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-17 17:38:21,729 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-17 17:38:21,729 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-17 17:38:21,729 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-17 17:38:21,729 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-17 17:38:21,730 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-17 17:38:21,732 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-17 17:38:21,733 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-17 17:38:21,733 - mms_extractor - INFO - _load_data 실행완료: 0.49초
2025-09-17 17:38:21,733 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-17 17:38:21,733 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-17 17:38:21,733 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-17 17:38:21,733 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-17 17:38:21,733 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-17 17:38:21,733 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-17 17:38:21,733 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-17 17:38:21,733 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-17 17:38:21,733 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-17 17:38:21,734 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-17 17:38:21,734 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-17 17:38:21,743 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.54:8000
2025-09-17 17:38:21,743 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-17 17:38:28,535 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 17:38:28] "GET /health HTTP/1.1" 200 -
2025-09-17 17:38:29,686 - werkzeug - INFO - 127.0.0.1 - - [17/Sep/2025 17:38:29] "GET /health HTTP/1.1" 200 -
2025-09-18 15:36:23,140 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 15:36:23,140 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 15:36:23,140 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 15:36:23,140 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 15:36:23,140 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 15:36:23,140 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 15:36:23,140 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 15:36:23,142 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 15:36:23,164 - mms_extractor - INFO - Using device: mps
2025-09-18 15:36:23,164 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 15:36:23,164 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 15:36:23,164 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 15:36:23,164 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 15:36:23,164 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 15:36:23,164 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 15:36:23,165 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 15:36:23,165 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 15:36:30,679 - mms_extractor - INFO - Model loaded on mps
2025-09-18 15:36:30,680 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 7.52초
2025-09-18 15:36:30,680 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 15:36:31,550 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 15:36:31,550 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.87초
2025-09-18 15:36:31,550 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 15:36:31,550 - mms_extractor - INFO - ============================================================
2025-09-18 15:36:31,551 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 15:36:31,551 - mms_extractor - INFO - ============================================================
2025-09-18 15:36:31,551 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 15:36:31,551 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 15:36:31,551 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 15:36:31,551 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 15:36:31,551 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 15:36:31,621 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 15:36:31,621 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 15:36:31,621 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 15:36:31,625 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 15:36:31,625 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 15:36:31,626 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 15:36:31,626 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 15:36:31,627 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 15:36:31,627 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 15:36:31,635 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 15:36:31,637 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 15:36:31,637 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 15:36:31,637 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 15:36:31,637 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 15:36:31,637 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 15:36:31,638 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 15:36:31,638 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 15:36:31,638 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 15:36:31,638 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 15:36:31,638 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 15:36:31,644 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 15:36:31,645 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 15:36:31,645 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 15:36:31,645 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 15:36:31,645 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 15:36:31,769 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 15:36:31,774 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 15:36:31,775 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-18 15:36:31,775 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 15:36:31,775 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 15:36:31,775 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 15:36:31,776 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 15:36:31,776 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 15:36:31,777 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 15:36:31,777 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 15:36:31,778 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 15:36:31,779 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 15:36:31,779 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-18 15:36:31,793 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 15:36:31,793 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 15:36:31,793 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 15:36:31,804 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 15:36:31,804 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 15:36:32,039 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 15:36:32,039 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 15:36:32,039 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 15:36:32,039 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 15:36:32,039 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 15:36:32,039 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 15:36:32,104 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 15:36:32,104 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 15:36:32,106 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 15:36:32,107 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 15:36:32,107 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 15:36:32,107 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 15:36:32,107 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 15:36:32,107 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 15:36:32,107 - mms_extractor - INFO - ============================================================
2025-09-18 15:36:32,107 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 15:36:32,107 - mms_extractor - INFO - ============================================================
2025-09-18 15:36:32,107 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 15:36:32,107 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 15:36:32,107 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 15:36:32,107 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 15:36:32,107 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 15:36:32,109 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 15:36:32,111 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 15:36:32,112 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 15:36:32,112 - mms_extractor - INFO - _load_data 실행완료: 0.56초
2025-09-18 15:36:32,112 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 15:36:32,112 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 15:36:32,112 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 15:36:32,112 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 15:36:32,112 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 15:36:32,112 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 15:36:32,112 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 15:36:32,112 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 15:36:32,112 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 15:36:32,112 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 15:36:32,112 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 15:36:32,135 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 15:36:32,135 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 15:36:47,284 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:36:47] "GET /health HTTP/1.1" 200 -
2025-09-18 15:36:49,882 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:36:49] "GET /health HTTP/1.1" 200 -
2025-09-18 15:36:49,924 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:36:49] "GET /health HTTP/1.1" 200 -
2025-09-18 15:36:54,227 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:36:54] "GET /health HTTP/1.1" 200 -
2025-09-18 15:36:57,133 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:36:57] "GET /health HTTP/1.1" 200 -
2025-09-18 15:37:02,103 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:37:02] "GET /health HTTP/1.1" 200 -
2025-09-18 15:37:02,121 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 15:37:02,122 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 15:37:02,122 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 15:37:02,122 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 15:37:02,122 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 15:37:02,122 - mms_extractor - INFO - ============================================================
2025-09-18 15:37:02,122 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 15:37:02,122 - mms_extractor - INFO - ============================================================
2025-09-18 15:37:02,122 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 15:37:02,122 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 15:37:02,122 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 15:37:02,122 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 15:37:02,122 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 15:37:02,122 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 15:37:02,123 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 15:37:02,123 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 15:37:02,123 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 15:37:02,123 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 15:37:02,123 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 15:37:02,123 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 15:37:02,126 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 15:37:02,612 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 15:37:02,612 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 15:37:02,615 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 15:37:02,615 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 15:37:02,615 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-18 15:37:02,615 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 15:37:09,778 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 15:37:09,778 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 15:37:09,779 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 15:37:09,779 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 15:37:09,883 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 15:37:09,884 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 15:37:09,884 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 15:37:09,891 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 15:37:09,894 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 15:37:09,895 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 15:37:09,901 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 15:37:09,906 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 15:37:09,906 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 15:37:09,906 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.78초
2025-09-18 15:37:09,906 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 15:37:09,907 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 15:37:09,907 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 15:37:10,214 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 15:37:10,214 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 15:37:10,214 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 15:37:10,214 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 15:37:10,214 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 15:37:10,214 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 15:37:10,214 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 15:37:10,214 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 15:37:10,215 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 15:37:10,215 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-18 15:37:10,215 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 15:37:10,215 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-18 15:37:10,215 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-18 15:37:10,215 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-18 15:37:10,215 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 15:37:10,215 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 15:37:17,246 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 15:37:17,261 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-18 15:37:17,262 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-18 15:37:17,262 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 15:37:17,262 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 15:37:17,263 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 15:37:17,263 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 15:37:17,263 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 15:37:17,263 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 15:37:18,219 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 15:37:18,219 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-18 15:37:18,220 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 15:37:18,220 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 15:37:20,905 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 15:37:21,060 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 3.80초
2025-09-18 15:37:21,064 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 15:37:21,064 - mms_extractor - INFO - ============================================================
2025-09-18 15:37:21,064 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 15:37:21,064 - mms_extractor - INFO - ============================================================
2025-09-18 15:37:21,064 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 15:37:21,064 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 15:37:21,064 - mms_extractor - INFO - 상품 수: 5개
2025-09-18 15:37:21,064 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 15:37:21,064 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 15:37:21,064 - mms_extractor - INFO - process_message 실행완료: 18.94초
2025-09-18 15:37:21,064 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 15:37:21,064 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 15:37:21,064 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 15:37:21,064 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x348ab94c0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x3549de0f0> root_client=<openai.OpenAI object at 0x348a13c80> root_async_client=<openai.AsyncOpenAI object at 0x348ab8530> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 15:37:21,064 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 15:37:21,065 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 15:37:43,664 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 15:37:43,667 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2340자
2025-09-18 15:37:43,668 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-18 15:37:43,668 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 15:37:43,669 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 217자
2025-09-18 15:37:43,669 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 15:37:43,670 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-18 15:37:43,670 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['우주패스 Netflix:가입', '2개월 할인 쿠폰:수령', '월 9900원:결제', '넷플릭스 광고형 스탠다드:사용', '웨이브 콘텐츠 팩:사용', '넷플릭스 스탠다드/프리미엄:구매']
2025-09-18 15:37:43,671 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('우주패스 Netflix:가입', '2개월 할인 쿠폰:수령'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:사용'), ('우주패스 Netflix:가입', '넷플릭스 스탠다드/프리미엄:구매'), ('2개월 할인 쿠폰:수령', '월 9900원:결제')]
2025-09-18 15:37:43,672 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 15:37:43,673 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 15:37:43,673 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-18 15:37:43,675 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 15:37:44,316 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 15:37:44,316 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 15:37:44,316 - mms_extractor - INFO - 🕒 DAG 처리 시간: 23.252초
2025-09-18 15:37:44,316 - mms_extractor - INFO - 📏 DAG 섹션 길이: 217자
2025-09-18 15:37:44,316 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (우주패스 Netflix:가입) -[가입하면]-> (2개월 할인 쿠폰:수령)
(2개월 할인 쿠폰:수령) -[사용하면]-> (월 9900원:결제)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)
(우주패스 Netflix:가입) -[가입후]-> (넷...
2025-09-18 15:37:44,317 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 15:37:44,317 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 15:37:44,317 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-18 15:37:44,317 - __main__ - INFO - DAG 내용 미리보기: ['(2개월 할인 쿠폰:수령) -[사용하면]-> (월 9900원:결제)', '(우주패스 Netflix:가입) -[가입하면]-> (2개월 할인 쿠폰:수령)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)', '(우주패스 Netflix:가입) -[가입후]-> (넷플릭스 스탠다드/프리미엄:구매)']...
2025-09-18 15:37:44,317 - __main__ - INFO - 추출 완료: 42.195초
2025-09-18 15:37:44,318 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:37:44] "POST /extract HTTP/1.1" 200 -
2025-09-18 15:37:44,350 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 15:37:44] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:27,654 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 16:19:27,654 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 16:19:27,654 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 16:19:27,654 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 16:19:27,654 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 16:19:27,654 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 16:19:27,654 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 16:19:27,655 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 16:19:27,674 - mms_extractor - INFO - Using device: mps
2025-09-18 16:19:27,674 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 16:19:27,674 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 16:19:27,674 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 16:19:27,674 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 16:19:27,674 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 16:19:27,674 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 16:19:27,675 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 16:19:27,675 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 16:19:28,499 - mms_extractor - INFO - Model loaded on mps
2025-09-18 16:19:28,499 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.82초
2025-09-18 16:19:28,499 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 16:19:28,899 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 16:19:28,899 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.40초
2025-09-18 16:19:28,899 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 16:19:28,899 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:28,899 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 16:19:28,899 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:28,899 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 16:19:28,899 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 16:19:28,900 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 16:19:28,900 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 16:19:28,900 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 16:19:28,964 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 16:19:28,964 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 16:19:28,964 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 16:19:28,967 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 16:19:28,968 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 16:19:28,968 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 16:19:28,969 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 16:19:28,969 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 16:19:28,969 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 16:19:28,971 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 16:19:28,974 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 16:19:28,974 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 16:19:28,974 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 16:19:28,974 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 16:19:28,974 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 16:19:28,974 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 16:19:28,974 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 16:19:28,974 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 16:19:28,974 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 16:19:28,974 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 16:19:28,976 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 16:19:28,976 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 16:19:28,976 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 16:19:28,976 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 16:19:28,976 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 16:19:29,101 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 16:19:29,106 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 16:19:29,107 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-18 16:19:29,107 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 16:19:29,107 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 16:19:29,107 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 16:19:29,108 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 16:19:29,108 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 16:19:29,108 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 16:19:29,108 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 16:19:29,110 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 16:19:29,111 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 16:19:29,111 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-09-18 16:19:29,125 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 16:19:29,125 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 16:19:29,126 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 16:19:29,128 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 16:19:29,128 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 16:19:29,285 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 16:19:29,285 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 16:19:29,285 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 16:19:29,285 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 16:19:29,286 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 16:19:29,286 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 16:19:29,353 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 16:19:29,353 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 16:19:29,355 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 16:19:29,356 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 16:19:29,356 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 16:19:29,356 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 16:19:29,356 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 16:19:29,356 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 16:19:29,356 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:29,356 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 16:19:29,357 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:29,357 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 16:19:29,357 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 16:19:29,357 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 16:19:29,357 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 16:19:29,357 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 16:19:29,358 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 16:19:29,360 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 16:19:29,361 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 16:19:29,361 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-18 16:19:29,361 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 16:19:29,361 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 16:19:29,361 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 16:19:29,361 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 16:19:29,361 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 16:19:29,361 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 16:19:29,361 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 16:19:29,361 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 16:19:29,361 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 16:19:29,361 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 16:19:29,361 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 16:19:29,503 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 16:19:29,504 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 16:19:34,099 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:34] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:35,369 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:35] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:35,415 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:35] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:38,911 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:38] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:40,892 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:40] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:43,972 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:19:43] "GET /health HTTP/1.1" 200 -
2025-09-18 16:19:43,990 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 16:19:43,991 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 16:19:43,991 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 16:19:43,991 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 16:19:43,991 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 16:19:43,991 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:43,991 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 16:19:43,991 - mms_extractor - INFO - ============================================================
2025-09-18 16:19:43,991 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 16:19:43,991 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 16:19:43,991 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 16:19:43,991 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 16:19:43,991 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 16:19:43,991 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 16:19:43,991 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 16:19:43,991 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 16:19:43,991 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 16:19:43,991 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 16:19:43,991 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 16:19:43,991 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 16:19:43,994 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 16:19:44,471 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 16:19:44,472 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 16:19:44,475 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 16:19:44,475 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 16:19:44,475 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-18 16:19:44,475 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 16:19:51,512 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 16:19:51,512 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 16:19:51,513 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 16:19:51,513 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 16:19:51,606 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 16:19:51,607 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 16:19:51,607 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 16:19:51,610 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 16:19:51,613 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 16:19:51,614 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 16:19:51,617 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 16:19:51,620 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 16:19:51,620 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 16:19:51,621 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.63초
2025-09-18 16:19:51,621 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 16:19:51,621 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 16:19:51,621 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 16:19:51,832 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 16:19:51,832 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 16:19:51,832 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 16:19:51,832 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 16:19:51,832 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 16:19:51,832 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 16:19:51,832 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 16:19:51,832 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 16:19:51,832 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 16:19:51,832 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-18 16:19:51,832 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 16:19:51,832 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-18 16:19:51,832 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-18 16:19:51,833 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-18 16:19:51,833 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 16:19:51,833 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 16:19:58,237 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 16:19:58,252 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-18 16:19:58,253 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-18 16:19:58,253 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 16:19:58,253 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 16:19:58,253 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 16:19:58,253 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 16:19:58,253 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 16:19:58,253 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 16:19:59,203 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 16:19:59,203 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-18 16:19:59,203 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 16:19:59,203 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 16:20:01,811 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 16:20:01,964 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 3.71초
2025-09-18 16:20:01,968 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 16:20:01,968 - mms_extractor - INFO - ============================================================
2025-09-18 16:20:01,968 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 16:20:01,968 - mms_extractor - INFO - ============================================================
2025-09-18 16:20:01,968 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 16:20:01,968 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 16:20:01,968 - mms_extractor - INFO - 상품 수: 5개
2025-09-18 16:20:01,968 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 16:20:01,968 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 16:20:01,968 - mms_extractor - INFO - process_message 실행완료: 17.98초
2025-09-18 16:20:01,968 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 16:20:01,969 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 16:20:01,969 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 16:20:01,969 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34eb6fd40> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35a8328d0> root_client=<openai.OpenAI object at 0x34ec79700> root_async_client=<openai.AsyncOpenAI object at 0x35a8320f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 16:20:01,969 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 16:20:01,969 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 16:20:21,743 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 16:20:21,746 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2367자
2025-09-18 16:20:21,746 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-18 16:20:21,747 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 16:20:21,748 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 246자
2025-09-18 16:20:21,748 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 16:20:21,750 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-18 16:20:21,750 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '추가 요금:지불']
2025-09-18 16:20:21,751 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-18 16:20:21,751 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 16:20:21,751 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 16:20:21,751 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-18 16:20:21,752 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 16:20:22,005 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 16:20:22,005 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 16:20:22,005 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.037초
2025-09-18 16:20:22,005 - mms_extractor - INFO - 📏 DAG 섹션 길이: 246자
2025-09-18 16:20:22,005 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가...
2025-09-18 16:20:22,005 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 16:20:22,005 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 16:20:22,005 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-18 16:20:22,006 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)']...
2025-09-18 16:20:22,006 - __main__ - INFO - 추출 완료: 38.015초
2025-09-18 16:20:22,006 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:20:22] "POST /extract HTTP/1.1" 200 -
2025-09-18 16:20:22,034 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 16:20:22] "GET /health HTTP/1.1" 200 -
2025-09-18 17:31:19,184 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 17:31:19] "GET /health HTTP/1.1" 200 -
2025-09-18 18:19:49,767 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 18:19:49,767 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 18:19:49,767 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 18:19:49,767 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 18:19:49,767 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 18:19:49,767 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 18:19:49,767 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 18:19:49,769 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 18:19:49,787 - mms_extractor - INFO - Using device: mps
2025-09-18 18:19:49,788 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 18:19:49,788 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 18:19:49,788 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 18:19:49,788 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 18:19:49,788 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 18:19:49,788 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 18:19:49,788 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 18:19:49,788 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 18:19:55,760 - mms_extractor - INFO - Model loaded on mps
2025-09-18 18:19:55,761 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.97초
2025-09-18 18:19:55,761 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 18:19:56,371 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 18:19:56,371 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.61초
2025-09-18 18:19:56,371 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 18:19:56,371 - mms_extractor - INFO - ============================================================
2025-09-18 18:19:56,371 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 18:19:56,371 - mms_extractor - INFO - ============================================================
2025-09-18 18:19:56,371 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 18:19:56,371 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 18:19:56,371 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 18:19:56,371 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 18:19:56,371 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 18:19:56,452 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 18:19:56,452 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 18:19:56,452 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 18:19:56,456 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 18:19:56,457 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 18:19:56,457 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:19:56,458 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:19:56,458 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 18:19:56,458 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 18:19:56,464 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 18:19:56,469 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 18:19:56,469 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 18:19:56,469 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:19:56,469 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 18:19:56,469 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 18:19:56,469 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 18:19:56,469 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:19:56,469 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 18:19:56,469 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 18:19:56,469 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 18:19:56,477 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 18:19:56,478 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 18:19:56,478 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:19:56,478 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 18:19:56,478 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:19:56,616 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 18:19:56,622 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 18:19:56,623 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-18 18:19:56,623 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 18:19:56,624 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 18:19:56,624 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 18:19:56,625 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 18:19:56,626 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 18:19:56,626 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 18:19:56,626 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 18:19:56,628 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 18:19:56,629 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 18:19:56,629 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-18 18:19:56,647 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 18:19:56,647 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 18:19:56,648 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 18:19:56,658 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 18:19:56,658 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 18:19:56,902 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 18:19:56,902 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 18:19:56,902 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 18:19:56,902 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 18:19:56,902 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 18:19:56,902 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 18:19:56,972 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 18:19:56,972 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 18:19:56,975 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 18:19:56,976 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 18:19:56,976 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 18:19:56,976 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:19:56,976 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 18:19:56,977 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 18:19:56,977 - mms_extractor - INFO - ============================================================
2025-09-18 18:19:56,977 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 18:19:56,977 - mms_extractor - INFO - ============================================================
2025-09-18 18:19:56,977 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 18:19:56,977 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 18:19:56,977 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 18:19:56,977 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 18:19:56,977 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 18:19:56,979 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 18:19:56,981 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 18:19:56,982 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 18:19:56,982 - mms_extractor - INFO - _load_data 실행완료: 0.61초
2025-09-18 18:19:56,982 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 18:19:56,982 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 18:19:56,982 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 18:19:56,982 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 18:19:56,982 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 18:19:56,982 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 18:19:56,982 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 18:19:56,982 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 18:19:56,982 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 18:19:56,982 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 18:19:56,982 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 18:19:57,028 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 18:19:57,029 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 18:20:08,374 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:08] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:11,623 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:11] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:13,004 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:13] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:13,041 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:13] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:17,391 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:17] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:20,009 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:20] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:22,920 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:20:22] "GET /health HTTP/1.1" 200 -
2025-09-18 18:20:22,996 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 18:20:22,996 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 18:20:22,996 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 18:20:22,996 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 18:20:22,997 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 18:20:22,997 - mms_extractor - INFO - ============================================================
2025-09-18 18:20:22,997 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 18:20:22,997 - mms_extractor - INFO - ============================================================
2025-09-18 18:20:22,997 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 18:20:22,997 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 18:20:22,997 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 18:20:22,997 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 18:20:22,997 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 18:20:22,997 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 18:20:22,997 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 18:20:22,997 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 18:20:22,997 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 18:20:22,997 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 18:20:22,997 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 18:20:22,997 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 18:20:22,999 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 18:20:23,518 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 18:20:23,519 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 18:20:23,523 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 18:20:23,523 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 18:20:23,523 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-18 18:20:23,523 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 18:20:44,714 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 18:20:44,714 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 18:20:44,715 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 18:20:44,715 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 18:20:44,809 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 18:20:44,810 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 18:20:44,810 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 18:20:44,812 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 18:20:44,814 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 18:20:44,815 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 18:20:44,817 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:20:44,820 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 18:20:44,820 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 18:20:44,820 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 21.82초
2025-09-18 18:20:44,820 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:20:44,820 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 18:20:44,820 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 18:20:44,963 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 18:20:44,963 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 18:20:44,963 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 18:20:44,963 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 18:20:44,963 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 18:20:44,963 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:20:44,963 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 18:20:44,963 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 18:20:44,963 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 18:20:44,963 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-18 18:20:44,963 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 18:20:44,964 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-18 18:20:44,964 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-18 18:20:44,964 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-18 18:20:44,964 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 18:20:44,964 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 18:20:51,090 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:20:51,104 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-18 18:20:51,104 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-18 18:20:51,104 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 18:20:51,104 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 18:20:51,104 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 18:20:51,104 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 18:20:51,105 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 18:20:51,105 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 18:20:52,053 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 18:20:52,053 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-18 18:20:52,053 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 18:20:52,053 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 18:20:52,882 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:20:53,037 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.93초
2025-09-18 18:20:53,041 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 18:20:53,041 - mms_extractor - INFO - ============================================================
2025-09-18 18:20:53,041 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 18:20:53,041 - mms_extractor - INFO - ============================================================
2025-09-18 18:20:53,041 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 18:20:53,041 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 18:20:53,041 - mms_extractor - INFO - 상품 수: 5개
2025-09-18 18:20:53,041 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 18:20:53,041 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 18:20:53,041 - mms_extractor - INFO - process_message 실행완료: 30.04초
2025-09-18 18:20:53,041 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 18:20:53,041 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 18:20:53,041 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 18:20:53,042 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34330e5d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x3501f3ef0> root_client=<openai.OpenAI object at 0x3431e6bd0> root_async_client=<openai.AsyncOpenAI object at 0x34330ee70> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 18:20:53,042 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 18:20:53,042 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 18:21:14,457 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:21:14,459 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2504자
2025-09-18 18:21:14,459 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 8월 31일까지 '우주패스 Netflix'에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용할 수 있는 혜택을 누리도록 유도하는 것입니다...
2025-09-18 18:21:14,459 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 18:21:14,460 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 205자
2025-09-18 18:21:14,460 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 18:21:14,461 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-09-18 18:21:14,461 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용', '웨이브 콘텐츠 팩:사용', '2개월 동안 월 9900원:결제', '넷플릭스 스탠다드/프리미엄:선택']
2025-09-18 18:21:14,461 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:사용'), ('우주패스 Netflix:가입', '2개월 동안 월 9900원:결제'), ('우주패스 Netflix:가입', '넷플릭스 스탠다드/프리미엄:선택')]
2025-09-18 18:21:14,462 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 18:21:14,462 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 18:21:14,462 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-09-18 18:21:14,463 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 18:21:15,078 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 18:21:15,078 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 18:21:15,078 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.037초
2025-09-18 18:21:15,078 - mms_extractor - INFO - 📏 DAG 섹션 길이: 205자
2025-09-18 18:21:15,078 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9900원:결제)
(우주패스 Netflix:가입) -[가입후]-> (넷플릭스 스탠다드/프리미엄:선택) -[선택하면]-> (추가 요...
2025-09-18 18:21:15,078 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 18:21:15,078 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 18:21:15,078 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 4자
2025-09-18 18:21:15,078 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9900원:결제)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)', '(우주패스 Netflix:가입) -[가입후]-> (넷플릭스 스탠다드/프리미엄:선택) -[선택하면]-> (추가 요금:결제)']...
2025-09-18 18:21:15,078 - __main__ - INFO - 추출 완료: 52.082초
2025-09-18 18:21:15,079 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:21:15] "POST /extract HTTP/1.1" 200 -
2025-09-18 18:21:15,113 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:21:15] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:34,375 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:34] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:43,739 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:43] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:48,172 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:48] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:50,325 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:50] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:53,548 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:53] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:56,029 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:56] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:57,988 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:57] "GET /health HTTP/1.1" 200 -
2025-09-18 18:24:58,029 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:24:58] "GET /health HTTP/1.1" 200 -
2025-09-18 18:25:00,019 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:25:00] "GET /health HTTP/1.1" 200 -
2025-09-18 18:25:00,033 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 18:25:00,033 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 18:25:00,033 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 18:25:00,033 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 18:25:00,033 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 18:25:00,033 - mms_extractor - INFO - ============================================================
2025-09-18 18:25:00,033 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 18:25:00,033 - mms_extractor - INFO - ============================================================
2025-09-18 18:25:00,033 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 18:25:00,033 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 18:25:00,033 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 18:25:00,033 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 18:25:00,033 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 18:25:00,033 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 18:25:00,033 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 18:25:00,033 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 18:25:00,033 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 18:25:00,033 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 18:25:00,033 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 18:25:00,033 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 18:25:00,035 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 18:25:00,045 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 18:25:00,046 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 18:25:00,051 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 18:25:00,051 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 18:25:00,051 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-09-18 18:25:00,051 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 18:25:00,286 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 18:25:00,286 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 18:25:00,286 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 18:25:00,286 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 18:25:00,380 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 18:25:00,381 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 18:25:00,381 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 18:25:00,383 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 18:25:00,385 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 18:25:00,385 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 18:25:00,387 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:25:00,389 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 18:25:00,389 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 18:25:00,389 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.36초
2025-09-18 18:25:00,389 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:25:00,389 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 18:25:00,389 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 18:25:00,506 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 18:25:00,506 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 18:25:00,506 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 18:25:00,506 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 18:25:00,506 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 18:25:00,506 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 18:25:00,506 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 18:25:00,506 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 18:25:00,506 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 18:25:00,506 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-18 18:25:00,506 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 18:25:00,506 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-18 18:25:00,506 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-18 18:25:00,507 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-18 18:25:00,507 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 18:25:00,507 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 18:25:06,517 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:25:06,522 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-18 18:25:06,522 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-18 18:25:06,522 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 18:25:06,524 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 18:25:06,524 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 18:25:06,524 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 18:25:06,524 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 18:25:06,524 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 18:25:07,504 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 18:25:07,504 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-18 18:25:07,504 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 18:25:07,504 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 18:25:08,384 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:25:08,537 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.01초
2025-09-18 18:25:08,541 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 18:25:08,541 - mms_extractor - INFO - ============================================================
2025-09-18 18:25:08,541 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 18:25:08,541 - mms_extractor - INFO - ============================================================
2025-09-18 18:25:08,541 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 18:25:08,541 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 18:25:08,541 - mms_extractor - INFO - 상품 수: 5개
2025-09-18 18:25:08,541 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 18:25:08,541 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 18:25:08,541 - mms_extractor - INFO - process_message 실행완료: 8.51초
2025-09-18 18:25:08,541 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 18:25:08,541 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 18:25:08,541 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 18:25:08,542 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34330e5d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x3501f3ef0> root_client=<openai.OpenAI object at 0x3431e6bd0> root_async_client=<openai.AsyncOpenAI object at 0x34330ee70> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 18:25:08,542 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 18:25:08,542 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 18:25:28,363 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 18:25:28,365 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2367자
2025-09-18 18:25:28,366 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-18 18:25:28,366 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 18:25:28,366 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 246자
2025-09-18 18:25:28,367 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 18:25:28,367 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-18 18:25:28,367 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '추가 요금:지불']
2025-09-18 18:25:28,367 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-18 18:25:28,368 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 18:25:28,368 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 18:25:28,368 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-18 18:25:28,370 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 18:25:28,680 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 18:25:28,680 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 18:25:28,680 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.139초
2025-09-18 18:25:28,680 - mms_extractor - INFO - 📏 DAG 섹션 길이: 246자
2025-09-18 18:25:28,680 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가...
2025-09-18 18:25:28,680 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 18:25:28,680 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 18:25:28,680 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-18 18:25:28,680 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)']...
2025-09-18 18:25:28,680 - __main__ - INFO - 추출 완료: 28.648초
2025-09-18 18:25:28,681 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:25:28] "POST /extract HTTP/1.1" 200 -
2025-09-18 18:25:28,708 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 18:25:28] "GET /health HTTP/1.1" 200 -
2025-09-18 18:25:59,052 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 18:25:59,052 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 18:25:59,052 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 18:25:59,052 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 18:25:59,052 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 18:25:59,052 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 18:25:59,052 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 18:25:59,053 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 18:25:59,070 - mms_extractor - INFO - Using device: mps
2025-09-18 18:25:59,070 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 18:25:59,070 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 18:25:59,071 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 18:25:59,071 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 18:25:59,071 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 18:25:59,071 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 18:25:59,071 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 18:25:59,071 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 18:26:03,574 - mms_extractor - INFO - Model loaded on mps
2025-09-18 18:26:03,575 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.50초
2025-09-18 18:26:03,575 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 18:26:04,019 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 18:26:04,019 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.44초
2025-09-18 18:26:04,019 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 18:26:04,019 - mms_extractor - INFO - ============================================================
2025-09-18 18:26:04,019 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 18:26:04,019 - mms_extractor - INFO - ============================================================
2025-09-18 18:26:04,019 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 18:26:04,019 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 18:26:04,019 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 18:26:04,019 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 18:26:04,019 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 18:26:04,091 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 18:26:04,091 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 18:26:04,091 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 18:26:04,094 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 18:26:04,095 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 18:26:04,095 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:26:04,096 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:26:04,096 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 18:26:04,096 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 18:26:04,103 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 18:26:04,105 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 18:26:04,105 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 18:26:04,105 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:26:04,105 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 18:26:04,105 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 18:26:04,106 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 18:26:04,106 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:26:04,106 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 18:26:04,106 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 18:26:04,106 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 18:26:04,112 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 18:26:04,113 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 18:26:04,113 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:26:04,113 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 18:26:04,113 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 18:26:04,234 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 18:26:04,238 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 18:26:04,239 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 18:26:04,239 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 18:26:04,239 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 18:26:04,239 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 18:26:04,240 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 18:26:04,240 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 18:26:04,240 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 18:26:04,240 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 18:26:04,242 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 18:26:04,243 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 18:26:04,243 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 18:26:04,256 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 18:26:04,256 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 18:26:04,256 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 18:26:04,269 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 18:26:04,269 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 18:26:04,480 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 18:26:04,480 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 18:26:04,480 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 18:26:04,480 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 18:26:04,480 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 18:26:04,480 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 18:26:04,546 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 18:26:04,546 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 18:26:04,549 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 18:26:04,549 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 18:26:04,549 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 18:26:04,549 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 18:26:04,549 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 18:26:04,550 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 18:26:04,550 - mms_extractor - INFO - ============================================================
2025-09-18 18:26:04,550 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 18:26:04,550 - mms_extractor - INFO - ============================================================
2025-09-18 18:26:04,550 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 18:26:04,550 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 18:26:04,550 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 18:26:04,550 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 18:26:04,550 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 18:26:04,551 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 18:26:04,553 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 18:26:04,554 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 18:26:04,554 - mms_extractor - INFO - _load_data 실행완료: 0.53초
2025-09-18 18:26:04,554 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 18:26:04,554 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 18:26:04,554 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 18:26:04,554 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 18:26:04,554 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 18:26:04,554 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 18:26:04,554 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 18:26:04,554 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 18:26:04,554 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 18:26:04,554 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 18:26:04,554 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 18:26:04,581 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 18:26:04,582 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 19:01:48,803 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 19:01:48,803 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 19:01:48,803 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 19:01:48,803 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 19:01:48,803 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 19:01:48,803 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 19:01:48,803 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 19:01:48,805 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 19:01:48,822 - mms_extractor - INFO - Using device: mps
2025-09-18 19:01:48,822 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 19:01:48,822 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 19:01:48,822 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 19:01:48,822 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 19:01:48,822 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 19:01:48,823 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 19:01:48,823 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 19:01:48,823 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 19:01:49,650 - mms_extractor - INFO - Model loaded on mps
2025-09-18 19:01:49,650 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.83초
2025-09-18 19:01:49,650 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 19:01:50,059 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 19:01:50,059 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.41초
2025-09-18 19:01:50,059 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 19:01:50,059 - mms_extractor - INFO - ============================================================
2025-09-18 19:01:50,059 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 19:01:50,059 - mms_extractor - INFO - ============================================================
2025-09-18 19:01:50,059 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 19:01:50,059 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 19:01:50,059 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 19:01:50,059 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 19:01:50,059 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:01:50,124 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 19:01:50,124 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:01:50,124 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 19:01:50,127 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 19:01:50,128 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 19:01:50,128 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:01:50,129 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:01:50,129 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 19:01:50,129 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 19:01:50,131 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 19:01:50,134 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 19:01:50,134 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 19:01:50,134 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:01:50,134 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 19:01:50,134 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 19:01:50,135 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 19:01:50,135 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:01:50,135 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 19:01:50,135 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 19:01:50,135 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 19:01:50,136 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 19:01:50,137 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 19:01:50,137 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:01:50,137 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 19:01:50,137 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:01:50,260 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 19:01:50,265 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 19:01:50,265 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-18 19:01:50,265 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 19:01:50,265 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 19:01:50,265 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 19:01:50,266 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 19:01:50,266 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 19:01:50,266 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 19:01:50,266 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 19:01:50,268 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 19:01:50,269 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 19:01:50,269 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-09-18 19:01:50,283 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 19:01:50,283 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 19:01:50,283 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 19:01:50,285 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 19:01:50,285 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 19:01:50,433 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 19:01:50,433 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 19:01:50,433 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 19:01:50,433 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 19:01:50,433 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 19:01:50,434 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:01:50,499 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 19:01:50,499 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:01:50,501 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 19:01:50,501 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 19:01:50,501 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 19:01:50,501 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:01:50,502 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 19:01:50,502 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 19:01:50,502 - mms_extractor - INFO - ============================================================
2025-09-18 19:01:50,502 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 19:01:50,502 - mms_extractor - INFO - ============================================================
2025-09-18 19:01:50,502 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 19:01:50,502 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 19:01:50,502 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 19:01:50,502 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 19:01:50,502 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 19:01:50,504 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 19:01:50,505 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 19:01:50,506 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 19:01:50,506 - mms_extractor - INFO - _load_data 실행완료: 0.45초
2025-09-18 19:01:50,506 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 19:01:50,506 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 19:01:50,506 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 19:01:50,506 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 19:01:50,507 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 19:01:50,507 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 19:01:50,507 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 19:01:50,507 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 19:01:50,507 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 19:01:50,507 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 19:01:50,507 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 19:01:50,525 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 19:01:50,525 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 19:02:02,398 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:02] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:04,867 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:04] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:07,879 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:07] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:10,069 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:10] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:10,106 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:10] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:11,203 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:11] "GET /health HTTP/1.1" 200 -
2025-09-18 19:02:11,234 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 19:02:11,234 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:02:11,235 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 19:02:11,235 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 19:02:11,235 - mms_extractor - INFO - ============================================================
2025-09-18 19:02:11,235 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:02:11,236 - mms_extractor - INFO - ============================================================
2025-09-18 19:02:11,236 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 19:02:11,236 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 19:02:11,236 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:02:11,236 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:02:11,236 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 19:02:11,236 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 19:02:11,236 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:02:11,236 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:02:11,236 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:02:11,236 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:02:11,237 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:02:11,237 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 19:02:11,241 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:02:11,727 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 19:02:11,728 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 19:02:11,731 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 19:02:11,731 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 19:02:11,731 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-18 19:02:11,731 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:02:18,554 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 19:02:18,554 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 19:02:18,555 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 19:02:18,555 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:02:18,647 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 19:02:18,648 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 19:02:18,648 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:02:18,651 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 19:02:18,653 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 19:02:18,654 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 19:02:18,658 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:02:18,661 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 19:02:18,661 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 19:02:18,662 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.42초
2025-09-18 19:02:18,662 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:02:18,662 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 19:02:18,662 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:02:18,871 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:02:18,871 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:02:18,871 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 19:02:18,871 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:02:18,871 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 19:02:18,871 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:02:18,871 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 19:02:18,871 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 19:02:18,871 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 19:02:18,871 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-18 19:02:18,871 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:02:18,871 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-09-18 19:02:18,871 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-18 19:02:18,872 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 7454)
2025-09-18 19:02:18,872 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:02:18,872 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:02:24,935 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:02:24,950 - mms_extractor - INFO - LLM 응답 길이: 857 문자
2025-09-18 19:02:24,950 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "T 우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "사용"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "사용"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http:/...
2025-09-18 19:02:24,950 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:02:24,951 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:02:24,951 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:02:24,951 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': 'T 우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '사용'}, {'name': 'Wavve 콘텐츠 팩', 'action': '사용'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 19:02:24,951 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:02:24,951 - mms_extractor - INFO - LLM 추출 엔티티: ['T 우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 19:02:25,916 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 19:02:25,917 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-18 19:02:25,917 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 19:02:25,917 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 19:02:26,772 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:02:26,922 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.97초
2025-09-18 19:02:26,926 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:02:26,926 - mms_extractor - INFO - ============================================================
2025-09-18 19:02:26,926 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:02:26,926 - mms_extractor - INFO - ============================================================
2025-09-18 19:02:26,926 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 19:02:26,926 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 19:02:26,926 - mms_extractor - INFO - 상품 수: 5개
2025-09-18 19:02:26,927 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 19:02:26,927 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:02:26,927 - mms_extractor - INFO - process_message 실행완료: 15.69초
2025-09-18 19:02:26,927 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 19:02:26,927 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 19:02:26,927 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 19:02:26,927 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 19:02:26,927 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34f00b470> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358ba3e30> root_client=<openai.OpenAI object at 0x34f1125d0> root_async_client=<openai.AsyncOpenAI object at 0x34f0e2c90> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 19:02:26,927 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 19:02:26,927 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 19:02:46,667 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:02:46,670 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2367자
2025-09-18 19:02:46,670 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-18 19:02:46,671 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 19:02:46,671 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 246자
2025-09-18 19:02:46,672 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 19:02:46,672 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-18 19:02:46,673 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '추가 요금:지불']
2025-09-18 19:02:46,673 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-18 19:02:46,673 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 19:02:46,674 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 19:02:46,675 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-18 19:02:46,676 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 19:02:46,937 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 19:02:46,937 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 19:02:46,937 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.010초
2025-09-18 19:02:46,937 - mms_extractor - INFO - 📏 DAG 섹션 길이: 246자
2025-09-18 19:02:46,937 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가...
2025-09-18 19:02:46,937 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 19:02:46,937 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 19:02:46,937 - __main__ - INFO - 추출 완료: 35.703초
2025-09-18 19:02:46,938 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:46] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:02:46,967 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:02:46] "GET /health HTTP/1.1" 200 -
2025-09-18 19:09:58,772 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:09:58] "GET /health HTTP/1.1" 200 -
2025-09-18 19:10:03,864 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:10:03] "GET /health HTTP/1.1" 200 -
2025-09-18 19:10:05,684 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:10:05] "GET /health HTTP/1.1" 200 -
2025-09-18 19:10:05,728 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:10:05] "GET /health HTTP/1.1" 200 -
2025-09-18 19:10:06,636 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:10:06] "GET /health HTTP/1.1" 200 -
2025-09-18 19:10:06,655 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:10:06,655 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:06,655 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:10:06,655 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:06,655 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 19:10:06,655 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 19:10:06,655 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:10:06,655 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:10:06,655 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-18 19:10:06,655 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-18 19:10:06,655 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:10:06,655 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:10:06,655 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:10:06,655 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:10:06,655 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:10:06,655 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 19:10:06,658 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:10:06,671 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 19:10:06,672 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 19:10:06,676 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 19:10:06,677 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 19:10:06,677 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-18 19:10:06,677 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:10:20,106 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 19:10:20,106 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 19:10:20,106 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 19:10:20,106 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 19:10:20,106 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 19:10:20,106 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 19:10:20,106 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 19:10:20,107 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 19:10:20,149 - mms_extractor - INFO - Using device: mps
2025-09-18 19:10:20,149 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-09-18 19:10:20,150 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 19:10:20,151 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 19:10:20,151 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 19:10:20,151 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 19:10:20,151 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 19:10:20,152 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 19:10:20,152 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 19:10:20,440 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 19:10:20,440 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 19:10:20,441 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 19:10:20,441 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:10:20,535 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 19:10:20,535 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 19:10:20,535 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:10:20,538 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 19:10:20,540 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 19:10:20,540 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 19:10:20,542 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:10:20,544 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 19:10:20,544 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 19:10:20,544 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 13.89초
2025-09-18 19:10:20,544 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:10:20,544 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 19:10:20,544 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:10:20,742 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:10:20,743 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:10:20,743 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 19:10:20,743 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:10:20,743 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 19:10:20,743 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:10:20,743 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 19:10:20,743 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 19:10:20,743 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 19:10:20,744 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-18 19:10:20,744 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-18 19:10:20,744 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:10:20,744 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-18 19:10:20,744 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-18 19:10:20,745 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-18 19:10:20,745 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:10:20,745 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:10:24,512 - mms_extractor - INFO - Model loaded on mps
2025-09-18 19:10:24,512 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.36초
2025-09-18 19:10:24,512 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 19:10:25,027 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 19:10:25,027 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.51초
2025-09-18 19:10:25,027 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 19:10:25,027 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:25,027 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 19:10:25,027 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:25,027 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 19:10:25,027 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 19:10:25,027 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 19:10:25,027 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 19:10:25,027 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:10:25,103 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 19:10:25,103 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:10:25,104 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 19:10:25,107 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 19:10:25,108 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 19:10:25,111 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:10:25,113 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:10:25,113 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 19:10:25,113 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 19:10:25,121 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 19:10:25,125 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 19:10:25,125 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 19:10:25,125 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:10:25,125 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 19:10:25,125 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 19:10:25,125 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 19:10:25,125 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:10:25,125 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 19:10:25,125 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 19:10:25,125 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 19:10:25,133 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 19:10:25,133 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 19:10:25,134 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:10:25,134 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 19:10:25,134 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:10:25,260 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 19:10:25,265 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 19:10:25,266 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-09-18 19:10:25,266 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 19:10:25,266 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 19:10:25,266 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 19:10:25,268 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 19:10:25,268 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 19:10:25,268 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 19:10:25,268 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 19:10:25,270 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 19:10:25,270 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 19:10:25,270 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-09-18 19:10:25,284 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 19:10:25,284 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 19:10:25,284 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 19:10:25,297 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 19:10:25,297 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 19:10:25,561 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 19:10:25,561 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 19:10:25,561 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 19:10:25,561 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 19:10:25,561 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 19:10:25,561 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:10:25,632 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 19:10:25,632 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:10:25,635 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 19:10:25,635 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 19:10:25,635 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 19:10:25,635 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:10:25,635 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 19:10:25,636 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 19:10:25,636 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:25,636 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 19:10:25,636 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:25,636 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 19:10:25,636 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 19:10:25,636 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 19:10:25,636 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 19:10:25,636 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 19:10:25,637 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 19:10:25,639 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 19:10:25,641 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 19:10:25,641 - mms_extractor - INFO - _load_data 실행완료: 0.61초
2025-09-18 19:10:25,641 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 19:10:25,641 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 19:10:25,641 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 19:10:25,641 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 19:10:25,641 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 19:10:25,641 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 19:10:25,641 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 19:10:25,641 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 19:10:25,641 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 19:10:25,641 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 19:10:25,641 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 19:10:27,645 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:10:27,656 - mms_extractor - INFO - LLM 응답 길이: 928 문자
2025-09-18 19:10:27,656 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드",
            "action": "가입"
        },
        {
            "name": "Netflix 프리미엄",
            "action": "가입"
        }
    ],
    "channe...
2025-09-18 19:10:27,656 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:10:27,657 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:10:27,657 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:10:27,657 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드', 'action': '가입'}, {'name': 'Netflix 프리미엄', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 19:10:27,657 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:10:27,657 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드', 'Netflix 프리미엄']
2025-09-18 19:10:27,776 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:10:27,776 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:27,776 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:10:27,776 - mms_extractor - INFO - ============================================================
2025-09-18 19:10:27,776 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 19:10:27,776 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내']
2025-09-18 19:10:27,776 - mms_extractor - INFO - 상품 수: 4개
2025-09-18 19:10:27,776 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 19:10:27,776 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:10:27,777 - mms_extractor - INFO - process_message 실행완료: 21.12초
2025-09-18 19:10:27,777 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 1개
2025-09-18 19:10:27,777 - __main__ - INFO - 추출 완료: 21.122초
2025-09-18 19:10:27,777 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:10:27] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:12:29,496 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 19:12:29,496 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 19:12:29,496 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 19:12:29,496 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 19:12:29,496 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 19:12:29,496 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 19:12:29,496 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 19:12:29,498 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 19:12:29,521 - mms_extractor - INFO - Using device: mps
2025-09-18 19:12:29,522 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 19:12:29,522 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 19:12:29,522 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 19:12:29,522 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 19:12:29,522 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 19:12:29,522 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 19:12:29,523 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 19:12:29,523 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 19:12:30,839 - mms_extractor - INFO - Model loaded on mps
2025-09-18 19:12:30,839 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.32초
2025-09-18 19:12:30,839 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 19:12:31,277 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 19:12:31,277 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.44초
2025-09-18 19:12:31,277 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 19:12:31,277 - mms_extractor - INFO - ============================================================
2025-09-18 19:12:31,277 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 19:12:31,277 - mms_extractor - INFO - ============================================================
2025-09-18 19:12:31,277 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 19:12:31,277 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 19:12:31,277 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 19:12:31,277 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 19:12:31,277 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:12:31,348 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 19:12:31,348 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:12:31,348 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 19:12:31,352 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 19:12:31,353 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 19:12:31,353 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:12:31,354 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:12:31,354 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 19:12:31,354 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 19:12:31,357 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 19:12:31,360 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 19:12:31,360 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 19:12:31,360 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:12:31,360 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 19:12:31,360 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 19:12:31,360 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 19:12:31,360 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:12:31,360 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 19:12:31,360 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 19:12:31,360 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 19:12:31,363 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 19:12:31,363 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 19:12:31,363 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:12:31,363 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 19:12:31,364 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:12:31,491 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 19:12:31,497 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 19:12:31,497 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 19:12:31,498 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 19:12:31,498 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 19:12:31,498 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 19:12:31,499 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 19:12:31,499 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 19:12:31,499 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 19:12:31,499 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 19:12:31,501 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 19:12:31,502 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 19:12:31,502 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 19:12:31,516 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 19:12:31,516 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 19:12:31,516 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 19:12:31,518 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 19:12:31,518 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 19:12:31,703 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 19:12:31,703 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 19:12:31,703 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 19:12:31,703 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 19:12:31,703 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 19:12:31,703 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:12:31,772 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 19:12:31,772 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:12:31,774 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 19:12:31,775 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 19:12:31,775 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 19:12:31,775 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:12:31,775 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 19:12:31,775 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 19:12:31,775 - mms_extractor - INFO - ============================================================
2025-09-18 19:12:31,775 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 19:12:31,776 - mms_extractor - INFO - ============================================================
2025-09-18 19:12:31,776 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 19:12:31,776 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 19:12:31,776 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 19:12:31,776 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 19:12:31,776 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 19:12:31,777 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 19:12:31,779 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 19:12:31,780 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 19:12:31,780 - mms_extractor - INFO - _load_data 실행완료: 0.50초
2025-09-18 19:12:31,780 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 19:12:31,780 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 19:12:31,780 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 19:12:31,780 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 19:12:31,780 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 19:12:31,780 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 19:12:31,780 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 19:12:31,780 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 19:12:31,780 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 19:12:31,780 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 19:12:31,780 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 19:13:25,161 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 19:13:25,161 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 19:13:25,161 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 19:13:25,161 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 19:13:25,161 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 19:13:25,161 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 19:13:25,161 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 19:13:25,163 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 19:13:25,180 - mms_extractor - INFO - Using device: mps
2025-09-18 19:13:25,180 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 19:13:25,180 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 19:13:25,180 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 19:13:25,180 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 19:13:25,180 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 19:13:25,180 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 19:13:25,181 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 19:13:25,181 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 19:13:26,080 - mms_extractor - INFO - Model loaded on mps
2025-09-18 19:13:26,080 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.90초
2025-09-18 19:13:26,080 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 19:13:26,497 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 19:13:26,497 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.42초
2025-09-18 19:13:26,497 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 19:13:26,497 - mms_extractor - INFO - ============================================================
2025-09-18 19:13:26,497 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 19:13:26,497 - mms_extractor - INFO - ============================================================
2025-09-18 19:13:26,497 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 19:13:26,497 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 19:13:26,497 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 19:13:26,497 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 19:13:26,497 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:13:26,568 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 19:13:26,568 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:13:26,568 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 19:13:26,572 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 19:13:26,572 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 19:13:26,573 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:13:26,573 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:13:26,574 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 19:13:26,574 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 19:13:26,575 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 19:13:26,578 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 19:13:26,578 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 19:13:26,578 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:13:26,578 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 19:13:26,578 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 19:13:26,578 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 19:13:26,578 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:13:26,578 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 19:13:26,578 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 19:13:26,578 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 19:13:26,579 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 19:13:26,580 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 19:13:26,580 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:13:26,580 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 19:13:26,580 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:13:26,707 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 19:13:26,712 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 19:13:26,712 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 19:13:26,712 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 19:13:26,713 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 19:13:26,713 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 19:13:26,714 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 19:13:26,714 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 19:13:26,714 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 19:13:26,714 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 19:13:26,716 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 19:13:26,717 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 19:13:26,717 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-09-18 19:13:26,731 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 19:13:26,731 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 19:13:26,731 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 19:13:26,733 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 19:13:26,733 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 19:13:26,908 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 19:13:26,908 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 19:13:26,908 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 19:13:26,908 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 19:13:26,908 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 19:13:26,908 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:13:26,985 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 19:13:26,985 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:13:26,988 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 19:13:26,988 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 19:13:26,988 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 19:13:26,988 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:13:26,988 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 19:13:26,989 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 19:13:26,989 - mms_extractor - INFO - ============================================================
2025-09-18 19:13:26,989 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 19:13:26,989 - mms_extractor - INFO - ============================================================
2025-09-18 19:13:26,989 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 19:13:26,989 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 19:13:26,989 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 19:13:26,989 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 19:13:26,989 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 19:13:26,991 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 19:13:26,993 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 19:13:26,995 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 19:13:26,995 - mms_extractor - INFO - _load_data 실행완료: 0.50초
2025-09-18 19:13:26,995 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 19:13:26,995 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 19:13:26,995 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 19:13:26,995 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 19:13:26,995 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 19:13:26,995 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 19:13:26,995 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 19:13:26,995 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 19:13:26,995 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 19:13:26,995 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 19:13:26,995 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 19:13:27,020 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 19:13:27,020 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 19:14:00,135 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-18 19:14:00,135 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:14:00,135 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 19:14:00,136 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-18 19:14:00,136 - mms_extractor - INFO - ============================================================
2025-09-18 19:14:00,136 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:14:00,136 - mms_extractor - INFO - ============================================================
2025-09-18 19:14:00,136 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-18 19:14:00,136 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-18 19:14:00,136 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:14:00,136 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:14:00,136 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 19:14:00,136 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 19:14:00,136 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:14:00,136 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:14:00,136 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:14:00,136 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:14:00,136 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:14:00,136 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-18 19:14:00,138 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:14:00,659 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-18 19:14:00,659 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-18 19:14:00,661 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-18 19:14:00,661 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-18 19:14:00,661 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '에이닷이빵쏜닷', '시크릿', '데일리']
2025-09-18 19:14:00,661 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:14:08,321 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-18 19:14:08,322 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-18 19:14:08,324 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-18 19:14:08,324 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:14:08,371 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-18 19:14:08,372 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-18 19:14:08,372 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:14:08,375 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-18 19:14:08,380 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-18 19:14:08,381 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-18 19:14:08,381 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-18 19:14:08,381 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.25초
2025-09-18 19:14:08,382 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-18 19:14:08,382 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-18 19:14:08,382 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:14:08,651 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:14:08,651 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:14:08,651 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-18 19:14:08,651 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:14:08,651 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-18 19:14:08,652 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-18 19:14:08,652 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-18 19:14:08,652 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-18 19:14:08,652 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-18 19:14:08,652 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:14:08,652 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-18 19:14:08,652 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-18 19:14:08,652 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-18 19:14:08,652 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:14:08,652 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:14:15,936 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:14:15,944 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-18 19:14:15,944 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-18 19:14:15,944 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:14:15,945 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:14:15,945 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:14:15,945 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-18 19:14:15,945 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:14:15,945 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-18 19:14:16,328 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 19:14:16,328 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-18 19:14:16,328 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 19:14:16,328 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 19:14:18,153 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:14:18,283 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.34초
2025-09-18 19:14:18,287 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:14:18,288 - mms_extractor - INFO - ============================================================
2025-09-18 19:14:18,288 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:14:18,288 - mms_extractor - INFO - ============================================================
2025-09-18 19:14:18,288 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-18 19:14:18,288 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-18 19:14:18,288 - mms_extractor - INFO - 상품 수: 1개
2025-09-18 19:14:18,288 - mms_extractor - INFO - 채널 수: 4개
2025-09-18 19:14:18,288 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:14:18,288 - mms_extractor - INFO - process_message 실행완료: 18.15초
2025-09-18 19:14:18,288 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 19:14:18,288 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 19:14:18,288 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 19:14:18,288 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-18 19:14:18,288 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x35a4abf20> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x350f4f3e0> root_client=<openai.OpenAI object at 0x35a4abcb0> root_async_client=<openai.AsyncOpenAI object at 0x35a4abfe0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 19:14:18,288 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 19:14:18,288 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-18 19:14:36,525 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:14:36,526 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1876자
2025-09-18 19:14:36,526 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 만 13~34세 고객에게 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하고, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]
...
2025-09-18 19:14:36,526 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 19:14:36,527 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-18 19:14:36,527 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 19:14:36,527 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-18 19:14:36,528 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-18 19:14:36,528 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-18 19:14:36,528 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 19:14:36,528 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-18 19:14:36,528 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-18 19:14:36,528 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 19:14:37,053 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-18 19:14:37,054 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-18 19:14:37,054 - mms_extractor - INFO - 🕒 DAG 처리 시간: 18.766초
2025-09-18 19:14:37,054 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-18 19:14:37,054 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-18 19:14:37,054 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 19:14:37,054 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 19:14:37,054 - __main__ - INFO - 추출 완료: 36.918초
2025-09-18 19:14:37,056 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:14:37] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:18:48,214 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-18 19:18:48,214 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-18 19:18:48,214 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-18 19:18:48,214 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-18 19:18:48,214 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-18 19:18:48,214 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-18 19:18:48,214 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-18 19:18:48,215 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-18 19:18:48,235 - mms_extractor - INFO - Using device: mps
2025-09-18 19:18:48,235 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-18 19:18:48,235 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-18 19:18:48,236 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-18 19:18:48,236 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-18 19:18:48,236 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-18 19:18:48,236 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-18 19:18:48,236 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-18 19:18:48,236 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-18 19:18:49,425 - mms_extractor - INFO - Model loaded on mps
2025-09-18 19:18:49,425 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.19초
2025-09-18 19:18:49,425 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-18 19:18:49,853 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-18 19:18:49,853 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.43초
2025-09-18 19:18:49,853 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-18 19:18:49,853 - mms_extractor - INFO - ============================================================
2025-09-18 19:18:49,854 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-18 19:18:49,854 - mms_extractor - INFO - ============================================================
2025-09-18 19:18:49,854 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-18 19:18:49,854 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-18 19:18:49,854 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-18 19:18:49,854 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-18 19:18:49,854 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:18:49,920 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-18 19:18:49,920 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:18:49,920 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-18 19:18:49,924 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-18 19:18:49,924 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-18 19:18:49,925 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:18:49,925 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:18:49,926 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-18 19:18:49,926 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-18 19:18:49,928 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-18 19:18:49,931 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-18 19:18:49,931 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-18 19:18:49,931 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:18:49,931 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-18 19:18:49,931 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-18 19:18:49,932 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-18 19:18:49,932 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:18:49,932 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-18 19:18:49,932 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-18 19:18:49,932 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-18 19:18:49,933 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-18 19:18:49,933 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-18 19:18:49,933 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:18:49,934 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-18 19:18:49,934 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-18 19:18:50,056 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-18 19:18:50,061 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-18 19:18:50,061 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-18 19:18:50,061 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-18 19:18:50,062 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-18 19:18:50,062 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-18 19:18:50,063 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-18 19:18:50,063 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-18 19:18:50,063 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-18 19:18:50,063 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-18 19:18:50,065 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-18 19:18:50,066 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-18 19:18:50,066 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-18 19:18:50,078 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-18 19:18:50,079 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-18 19:18:50,079 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-18 19:18:50,081 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-18 19:18:50,081 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-18 19:18:50,235 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-18 19:18:50,235 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-18 19:18:50,235 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-18 19:18:50,235 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-18 19:18:50,235 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-18 19:18:50,235 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-18 19:18:50,303 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-18 19:18:50,303 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-18 19:18:50,305 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-18 19:18:50,305 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-18 19:18:50,305 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-18 19:18:50,306 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-18 19:18:50,306 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-18 19:18:50,306 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-18 19:18:50,306 - mms_extractor - INFO - ============================================================
2025-09-18 19:18:50,306 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-18 19:18:50,306 - mms_extractor - INFO - ============================================================
2025-09-18 19:18:50,306 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-18 19:18:50,306 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-18 19:18:50,306 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-18 19:18:50,306 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-18 19:18:50,306 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-18 19:18:50,308 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-18 19:18:50,309 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-18 19:18:50,310 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-18 19:18:50,310 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-18 19:18:50,310 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-18 19:18:50,310 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-18 19:18:50,310 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-18 19:18:50,310 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-18 19:18:50,310 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-18 19:18:50,310 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-18 19:18:50,310 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-18 19:18:50,310 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-18 19:18:50,310 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-18 19:18:50,310 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-18 19:18:50,311 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-18 19:18:50,330 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.43:8000
2025-09-18 19:18:50,330 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-18 19:19:02,911 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-18 19:19:02,912 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:19:02,912 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 19:19:02,912 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-18 19:19:02,912 - mms_extractor - INFO - ============================================================
2025-09-18 19:19:02,912 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:19:02,912 - mms_extractor - INFO - ============================================================
2025-09-18 19:19:02,912 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-18 19:19:02,912 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-18 19:19:02,912 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:19:02,912 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:19:02,912 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-18 19:19:02,912 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-18 19:19:02,912 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:19:02,912 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:19:02,912 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:19:02,912 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:19:02,912 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:19:02,912 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-18 19:19:02,914 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:19:03,397 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-18 19:19:03,398 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-18 19:19:03,399 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-18 19:19:03,399 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-18 19:19:03,399 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '시크릿', '데일리']
2025-09-18 19:19:03,399 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:19:10,242 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-18 19:19:10,243 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-18 19:19:10,243 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-18 19:19:10,244 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:19:10,286 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-18 19:19:10,286 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-18 19:19:10,286 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:19:10,289 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-18 19:19:10,291 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-18 19:19:10,292 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-18 19:19:10,292 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-18 19:19:10,292 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.38초
2025-09-18 19:19:10,292 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-18 19:19:10,292 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-18 19:19:10,292 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:19:10,417 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:19:10,417 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:19:10,417 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-18 19:19:10,417 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:19:10,417 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-18 19:19:10,417 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-18 19:19:10,417 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-18 19:19:10,417 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-18 19:19:10,417 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-18 19:19:10,417 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:19:10,417 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-18 19:19:10,417 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-18 19:19:10,417 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-18 19:19:10,417 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:19:10,417 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:19:17,370 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:19:17,376 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-18 19:19:17,376 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-18 19:19:17,376 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:19:17,377 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:19:17,377 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:19:17,377 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-18 19:19:17,377 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:19:17,377 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-18 19:19:17,765 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-18 19:19:17,765 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-18 19:19:17,765 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-18 19:19:17,765 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-18 19:19:18,742 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:19:18,884 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.51초
2025-09-18 19:19:18,888 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:19:18,888 - mms_extractor - INFO - ============================================================
2025-09-18 19:19:18,888 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:19:18,888 - mms_extractor - INFO - ============================================================
2025-09-18 19:19:18,888 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-18 19:19:18,888 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-18 19:19:18,888 - mms_extractor - INFO - 상품 수: 1개
2025-09-18 19:19:18,888 - mms_extractor - INFO - 채널 수: 4개
2025-09-18 19:19:18,888 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:19:18,888 - mms_extractor - INFO - process_message 실행완료: 15.98초
2025-09-18 19:19:18,888 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 19:19:18,888 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 19:19:18,888 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 19:19:18,888 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-18 19:19:18,889 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x31cd19520> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x31cc0fe30> root_client=<openai.OpenAI object at 0x31cc7a870> root_async_client=<openai.AsyncOpenAI object at 0x3500a7f20> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 19:19:18,889 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 19:19:18,889 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-18 19:19:35,909 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:19:35,910 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1866자
2025-09-18 19:19:35,910 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-18 19:19:35,910 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 19:19:35,910 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-18 19:19:35,910 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 19:19:35,911 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-18 19:19:35,911 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-18 19:19:35,911 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-18 19:19:35,911 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 19:19:35,911 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-18 19:19:35,911 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-18 19:19:35,912 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 19:19:36,145 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-18 19:19:36,146 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-18 19:19:36,146 - mms_extractor - INFO - 🕒 DAG 처리 시간: 17.257초
2025-09-18 19:19:36,146 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-18 19:19:36,146 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-18 19:19:36,146 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 19:19:36,146 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-18 19:19:36,146 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-18 19:19:36,146 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-18 19:19:36,146 - __main__ - INFO - 추출 완료: 33.234초
2025-09-18 19:19:36,147 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:19:36] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:20:27,437 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:27] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:30,090 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:30] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:31,578 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:31] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:31,610 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:31] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:32,993 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:32] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:33,016 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:20:33,016 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:33,016 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:20:33,016 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:33,016 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 19:20:33,016 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 19:20:33,016 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:20:33,016 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:20:33,016 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-18 19:20:33,016 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-18 19:20:33,016 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:20:33,017 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:20:33,017 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:20:33,017 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:20:33,017 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:20:33,017 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 19:20:33,020 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:20:33,028 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 19:20:33,029 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 19:20:33,034 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 19:20:33,034 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 19:20:33,034 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-18 19:20:33,034 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:20:33,277 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 19:20:33,277 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 19:20:33,278 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 19:20:33,278 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:20:33,382 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 19:20:33,382 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 19:20:33,382 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:20:33,384 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 19:20:33,386 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 19:20:33,387 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 19:20:33,388 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:33,390 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 19:20:33,390 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 19:20:33,391 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.37초
2025-09-18 19:20:33,391 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:33,391 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 19:20:33,391 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:20:33,436 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:20:33,436 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:20:33,436 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 19:20:33,436 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:20:33,436 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 19:20:33,436 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:33,436 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 19:20:33,436 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 19:20:33,436 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 19:20:33,437 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-18 19:20:33,438 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-18 19:20:33,438 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:20:33,438 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-18 19:20:33,438 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-18 19:20:33,438 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-18 19:20:33,438 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:20:33,438 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:20:39,747 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:20:39,751 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-18 19:20:39,752 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-18 19:20:39,752 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:20:39,753 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:20:39,753 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:20:39,753 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 19:20:39,755 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:20:39,755 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 19:20:39,872 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:20:39,872 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:39,873 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:20:39,873 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:39,873 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 19:20:39,873 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 19:20:39,873 - mms_extractor - INFO - 상품 수: 3개
2025-09-18 19:20:39,873 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 19:20:39,873 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:20:39,873 - mms_extractor - INFO - process_message 실행완료: 6.86초
2025-09-18 19:20:39,873 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 1개
2025-09-18 19:20:39,873 - __main__ - INFO - 추출 완료: 6.857초
2025-09-18 19:20:39,873 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:39] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:20:39,902 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:39] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:50,713 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:50] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:51,821 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:20:51] "GET /health HTTP/1.1" 200 -
2025-09-18 19:20:51,834 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-18 19:20:51,834 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-18 19:20:51,834 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-18 19:20:51,834 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-18 19:20:51,834 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:51,834 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-18 19:20:51,834 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:51,834 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-18 19:20:51,834 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-18 19:20:51,834 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-18 19:20:51,834 - mms_extractor - INFO - 데이터 소스: local
2025-09-18 19:20:51,834 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-18 19:20:51,834 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-18 19:20:51,834 - mms_extractor - INFO - LLM 모델: ax
2025-09-18 19:20:51,834 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-18 19:20:51,834 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-18 19:20:51,834 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-18 19:20:51,834 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-18 19:20:51,834 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-18 19:20:51,836 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-18 19:20:51,842 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-18 19:20:51,843 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-18 19:20:51,847 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-18 19:20:51,847 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-18 19:20:51,847 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-18 19:20:51,847 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-18 19:20:52,156 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-18 19:20:52,156 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-18 19:20:52,156 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-18 19:20:52,156 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-18 19:20:52,263 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-18 19:20:52,264 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-18 19:20:52,264 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-18 19:20:52,266 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-18 19:20:52,268 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-18 19:20:52,268 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-18 19:20:52,269 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:52,271 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-18 19:20:52,272 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-18 19:20:52,272 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.44초
2025-09-18 19:20:52,272 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:52,272 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-18 19:20:52,272 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-18 19:20:52,315 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-18 19:20:52,315 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-18 19:20:52,315 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-18 19:20:52,315 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-18 19:20:52,315 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-18 19:20:52,315 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-18 19:20:52,315 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-18 19:20:52,315 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-18 19:20:52,316 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-18 19:20:52,317 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-18 19:20:52,317 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-18 19:20:52,317 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-18 19:20:52,317 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-18 19:20:52,317 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-18 19:20:52,317 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-18 19:20:52,317 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-18 19:20:52,317 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-18 19:20:58,227 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:20:58,231 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-18 19:20:58,232 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-18 19:20:58,232 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-18 19:20:58,233 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-18 19:20:58,233 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-18 19:20:58,233 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-18 19:20:58,234 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-18 19:20:58,234 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-18 19:20:58,351 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-18 19:20:58,351 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:58,351 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-18 19:20:58,351 - mms_extractor - INFO - ============================================================
2025-09-18 19:20:58,351 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-18 19:20:58,351 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-18 19:20:58,351 - mms_extractor - INFO - 상품 수: 3개
2025-09-18 19:20:58,351 - mms_extractor - INFO - 채널 수: 3개
2025-09-18 19:20:58,351 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-18 19:20:58,351 - mms_extractor - INFO - process_message 실행완료: 6.52초
2025-09-18 19:20:58,351 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-18 19:20:58,351 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-18 19:20:58,351 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-18 19:20:58,351 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-18 19:20:58,351 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x31cd19520> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x31cc0fe30> root_client=<openai.OpenAI object at 0x31cc7a870> root_async_client=<openai.AsyncOpenAI object at 0x3500a7f20> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-18 19:20:58,351 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-18 19:20:58,352 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-18 19:21:16,459 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-18 19:21:16,461 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2098자
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 178자
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인']
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인')]
2025-09-18 19:21:16,462 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-18 19:21:16,462 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 19:21:16,463 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-09-18 19:21:16,463 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-18 19:21:17,031 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-18 19:21:17,031 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-18 19:21:17,032 - mms_extractor - INFO - 🕒 DAG 처리 시간: 18.680초
2025-09-18 19:21:17,032 - mms_extractor - INFO - 📏 DAG 섹션 길이: 178자
2025-09-18 19:21:17,032 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)...
2025-09-18 19:21:17,032 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-18 19:21:17,032 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-18 19:21:17,032 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 4자
2025-09-18 19:21:17,032 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)']...
2025-09-18 19:21:17,032 - __main__ - INFO - 추출 완료: 25.198초
2025-09-18 19:21:17,032 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:21:17] "POST /extract HTTP/1.1" 200 -
2025-09-18 19:21:17,058 - werkzeug - INFO - 127.0.0.1 - - [18/Sep/2025 19:21:17] "GET /health HTTP/1.1" 200 -
2025-09-19 10:50:05,673 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 10:50:05,674 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 10:50:05,674 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 10:50:05,674 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 10:50:05,674 - mms_extractor - INFO - ============================================================
2025-09-19 10:50:05,674 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 10:50:05,674 - mms_extractor - INFO - ============================================================
2025-09-19 10:50:05,674 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 10:50:05,674 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 10:50:05,674 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 10:50:05,675 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 10:50:05,675 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 10:50:05,675 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 10:50:05,675 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 10:50:05,676 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 10:50:05,676 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 10:50:05,676 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 10:50:05,676 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 10:50:05,676 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 10:50:05,681 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 10:50:05,688 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 10:50:05,689 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 10:50:05,691 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 10:50:05,691 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 10:50:05,691 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '시크릿', '데일리']
2025-09-19 10:50:05,691 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 10:50:29,196 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 10:50:29,196 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 10:50:29,197 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 10:50:29,197 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 10:50:29,241 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 10:50:29,242 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 10:50:29,242 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 10:50:29,245 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 10:50:29,247 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 10:50:29,247 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 10:50:29,248 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 10:50:29,248 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 23.57초
2025-09-19 10:50:29,248 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 10:50:29,248 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 10:50:29,248 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 10:50:29,397 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 10:50:29,397 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 10:50:29,397 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 10:50:29,398 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 10:50:29,398 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 10:50:29,398 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 10:50:29,398 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 10:50:29,398 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 10:50:29,398 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 10:50:29,398 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 10:50:29,398 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 10:50:29,398 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 10:50:29,398 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 10:50:29,398 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 10:50:29,398 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 10:50:36,442 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 10:50:36,445 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 10:50:36,445 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 10:50:36,445 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 10:50:36,446 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 10:50:36,446 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 10:50:36,446 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 10:50:36,446 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 10:50:36,446 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 10:50:36,843 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 10:50:36,843 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 10:50:36,843 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 10:50:36,843 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 10:50:38,687 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 10:50:38,826 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.38초
2025-09-19 10:50:38,830 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 10:50:38,830 - mms_extractor - INFO - ============================================================
2025-09-19 10:50:38,830 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 10:50:38,830 - mms_extractor - INFO - ============================================================
2025-09-19 10:50:38,830 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 10:50:38,830 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 10:50:38,830 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 10:50:38,830 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 10:50:38,830 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 10:50:38,830 - mms_extractor - INFO - process_message 실행완료: 33.16초
2025-09-19 10:50:38,830 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 10:50:38,830 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 10:50:38,830 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 10:50:38,830 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 10:50:38,830 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x31cd19520> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x31cc0fe30> root_client=<openai.OpenAI object at 0x31cc7a870> root_async_client=<openai.AsyncOpenAI object at 0x3500a7f20> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 10:50:38,830 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 10:50:38,830 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 10:50:56,648 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 10:50:56,650 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1922자
2025-09-19 10:50:56,650 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 10:50:56,650 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 10:50:56,650 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 10:50:56,650 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 10:50:56,651 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 10:50:56,651 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 10:50:56,651 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 10:50:56,651 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 10:50:56,651 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 10:50:56,651 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 10:50:56,652 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 10:50:57,483 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 10:50:57,483 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 10:50:57,483 - mms_extractor - INFO - 🕒 DAG 처리 시간: 18.653초
2025-09-19 10:50:57,483 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 10:50:57,483 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 10:50:57,483 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 10:50:57,483 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 10:50:57,484 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 10:50:57,484 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 10:50:57,484 - __main__ - INFO - 추출 완료: 51.810초
2025-09-19 10:50:57,484 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 10:50:57] "POST /extract HTTP/1.1" 200 -
2025-09-19 10:55:56,934 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 10:55:56,935 - mms_extractor - INFO - ============================================================
2025-09-19 10:55:56,935 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 10:55:56,935 - mms_extractor - INFO - ============================================================
2025-09-19 10:55:56,935 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 10:55:56,935 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 10:55:56,935 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 10:55:56,935 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 10:55:56,935 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 10:55:56,935 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 10:55:56,935 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 10:55:56,936 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 10:55:56,936 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 10:55:56,936 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 10:55:56,936 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 10:55:56,936 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 10:55:56,945 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 10:55:56,949 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 10:55:56,950 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 10:55:56,955 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 10:55:56,956 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 10:55:56,956 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '시크릿', '데일리']
2025-09-19 10:55:56,956 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 10:56:04,234 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 10:56:04,234 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 10:56:04,235 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 10:56:04,235 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 10:56:04,282 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 10:56:04,282 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 10:56:04,282 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 10:56:04,285 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 10:56:04,287 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 10:56:04,287 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 10:56:04,287 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 10:56:04,288 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.35초
2025-09-19 10:56:04,288 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 10:56:04,288 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 10:56:04,288 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 10:56:04,431 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 10:56:04,431 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 10:56:04,431 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 10:56:04,431 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 10:56:04,431 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 10:56:04,431 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 10:56:04,431 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 10:56:04,431 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 10:56:04,431 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 10:56:04,431 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 10:56:04,431 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 10:56:04,431 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 10:56:04,431 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 10:56:04,431 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 10:56:04,431 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 10:56:11,793 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 10:56:11,796 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 10:56:11,796 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 10:56:11,796 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 10:56:11,797 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 10:56:11,798 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 10:56:11,798 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 10:56:11,798 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 10:56:11,798 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 10:56:12,189 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 10:56:12,189 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 10:56:12,189 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 10:56:12,189 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 10:56:14,155 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 10:56:14,284 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.49초
2025-09-19 10:56:14,287 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 10:56:14,288 - mms_extractor - INFO - ============================================================
2025-09-19 10:56:14,288 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 10:56:14,288 - mms_extractor - INFO - ============================================================
2025-09-19 10:56:14,288 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 10:56:14,288 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 10:56:14,288 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 10:56:14,288 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 10:56:14,288 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 10:56:14,288 - mms_extractor - INFO - process_message 실행완료: 17.35초
2025-09-19 10:56:14,288 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-19 10:56:14,288 - __main__ - INFO - 추출 완료: 17.354초
2025-09-19 10:56:14,288 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 10:56:14] "POST /extract HTTP/1.1" 200 -
2025-09-19 10:59:39,768 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 10:59:39,768 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 10:59:39,768 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 10:59:39,768 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 10:59:39,768 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 10:59:39,768 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 10:59:39,768 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 10:59:39,770 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 10:59:39,836 - mms_extractor - INFO - Using device: mps
2025-09-19 10:59:39,836 - mms_extractor - INFO - _initialize_device 실행완료: 0.07초
2025-09-19 10:59:39,836 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 10:59:39,836 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 10:59:39,836 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 10:59:39,836 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 10:59:39,836 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 10:59:39,836 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 10:59:39,836 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 10:59:43,381 - mms_extractor - INFO - Model loaded on mps
2025-09-19 10:59:43,381 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 3.55초
2025-09-19 10:59:43,381 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 10:59:43,874 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 10:59:43,874 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-19 10:59:43,874 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 10:59:43,874 - mms_extractor - INFO - ============================================================
2025-09-19 10:59:43,874 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 10:59:43,874 - mms_extractor - INFO - ============================================================
2025-09-19 10:59:43,874 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 10:59:43,874 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 10:59:43,874 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 10:59:43,874 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 10:59:43,874 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 10:59:43,948 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 10:59:43,948 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 10:59:43,948 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 10:59:43,953 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 10:59:43,954 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 10:59:43,955 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 10:59:43,955 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 10:59:43,955 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 10:59:43,955 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 10:59:43,962 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 10:59:43,965 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 10:59:43,965 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 10:59:43,965 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 10:59:43,965 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 10:59:43,965 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 10:59:43,966 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 10:59:43,966 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 10:59:43,966 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 10:59:43,966 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 10:59:43,966 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 10:59:43,973 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 10:59:43,974 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 10:59:43,974 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 10:59:43,974 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 10:59:43,974 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 10:59:44,101 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 10:59:44,105 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 10:59:44,106 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 10:59:44,106 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 10:59:44,106 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 10:59:44,106 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 10:59:44,107 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 10:59:44,107 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 10:59:44,107 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 10:59:44,107 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 10:59:44,109 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 10:59:44,110 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 10:59:44,110 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 10:59:44,125 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 10:59:44,125 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 10:59:44,125 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 10:59:44,134 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 10:59:44,134 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 10:59:44,364 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 10:59:44,364 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 10:59:44,364 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 10:59:44,364 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 10:59:44,365 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 10:59:44,365 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 10:59:44,432 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 10:59:44,432 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 10:59:44,434 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 10:59:44,435 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 10:59:44,435 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 10:59:44,435 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 10:59:44,435 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 10:59:44,435 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 10:59:44,435 - mms_extractor - INFO - ============================================================
2025-09-19 10:59:44,435 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 10:59:44,435 - mms_extractor - INFO - ============================================================
2025-09-19 10:59:44,436 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 10:59:44,436 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 10:59:44,436 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 10:59:44,436 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 10:59:44,436 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 10:59:44,437 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 10:59:44,439 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 10:59:44,440 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 10:59:44,440 - mms_extractor - INFO - _load_data 실행완료: 0.57초
2025-09-19 10:59:44,440 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 10:59:44,440 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 10:59:44,440 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 10:59:44,440 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 10:59:44,440 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 10:59:44,440 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 10:59:44,440 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 10:59:44,440 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 10:59:44,440 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 10:59:44,440 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 10:59:44,440 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 10:59:44,459 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 10:59:44,459 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 10:59:58,940 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 10:59:58] "[31m[1mPOST /extract/batch HTTP/1.1[0m" 400 -
2025-09-19 11:00:12,694 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:00:12] "[31m[1mPOST /extract/batch HTTP/1.1[0m" 400 -
2025-09-19 11:00:19,485 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 11:00:19,485 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 11:00:19,485 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 11:00:19,485 - mms_extractor - INFO - ============================================================
2025-09-19 11:00:19,485 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:00:19,485 - mms_extractor - INFO - ============================================================
2025-09-19 11:00:19,485 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:00:19,485 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:00:19,485 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:00:19,485 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:00:19,485 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:00:19,485 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:00:19,485 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:00:19,485 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:00:19,485 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:00:19,486 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:00:19,486 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:00:19,486 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:00:19,487 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:00:19,965 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:00:19,966 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:00:19,967 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:00:19,967 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:00:19,967 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '뚜레쥬르', '에이닷이빵쏜닷', '데일리']
2025-09-19 11:00:19,967 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:00:26,825 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:00:26,826 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:00:26,827 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:00:26,827 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:00:26,874 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:00:26,875 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:00:26,875 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:00:26,878 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:00:26,880 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:00:26,880 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:00:26,880 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:00:26,880 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.39초
2025-09-19 11:00:26,881 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:00:26,881 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:00:26,881 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:00:27,016 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:00:27,017 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:00:27,017 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:00:27,017 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:00:27,017 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:00:27,017 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:00:27,017 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:00:27,017 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:00:27,017 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:00:27,017 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:00:27,017 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:00:27,017 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:00:27,017 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:00:27,017 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:00:27,017 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:00:33,986 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:00:33,992 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:00:33,992 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:00:33,992 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:00:33,993 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:00:33,993 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:00:33,993 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:00:33,993 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:00:33,993 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:00:34,380 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:00:34,380 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:00:34,380 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:00:34,380 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:00:35,379 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:00:35,510 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.52초
2025-09-19 11:00:35,514 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:00:35,514 - mms_extractor - INFO - ============================================================
2025-09-19 11:00:35,514 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:00:35,514 - mms_extractor - INFO - ============================================================
2025-09-19 11:00:35,514 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:00:35,514 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:00:35,514 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:00:35,514 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:00:35,514 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:00:35,514 - mms_extractor - INFO - process_message 실행완료: 16.03초
2025-09-19 11:00:35,514 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 11:00:35,514 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 11:00:35,515 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 16.03초
2025-09-19 11:00:35,515 - mms_extractor - INFO - 평균 처리 시간: 16.03초/메시지
2025-09-19 11:00:35,515 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 16.030초 소요
2025-09-19 11:00:35,515 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:00:35] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 11:01:01,233 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 11:01:01,233 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 11:01:01,233 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 11:01:01,233 - mms_extractor - INFO - ============================================================
2025-09-19 11:01:01,233 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:01:01,233 - mms_extractor - INFO - ============================================================
2025-09-19 11:01:01,233 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:01:01,233 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:01:01,233 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:01:01,234 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:01:01,234 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:01:01,234 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:01:01,234 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:01:01,234 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:01:01,234 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:01:01,234 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:01:01,234 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:01:01,234 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:01:01,236 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:01:01,238 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:01:01,238 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:01:01,241 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:01:01,241 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:01:01,241 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '뚜레쥬르', '에이닷이빵쏜닷', '데일리']
2025-09-19 11:01:01,241 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:01:01,565 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:01:01,565 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:01:01,565 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:01:01,566 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:01:01,610 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:01:01,611 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:01:01,611 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:01:01,613 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:01:01,615 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:01:01,616 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:01:01,616 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:01:01,616 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.38초
2025-09-19 11:01:01,616 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:01:01,616 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:01:01,616 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:01:01,656 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:01:01,657 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:01:01,657 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:01:01,657 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:01:01,657 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:01:01,657 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:01:01,657 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:01:01,657 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:01:01,657 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:01:01,657 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:01:01,657 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:01:01,657 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:01:01,657 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:01:01,657 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:01:01,657 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:01:08,864 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:01:08,867 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:01:08,868 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:01:08,868 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:01:08,869 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:01:08,869 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:01:08,869 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:01:08,869 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:01:08,869 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:01:09,245 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:01:09,246 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:01:09,246 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:01:09,246 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:01:10,298 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:01:10,422 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.55초
2025-09-19 11:01:10,426 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:01:10,426 - mms_extractor - INFO - ============================================================
2025-09-19 11:01:10,426 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:01:10,426 - mms_extractor - INFO - ============================================================
2025-09-19 11:01:10,426 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:01:10,426 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:01:10,426 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:01:10,426 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:01:10,426 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:01:10,426 - mms_extractor - INFO - process_message 실행완료: 9.19초
2025-09-19 11:01:10,426 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 11:01:10,426 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 11:01:10,426 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 9.19초
2025-09-19 11:01:10,426 - mms_extractor - INFO - 평균 처리 시간: 9.19초/메시지
2025-09-19 11:01:10,426 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 9.194초 소요
2025-09-19 11:01:10,427 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:01:10] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 11:02:14,316 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:14] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:18,814 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:18] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:20,825 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:20] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:22,661 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:22] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:22,696 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:22] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:24,296 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:24] "GET /health HTTP/1.1" 200 -
2025-09-19 11:02:24,317 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 11:02:24,317 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:02:24,317 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 11:02:24,317 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 11:02:24,318 - mms_extractor - INFO - ============================================================
2025-09-19 11:02:24,318 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:02:24,318 - mms_extractor - INFO - ============================================================
2025-09-19 11:02:24,318 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 11:02:24,318 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 11:02:24,318 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:02:24,318 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:02:24,318 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 11:02:24,318 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-09-19 11:02:24,318 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:02:24,318 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:02:24,318 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:02:24,318 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:02:24,318 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:02:24,318 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 11:02:24,321 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:02:24,333 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 11:02:24,334 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 11:02:24,339 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 11:02:24,339 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 11:02:24,339 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', 'Netflix', '넷플릭스']
2025-09-19 11:02:24,339 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:02:24,574 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 11:02:24,574 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 11:02:24,574 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 11:02:24,574 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:02:24,666 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 11:02:24,667 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 11:02:24,667 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:02:24,669 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 11:02:24,671 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 11:02:24,671 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 11:02:24,672 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 11:02:24,674 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 11:02:24,675 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 11:02:24,675 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.36초
2025-09-19 11:02:24,675 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 11:02:24,675 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 11:02:24,675 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:02:24,721 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:02:24,721 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:02:24,721 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 11:02:24,721 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:02:24,721 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 11:02:24,721 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 11:02:24,721 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 11:02:24,721 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 11:02:24,721 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 11:02:24,722 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 11:02:24,722 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 11:02:24,722 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:02:24,723 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 11:02:24,723 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:02:24,723 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 11:02:24,723 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:02:24,723 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:02:32,015 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:02:32,019 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-09-19 11:02:32,019 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-09-19 11:02:32,019 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:02:32,020 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:02:32,021 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:02:32,021 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 11:02:32,021 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:02:32,022 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-09-19 11:02:32,169 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:02:32,169 - mms_extractor - INFO - ============================================================
2025-09-19 11:02:32,169 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:02:32,169 - mms_extractor - INFO - ============================================================
2025-09-19 11:02:32,169 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 11:02:32,169 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-19 11:02:32,169 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 11:02:32,169 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 11:02:32,169 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:02:32,169 - mms_extractor - INFO - process_message 실행완료: 7.85초
2025-09-19 11:02:32,169 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 11:02:32,169 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 11:02:32,169 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 11:02:32,169 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 11:02:32,169 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34f5a2270> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35a9abc50> root_client=<openai.OpenAI object at 0x34f71a7b0> root_async_client=<openai.AsyncOpenAI object at 0x34f5a3830> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 11:02:32,169 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 11:02:32,170 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 11:02:53,317 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:02:53,319 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2516자
2025-09-19 11:02:53,320 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 11:02:53,320 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 11:02:53,321 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-09-19 11:02:53,321 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 11:02:53,322 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 11:02:53,322 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 11:02:53,322 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 11:02:53,322 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 11:02:53,323 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 11:02:53,323 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 11:02:53,325 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 11:02:53,902 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 11:02:53,902 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 11:02:53,902 - mms_extractor - INFO - 🕒 DAG 처리 시간: 21.733초
2025-09-19 11:02:53,902 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-09-19 11:02:53,902 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-09-19 11:02:53,902 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 11:02:53,902 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-19 11:02:53,902 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 11:02:53,902 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 11:02:53,903 - __main__ - INFO - 추출 완료: 29.585초
2025-09-19 11:02:53,903 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:53] "POST /extract HTTP/1.1" 200 -
2025-09-19 11:02:53,930 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:02:53] "GET /health HTTP/1.1" 200 -
2025-09-19 11:06:52,812 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:06:52,813 - mms_extractor - INFO - ============================================================
2025-09-19 11:06:52,813 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:06:52,813 - mms_extractor - INFO - ============================================================
2025-09-19 11:06:52,813 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:06:52,813 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:06:52,813 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:06:52,813 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:06:52,813 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:06:52,813 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:06:52,813 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:06:52,813 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:06:52,813 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:06:52,813 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:06:52,813 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:06:52,814 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:06:52,815 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:06:52,818 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:06:52,819 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:06:52,821 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:06:52,821 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:06:52,821 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '뚜레쥬르', '에이닷이빵쏜닷', '데일리']
2025-09-19 11:06:52,821 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:06:53,061 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:06:53,061 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:06:53,062 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:06:53,062 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:06:53,109 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:06:53,109 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:06:53,109 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:06:53,112 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:06:53,113 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:06:53,114 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:06:53,114 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:06:53,114 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.30초
2025-09-19 11:06:53,114 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:06:53,114 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:06:53,114 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:06:53,161 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:06:53,161 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:06:53,161 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:06:53,161 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:06:53,161 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:06:53,161 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:06:53,161 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:06:53,161 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:06:53,161 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:06:53,161 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:06:53,162 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:06:53,162 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:06:53,162 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:06:53,162 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:06:53,162 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:07:00,406 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:07:00,408 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:07:00,408 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:07:00,408 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:07:00,409 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:07:00,409 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:07:00,409 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:07:00,409 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:07:00,409 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:07:00,807 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:07:00,808 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:07:00,808 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:07:00,808 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:07:01,758 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:07:01,901 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.49초
2025-09-19 11:07:01,905 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:07:01,905 - mms_extractor - INFO - ============================================================
2025-09-19 11:07:01,905 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:07:01,905 - mms_extractor - INFO - ============================================================
2025-09-19 11:07:01,905 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:07:01,905 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:07:01,905 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:07:01,905 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:07:01,905 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:07:01,905 - mms_extractor - INFO - process_message 실행완료: 9.09초
2025-09-19 11:07:01,905 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-19 11:07:01,905 - __main__ - INFO - 추출 완료: 9.093초
2025-09-19 11:07:01,905 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:07:01] "POST /extract HTTP/1.1" 200 -
2025-09-19 11:22:49,790 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 11:22:49,790 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 11:22:49,790 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 11:22:49,790 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 11:22:49,790 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 11:22:49,790 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 11:22:49,790 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 11:22:49,792 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 11:22:49,855 - mms_extractor - INFO - Using device: mps
2025-09-19 11:22:49,855 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-09-19 11:22:49,855 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 11:22:49,855 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 11:22:49,855 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 11:22:49,855 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 11:22:49,855 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 11:22:49,856 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 11:22:49,856 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 11:22:55,818 - mms_extractor - INFO - Model loaded on mps
2025-09-19 11:22:55,818 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.96초
2025-09-19 11:22:55,818 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 11:22:56,261 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 11:22:56,261 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.44초
2025-09-19 11:22:56,261 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 11:22:56,261 - mms_extractor - INFO - ============================================================
2025-09-19 11:22:56,261 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 11:22:56,261 - mms_extractor - INFO - ============================================================
2025-09-19 11:22:56,261 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 11:22:56,261 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 11:22:56,261 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 11:22:56,261 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 11:22:56,261 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:22:56,333 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 11:22:56,333 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:22:56,333 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 11:22:56,336 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 11:22:56,337 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 11:22:56,338 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:22:56,338 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:22:56,339 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 11:22:56,339 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 11:22:56,348 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 11:22:56,350 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 11:22:56,350 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 11:22:56,350 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:22:56,350 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 11:22:56,350 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 11:22:56,351 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 11:22:56,351 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:22:56,351 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 11:22:56,351 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 11:22:56,351 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 11:22:56,356 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 11:22:56,357 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 11:22:56,357 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:22:56,357 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 11:22:56,357 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:22:56,481 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 11:22:56,486 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 11:22:56,486 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 11:22:56,486 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 11:22:56,487 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 11:22:56,487 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 11:22:56,488 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 11:22:56,488 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 11:22:56,488 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 11:22:56,488 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 11:22:56,490 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 11:22:56,491 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 11:22:56,491 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 11:22:56,504 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 11:22:56,504 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 11:22:56,504 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 11:22:56,517 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 11:22:56,517 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 11:22:56,714 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 11:22:56,714 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 11:22:56,714 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 11:22:56,714 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 11:22:56,714 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 11:22:56,714 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:22:56,781 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 11:22:56,781 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:22:56,783 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 11:22:56,783 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 11:22:56,783 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 11:22:56,783 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:22:56,783 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 11:22:56,784 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 11:22:56,784 - mms_extractor - INFO - ============================================================
2025-09-19 11:22:56,784 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 11:22:56,784 - mms_extractor - INFO - ============================================================
2025-09-19 11:22:56,784 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 11:22:56,784 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 11:22:56,784 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 11:22:56,784 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 11:22:56,784 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 11:22:56,785 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 11:22:56,787 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 11:22:56,788 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 11:22:56,788 - mms_extractor - INFO - _load_data 실행완료: 0.53초
2025-09-19 11:22:56,788 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 11:22:56,788 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 11:22:56,788 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 11:22:56,788 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 11:22:56,788 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 11:22:56,788 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 11:22:56,788 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 11:22:56,788 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 11:22:56,788 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 11:22:56,788 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 11:22:56,788 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 11:22:56,814 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 11:22:56,814 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 11:23:39,466 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:23:39,466 - mms_extractor - INFO - ============================================================
2025-09-19 11:23:39,466 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:23:39,466 - mms_extractor - INFO - ============================================================
2025-09-19 11:23:39,466 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:23:39,466 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:23:39,466 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:23:39,466 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:23:39,466 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:23:39,466 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:23:39,466 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:23:39,466 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:23:39,466 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:23:39,466 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:23:39,466 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:23:39,466 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:23:39,468 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:23:39,984 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:23:39,985 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:23:39,987 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:23:39,987 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:23:39,987 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리']
2025-09-19 11:23:39,987 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:23:47,336 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:23:47,336 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:23:47,337 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:23:47,337 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:23:47,384 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:23:47,384 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:23:47,384 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:23:47,387 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:23:47,389 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:23:47,389 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:23:47,390 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:23:47,390 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.92초
2025-09-19 11:23:47,390 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:23:47,390 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:23:47,390 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:23:47,573 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:23:47,573 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:23:47,573 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:23:47,573 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:23:47,573 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:23:47,573 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:23:47,573 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:23:47,573 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:23:47,573 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:23:47,573 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:23:47,574 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:23:47,574 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:23:47,574 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:23:47,574 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:23:47,574 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:23:54,624 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:23:54,631 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:23:54,631 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:23:54,632 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:23:54,632 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:23:54,632 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:23:54,632 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:23:54,632 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:23:54,632 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:23:55,014 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:23:55,014 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:23:55,014 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:23:55,014 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:23:56,056 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:23:56,201 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.57초
2025-09-19 11:23:56,205 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:23:56,205 - mms_extractor - INFO - ============================================================
2025-09-19 11:23:56,205 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:23:56,206 - mms_extractor - INFO - ============================================================
2025-09-19 11:23:56,206 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:23:56,206 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:23:56,206 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:23:56,206 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:23:56,206 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:23:56,206 - mms_extractor - INFO - process_message 실행완료: 16.74초
2025-09-19 11:23:56,206 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:23:56,206 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:23:56,207 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:23:56] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:29:00,997 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:29:00,998 - mms_extractor - INFO - ============================================================
2025-09-19 11:29:00,998 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:29:00,998 - mms_extractor - INFO - ============================================================
2025-09-19 11:29:00,998 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:29:00,998 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:29:00,998 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:29:00,998 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:29:00,998 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:29:00,998 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:29:00,998 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:29:00,998 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:29:00,998 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:29:00,998 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:29:00,998 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:29:00,998 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:29:01,000 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:29:01,007 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:29:01,008 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:29:01,010 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:29:01,010 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:29:01,010 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리']
2025-09-19 11:29:01,010 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:29:21,238 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:29:21,238 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:29:21,239 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:29:21,239 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:29:21,284 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:29:21,285 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:29:21,285 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:29:21,287 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:29:21,290 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:29:21,290 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:29:21,290 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:29:21,290 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 20.29초
2025-09-19 11:29:21,290 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:29:21,291 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:29:21,291 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:29:21,427 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:29:21,427 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:29:21,427 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:29:21,427 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:29:21,427 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:29:21,427 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:29:21,427 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:29:21,427 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:29:21,427 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:29:21,427 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:29:21,427 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:29:21,427 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:29:21,427 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:29:21,427 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:29:21,427 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:29:28,285 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:29:28,287 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:29:28,287 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:29:28,287 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:29:28,287 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:29:28,287 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:29:28,288 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:29:28,288 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:29:28,288 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:29:28,658 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:29:28,658 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:29:28,658 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:29:28,658 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:29:29,674 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:29:29,824 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.54초
2025-09-19 11:29:29,827 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:29:29,827 - mms_extractor - INFO - ============================================================
2025-09-19 11:29:29,827 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:29:29,827 - mms_extractor - INFO - ============================================================
2025-09-19 11:29:29,827 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:29:29,828 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:29:29,828 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:29:29,828 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:29:29,828 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:29:29,828 - mms_extractor - INFO - process_message 실행완료: 28.83초
2025-09-19 11:29:29,828 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:29:29,828 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:29:29,828 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:29:29] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:31:05,314 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:31:05,315 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:05,315 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:31:05,315 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:05,315 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:31:05,315 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:31:05,315 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:31:05,315 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:31:05,315 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:31:05,315 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:31:05,315 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:31:05,315 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:31:05,315 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:31:05,315 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:31:05,315 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:31:05,315 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:31:05,318 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:31:05,322 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:31:05,323 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:31:05,326 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:31:05,326 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:31:05,326 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리']
2025-09-19 11:31:05,326 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:31:05,545 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:31:05,545 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:31:05,545 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:31:05,545 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:31:05,602 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:31:05,602 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:31:05,602 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:31:05,605 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:31:05,607 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:31:05,607 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:31:05,607 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:31:05,607 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.29초
2025-09-19 11:31:05,607 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:31:05,607 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:31:05,607 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:31:05,652 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:31:05,652 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:31:05,653 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:31:05,653 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:31:05,653 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:31:05,653 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:31:05,653 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:31:05,653 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:31:05,653 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:31:05,653 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:31:05,653 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:31:05,653 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:31:05,653 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:31:05,653 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:31:05,653 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:31:12,541 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:31:12,545 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:31:12,545 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:31:12,545 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:31:12,546 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:31:12,546 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:31:12,546 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:31:12,547 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:31:12,547 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:31:12,946 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:31:12,946 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:31:12,946 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:31:12,946 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:31:13,925 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:31:14,068 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.52초
2025-09-19 11:31:14,071 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:31:14,071 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:14,071 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:31:14,071 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:14,071 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:31:14,071 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:31:14,072 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:31:14,072 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:31:14,072 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:31:14,072 - mms_extractor - INFO - process_message 실행완료: 8.76초
2025-09-19 11:31:14,072 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:31:14,072 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:31:14,072 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:31:14] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:31:34,465 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:31:34,465 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:34,465 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:31:34,465 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:34,465 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:31:34,465 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:31:34,465 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:31:34,465 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:31:34,465 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:31:34,465 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:31:34,465 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:31:34,465 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:31:34,465 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:31:34,465 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:31:34,465 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:31:34,465 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:31:34,467 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:31:34,467 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:31:34,468 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:31:34,469 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:31:34,469 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:31:34,469 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리']
2025-09-19 11:31:34,469 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:31:34,694 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:31:34,694 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:31:34,694 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:31:34,694 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:31:34,739 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:31:34,739 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:31:34,740 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:31:34,742 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:31:34,743 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:31:34,744 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:31:34,744 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:31:34,744 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.28초
2025-09-19 11:31:34,744 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:31:34,744 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:31:34,744 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:31:34,784 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:31:34,784 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:31:34,784 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:31:34,784 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:31:34,784 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:31:34,784 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:31:34,784 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:31:34,784 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:31:34,784 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:31:34,784 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:31:34,785 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:31:34,785 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:31:34,785 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:31:34,785 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:31:34,785 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:31:41,809 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:31:41,813 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:31:41,813 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:31:41,813 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:31:41,814 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:31:41,814 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:31:41,814 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:31:41,814 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:31:41,814 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:31:42,203 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:31:42,203 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:31:42,203 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:31:42,203 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:31:43,201 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:31:43,347 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.53초
2025-09-19 11:31:43,350 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:31:43,350 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:43,350 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:31:43,350 - mms_extractor - INFO - ============================================================
2025-09-19 11:31:43,350 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:31:43,350 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:31:43,350 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:31:43,350 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:31:43,350 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:31:43,350 - mms_extractor - INFO - process_message 실행완료: 8.89초
2025-09-19 11:31:43,350 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:31:43,350 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:31:43,351 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:31:43] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:33:47,885 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:33:47,886 - mms_extractor - INFO - ============================================================
2025-09-19 11:33:47,886 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:33:47,886 - mms_extractor - INFO - ============================================================
2025-09-19 11:33:47,886 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:33:47,886 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:33:47,886 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:33:47,886 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:33:47,886 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:33:47,886 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:33:47,886 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:33:47,886 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:33:47,886 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:33:47,886 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:33:47,886 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:33:47,886 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:33:47,888 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:33:47,888 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:33:47,889 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:33:47,890 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:33:47,890 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:33:47,890 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '시크릿', '뚜레쥬르', '데일리']
2025-09-19 11:33:47,890 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:33:48,106 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:33:48,106 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:33:48,106 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:33:48,106 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:33:48,153 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:33:48,153 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:33:48,153 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:33:48,155 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:33:48,157 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:33:48,157 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:33:48,157 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:33:48,158 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.27초
2025-09-19 11:33:48,158 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:33:48,158 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:33:48,158 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:33:48,199 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:33:48,200 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:33:48,200 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:33:48,200 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:33:48,200 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:33:48,200 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:33:48,200 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:33:48,200 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:33:48,200 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:33:48,200 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:33:48,200 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:33:48,200 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:33:48,200 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:33:48,200 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:33:48,200 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:33:55,063 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:33:55,064 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:33:55,064 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:33:55,064 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:33:55,064 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:33:55,064 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:33:55,064 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:33:55,064 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:33:55,064 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:33:55,436 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:33:55,436 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:33:55,436 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:33:55,436 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:33:56,406 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:33:56,529 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.46초
2025-09-19 11:33:56,532 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:33:56,532 - mms_extractor - INFO - ============================================================
2025-09-19 11:33:56,532 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:33:56,533 - mms_extractor - INFO - ============================================================
2025-09-19 11:33:56,533 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:33:56,533 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:33:56,533 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:33:56,533 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:33:56,533 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:33:56,533 - mms_extractor - INFO - process_message 실행완료: 8.65초
2025-09-19 11:33:56,533 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:33:56,533 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:33:56,533 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:33:56] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:36:14,297 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 11:36:14,297 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 11:36:14,297 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 11:36:14,297 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 11:36:14,297 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 11:36:14,297 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 11:36:14,297 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 11:36:14,298 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 11:36:14,370 - mms_extractor - INFO - Using device: mps
2025-09-19 11:36:14,370 - mms_extractor - INFO - _initialize_device 실행완료: 0.07초
2025-09-19 11:36:14,370 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 11:36:14,371 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 11:36:14,371 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 11:36:14,371 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 11:36:14,371 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 11:36:14,371 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 11:36:14,371 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 11:36:18,601 - mms_extractor - INFO - Model loaded on mps
2025-09-19 11:36:18,601 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.23초
2025-09-19 11:36:18,601 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 11:36:19,132 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 11:36:19,133 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.53초
2025-09-19 11:36:19,133 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 11:36:19,133 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:19,133 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 11:36:19,133 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:19,133 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 11:36:19,133 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 11:36:19,133 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 11:36:19,133 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 11:36:19,133 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:36:19,219 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 11:36:19,219 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:36:19,219 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 11:36:19,223 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 11:36:19,223 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 11:36:19,224 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:36:19,225 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:36:19,225 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 11:36:19,225 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 11:36:19,232 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 11:36:19,235 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 11:36:19,235 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 11:36:19,235 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:36:19,235 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 11:36:19,235 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 11:36:19,236 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 11:36:19,236 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:36:19,236 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 11:36:19,236 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 11:36:19,236 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 11:36:19,243 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 11:36:19,243 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 11:36:19,243 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:36:19,243 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 11:36:19,244 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:36:19,375 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 11:36:19,381 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 11:36:19,381 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 11:36:19,381 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 11:36:19,382 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 11:36:19,382 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 11:36:19,383 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 11:36:19,383 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 11:36:19,383 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 11:36:19,383 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 11:36:19,386 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 11:36:19,387 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 11:36:19,387 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 11:36:19,402 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 11:36:19,402 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 11:36:19,402 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 11:36:19,415 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 11:36:19,415 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 11:36:19,647 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 11:36:19,648 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 11:36:19,648 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 11:36:19,648 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 11:36:19,648 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 11:36:19,648 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:36:19,715 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 11:36:19,715 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:36:19,717 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 11:36:19,718 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 11:36:19,718 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 11:36:19,718 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:36:19,718 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 11:36:19,718 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 11:36:19,718 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:19,718 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 11:36:19,718 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:19,718 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 11:36:19,718 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 11:36:19,718 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 11:36:19,718 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 11:36:19,718 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 11:36:19,720 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 11:36:19,722 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 11:36:19,723 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 11:36:19,723 - mms_extractor - INFO - _load_data 실행완료: 0.59초
2025-09-19 11:36:19,723 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 11:36:19,723 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 11:36:19,723 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 11:36:19,723 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 11:36:19,723 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 11:36:19,723 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 11:36:19,723 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 11:36:19,723 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 11:36:19,723 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 11:36:19,723 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 11:36:19,723 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 11:36:19,750 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 11:36:19,750 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 11:36:32,315 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:36:32,316 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:32,316 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:36:32,316 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:32,316 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:36:32,316 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:36:32,316 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:36:32,316 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:36:32,316 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:36:32,316 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:36:32,316 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:36:32,316 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:36:32,316 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:36:32,316 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:36:32,316 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:36:32,316 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:36:32,318 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:36:32,823 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:36:32,823 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:36:32,825 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:36:32,825 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:36:32,825 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '데일리', '뚜레쥬르', '에이닷이빵쏜닷']
2025-09-19 11:36:32,825 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:36:39,722 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:36:39,723 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:36:39,724 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:36:39,724 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:36:39,768 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:36:39,769 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:36:39,769 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:36:39,772 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:36:39,774 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:36:39,774 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:36:39,774 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:36:39,775 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.46초
2025-09-19 11:36:39,775 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:36:39,775 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:36:39,775 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:36:39,875 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:36:39,875 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:36:39,875 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:36:39,875 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:36:39,875 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:36:39,876 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:36:39,876 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:36:39,876 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:36:39,876 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:36:39,876 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:36:39,876 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:36:39,876 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:36:39,876 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:36:39,876 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:36:39,876 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:36:46,932 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:36:46,940 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:36:46,941 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:36:46,941 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:36:46,941 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:36:46,941 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:36:46,941 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:36:46,941 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:36:46,941 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:36:47,326 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:36:47,326 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:36:47,326 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:36:47,326 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:36:48,234 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:36:48,373 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.43초
2025-09-19 11:36:48,377 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:36:48,377 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:48,377 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:36:48,377 - mms_extractor - INFO - ============================================================
2025-09-19 11:36:48,377 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:36:48,377 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:36:48,377 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:36:48,377 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:36:48,377 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:36:48,377 - mms_extractor - INFO - process_message 실행완료: 16.06초
2025-09-19 11:36:48,377 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:36:48,377 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'to_dict'
2025-09-19 11:36:48,378 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:36:48] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:38:06,461 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 11:38:06,461 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 11:38:06,461 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 11:38:06,461 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 11:38:06,461 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 11:38:06,461 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 11:38:06,461 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 11:38:06,462 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 11:38:06,482 - mms_extractor - INFO - Using device: mps
2025-09-19 11:38:06,482 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 11:38:06,482 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 11:38:06,483 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 11:38:06,483 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 11:38:06,483 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 11:38:06,483 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 11:38:06,483 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 11:38:06,483 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 11:38:07,511 - mms_extractor - INFO - Model loaded on mps
2025-09-19 11:38:07,511 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.03초
2025-09-19 11:38:07,511 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 11:38:07,920 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 11:38:07,920 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.41초
2025-09-19 11:38:07,920 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 11:38:07,920 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:07,920 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 11:38:07,920 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:07,920 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 11:38:07,920 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 11:38:07,920 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 11:38:07,920 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 11:38:07,920 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:38:07,987 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 11:38:07,987 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:38:07,987 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 11:38:07,991 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 11:38:07,992 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 11:38:07,992 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:38:07,992 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:38:07,993 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 11:38:07,993 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 11:38:08,040 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 11:38:08,043 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 11:38:08,043 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 11:38:08,043 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:38:08,043 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 11:38:08,043 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 11:38:08,043 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 11:38:08,043 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:38:08,043 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 11:38:08,043 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 11:38:08,043 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 11:38:08,051 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 11:38:08,052 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 11:38:08,052 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:38:08,052 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 11:38:08,052 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:38:08,179 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 11:38:08,183 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 11:38:08,184 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증']
2025-09-19 11:38:08,184 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 11:38:08,184 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 11:38:08,184 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 11:38:08,185 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 11:38:08,185 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 11:38:08,185 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 11:38:08,185 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 11:38:08,187 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 11:38:08,188 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 11:38:08,188 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증']
2025-09-19 11:38:08,201 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 11:38:08,201 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 11:38:08,201 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 11:38:08,203 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 11:38:08,203 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 11:38:08,366 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 11:38:08,366 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 11:38:08,366 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 11:38:08,366 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 11:38:08,366 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 11:38:08,366 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:38:08,432 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 11:38:08,432 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:38:08,434 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 11:38:08,434 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 11:38:08,434 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 11:38:08,434 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:38:08,435 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 11:38:08,435 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 11:38:08,435 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:08,435 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 11:38:08,435 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:08,435 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 11:38:08,435 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 11:38:08,435 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 11:38:08,435 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 11:38:08,435 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 11:38:08,436 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 11:38:08,438 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 11:38:08,439 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 11:38:08,439 - mms_extractor - INFO - _load_data 실행완료: 0.52초
2025-09-19 11:38:08,439 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 11:38:08,439 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 11:38:08,439 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 11:38:08,439 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 11:38:08,439 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 11:38:08,439 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 11:38:08,439 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 11:38:08,439 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 11:38:08,439 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 11:38:08,439 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 11:38:08,439 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 11:38:08,449 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 11:38:08,449 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 11:38:15,401 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:38:15,401 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:15,401 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:38:15,401 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:15,401 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:38:15,401 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:38:15,401 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:38:15,401 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:38:15,401 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:38:15,401 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:38:15,401 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:38:15,401 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:38:15,402 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:38:15,402 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:38:15,402 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:38:15,402 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:38:15,403 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:38:15,912 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:38:15,912 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:38:15,914 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:38:15,914 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:38:15,914 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '에이닷이빵쏜닷', '시크릿', '뚜레쥬르']
2025-09-19 11:38:15,914 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:38:22,604 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:38:22,604 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:38:22,605 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:38:22,605 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:38:22,649 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:38:22,649 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:38:22,650 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:38:22,652 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:38:22,654 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:38:22,655 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:38:22,655 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:38:22,655 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.25초
2025-09-19 11:38:22,655 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:38:22,655 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:38:22,655 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:38:22,765 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:38:22,765 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:38:22,765 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:38:22,765 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:38:22,765 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:38:22,765 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:38:22,765 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:38:22,765 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:38:22,765 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:38:22,765 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:38:22,765 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:38:22,765 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:38:22,765 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:38:22,765 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:38:22,765 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:38:29,659 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:38:29,665 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:38:29,665 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:38:29,666 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:38:29,666 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:38:29,666 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:38:29,667 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:38:29,667 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:38:29,667 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:38:30,064 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:38:30,064 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:38:30,064 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:38:30,064 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:38:31,069 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:38:31,200 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.53초
2025-09-19 11:38:31,204 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:38:31,204 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:31,204 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:38:31,204 - mms_extractor - INFO - ============================================================
2025-09-19 11:38:31,204 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:38:31,204 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:38:31,204 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:38:31,204 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:38:31,204 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:38:31,204 - mms_extractor - INFO - process_message 실행완료: 15.80초
2025-09-19 11:38:31,204 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:38:31,204 - __main__ - ERROR - 추출 중 오류 발생: 'dict' object has no attribute 'save_to_mongodb'
2025-09-19 11:38:31,205 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:38:31] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 11:50:50,310 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 11:50:50,310 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 11:50:50,310 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 11:50:50,310 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 11:50:50,310 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 11:50:50,310 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 11:50:50,310 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 11:50:50,311 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 11:50:50,376 - mms_extractor - INFO - Using device: mps
2025-09-19 11:50:50,376 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-09-19 11:50:50,376 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 11:50:50,377 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 11:50:50,377 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 11:50:50,377 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 11:50:50,377 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 11:50:50,377 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 11:50:50,377 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 11:50:55,541 - mms_extractor - INFO - Model loaded on mps
2025-09-19 11:50:55,541 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.16초
2025-09-19 11:50:55,541 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 11:50:56,021 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 11:50:56,021 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.48초
2025-09-19 11:50:56,021 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 11:50:56,021 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:56,021 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 11:50:56,021 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:56,021 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 11:50:56,021 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 11:50:56,021 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 11:50:56,021 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 11:50:56,021 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:50:56,094 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 11:50:56,094 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:50:56,094 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 11:50:56,097 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 11:50:56,098 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 11:50:56,099 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:50:56,099 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:50:56,099 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 11:50:56,099 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 11:50:56,107 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 11:50:56,110 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 11:50:56,110 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 11:50:56,110 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:50:56,110 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 11:50:56,110 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 11:50:56,110 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 11:50:56,110 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:50:56,110 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 11:50:56,110 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 11:50:56,110 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 11:50:56,117 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 11:50:56,117 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 11:50:56,117 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:50:56,118 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 11:50:56,118 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 11:50:56,244 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 11:50:56,249 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 11:50:56,250 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 11:50:56,250 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 11:50:56,250 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 11:50:56,250 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 11:50:56,252 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 11:50:56,252 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 11:50:56,252 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 11:50:56,252 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 11:50:56,254 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 11:50:56,254 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 11:50:56,254 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 11:50:56,268 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 11:50:56,268 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 11:50:56,268 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 11:50:56,280 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 11:50:56,280 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 11:50:56,481 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 11:50:56,481 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 11:50:56,481 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 11:50:56,482 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 11:50:56,482 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 11:50:56,482 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 11:50:56,553 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 11:50:56,553 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 11:50:56,555 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 11:50:56,555 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 11:50:56,555 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 11:50:56,555 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 11:50:56,555 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 11:50:56,556 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 11:50:56,556 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:56,556 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 11:50:56,556 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:56,556 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 11:50:56,556 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 11:50:56,556 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 11:50:56,556 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 11:50:56,556 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 11:50:56,557 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 11:50:56,559 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 11:50:56,560 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 11:50:56,560 - mms_extractor - INFO - _load_data 실행완료: 0.54초
2025-09-19 11:50:56,560 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 11:50:56,560 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 11:50:56,560 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 11:50:56,560 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 11:50:56,560 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 11:50:56,560 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 11:50:56,560 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 11:50:56,560 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 11:50:56,560 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 11:50:56,560 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 11:50:56,560 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 11:50:56,586 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 11:50:56,586 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 11:50:59,776 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 11:50:59,776 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:59,776 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 11:50:59,777 - mms_extractor - INFO - ============================================================
2025-09-19 11:50:59,777 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 11:50:59,777 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 11:50:59,777 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 11:50:59,777 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 11:50:59,777 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 11:50:59,777 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 11:50:59,777 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 11:50:59,777 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 11:50:59,777 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 11:50:59,777 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 11:50:59,777 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 11:50:59,777 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 11:50:59,778 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 11:51:00,265 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 11:51:00,266 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 11:51:00,267 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 11:51:00,267 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 11:51:00,267 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-09-19 11:51:00,267 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 11:51:07,741 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 11:51:07,741 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 11:51:07,742 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 11:51:07,742 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 11:51:07,796 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 11:51:07,797 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 11:51:07,797 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 11:51:07,799 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 11:51:07,801 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 11:51:07,802 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 11:51:07,802 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 11:51:07,802 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.03초
2025-09-19 11:51:07,802 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 11:51:07,803 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 11:51:07,803 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 11:51:08,004 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 11:51:08,004 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 11:51:08,004 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 11:51:08,004 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 11:51:08,004 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 11:51:08,004 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 11:51:08,005 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 11:51:08,005 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 11:51:08,005 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 11:51:08,005 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 11:51:08,005 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 11:51:08,005 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 11:51:08,005 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 11:51:08,005 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 11:51:08,005 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 11:51:14,961 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:51:14,967 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 11:51:14,967 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 11:51:14,967 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 11:51:14,968 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 11:51:14,968 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 11:51:14,968 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 11:51:14,968 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 11:51:14,968 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 11:51:15,384 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 11:51:15,384 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 11:51:15,384 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 11:51:15,384 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 11:51:16,393 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 11:51:16,522 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.55초
2025-09-19 11:51:16,526 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 11:51:16,526 - mms_extractor - INFO - ============================================================
2025-09-19 11:51:16,526 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 11:51:16,526 - mms_extractor - INFO - ============================================================
2025-09-19 11:51:16,526 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 11:51:16,526 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 11:51:16,526 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 11:51:16,526 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 11:51:16,526 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 11:51:16,526 - mms_extractor - INFO - process_message 실행완료: 16.75초
2025-09-19 11:51:16,526 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 11:51:16,526 - __main__ - ERROR - 추출 중 오류 발생: name 'MONGODB_AVAILABLE' is not defined
2025-09-19 11:51:16,527 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 11:51:16] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 12:25:51,463 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 12:25:51,463 - mms_extractor - INFO - ============================================================
2025-09-19 12:25:51,463 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 12:25:51,463 - mms_extractor - INFO - ============================================================
2025-09-19 12:25:51,463 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 12:25:51,463 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 12:25:51,463 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 12:25:51,464 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 12:25:51,464 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 12:25:51,464 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 12:25:51,464 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 12:25:51,464 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 12:25:51,464 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 12:25:51,464 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 12:25:51,464 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 12:25:51,464 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 12:25:51,465 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 12:25:51,472 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 12:25:51,473 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 12:25:51,476 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 12:25:51,476 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 12:25:51,476 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-09-19 12:25:51,476 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 12:26:12,221 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 12:26:12,221 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 12:26:12,221 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 12:26:12,221 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 12:26:12,265 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 12:26:12,266 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 12:26:12,266 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 12:26:12,268 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 12:26:12,270 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 12:26:12,270 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 12:26:12,270 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 12:26:12,271 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 20.81초
2025-09-19 12:26:12,271 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 12:26:12,271 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 12:26:12,271 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 12:26:12,466 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 12:26:12,466 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 12:26:12,466 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 12:26:12,466 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 12:26:12,466 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 12:26:12,466 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 12:26:12,466 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 12:26:12,466 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 12:26:12,466 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 12:26:12,466 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 12:26:12,466 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 12:26:12,466 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 12:26:12,466 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 12:26:12,466 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 12:26:12,466 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 12:26:19,284 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 12:26:19,286 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 12:26:19,286 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 12:26:19,286 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 12:26:19,287 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 12:26:19,287 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 12:26:19,287 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 12:26:19,287 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 12:26:19,287 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 12:26:19,679 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 12:26:19,679 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 12:26:19,679 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 12:26:19,679 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 12:26:20,727 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 12:26:20,866 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.58초
2025-09-19 12:26:20,869 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 12:26:20,869 - mms_extractor - INFO - ============================================================
2025-09-19 12:26:20,869 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 12:26:20,869 - mms_extractor - INFO - ============================================================
2025-09-19 12:26:20,869 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 12:26:20,869 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 12:26:20,869 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 12:26:20,869 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 12:26:20,869 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 12:26:20,869 - mms_extractor - INFO - process_message 실행완료: 29.41초
2025-09-19 12:26:20,869 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 12:26:20,869 - __main__ - ERROR - 추출 중 오류 발생: name 'MONGODB_AVAILABLE' is not defined
2025-09-19 12:26:20,870 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 12:26:20] "[35m[1mPOST /extract HTTP/1.1[0m" 500 -
2025-09-19 12:30:56,193 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 12:30:56,193 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 12:30:56,193 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 12:30:56,193 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 12:30:56,193 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 12:30:56,193 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 12:30:56,193 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 12:30:56,194 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 12:30:56,261 - mms_extractor - INFO - Using device: mps
2025-09-19 12:30:56,261 - mms_extractor - INFO - _initialize_device 실행완료: 0.07초
2025-09-19 12:30:56,261 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 12:30:56,261 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 12:30:56,261 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 12:30:56,261 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 12:30:56,261 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 12:30:56,262 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 12:30:56,262 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 12:30:59,330 - mms_extractor - INFO - Model loaded on mps
2025-09-19 12:30:59,330 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 3.07초
2025-09-19 12:30:59,330 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 12:30:59,908 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 12:30:59,908 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.58초
2025-09-19 12:30:59,908 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 12:30:59,908 - mms_extractor - INFO - ============================================================
2025-09-19 12:30:59,908 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 12:30:59,908 - mms_extractor - INFO - ============================================================
2025-09-19 12:30:59,908 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 12:30:59,908 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 12:30:59,908 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 12:30:59,908 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 12:30:59,908 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:30:59,981 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 12:30:59,981 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:30:59,981 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 12:30:59,984 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 12:30:59,985 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 12:30:59,985 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:30:59,986 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:30:59,986 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 12:30:59,986 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 12:30:59,993 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 12:30:59,995 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 12:30:59,995 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 12:30:59,995 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:30:59,996 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 12:30:59,996 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 12:30:59,996 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 12:30:59,996 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:30:59,996 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 12:30:59,996 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 12:30:59,996 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 12:31:00,002 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 12:31:00,002 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 12:31:00,002 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:00,002 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 12:31:00,002 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:00,127 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 12:31:00,131 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 12:31:00,132 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 12:31:00,132 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 12:31:00,132 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 12:31:00,132 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 12:31:00,133 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 12:31:00,133 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 12:31:00,133 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 12:31:00,133 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 12:31:00,135 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 12:31:00,136 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 12:31:00,136 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 12:31:00,149 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 12:31:00,149 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 12:31:00,149 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 12:31:00,160 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 12:31:00,160 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 12:31:00,415 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 12:31:00,416 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 12:31:00,416 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 12:31:00,416 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 12:31:00,416 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 12:31:00,416 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:31:00,486 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 12:31:00,487 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:31:00,489 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 12:31:00,489 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 12:31:00,489 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 12:31:00,489 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:00,489 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 12:31:00,490 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 12:31:00,490 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:00,490 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 12:31:00,490 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:00,490 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 12:31:00,490 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 12:31:00,490 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 12:31:00,490 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 12:31:00,490 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 12:31:00,491 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 12:31:00,493 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 12:31:00,494 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 12:31:00,494 - mms_extractor - INFO - _load_data 실행완료: 0.59초
2025-09-19 12:31:00,494 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 12:31:00,494 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 12:31:00,494 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 12:31:00,494 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 12:31:00,494 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 12:31:00,494 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 12:31:00,494 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 12:31:00,494 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 12:31:00,494 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 12:31:00,494 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 12:31:00,494 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 12:31:00,520 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 12:31:00,520 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 12:31:17,962 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 12:31:17,962 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 12:31:17,962 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 12:31:17,962 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 12:31:17,962 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 12:31:17,962 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 12:31:17,962 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 12:31:17,964 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 12:31:17,980 - mms_extractor - INFO - Using device: mps
2025-09-19 12:31:17,980 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 12:31:17,980 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 12:31:17,980 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 12:31:17,980 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 12:31:17,980 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 12:31:17,980 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 12:31:17,981 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 12:31:17,981 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 12:31:19,252 - mms_extractor - INFO - Model loaded on mps
2025-09-19 12:31:19,253 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.27초
2025-09-19 12:31:19,253 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 12:31:19,728 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 12:31:19,728 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.48초
2025-09-19 12:31:19,728 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 12:31:19,728 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:19,728 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 12:31:19,728 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:19,729 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 12:31:19,729 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 12:31:19,729 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 12:31:19,729 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 12:31:19,729 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:31:19,798 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 12:31:19,798 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:31:19,798 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 12:31:19,802 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 12:31:19,803 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 12:31:19,803 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:19,804 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:19,804 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 12:31:19,804 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 12:31:19,806 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 12:31:19,810 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 12:31:19,810 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 12:31:19,810 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:19,810 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 12:31:19,810 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 12:31:19,810 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 12:31:19,810 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:19,810 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 12:31:19,810 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 12:31:19,810 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 12:31:19,812 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 12:31:19,812 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 12:31:19,812 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:19,812 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 12:31:19,812 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:19,940 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 12:31:19,945 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 12:31:19,945 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 12:31:19,945 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 12:31:19,946 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 12:31:19,946 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 12:31:19,947 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 12:31:19,947 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 12:31:19,947 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 12:31:19,947 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 12:31:19,949 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 12:31:19,949 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 12:31:19,949 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 12:31:19,963 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 12:31:19,963 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 12:31:19,963 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 12:31:19,965 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 12:31:19,965 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 12:31:20,183 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 12:31:20,184 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 12:31:20,184 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 12:31:20,184 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 12:31:20,184 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 12:31:20,184 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:31:20,252 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 12:31:20,252 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:31:20,254 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 12:31:20,255 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 12:31:20,255 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 12:31:20,255 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:20,255 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 12:31:20,255 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 12:31:20,255 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:20,255 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 12:31:20,255 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:20,255 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 12:31:20,256 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 12:31:20,256 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 12:31:20,256 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 12:31:20,256 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 12:31:20,257 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 12:31:20,259 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 12:31:20,260 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 12:31:20,260 - mms_extractor - INFO - _load_data 실행완료: 0.53초
2025-09-19 12:31:20,260 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 12:31:20,260 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 12:31:20,260 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 12:31:20,260 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 12:31:20,260 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 12:31:20,260 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 12:31:20,260 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 12:31:20,260 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 12:31:20,260 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 12:31:20,260 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 12:31:20,260 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 12:31:33,349 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 12:31:33,349 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 12:31:33,349 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 12:31:33,349 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 12:31:33,349 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 12:31:33,349 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 12:31:33,349 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 12:31:33,350 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 12:31:33,368 - mms_extractor - INFO - Using device: mps
2025-09-19 12:31:33,368 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 12:31:33,369 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 12:31:33,369 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 12:31:33,369 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 12:31:33,369 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 12:31:33,369 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 12:31:33,369 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 12:31:33,369 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 12:31:34,236 - mms_extractor - INFO - Model loaded on mps
2025-09-19 12:31:34,236 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.87초
2025-09-19 12:31:34,236 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 12:31:34,730 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 12:31:34,731 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-19 12:31:34,731 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 12:31:34,731 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:34,731 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 12:31:34,731 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:34,731 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 12:31:34,731 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 12:31:34,731 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 12:31:34,731 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 12:31:34,731 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:31:34,800 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 12:31:34,800 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:31:34,800 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 12:31:34,804 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 12:31:34,805 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 12:31:34,805 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:34,806 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:34,806 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 12:31:34,806 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 12:31:34,809 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 12:31:34,811 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 12:31:34,811 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 12:31:34,811 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:34,812 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 12:31:34,812 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 12:31:34,812 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 12:31:34,812 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:34,812 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 12:31:34,812 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 12:31:34,812 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 12:31:34,813 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 12:31:34,814 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 12:31:34,814 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:34,814 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 12:31:34,814 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:31:34,940 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 12:31:34,944 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 12:31:34,945 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 12:31:34,945 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 12:31:34,945 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 12:31:34,945 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 12:31:34,946 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 12:31:34,946 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 12:31:34,946 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 12:31:34,946 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 12:31:34,948 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 12:31:34,949 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 12:31:34,949 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 12:31:34,963 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 12:31:34,963 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 12:31:34,963 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 12:31:34,965 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 12:31:34,965 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 12:31:35,167 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 12:31:35,167 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 12:31:35,167 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 12:31:35,167 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 12:31:35,167 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 12:31:35,167 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:31:35,237 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 12:31:35,237 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:31:35,239 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 12:31:35,239 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 12:31:35,240 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 12:31:35,240 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:31:35,240 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 12:31:35,240 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 12:31:35,240 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:35,240 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 12:31:35,240 - mms_extractor - INFO - ============================================================
2025-09-19 12:31:35,240 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 12:31:35,241 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 12:31:35,241 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 12:31:35,241 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 12:31:35,241 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 12:31:35,242 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 12:31:35,244 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 12:31:35,245 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 12:31:35,245 - mms_extractor - INFO - _load_data 실행완료: 0.51초
2025-09-19 12:31:35,245 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 12:31:35,245 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 12:31:35,245 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8001, debug=False
2025-09-19 12:31:35,245 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 12:31:35,245 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8001에서 시작합니다
2025-09-19 12:31:35,245 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 12:31:35,245 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 12:31:35,245 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 12:31:35,245 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 12:31:35,245 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 12:31:35,245 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 12:31:35,256 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8001
 * Running on http://192.168.0.35:8001
2025-09-19 12:31:35,256 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 12:41:28,702 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 12:41:28,703 - mms_extractor - INFO - ============================================================
2025-09-19 12:41:28,703 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 12:41:28,703 - mms_extractor - INFO - ============================================================
2025-09-19 12:41:28,703 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 12:41:28,703 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 12:41:28,703 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 12:41:28,703 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 12:41:28,703 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 12:41:28,703 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 12:41:28,703 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 12:41:28,703 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 12:41:28,703 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 12:41:28,703 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 12:41:28,703 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 12:41:28,703 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 12:41:28,705 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 12:41:29,234 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 12:41:29,235 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 12:41:29,237 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 12:41:29,237 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 12:41:29,237 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '시크릿', '데일리', '에이닷이빵쏜닷']
2025-09-19 12:41:29,237 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 12:41:48,263 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 12:41:48,263 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 12:41:48,264 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 12:41:48,264 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 12:41:48,323 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 12:41:48,324 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 12:41:48,324 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 12:41:48,327 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 12:41:48,328 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 12:41:48,329 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 12:41:48,329 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 12:41:48,329 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 19.63초
2025-09-19 12:41:48,329 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 12:41:48,329 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 12:41:48,329 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 12:41:48,467 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 12:41:48,467 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 12:41:48,467 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 12:41:48,467 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 12:41:48,467 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 12:41:48,467 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 12:41:48,467 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 12:41:48,467 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 12:41:48,467 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 12:41:48,467 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 12:41:48,467 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 12:41:48,467 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 12:41:48,468 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 12:41:48,468 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 12:41:48,468 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 12:41:55,565 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 12:41:55,574 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 12:41:55,574 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 12:41:55,575 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 12:41:55,575 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 12:41:55,575 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 12:41:55,575 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 12:41:55,575 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 12:41:55,576 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 12:41:55,963 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 12:41:55,963 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 12:41:55,963 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 12:41:55,963 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 12:41:56,922 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 12:41:57,073 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.50초
2025-09-19 12:41:57,077 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 12:41:57,077 - mms_extractor - INFO - ============================================================
2025-09-19 12:41:57,077 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 12:41:57,077 - mms_extractor - INFO - ============================================================
2025-09-19 12:41:57,077 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 12:41:57,077 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 12:41:57,077 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 12:41:57,077 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 12:41:57,077 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 12:41:57,077 - mms_extractor - INFO - process_message 실행완료: 28.37초
2025-09-19 12:41:57,077 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 12:41:57,553 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 12:41:57,555 - mongodb_utils - INFO - 문서 저장 성공: 68ccd1052bb4d8de1d7a5fed
2025-09-19 12:41:57,555 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 12:41:57,555 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 12:41:57,555 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-19 12:41:57,555 - __main__ - INFO - 추출 완료: 28.853초
2025-09-19 12:41:57,556 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 12:41:57] "POST /extract HTTP/1.1" 200 -
2025-09-19 12:51:39,149 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 12:51:39,149 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 12:51:39,149 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 12:51:39,149 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 12:51:39,149 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 12:51:39,149 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 12:51:39,149 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 12:51:39,150 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 12:51:39,169 - mms_extractor - INFO - Using device: mps
2025-09-19 12:51:39,169 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 12:51:39,169 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 12:51:39,169 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 12:51:39,170 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 12:51:39,170 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 12:51:39,170 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 12:51:39,170 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 12:51:39,170 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 12:51:43,371 - mms_extractor - INFO - Model loaded on mps
2025-09-19 12:51:43,372 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.20초
2025-09-19 12:51:43,372 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 12:51:43,866 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 12:51:43,866 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.49초
2025-09-19 12:51:43,866 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 12:51:43,866 - mms_extractor - INFO - ============================================================
2025-09-19 12:51:43,866 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 12:51:43,866 - mms_extractor - INFO - ============================================================
2025-09-19 12:51:43,866 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 12:51:43,866 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 12:51:43,866 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 12:51:43,866 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 12:51:43,866 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:51:43,937 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 12:51:43,937 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:51:43,937 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 12:51:43,941 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 12:51:43,942 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 12:51:43,943 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:51:43,943 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:51:43,943 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 12:51:43,943 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 12:51:43,946 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 12:51:43,949 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 12:51:43,949 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 12:51:43,949 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:51:43,949 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 12:51:43,949 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 12:51:43,950 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 12:51:43,950 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:51:43,950 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 12:51:43,950 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 12:51:43,950 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 12:51:43,952 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 12:51:43,952 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 12:51:43,952 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:51:43,953 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 12:51:43,953 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 12:51:44,078 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 12:51:44,082 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 12:51:44,083 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 12:51:44,083 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 12:51:44,083 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 12:51:44,083 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 12:51:44,085 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 12:51:44,085 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 12:51:44,085 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 12:51:44,086 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 12:51:44,087 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 12:51:44,088 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 12:51:44,088 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 12:51:44,102 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 12:51:44,102 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 12:51:44,102 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 12:51:44,105 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 12:51:44,105 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 12:51:45,822 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 12:51:45,822 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 12:51:45,822 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 12:51:45,822 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 12:51:45,822 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 12:51:45,822 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 12:51:45,890 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 12:51:45,890 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 12:51:45,892 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 12:51:45,892 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 12:51:45,892 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 12:51:45,892 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 12:51:45,892 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 12:51:45,893 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 12:51:45,893 - mms_extractor - INFO - ============================================================
2025-09-19 12:51:45,893 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 12:51:45,893 - mms_extractor - INFO - ============================================================
2025-09-19 12:51:45,893 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 12:51:45,893 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 12:51:45,893 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 12:51:45,893 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 12:51:45,893 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 12:51:45,895 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 12:51:45,896 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 12:51:45,897 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 12:51:45,897 - mms_extractor - INFO - _load_data 실행완료: 2.03초
2025-09-19 12:51:45,897 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 12:51:45,897 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 12:51:45,897 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 12:51:45,897 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 12:51:45,897 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 12:51:45,897 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 12:51:45,897 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 12:51:45,897 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 12:51:45,897 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 12:51:45,897 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 12:51:45,897 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:04:55,065 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:04:55,065 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:04:55,065 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:04:55,065 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:04:55,065 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:04:55,065 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:04:55,065 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:04:55,067 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:04:55,087 - mms_extractor - INFO - Using device: mps
2025-09-19 15:04:55,088 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 15:04:55,088 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:04:55,088 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:04:55,088 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:04:55,088 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:04:55,088 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:04:55,088 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:04:55,088 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:05:00,789 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:05:00,790 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.70초
2025-09-19 15:05:00,790 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:05:01,336 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:05:01,336 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.55초
2025-09-19 15:05:01,336 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:05:01,336 - mms_extractor - INFO - ============================================================
2025-09-19 15:05:01,336 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:05:01,336 - mms_extractor - INFO - ============================================================
2025-09-19 15:05:01,336 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:05:01,336 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:05:01,336 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:05:01,336 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:05:01,336 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:05:01,407 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:05:01,407 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:05:01,407 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:05:01,410 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:05:01,411 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:05:01,412 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:05:01,412 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:05:01,412 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:05:01,412 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:05:01,420 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:05:01,423 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:05:01,423 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:05:01,423 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:05:01,423 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:05:01,423 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:05:01,424 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:05:01,424 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:05:01,424 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:05:01,424 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:05:01,424 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:05:01,431 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:05:01,431 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:05:01,431 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:05:01,432 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:05:01,432 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:05:01,558 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:05:01,562 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:05:01,563 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 15:05:01,563 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:05:01,563 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:05:01,563 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:05:01,564 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:05:01,564 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:05:01,564 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:05:01,564 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:05:01,566 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:05:01,567 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:05:01,567 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 15:05:01,579 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:05:01,579 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:05:01,579 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:05:01,591 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:05:01,591 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:05:01,832 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:05:01,832 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:05:01,832 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:05:01,832 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:05:01,832 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:05:01,832 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:05:01,898 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:05:01,898 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:05:01,900 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:05:01,900 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:05:01,900 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:05:01,900 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:05:01,900 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:05:01,901 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:05:01,901 - mms_extractor - INFO - ============================================================
2025-09-19 15:05:01,901 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:05:01,901 - mms_extractor - INFO - ============================================================
2025-09-19 15:05:01,901 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:05:01,901 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:05:01,901 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:05:01,901 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:05:01,901 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:05:01,902 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:05:01,904 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:05:01,905 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:05:01,905 - mms_extractor - INFO - _load_data 실행완료: 0.57초
2025-09-19 15:05:01,905 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:05:01,905 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:05:01,905 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:05:01,905 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:05:01,905 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:05:01,905 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:05:01,905 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:05:01,905 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:05:01,905 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:05:01,905 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:05:01,905 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:06:01,070 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:06:01,071 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:06:01,071 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:06:01,071 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:06:01,071 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:06:01,071 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:06:01,071 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:06:01,072 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:06:01,091 - mms_extractor - INFO - Using device: mps
2025-09-19 15:06:01,091 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 15:06:01,091 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:06:01,092 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:06:01,092 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:06:01,092 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:06:01,092 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:06:01,092 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:06:01,092 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:06:01,892 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:06:01,892 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.80초
2025-09-19 15:06:01,892 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:06:02,294 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:06:02,294 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.40초
2025-09-19 15:06:02,294 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:06:02,294 - mms_extractor - INFO - ============================================================
2025-09-19 15:06:02,295 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:06:02,295 - mms_extractor - INFO - ============================================================
2025-09-19 15:06:02,295 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:06:02,295 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:06:02,295 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:06:02,295 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:06:02,295 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:06:02,358 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:06:02,358 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:06:02,358 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:06:02,362 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:06:02,362 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:06:02,363 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:06:02,363 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:06:02,364 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:06:02,364 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:06:02,365 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:06:02,367 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:06:02,367 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:06:02,367 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:06:02,367 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:06:02,367 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:06:02,368 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:06:02,368 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:06:02,368 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:06:02,368 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:06:02,368 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:06:02,369 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:06:02,369 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:06:02,369 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:06:02,369 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:06:02,370 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:06:02,491 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:06:02,495 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:06:02,496 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 15:06:02,496 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:06:02,496 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:06:02,497 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:06:02,497 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:06:02,497 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:06:02,498 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:06:02,498 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:06:02,499 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:06:02,500 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:06:02,500 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 15:06:02,512 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:06:02,512 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:06:02,512 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:06:02,513 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:06:02,513 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:06:02,675 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:06:02,676 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:06:02,676 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:06:02,676 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:06:02,676 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:06:02,676 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:06:02,738 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:06:02,738 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:06:02,740 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:06:02,740 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:06:02,741 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:06:02,741 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:06:02,741 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:06:02,741 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:06:02,741 - mms_extractor - INFO - ============================================================
2025-09-19 15:06:02,741 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:06:02,741 - mms_extractor - INFO - ============================================================
2025-09-19 15:06:02,741 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:06:02,741 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:06:02,741 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:06:02,741 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:06:02,741 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:06:02,743 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:06:02,744 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:06:02,745 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:06:02,745 - mms_extractor - INFO - _load_data 실행완료: 0.45초
2025-09-19 15:06:02,745 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:06:02,746 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:06:02,746 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:06:02,746 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:06:02,746 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:06:02,746 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:06:02,746 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:06:02,746 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:06:02,746 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:06:02,746 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:06:02,746 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:06:02,774 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 15:06:02,774 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 15:13:52,414 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:13:52,414 - mms_extractor - INFO - ============================================================
2025-09-19 15:13:52,414 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:13:52,414 - mms_extractor - INFO - ============================================================
2025-09-19 15:13:52,414 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:13:52,414 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:13:52,414 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:13:52,414 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:13:52,414 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:13:52,414 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:13:52,414 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:13:52,415 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:13:52,415 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:13:52,415 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:13:52,415 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:13:52,415 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:13:52,417 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:13:52,904 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:13:52,904 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:13:52,906 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:13:52,906 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:13:52,906 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '데일리', '시크릿', '에이닷이빵쏜닷']
2025-09-19 15:13:52,906 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:14:15,356 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:14:15,356 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:14:15,357 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:14:15,357 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:14:15,400 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:14:15,401 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:14:15,401 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:14:15,405 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:14:15,407 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:14:15,407 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:14:15,408 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:14:15,408 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 22.99초
2025-09-19 15:14:15,408 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:14:15,408 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:14:15,408 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:14:15,631 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:14:15,631 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:14:15,631 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:14:15,631 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:14:15,631 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:14:15,631 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:14:15,631 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:14:15,631 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:14:15,631 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:14:15,631 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:14:15,631 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:14:15,631 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:14:15,631 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:14:15,631 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:14:15,631 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:14:23,857 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:14:23,868 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 15:14:23,868 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 15:14:23,868 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:14:23,869 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:14:23,869 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:14:23,869 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:14:23,869 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:14:23,869 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:14:24,251 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:14:24,251 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:14:24,251 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:14:24,251 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:14:26,193 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:14:26,319 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.45초
2025-09-19 15:14:26,322 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:14:26,322 - mms_extractor - INFO - ============================================================
2025-09-19 15:14:26,322 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:14:26,322 - mms_extractor - INFO - ============================================================
2025-09-19 15:14:26,322 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:14:26,322 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 15:14:26,322 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:14:26,323 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:14:26,323 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:14:26,323 - mms_extractor - INFO - process_message 실행완료: 33.91초
2025-09-19 15:14:26,323 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:14:26,759 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:14:26,761 - mongodb_utils - INFO - 문서 저장 성공: 68ccf4c27089418963b01656
2025-09-19 15:14:26,762 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:14:26,762 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 15:14:26,762 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-19 15:14:26,762 - __main__ - INFO - 추출 완료: 34.349초
2025-09-19 15:14:26,764 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:14:26] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:16:14,190 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 15:16:14,190 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:16:14,190 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 15:16:14,190 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:16:14,190 - mms_extractor - INFO - ============================================================
2025-09-19 15:16:14,190 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:16:14,190 - mms_extractor - INFO - ============================================================
2025-09-19 15:16:14,190 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:16:14,190 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:16:14,190 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:16:14,190 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:16:14,190 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:16:14,190 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:16:14,190 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:16:14,190 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:16:14,191 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:16:14,191 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:16:14,191 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:16:14,191 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:16:14,192 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:16:14,199 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:16:14,199 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:16:14,202 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:16:14,202 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:16:14,202 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '데일리', '시크릿', '에이닷이빵쏜닷']
2025-09-19 15:16:14,202 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:16:14,611 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:16:14,611 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:16:14,611 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:16:14,611 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:16:14,655 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:16:14,656 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:16:14,656 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:16:14,658 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:16:14,660 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:16:14,660 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:16:14,660 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:16:14,661 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.47초
2025-09-19 15:16:14,661 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:16:14,661 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:16:14,661 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:16:14,719 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:16:14,719 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:16:14,719 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:16:14,719 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:16:14,719 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:16:14,719 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:16:14,719 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:16:14,719 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:16:14,719 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:16:14,719 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:16:14,719 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:16:14,719 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:16:14,719 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:16:14,719 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:16:14,720 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:16:22,187 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:16:22,190 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:16:22,190 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:16:22,190 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:16:22,191 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:16:22,191 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:16:22,191 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:16:22,191 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:16:22,191 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:16:22,637 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:16:22,637 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:16:22,637 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:16:22,637 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:16:23,582 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:16:23,717 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.53초
2025-09-19 15:16:23,720 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:16:23,720 - mms_extractor - INFO - ============================================================
2025-09-19 15:16:23,720 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:16:23,720 - mms_extractor - INFO - ============================================================
2025-09-19 15:16:23,720 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:16:23,720 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:16:23,720 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:16:23,720 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:16:23,720 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:16:23,720 - mms_extractor - INFO - process_message 실행완료: 9.53초
2025-09-19 15:16:23,720 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:16:23,721 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:16:23,721 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:16:23,721 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:16:23,721 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34bd1c5f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34bd1c800> root_client=<openai.OpenAI object at 0x32b40bb00> root_async_client=<openai.AsyncOpenAI object at 0x34bd1c8c0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:16:23,721 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:16:23,721 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:16:42,815 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:16:42,816 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1921자
2025-09-19 15:16:42,816 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:16:42,816 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:16:42,816 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 96자
2025-09-19 15:16:42,816 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:16:42,817 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 3
2025-09-19 15:16:42,817 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트/앱:접속', '베어유쿠폰:수령', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:16:42,817 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트/앱:접속', '베어유쿠폰:수령'), ('웹사이트/앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:16:42,817 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:16:42,817 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:16:42,817 - utils - INFO - 📊 입력 그래프 - 노드 수: 4, 엣지 수: 3
2025-09-19 15:16:42,818 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:16:43,396 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:16:43,396 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:16:43,396 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.676초
2025-09-19 15:16:43,396 - mms_extractor - INFO - 📏 DAG 섹션 길이: 96자
2025-09-19 15:16:43,396 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트/앱:접속) -[접속하면]-> (베어유쿠폰:수령)
(웹사이트/앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:16:43,396 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:16:43,396 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:16:43,397 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 15:16:43,397 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 15:16:43,397 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(웹사이트/앱:접속) -[접속하면]-> (베어유쿠폰:수령)', '(웹사이트/앱:접속) -[접속하면]-> (시크릿코드:입력)']...
2025-09-19 15:16:43,397 - __main__ - INFO - 추출 완료: 29.206초
2025-09-19 15:16:43,397 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:16:43] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:18:40,180 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 15:18:40,180 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:18:40,180 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 15:18:40,180 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:18:40,180 - mms_extractor - INFO - ============================================================
2025-09-19 15:18:40,180 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:18:40,180 - mms_extractor - INFO - ============================================================
2025-09-19 15:18:40,180 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:18:40,180 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:18:40,180 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:18:40,180 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:18:40,180 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:18:40,180 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:18:40,180 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:18:40,181 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:18:40,181 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:18:40,181 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:18:40,181 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:18:40,181 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:18:40,183 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:18:40,185 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:18:40,185 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:18:40,188 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:18:40,188 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:18:40,188 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '데일리', '시크릿', '에이닷이빵쏜닷']
2025-09-19 15:18:40,188 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:18:40,408 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:18:40,408 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:18:40,409 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:18:40,409 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:18:40,455 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:18:40,456 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:18:40,456 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:18:40,459 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:18:40,460 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:18:40,461 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:18:40,461 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:18:40,461 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.28초
2025-09-19 15:18:40,461 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:18:40,461 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:18:40,461 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:18:40,516 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:18:40,516 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:18:40,516 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:18:40,516 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:18:40,516 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:18:40,516 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:18:40,516 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:18:40,516 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:18:40,516 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:18:40,516 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:18:40,516 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:18:40,516 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:18:40,516 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:18:40,516 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:18:40,516 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:18:47,730 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:18:47,732 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:18:47,732 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:18:47,732 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:18:47,732 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:18:47,732 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:18:47,732 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:18:47,732 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:18:47,732 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:18:48,107 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:18:48,107 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:18:48,107 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:18:48,107 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:18:50,038 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:18:50,177 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.44초
2025-09-19 15:18:50,180 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:18:50,180 - mms_extractor - INFO - ============================================================
2025-09-19 15:18:50,180 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:18:50,180 - mms_extractor - INFO - ============================================================
2025-09-19 15:18:50,180 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:18:50,181 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:18:50,181 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:18:50,181 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:18:50,181 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:18:50,181 - mms_extractor - INFO - process_message 실행완료: 10.00초
2025-09-19 15:18:50,181 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:18:50,181 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:18:50,181 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:18:50,181 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:18:50,181 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34bd1c5f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34bd1c800> root_client=<openai.OpenAI object at 0x32b40bb00> root_async_client=<openai.AsyncOpenAI object at 0x34bd1c8c0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:18:50,181 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:18:50,181 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:19:10,922 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:19:10,922 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2053자
2025-09-19 15:19:10,922 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:19:10,922 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:19:10,922 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 15:19:10,922 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:19:10,923 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 15:19:10,923 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:19:10,923 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:19:10,923 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:19:10,923 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:19:10,923 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 15:19:10,924 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:19:11,150 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:19:11,150 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:19:11,150 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.969초
2025-09-19 15:19:11,150 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 15:19:11,150 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:19:11,150 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:19:11,150 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:19:11,154 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:19:11,155 - mongodb_utils - INFO - 문서 저장 성공: 68ccf5df7089418963b01658
2025-09-19 15:19:11,155 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:19:11,155 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 15:19:11,155 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 15:19:11,155 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 15:19:11,155 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 15:19:11,155 - __main__ - INFO - 추출 완료: 30.975초
2025-09-19 15:19:11,156 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:19:11] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:20:52,212 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 15:20:52,213 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:20:52,213 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 15:20:52,213 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:20:52,213 - mms_extractor - INFO - ============================================================
2025-09-19 15:20:52,213 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:20:52,213 - mms_extractor - INFO - ============================================================
2025-09-19 15:20:52,213 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:20:52,213 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:20:52,213 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:20:52,213 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:20:52,213 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:20:52,213 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:20:52,213 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:20:52,213 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:20:52,213 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:20:52,213 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:20:52,213 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:20:52,213 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:20:52,215 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:20:52,217 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:20:52,217 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:20:52,219 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:20:52,219 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:20:52,219 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '데일리', '시크릿', '에이닷이빵쏜닷']
2025-09-19 15:20:52,219 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:20:52,457 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:20:52,457 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:20:52,458 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:20:52,458 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:20:52,504 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:20:52,505 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:20:52,505 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:20:52,508 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:20:52,510 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:20:52,510 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:20:52,510 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:20:52,510 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.30초
2025-09-19 15:20:52,510 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:20:52,511 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:20:52,511 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:20:52,634 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:20:52,635 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:20:52,635 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:20:52,635 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:20:52,635 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:20:52,635 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:20:52,635 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:20:52,635 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:20:52,635 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:20:52,635 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:20:52,635 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:20:52,635 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:20:52,635 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:20:52,635 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:20:52,635 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:20:59,852 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:20:59,854 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:20:59,854 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:20:59,854 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:20:59,855 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:20:59,855 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:20:59,855 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:20:59,855 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:20:59,855 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:21:00,241 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:21:00,241 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:21:00,241 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:21:00,241 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:21:01,272 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:21:01,414 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.56초
2025-09-19 15:21:01,418 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:21:01,418 - mms_extractor - INFO - ============================================================
2025-09-19 15:21:01,418 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:21:01,418 - mms_extractor - INFO - ============================================================
2025-09-19 15:21:01,418 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:21:01,418 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:21:01,418 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:21:01,418 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:21:01,419 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:21:01,419 - mms_extractor - INFO - process_message 실행완료: 9.21초
2025-09-19 15:21:01,419 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:21:01,419 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:21:01,419 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:21:01,419 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:21:01,419 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34bd1c5f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34bd1c800> root_client=<openai.OpenAI object at 0x32b40bb00> root_async_client=<openai.AsyncOpenAI object at 0x34bd1c8c0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:21:01,419 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:21:01,419 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:21:20,717 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:21:20,718 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1956자
2025-09-19 15:21:20,718 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:21:20,718 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 92자
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '에이닷앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('에이닷앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:21:20,719 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:21:20,719 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:21:20,720 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 15:21:20,720 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:21:20,958 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:21:20,959 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:21:20,959 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.540초
2025-09-19 15:21:20,959 - mms_extractor - INFO - 📏 DAG 섹션 길이: 92자
2025-09-19 15:21:20,959 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(에이닷앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:21:20,959 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:21:20,959 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:21:20,959 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 15:21:20,959 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 15:21:20,959 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(에이닷앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 15:21:20,959 - __main__ - INFO - 추출 완료: 28.746초
2025-09-19 15:21:20,959 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:21:20] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:23:53,144 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:23:53,144 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:23:53,144 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:23:53,144 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:23:53,144 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:23:53,144 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:23:53,144 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:23:53,149 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:23:53,205 - mms_extractor - INFO - Using device: mps
2025-09-19 15:23:53,205 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-09-19 15:23:53,205 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:23:53,205 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:23:53,205 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:23:53,205 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:23:53,206 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:23:53,206 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:23:53,206 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:24:01,302 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:24:01,303 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 8.10초
2025-09-19 15:24:01,303 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:24:01,825 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:24:01,825 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.52초
2025-09-19 15:24:01,825 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:24:01,825 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:01,825 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:24:01,825 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:01,825 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:24:01,825 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:24:01,825 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:24:01,825 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:24:01,825 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:24:01,898 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:24:01,898 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:24:01,898 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:24:01,901 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:24:01,902 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:24:01,903 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:24:01,904 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:24:01,904 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:24:01,904 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:24:01,912 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:24:01,915 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:24:01,915 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:24:01,915 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:24:01,915 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:24:01,915 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:24:01,915 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:24:01,915 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:24:01,915 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:24:01,915 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:24:01,915 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:24:01,921 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:24:01,921 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:24:01,921 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:24:01,922 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:24:01,922 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:24:02,055 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:24:02,060 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:24:02,061 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:24:02,061 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:24:02,061 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:24:02,061 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:24:02,062 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:24:02,062 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:24:02,062 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:24:02,062 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:24:02,064 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:24:02,065 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:24:02,065 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:24:02,080 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:24:02,080 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:24:02,080 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:24:02,091 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:24:02,091 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:24:02,339 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:24:02,339 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:24:02,339 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:24:02,339 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:24:02,339 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:24:02,339 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:24:02,411 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:24:02,411 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:24:02,414 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:24:02,414 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:24:02,414 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:24:02,414 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:24:02,414 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:24:02,415 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:24:02,415 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:02,415 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:24:02,415 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:02,415 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:24:02,415 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:24:02,415 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:24:02,415 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:24:02,415 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:24:02,416 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:24:02,418 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:24:02,419 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:24:02,419 - mms_extractor - INFO - _load_data 실행완료: 0.59초
2025-09-19 15:24:02,419 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:24:02,419 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:24:02,419 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:24:02,419 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:24:02,419 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:24:02,419 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:24:02,419 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:24:02,419 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:24:02,419 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:24:02,419 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:24:02,419 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:24:02,456 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 15:24:02,456 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 15:24:10,445 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 15:24:10,445 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:24:10,445 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 15:24:10,445 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:24:10,445 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:10,445 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:24:10,445 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:10,445 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:24:10,445 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:24:10,445 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:24:10,445 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:24:10,446 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:24:10,446 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:24:10,446 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:24:10,446 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:24:10,446 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:24:10,446 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:24:10,446 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:24:10,446 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:24:10,448 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:24:10,941 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:24:10,941 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:24:10,942 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:24:10,942 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:24:10,942 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-09-19 15:24:10,943 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:24:23,538 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:24:23,538 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:24:23,539 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:24:23,539 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:24:23,596 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:24:23,597 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:24:23,597 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:24:23,600 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:24:23,601 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:24:23,602 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:24:23,602 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:24:23,602 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 13.16초
2025-09-19 15:24:23,602 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:24:23,602 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:24:23,602 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:24:23,795 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:24:23,796 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:24:23,796 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:24:23,796 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:24:23,796 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:24:23,796 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:24:23,796 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:24:23,796 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:24:23,796 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:24:23,796 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:24:23,796 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:24:23,796 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:24:23,796 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:24:23,796 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:24:23,796 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:24:31,405 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:24:31,414 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 15:24:31,414 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 15:24:31,414 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:24:31,415 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:24:31,415 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:24:31,415 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:24:31,415 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:24:31,415 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:24:31,791 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:24:31,792 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:24:31,792 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:24:31,792 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:24:32,821 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:24:32,962 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.55초
2025-09-19 15:24:32,966 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:24:32,966 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:32,966 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:24:32,966 - mms_extractor - INFO - ============================================================
2025-09-19 15:24:32,966 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:24:32,966 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 15:24:32,966 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:24:32,966 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:24:32,966 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:24:32,966 - mms_extractor - INFO - process_message 실행완료: 22.52초
2025-09-19 15:24:32,966 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:24:32,966 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:24:32,966 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:24:32,966 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:24:32,966 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x348fcb140> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35331c980> root_client=<openai.OpenAI object at 0x348fa3b00> root_async_client=<openai.AsyncOpenAI object at 0x348abf950> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:24:32,966 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:24:32,966 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:24:52,795 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:24:52,797 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1892자
2025-09-19 15:24:52,797 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:24:52,797 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:24:52,798 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 15:24:52,798 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:24:52,799 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 15:24:52,799 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:24:52,799 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:24:52,799 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:24:52,799 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:24:52,799 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 15:24:52,799 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:24:53,312 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:24:53,313 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:24:53,313 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.347초
2025-09-19 15:24:53,313 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 15:24:53,313 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:24:53,313 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:24:53,313 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:24:53,634 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:24:53,636 - mongodb_utils - INFO - 문서 저장 성공: 68ccf735b7631f8f7f9b4585
2025-09-19 15:24:53,637 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:24:53,637 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 15:24:53,637 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 15:24:53,637 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 15:24:53,637 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 15:24:53,637 - __main__ - INFO - 추출 완료: 43.192초
2025-09-19 15:24:53,639 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:24:53] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:29:10,159 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:29:10,159 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:29:10,159 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:29:10,159 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:29:10,159 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:29:10,159 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:29:10,159 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:29:10,160 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:29:10,177 - mms_extractor - INFO - Using device: mps
2025-09-19 15:29:10,177 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 15:29:10,177 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:29:10,178 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:29:10,178 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:29:10,178 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:29:10,178 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:29:10,178 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:29:10,178 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:29:11,494 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:29:11,494 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.32초
2025-09-19 15:29:11,494 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:29:11,916 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:29:11,916 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.42초
2025-09-19 15:29:11,916 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:29:11,916 - mms_extractor - INFO - ============================================================
2025-09-19 15:29:11,916 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:29:11,916 - mms_extractor - INFO - ============================================================
2025-09-19 15:29:11,916 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:29:11,916 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:29:11,916 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:29:11,916 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:29:11,916 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:29:11,981 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:29:11,981 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:29:11,981 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:29:11,984 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:29:11,985 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:29:11,986 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:29:11,986 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:29:11,986 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:29:11,986 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:29:11,988 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:29:11,990 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:29:11,990 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:29:11,990 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:29:11,990 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:29:11,990 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:29:11,991 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:29:11,991 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:29:11,991 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:29:11,991 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:29:11,991 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:29:11,992 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:29:11,992 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:29:11,992 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:29:11,992 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:29:11,993 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:29:12,118 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:29:12,122 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:29:12,123 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:29:12,123 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:29:12,123 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:29:12,123 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:29:12,125 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:29:12,125 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:29:12,125 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:29:12,125 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:29:12,127 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:29:12,127 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:29:12,127 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:29:12,143 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:29:12,143 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:29:12,143 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:29:12,145 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:29:12,145 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:29:12,307 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:29:12,308 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:29:12,308 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:29:12,308 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:29:12,308 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:29:12,308 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:29:12,373 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:29:12,373 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:29:12,375 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:29:12,376 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:29:12,376 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:29:12,376 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:29:12,376 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:29:12,376 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:29:12,376 - mms_extractor - INFO - ============================================================
2025-09-19 15:29:12,376 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:29:12,376 - mms_extractor - INFO - ============================================================
2025-09-19 15:29:12,376 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:29:12,376 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:29:12,376 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:29:12,377 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:29:12,377 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:29:12,378 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:29:12,380 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:29:12,381 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:29:12,381 - mms_extractor - INFO - _load_data 실행완료: 0.47초
2025-09-19 15:29:12,381 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:29:12,381 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:29:12,381 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:29:12,381 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:29:12,381 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:29:12,381 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:29:12,381 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:29:12,381 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:29:12,381 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:29:12,381 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:29:12,381 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:29:12,391 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 15:29:12,391 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 15:29:22,639 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:29:22] "GET /health HTTP/1.1" 200 -
2025-09-19 15:29:28,857 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:29:28] "GET /health HTTP/1.1" 200 -
2025-09-19 15:29:32,231 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:29:32] "GET /health HTTP/1.1" 200 -
2025-09-19 15:29:33,789 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:29:33] "GET /health HTTP/1.1" 200 -
2025-09-19 15:37:48,559 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:37:48,559 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:37:48,559 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:37:48,559 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:37:48,559 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:37:48,559 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:37:48,559 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:37:48,561 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:37:48,579 - mms_extractor - INFO - Using device: mps
2025-09-19 15:37:48,579 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 15:37:48,579 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:37:48,580 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:37:48,580 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:37:48,580 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:37:48,580 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:37:48,580 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:37:48,580 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:37:49,540 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:37:49,541 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.96초
2025-09-19 15:37:49,541 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:37:50,013 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:37:50,013 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-19 15:37:50,013 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:37:50,013 - mms_extractor - INFO - ============================================================
2025-09-19 15:37:50,013 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:37:50,013 - mms_extractor - INFO - ============================================================
2025-09-19 15:37:50,013 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:37:50,013 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:37:50,013 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:37:50,013 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:37:50,013 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:37:50,083 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:37:50,083 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:37:50,083 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:37:50,086 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:37:50,087 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:37:50,087 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:37:50,088 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:37:50,088 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:37:50,088 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:37:50,090 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:37:50,092 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:37:50,092 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:37:50,092 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:37:50,092 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:37:50,093 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:37:50,093 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:37:50,093 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:37:50,093 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:37:50,093 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:37:50,093 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:37:50,094 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:37:50,095 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:37:50,095 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:37:50,095 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:37:50,095 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:37:50,218 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:37:50,222 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:37:50,223 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 15:37:50,223 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:37:50,223 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:37:50,223 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:37:50,224 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:37:50,224 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:37:50,224 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:37:50,224 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:37:50,226 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:37:50,226 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:37:50,226 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 15:37:50,240 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:37:50,240 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:37:50,240 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:37:50,242 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:37:50,242 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:37:50,416 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:37:50,416 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:37:50,416 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:37:50,416 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:37:50,416 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:37:50,416 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:37:50,482 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:37:50,482 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:37:50,484 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:37:50,484 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:37:50,485 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:37:50,485 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:37:50,485 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:37:50,485 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:37:50,485 - mms_extractor - INFO - ============================================================
2025-09-19 15:37:50,485 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:37:50,485 - mms_extractor - INFO - ============================================================
2025-09-19 15:37:50,485 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:37:50,485 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:37:50,485 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:37:50,485 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:37:50,485 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:37:50,487 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:37:50,488 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:37:50,489 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:37:50,489 - mms_extractor - INFO - _load_data 실행완료: 0.48초
2025-09-19 15:37:50,489 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:37:50,489 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:37:50,489 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:37:50,489 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:37:50,489 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:37:50,489 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:37:50,490 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:37:50,490 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:37:50,490 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:37:50,490 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:37:50,490 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:37:50,499 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 15:37:50,500 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 15:38:06,213 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 15:38:06,213 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 15:38:06,213 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 15:38:06,213 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:38:06,213 - mms_extractor - INFO - ============================================================
2025-09-19 15:38:06,213 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:38:06,213 - mms_extractor - INFO - ============================================================
2025-09-19 15:38:06,213 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:38:06,213 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:38:06,213 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:38:06,213 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:38:06,213 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:38:06,213 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:38:06,213 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:38:06,213 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:38:06,214 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:38:06,214 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:38:06,214 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:38:06,214 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:38:06,215 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:38:06,747 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:38:06,747 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:38:06,749 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:38:06,750 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:38:06,750 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-09-19 15:38:06,750 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:38:14,518 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:38:14,519 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:38:14,520 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:38:14,520 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:38:14,565 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:38:14,565 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:38:14,565 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:38:14,570 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:38:14,572 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:38:14,573 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:38:14,573 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:38:14,573 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.36초
2025-09-19 15:38:14,574 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:38:14,574 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:38:14,574 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:38:14,893 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:38:14,894 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:38:14,894 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:38:14,894 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:38:14,894 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:38:14,894 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:38:14,894 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:38:14,894 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:38:14,894 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:38:14,894 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:38:14,894 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:38:14,894 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:38:14,894 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:38:14,894 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:38:14,894 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:38:22,074 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:38:22,080 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:38:22,081 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:38:22,081 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:38:22,081 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:38:22,082 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:38:22,082 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:38:22,082 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:38:22,082 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:38:22,467 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:38:22,467 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:38:22,467 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:38:22,467 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:38:23,492 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:38:23,638 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.56초
2025-09-19 15:38:23,642 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:38:23,642 - mms_extractor - INFO - ============================================================
2025-09-19 15:38:23,642 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:38:23,642 - mms_extractor - INFO - ============================================================
2025-09-19 15:38:23,642 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:38:23,642 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:38:23,642 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:38:23,642 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:38:23,642 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:38:23,642 - mms_extractor - INFO - process_message 실행완료: 17.43초
2025-09-19 15:38:23,642 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:38:23,642 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:38:23,643 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:38:23,643 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:38:23,643 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x3508297f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35ac25e80> root_client=<openai.OpenAI object at 0x35073fb00> root_async_client=<openai.AsyncOpenAI object at 0x35ac266f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:38:23,643 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:38:23,643 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:38:43,371 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:38:43,373 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1903자
2025-09-19 15:38:43,373 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:38:43,373 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:38:43,374 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 15:38:43,374 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:38:43,374 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 15:38:43,375 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:38:43,375 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:38:43,375 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:38:43,375 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:38:43,375 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 15:38:43,376 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:38:43,935 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:38:43,935 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:38:43,935 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.293초
2025-09-19 15:38:43,935 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 15:38:43,935 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:38:43,935 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:38:43,935 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 15:38:44,379 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:38:44,380 - mongodb_utils - INFO - 문서 저장 성공: 68ccfa741d193064525a9d00
2025-09-19 15:38:44,380 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:38:44,380 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 15:38:44,380 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 15:38:44,380 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 15:38:44,381 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 15:38:44,381 - __main__ - INFO - 추출 완료: 38.167초
2025-09-19 15:38:44,382 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:38:44] "POST /extract HTTP/1.1" 200 -
2025-09-19 15:39:10,726 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 15:39:10,726 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 15:39:10,726 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:39:10,726 - mms_extractor - INFO - ============================================================
2025-09-19 15:39:10,726 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:39:10,727 - mms_extractor - INFO - ============================================================
2025-09-19 15:39:10,727 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:39:10,727 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:39:10,727 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:39:10,727 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:39:10,727 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:39:10,727 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:39:10,727 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:39:10,727 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:39:10,727 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:39:10,727 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:39:10,727 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:39:10,727 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:39:10,730 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:39:10,739 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:39:10,740 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:39:10,746 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:39:10,746 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:39:10,746 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '시크릿', '에이닷이빵쏜닷', '뚜레쥬르']
2025-09-19 15:39:10,746 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:39:11,147 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:39:11,147 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:39:11,148 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:39:11,148 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:39:11,192 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:39:11,192 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:39:11,192 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:39:11,195 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:39:11,197 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:39:11,197 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:39:11,197 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:39:11,198 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.47초
2025-09-19 15:39:11,198 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:39:11,198 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:39:11,198 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:39:11,317 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:39:11,317 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:39:11,317 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:39:11,317 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:39:11,317 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:39:11,317 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:39:11,317 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:39:11,317 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:39:11,318 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:39:11,318 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:39:11,318 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:39:11,318 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:39:11,318 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:39:11,318 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:39:11,318 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:39:18,523 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:39:18,524 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:39:18,524 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:39:18,524 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:39:18,524 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:39:18,524 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:39:18,524 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:39:18,524 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:39:18,524 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:39:18,946 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:39:18,947 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:39:18,947 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:39:18,947 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:39:19,961 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:39:20,093 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.57초
2025-09-19 15:39:20,097 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:39:20,097 - mms_extractor - INFO - ============================================================
2025-09-19 15:39:20,097 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:39:20,097 - mms_extractor - INFO - ============================================================
2025-09-19 15:39:20,097 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:39:20,097 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:39:20,097 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:39:20,097 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:39:20,097 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:39:20,097 - mms_extractor - INFO - process_message 실행완료: 9.37초
2025-09-19 15:39:20,097 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:39:20,097 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 15:39:20,097 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 9.37초
2025-09-19 15:39:20,097 - mms_extractor - INFO - 평균 처리 시간: 9.37초/메시지
2025-09-19 15:39:20,103 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:39:20,104 - mongodb_utils - INFO - 문서 저장 성공: 68ccfa981d193064525a9d02
2025-09-19 15:39:20,104 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:39:20,104 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 15:39:20,104 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 15:39:20,104 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 9.379초 소요
2025-09-19 15:39:20,105 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:39:20] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 15:43:49,660 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 15:43:49,660 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 15:43:49,660 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 15:43:49,660 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 15:43:49,661 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 15:43:49,661 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 15:43:49,661 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 15:43:49,662 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 15:43:49,730 - mms_extractor - INFO - Using device: mps
2025-09-19 15:43:49,730 - mms_extractor - INFO - _initialize_device 실행완료: 0.07초
2025-09-19 15:43:49,730 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 15:43:49,730 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 15:43:49,730 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 15:43:49,730 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 15:43:49,730 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 15:43:49,731 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 15:43:49,731 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 15:43:54,155 - mms_extractor - INFO - Model loaded on mps
2025-09-19 15:43:54,155 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.42초
2025-09-19 15:43:54,155 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 15:43:54,617 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 15:43:54,617 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-19 15:43:54,617 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 15:43:54,617 - mms_extractor - INFO - ============================================================
2025-09-19 15:43:54,617 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 15:43:54,617 - mms_extractor - INFO - ============================================================
2025-09-19 15:43:54,617 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 15:43:54,617 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 15:43:54,617 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 15:43:54,617 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 15:43:54,617 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:43:54,687 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 15:43:54,687 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:43:54,687 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 15:43:54,691 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 15:43:54,691 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 15:43:54,692 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:43:54,692 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:43:54,693 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 15:43:54,693 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 15:43:54,701 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 15:43:54,703 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 15:43:54,703 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 15:43:54,703 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:43:54,703 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 15:43:54,703 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 15:43:54,703 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 15:43:54,703 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:43:54,703 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 15:43:54,703 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 15:43:54,703 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 15:43:54,710 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 15:43:54,711 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 15:43:54,711 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:43:54,711 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 15:43:54,711 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 15:43:54,833 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 15:43:54,838 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 15:43:54,838 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:43:54,838 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 15:43:54,839 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 15:43:54,839 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 15:43:54,840 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 15:43:54,840 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 15:43:54,840 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 15:43:54,840 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 15:43:54,841 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 15:43:54,842 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 15:43:54,842 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 15:43:54,855 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 15:43:54,855 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 15:43:54,855 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 15:43:54,868 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 15:43:54,868 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 15:43:55,062 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 15:43:55,062 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 15:43:55,062 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 15:43:55,062 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 15:43:55,062 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 15:43:55,062 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 15:43:55,130 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 15:43:55,130 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 15:43:55,132 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 15:43:55,133 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 15:43:55,133 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 15:43:55,133 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 15:43:55,133 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 15:43:55,133 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 15:43:55,133 - mms_extractor - INFO - ============================================================
2025-09-19 15:43:55,133 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 15:43:55,133 - mms_extractor - INFO - ============================================================
2025-09-19 15:43:55,133 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 15:43:55,133 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 15:43:55,133 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 15:43:55,133 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 15:43:55,133 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 15:43:55,135 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 15:43:55,137 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 15:43:55,137 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 15:43:55,138 - mms_extractor - INFO - _load_data 실행완료: 0.52초
2025-09-19 15:43:55,138 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 15:43:55,138 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 15:43:55,138 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 15:43:55,138 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 15:43:55,138 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 15:43:55,138 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 15:43:55,138 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 15:43:55,138 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 15:43:55,138 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 15:43:55,138 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 15:43:55,138 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 15:43:55,159 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 15:43:55,159 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 15:44:15,247 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 15:44:15,248 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 15:44:15,248 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:44:15,248 - mms_extractor - INFO - ============================================================
2025-09-19 15:44:15,248 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:44:15,248 - mms_extractor - INFO - ============================================================
2025-09-19 15:44:15,248 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:44:15,248 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:44:15,248 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:44:15,248 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:44:15,248 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:44:15,248 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:44:15,248 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:44:15,248 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:44:15,248 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:44:15,248 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:44:15,248 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:44:15,248 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:44:15,250 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:44:15,735 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:44:15,735 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:44:15,737 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:44:15,737 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:44:15,737 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '데일리', '시크릿', '뚜레쥬르']
2025-09-19 15:44:15,737 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:44:23,662 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:44:23,663 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:44:23,665 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:44:23,665 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:44:23,708 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:44:23,709 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:44:23,709 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:44:23,714 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:44:23,718 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:44:23,719 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:44:23,719 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:44:23,720 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.47초
2025-09-19 15:44:23,720 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:44:23,720 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:44:23,720 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:44:24,119 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:44:24,119 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:44:24,119 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:44:24,119 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:44:24,119 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:44:24,120 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:44:24,120 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:44:24,120 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:44:24,120 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:44:24,120 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:44:24,120 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:44:24,120 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:44:24,120 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:44:24,120 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:44:24,120 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:44:31,533 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:44:31,541 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 15:44:31,541 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 15:44:31,541 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:44:31,541 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:44:31,541 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:44:31,542 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:44:31,542 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:44:31,542 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:44:31,918 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:44:31,918 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:44:31,918 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:44:31,918 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:44:32,962 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:44:33,089 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.55초
2025-09-19 15:44:33,093 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:44:33,093 - mms_extractor - INFO - ============================================================
2025-09-19 15:44:33,093 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:44:33,093 - mms_extractor - INFO - ============================================================
2025-09-19 15:44:33,093 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:44:33,093 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 15:44:33,093 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:44:33,093 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:44:33,093 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:44:33,093 - mms_extractor - INFO - process_message 실행완료: 17.84초
2025-09-19 15:44:33,093 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:44:33,093 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 15:44:33,093 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 17.85초
2025-09-19 15:44:33,093 - mms_extractor - INFO - 평균 처리 시간: 17.85초/메시지
2025-09-19 15:44:33,180 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:44:33,181 - mongodb_utils - INFO - 문서 저장 성공: 68ccfbd13415436c39935c21
2025-09-19 15:44:33,181 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:44:33,182 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 15:44:33,182 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 15:44:33,182 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 17.934초 소요
2025-09-19 15:44:33,182 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:44:33] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 15:46:46,018 - __main__ - INFO - 🎯 배치 DAG 추출 요청됨 - 1개 메시지, 워커: None
2025-09-19 15:46:46,018 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 15:46:46,018 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 15:46:46,018 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 15:46:46,018 - mms_extractor - INFO - ============================================================
2025-09-19 15:46:46,018 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 15:46:46,018 - mms_extractor - INFO - ============================================================
2025-09-19 15:46:46,018 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 15:46:46,018 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 15:46:46,018 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 15:46:46,018 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 15:46:46,018 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 15:46:46,018 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 15:46:46,018 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 15:46:46,018 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 15:46:46,018 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 15:46:46,018 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 15:46:46,018 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 15:46:46,018 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 15:46:46,020 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 15:46:46,025 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 15:46:46,026 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 15:46:46,028 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 15:46:46,028 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 15:46:46,028 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '데일리', '시크릿', '뚜레쥬르']
2025-09-19 15:46:46,028 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 15:46:46,372 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 15:46:46,372 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 15:46:46,373 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 15:46:46,373 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 15:46:46,427 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 15:46:46,427 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 15:46:46,427 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 15:46:46,429 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 15:46:46,431 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 15:46:46,432 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 15:46:46,432 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 15:46:46,432 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.41초
2025-09-19 15:46:46,432 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 15:46:46,432 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 15:46:46,432 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 15:46:46,480 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 15:46:46,480 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 15:46:46,480 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 15:46:46,480 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 15:46:46,480 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 15:46:46,480 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 15:46:46,480 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 15:46:46,481 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 15:46:46,481 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 15:46:46,481 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 15:46:46,481 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 15:46:46,481 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 15:46:46,481 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 15:46:46,481 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 15:46:46,481 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 15:46:53,989 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:46:53,991 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 15:46:53,992 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 15:46:53,992 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 15:46:53,993 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 15:46:53,993 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 15:46:53,993 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 15:46:53,993 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 15:46:53,993 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 15:46:54,378 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 15:46:54,378 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 15:46:54,378 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 15:46:54,378 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 15:46:55,458 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:46:55,589 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.60초
2025-09-19 15:46:55,593 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 15:46:55,593 - mms_extractor - INFO - ============================================================
2025-09-19 15:46:55,593 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 15:46:55,593 - mms_extractor - INFO - ============================================================
2025-09-19 15:46:55,593 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 15:46:55,593 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 15:46:55,593 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 15:46:55,593 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 15:46:55,593 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 15:46:55,593 - mms_extractor - INFO - process_message 실행완료: 9.58초
2025-09-19 15:46:55,593 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 15:46:55,593 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 15:46:55,593 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 15:46:55,593 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 15:46:55,593 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34dfda540> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x357c15e20> root_client=<openai.OpenAI object at 0x34e531070> root_async_client=<openai.AsyncOpenAI object at 0x34dabeab0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 15:46:55,593 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 15:46:55,593 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 15:47:14,457 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 15:47:14,459 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1900자
2025-09-19 15:47:14,460 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 15:47:14,460 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 15:47:14,460 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 15:47:14,460 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 15:47:14,461 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 15:47:14,461 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 15:47:14,461 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 15:47:14,461 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 15:47:14,461 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:47:14,461 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 15:47:14,462 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 15:47:14,730 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 15:47:14,731 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 15:47:14,731 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.137초
2025-09-19 15:47:14,731 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 15:47:14,731 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 15:47:14,731 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 15:47:14,731 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 15:47:14,731 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 28.71초
2025-09-19 15:47:14,731 - mms_extractor - INFO - 평균 처리 시간: 28.71초/메시지
2025-09-19 15:47:14,736 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 15:47:14,736 - mongodb_utils - INFO - 문서 저장 성공: 68ccfc723415436c39935c23
2025-09-19 15:47:14,737 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 15:47:14,737 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 15:47:14,737 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 15:47:14,737 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 28.719초 소요
2025-09-19 15:47:14,738 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 15:47:14] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 16:05:13,556 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 16:05:13,556 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 16:05:13,556 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 16:05:13,556 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 16:05:13,556 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 16:05:13,556 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 16:05:13,556 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 16:05:13,557 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 16:05:13,575 - mms_extractor - INFO - Using device: mps
2025-09-19 16:05:13,575 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 16:05:13,575 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 16:05:13,575 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 16:05:13,575 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 16:05:13,575 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 16:05:13,575 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 16:05:13,575 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 16:05:13,575 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 16:05:14,387 - mms_extractor - INFO - Model loaded on mps
2025-09-19 16:05:14,387 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.81초
2025-09-19 16:05:14,387 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 16:05:14,797 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 16:05:14,797 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.41초
2025-09-19 16:05:14,797 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 16:05:14,797 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:14,798 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 16:05:14,798 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:14,798 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 16:05:14,798 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 16:05:14,798 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 16:05:14,798 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 16:05:14,798 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:05:14,863 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 16:05:14,864 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:05:14,864 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 16:05:14,867 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 16:05:14,868 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 16:05:14,868 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:05:14,869 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:05:14,869 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 16:05:14,869 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 16:05:14,871 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 16:05:14,873 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 16:05:14,873 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 16:05:14,873 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:05:14,873 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 16:05:14,873 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 16:05:14,873 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 16:05:14,873 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:05:14,873 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 16:05:14,873 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 16:05:14,873 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 16:05:14,875 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 16:05:14,875 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 16:05:14,875 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:05:14,876 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 16:05:14,876 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:05:15,000 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 16:05:15,004 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 16:05:15,005 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 16:05:15,005 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 16:05:15,005 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 16:05:15,005 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 16:05:15,006 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 16:05:15,006 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 16:05:15,006 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 16:05:15,006 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 16:05:15,008 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 16:05:15,009 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 16:05:15,009 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 16:05:15,022 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 16:05:15,022 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 16:05:15,022 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 16:05:15,023 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 16:05:15,023 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 16:05:15,180 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 16:05:15,180 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 16:05:15,180 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 16:05:15,180 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 16:05:15,180 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 16:05:15,180 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:05:15,248 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 16:05:15,248 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:05:15,250 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 16:05:15,250 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 16:05:15,250 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 16:05:15,250 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:05:15,250 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 16:05:15,251 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 16:05:15,251 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:15,251 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 16:05:15,251 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:15,251 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 16:05:15,251 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 16:05:15,251 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 16:05:15,251 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 16:05:15,251 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 16:05:15,252 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 16:05:15,254 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 16:05:15,255 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 16:05:15,255 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-19 16:05:15,255 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 16:05:15,255 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 16:05:15,255 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 16:05:15,255 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 16:05:15,255 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 16:05:15,255 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 16:05:15,255 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 16:05:15,255 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 16:05:15,255 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 16:05:15,255 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 16:05:15,256 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 16:05:15,266 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 16:05:15,266 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 16:05:18,738 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 16:05:18,738 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 16:05:18,738 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 16:05:18,738 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:05:18,738 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:18,738 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:05:18,738 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:18,738 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:05:18,738 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:05:18,738 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:05:18,738 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:05:18,738 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:05:18,738 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:05:18,738 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:05:18,738 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:05:18,738 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:05:18,738 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:05:18,738 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:05:18,738 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:05:18,740 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:05:19,267 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:05:19,268 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:05:19,273 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:05:19,273 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:05:19,273 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '에이닷이빵쏜닷', '데일리', '뚜레쥬르']
2025-09-19 16:05:19,273 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:05:26,565 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:05:26,565 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:05:26,566 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:05:26,566 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:05:26,624 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:05:26,625 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:05:26,625 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:05:26,628 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:05:26,630 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:05:26,630 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:05:26,630 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:05:26,631 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.89초
2025-09-19 16:05:26,631 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:05:26,631 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:05:26,631 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:05:26,731 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:05:26,731 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:05:26,731 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:05:26,731 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:05:26,731 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:05:26,731 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:05:26,731 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:05:26,731 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:05:26,731 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:05:26,731 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:05:26,732 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:05:26,732 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:05:26,732 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:05:26,732 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:05:26,732 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:05:34,076 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:05:34,087 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 16:05:34,087 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 16:05:34,087 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:05:34,087 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:05:34,088 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:05:34,088 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:05:34,088 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:05:34,088 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:05:34,484 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:05:34,485 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:05:34,485 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:05:34,485 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:05:35,501 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:05:35,646 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.56초
2025-09-19 16:05:35,650 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:05:35,650 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:35,650 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:05:35,650 - mms_extractor - INFO - ============================================================
2025-09-19 16:05:35,650 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:05:35,650 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 16:05:35,650 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:05:35,650 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:05:35,650 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:05:35,650 - mms_extractor - INFO - process_message 실행완료: 16.91초
2025-09-19 16:05:35,650 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:05:35,650 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:05:35,650 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:05:35,650 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:05:35,651 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34c3f93d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34c428b00> root_client=<openai.OpenAI object at 0x34c3d0890> root_async_client=<openai.AsyncOpenAI object at 0x358019e20> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:05:35,651 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:05:35,651 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:05:54,596 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:05:54,598 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1883자
2025-09-19 16:05:54,598 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 16:05:54,599 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:05:54,599 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 16:05:54,599 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:05:54,600 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 16:05:54,600 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:05:54,600 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:05:54,600 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:05:54,600 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:05:54,600 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 16:05:54,601 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:05:54,861 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:05:54,862 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:05:54,862 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.211초
2025-09-19 16:05:54,862 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 16:05:54,862 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:05:54,862 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:05:54,862 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 16:05:54,943 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:05:54,944 - mongodb_utils - INFO - 문서 저장 성공: 68cd00d248a6ba0ec8b35938
2025-09-19 16:05:54,945 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:05:54,945 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 16:05:54,945 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 16:05:54,945 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 16:05:54,945 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 16:05:54,945 - __main__ - INFO - 추출 완료: 36.207초
2025-09-19 16:05:54,946 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:05:54] "POST /extract HTTP/1.1" 200 -
2025-09-19 16:07:00,742 - __main__ - INFO - 🎯 배치 DAG 추출 요청됨 - 1개 메시지, 워커: None
2025-09-19 16:07:00,743 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 16:07:00,743 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 16:07:00,743 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:07:00,743 - mms_extractor - INFO - ============================================================
2025-09-19 16:07:00,743 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:07:00,743 - mms_extractor - INFO - ============================================================
2025-09-19 16:07:00,743 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:07:00,743 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:07:00,743 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:07:00,743 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:07:00,743 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:07:00,743 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:07:00,743 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:07:00,743 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:07:00,743 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:07:00,743 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:07:00,744 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:07:00,744 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:07:00,746 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:07:00,749 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:07:00,749 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:07:00,752 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:07:00,752 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:07:00,752 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['시크릿', '에이닷이빵쏜닷', '데일리', '뚜레쥬르']
2025-09-19 16:07:00,752 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:07:01,097 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:07:01,097 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:07:01,098 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:07:01,098 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:07:01,156 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:07:01,157 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:07:01,157 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:07:01,159 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:07:01,161 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:07:01,162 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:07:01,162 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:07:01,162 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.42초
2025-09-19 16:07:01,162 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:07:01,162 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:07:01,162 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:07:01,251 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:07:01,251 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:07:01,251 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:07:01,251 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:07:01,251 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:07:01,251 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:07:01,251 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:07:01,251 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:07:01,251 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:07:01,251 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:07:01,251 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:07:01,251 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:07:01,251 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:07:01,251 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:07:01,251 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:07:08,597 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:07:08,598 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 16:07:08,599 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 16:07:08,599 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:07:08,599 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:07:08,599 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:07:08,599 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:07:08,599 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:07:08,599 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:07:08,996 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:07:08,996 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:07:08,996 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:07:08,996 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:07:09,971 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:07:10,112 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.51초
2025-09-19 16:07:10,115 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:07:10,115 - mms_extractor - INFO - ============================================================
2025-09-19 16:07:10,115 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:07:10,115 - mms_extractor - INFO - ============================================================
2025-09-19 16:07:10,115 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:07:10,115 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 16:07:10,115 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:07:10,115 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:07:10,116 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:07:10,116 - mms_extractor - INFO - process_message 실행완료: 9.37초
2025-09-19 16:07:10,116 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:07:10,116 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:07:10,116 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:07:10,116 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:07:10,116 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34c3f93d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34c428b00> root_client=<openai.OpenAI object at 0x34c3d0890> root_async_client=<openai.AsyncOpenAI object at 0x358019e20> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:07:10,116 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:07:10,116 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:07:28,763 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1898자
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:07:28,764 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:07:28,764 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:07:28,764 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 16:07:28,765 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:07:28,990 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:07:28,991 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:07:28,991 - mms_extractor - INFO - 🕒 DAG 처리 시간: 18.875초
2025-09-19 16:07:28,991 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 16:07:28,991 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:07:28,991 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:07:28,991 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 16:07:28,991 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 28.25초
2025-09-19 16:07:28,991 - mms_extractor - INFO - 평균 처리 시간: 28.25초/메시지
2025-09-19 16:07:28,996 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:07:28,997 - mongodb_utils - INFO - 문서 저장 성공: 68cd013048a6ba0ec8b3593a
2025-09-19 16:07:28,997 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:07:28,997 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 16:07:28,997 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 16:07:28,997 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 28.255초 소요
2025-09-19 16:07:28,998 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:07:28] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 16:10:01,230 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 16:10:01,230 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 16:10:01,230 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 16:10:01,230 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 16:10:01,230 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 16:10:01,230 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 16:10:01,230 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 16:10:01,231 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 16:10:01,250 - mms_extractor - INFO - Using device: mps
2025-09-19 16:10:01,251 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 16:10:01,251 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 16:10:01,251 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 16:10:01,251 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 16:10:01,252 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 16:10:01,252 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 16:10:01,252 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 16:10:01,252 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 16:10:02,836 - mms_extractor - INFO - Model loaded on mps
2025-09-19 16:10:02,836 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.58초
2025-09-19 16:10:02,837 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 16:10:03,318 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 16:10:03,318 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.48초
2025-09-19 16:10:03,318 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 16:10:03,318 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:03,318 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 16:10:03,318 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:03,319 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 16:10:03,319 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 16:10:03,319 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 16:10:03,319 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 16:10:03,319 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:10:03,387 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 16:10:03,387 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:10:03,387 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 16:10:03,391 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 16:10:03,391 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 16:10:03,392 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:10:03,392 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:10:03,393 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 16:10:03,393 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 16:10:03,395 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 16:10:03,398 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 16:10:03,398 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 16:10:03,398 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:10:03,398 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 16:10:03,398 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 16:10:03,398 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 16:10:03,398 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:10:03,398 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 16:10:03,398 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 16:10:03,398 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 16:10:03,400 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 16:10:03,400 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 16:10:03,400 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:10:03,400 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 16:10:03,401 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:10:03,524 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 16:10:03,528 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 16:10:03,528 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증']
2025-09-19 16:10:03,529 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 16:10:03,529 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 16:10:03,529 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 16:10:03,530 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 16:10:03,530 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 16:10:03,530 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 16:10:03,530 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 16:10:03,532 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 16:10:03,533 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 16:10:03,533 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증']
2025-09-19 16:10:03,546 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 16:10:03,546 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 16:10:03,546 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 16:10:03,548 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 16:10:03,548 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 16:10:03,703 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 16:10:03,703 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 16:10:03,703 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 16:10:03,703 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 16:10:03,703 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 16:10:03,703 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:10:03,771 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 16:10:03,771 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:10:03,773 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 16:10:03,774 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 16:10:03,774 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 16:10:03,774 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:10:03,774 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 16:10:03,774 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 16:10:03,774 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:03,774 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 16:10:03,774 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:03,774 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 16:10:03,774 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 16:10:03,774 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 16:10:03,774 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 16:10:03,774 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 16:10:03,776 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 16:10:03,777 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 16:10:03,779 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 16:10:03,779 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-19 16:10:03,779 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 16:10:03,779 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 16:10:03,779 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 16:10:03,779 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 16:10:03,779 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 16:10:03,779 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 16:10:03,779 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 16:10:03,779 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 16:10:03,779 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 16:10:03,779 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 16:10:03,779 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 16:10:03,789 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 16:10:03,789 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 16:10:13,151 - __main__ - INFO - 🎯 배치 DAG 추출 요청됨 - 1개 메시지, 워커: None
2025-09-19 16:10:13,151 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 16:10:13,152 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 16:10:13,152 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:10:13,152 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:13,152 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:10:13,152 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:13,152 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:10:13,152 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:10:13,152 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:10:13,152 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:10:13,152 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:10:13,152 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:10:13,152 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:10:13,152 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:10:13,152 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:10:13,152 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:10:13,152 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:10:13,152 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:10:13,154 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:10:13,639 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:10:13,640 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:10:13,642 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:10:13,642 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:10:13,642 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '시크릿', '데일리']
2025-09-19 16:10:13,642 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:10:20,668 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:10:20,668 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:10:20,669 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:10:20,669 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:10:20,712 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:10:20,713 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:10:20,713 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:10:20,715 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:10:20,717 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:10:20,717 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:10:20,718 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:10:20,718 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.57초
2025-09-19 16:10:20,718 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:10:20,718 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:10:20,718 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:10:20,846 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:10:20,846 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:10:20,846 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:10:20,846 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:10:20,846 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:10:20,846 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:10:20,846 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:10:20,846 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:10:20,846 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:10:20,846 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:10:20,847 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:10:20,847 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:10:20,847 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:10:20,847 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:10:20,847 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:10:28,632 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:10:28,637 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 16:10:28,637 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 16:10:28,637 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:10:28,638 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:10:28,638 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:10:28,638 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:10:28,638 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:10:28,638 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:10:29,032 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:10:29,032 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:10:29,032 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:10:29,032 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:10:30,144 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:10:30,289 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.65초
2025-09-19 16:10:30,295 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:10:30,295 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:30,295 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:10:30,295 - mms_extractor - INFO - ============================================================
2025-09-19 16:10:30,295 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:10:30,295 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 16:10:30,295 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:10:30,295 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:10:30,295 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:10:30,295 - mms_extractor - INFO - process_message 실행완료: 17.14초
2025-09-19 16:10:30,296 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:10:30,296 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:10:30,296 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:10:30,296 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:10:30,296 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x351f2d070> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35a5ae720> root_client=<openai.OpenAI object at 0x3535c96d0> root_async_client=<openai.AsyncOpenAI object at 0x353629640> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:10:30,296 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:10:30,296 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:10:49,089 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:10:49,090 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1875자
2025-09-19 16:10:49,090 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 만 13~34세 고객에게 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하고, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]
...
2025-09-19 16:10:49,090 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:10:49,090 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 16:10:49,090 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:10:49,091 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 16:10:49,091 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:10:49,091 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:10:49,091 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:10:49,091 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:10:49,091 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 16:10:49,092 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:10:49,318 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:10:49,319 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:10:49,319 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.023초
2025-09-19 16:10:49,319 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 16:10:49,319 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:10:49,319 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:10:49,319 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 16:10:49,319 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 36.17초
2025-09-19 16:10:49,319 - mms_extractor - INFO - 평균 처리 시간: 36.17초/메시지
2025-09-19 16:10:49,407 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:10:49,408 - mongodb_utils - INFO - 문서 저장 성공: 68cd01f943b628567cba245a
2025-09-19 16:10:49,408 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:10:49,408 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 16:10:49,408 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 16:10:49,408 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 36.257초 소요
2025-09-19 16:10:49,409 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:10:49] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 16:11:54,087 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 16:11:54,087 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 16:11:54,087 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 16:11:54,087 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 16:11:54,087 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 16:11:54,087 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 16:11:54,087 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 16:11:54,089 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 16:11:54,109 - mms_extractor - INFO - Using device: mps
2025-09-19 16:11:54,109 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 16:11:54,109 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 16:11:54,109 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 16:11:54,109 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 16:11:54,109 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 16:11:54,109 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 16:11:54,110 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 16:11:54,110 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 16:11:55,262 - mms_extractor - INFO - Model loaded on mps
2025-09-19 16:11:55,262 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.15초
2025-09-19 16:11:55,262 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 16:11:55,672 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 16:11:55,672 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.41초
2025-09-19 16:11:55,672 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 16:11:55,672 - mms_extractor - INFO - ============================================================
2025-09-19 16:11:55,672 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 16:11:55,672 - mms_extractor - INFO - ============================================================
2025-09-19 16:11:55,672 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 16:11:55,672 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 16:11:55,672 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 16:11:55,672 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 16:11:55,672 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:11:55,737 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 16:11:55,737 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:11:55,737 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 16:11:55,741 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 16:11:55,741 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 16:11:55,742 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:11:55,742 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:11:55,742 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 16:11:55,742 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 16:11:55,744 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 16:11:55,746 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 16:11:55,746 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 16:11:55,746 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:11:55,746 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 16:11:55,746 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 16:11:55,747 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 16:11:55,747 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:11:55,747 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 16:11:55,747 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 16:11:55,747 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 16:11:55,749 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 16:11:55,749 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 16:11:55,749 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:11:55,749 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 16:11:55,750 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:11:55,872 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 16:11:55,876 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 16:11:55,876 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 16:11:55,877 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 16:11:55,877 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 16:11:55,877 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 16:11:55,878 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 16:11:55,878 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 16:11:55,878 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 16:11:55,878 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 16:11:55,880 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 16:11:55,880 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 16:11:55,880 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-09-19 16:11:55,894 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 16:11:55,894 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 16:11:55,894 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 16:11:55,897 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 16:11:55,897 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 16:11:56,058 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 16:11:56,058 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 16:11:56,058 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 16:11:56,058 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 16:11:56,058 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 16:11:56,058 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:11:56,124 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 16:11:56,124 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:11:56,126 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 16:11:56,126 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 16:11:56,126 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 16:11:56,126 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:11:56,126 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 16:11:56,127 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 16:11:56,127 - mms_extractor - INFO - ============================================================
2025-09-19 16:11:56,127 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 16:11:56,127 - mms_extractor - INFO - ============================================================
2025-09-19 16:11:56,127 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 16:11:56,127 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 16:11:56,127 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 16:11:56,127 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 16:11:56,127 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 16:11:56,128 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 16:11:56,130 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 16:11:56,131 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 16:11:56,131 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-19 16:11:56,131 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 16:11:56,131 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 16:11:56,131 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 16:11:56,131 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 16:11:56,131 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 16:11:56,132 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 16:11:56,132 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 16:11:56,132 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 16:11:56,132 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 16:11:56,132 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 16:11:56,132 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 16:11:56,140 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 16:11:56,140 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 16:12:23,846 - __main__ - INFO - 🎯 배치 DAG 추출 요청됨 - 1개 메시지, 워커: None
2025-09-19 16:12:23,846 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 16:12:23,846 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 16:12:23,846 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:12:23,846 - mms_extractor - INFO - ============================================================
2025-09-19 16:12:23,846 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:12:23,846 - mms_extractor - INFO - ============================================================
2025-09-19 16:12:23,846 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:12:23,846 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:12:23,846 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:12:23,847 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:12:23,847 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:12:23,847 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:12:23,847 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:12:23,847 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:12:23,847 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:12:23,847 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:12:23,847 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:12:23,847 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:12:23,849 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:12:24,364 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:12:24,364 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:12:24,366 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:12:24,366 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:12:24,366 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['데일리', '뚜레쥬르', '시크릿', '에이닷이빵쏜닷']
2025-09-19 16:12:24,366 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:12:31,269 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:12:31,269 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:12:31,270 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:12:31,270 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:12:31,314 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:12:31,314 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:12:31,314 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:12:31,317 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:12:31,319 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:12:31,320 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:12:31,320 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:12:31,320 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.47초
2025-09-19 16:12:31,320 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:12:31,320 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:12:31,320 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:12:31,457 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:12:31,457 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:12:31,457 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:12:31,457 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:12:31,457 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:12:31,457 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:12:31,457 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:12:31,457 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:12:31,457 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:12:31,457 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:12:31,457 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:12:31,457 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:12:31,457 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:12:31,457 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:12:31,457 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:12:38,918 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:12:38,925 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 16:12:38,925 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 16:12:38,925 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:12:38,926 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:12:38,926 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:12:38,926 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:12:38,926 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:12:38,926 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:12:39,363 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:12:39,364 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:12:39,364 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:12:39,364 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:12:40,364 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:12:40,510 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.58초
2025-09-19 16:12:40,514 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:12:40,514 - mms_extractor - INFO - ============================================================
2025-09-19 16:12:40,514 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:12:40,514 - mms_extractor - INFO - ============================================================
2025-09-19 16:12:40,514 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:12:40,514 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 16:12:40,514 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:12:40,514 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:12:40,514 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:12:40,514 - mms_extractor - INFO - process_message 실행완료: 16.67초
2025-09-19 16:12:40,514 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:12:40,514 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:12:40,514 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:12:40,514 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:12:40,514 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x351ce1c10> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35d321b20> root_client=<openai.OpenAI object at 0x351dfd070> root_async_client=<openai.AsyncOpenAI object at 0x35d321b50> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:12:40,514 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:12:40,514 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:12:59,807 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:12:59,808 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1949자
2025-09-19 16:12:59,808 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 16:12:59,808 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:12:59,808 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 16:12:59,808 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:12:59,809 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 16:12:59,809 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:12:59,809 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:12:59,809 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:12:59,809 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:12:59,809 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 16:12:59,810 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:13:00,063 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:13:00,064 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:13:00,064 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.550초
2025-09-19 16:13:00,064 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 16:13:00,064 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:13:00,064 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:13:00,064 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 16:13:00,064 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 36.22초
2025-09-19 16:13:00,064 - mms_extractor - INFO - 평균 처리 시간: 36.22초/메시지
2025-09-19 16:13:00,165 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:13:00,166 - mongodb_utils - INFO - 문서 저장 성공: 68cd027c7adf748a47eeda48
2025-09-19 16:13:00,166 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:13:00,166 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 16:13:00,166 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 16:13:00,166 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 36.320초 소요
2025-09-19 16:13:00,167 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:13:00] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 16:20:30,426 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 16:20:30,426 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 16:20:30,426 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 16:20:30,426 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 16:20:30,426 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 16:20:30,426 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 16:20:30,426 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 16:20:30,428 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 16:20:30,447 - mms_extractor - INFO - Using device: mps
2025-09-19 16:20:30,447 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 16:20:30,447 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 16:20:30,447 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 16:20:30,447 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 16:20:30,447 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 16:20:30,447 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 16:20:30,448 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 16:20:30,448 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 16:20:31,463 - mms_extractor - INFO - Model loaded on mps
2025-09-19 16:20:31,463 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.02초
2025-09-19 16:20:31,463 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 16:20:31,868 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 16:20:31,868 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.40초
2025-09-19 16:20:31,868 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 16:20:31,868 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:31,868 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 16:20:31,868 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:31,868 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 16:20:31,868 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 16:20:31,868 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 16:20:31,868 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 16:20:31,868 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:20:31,934 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 16:20:31,934 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:20:31,934 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 16:20:31,938 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 16:20:31,938 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 16:20:31,939 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:20:31,939 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:20:31,940 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 16:20:31,940 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 16:20:31,942 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 16:20:31,944 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 16:20:31,944 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 16:20:31,944 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:20:31,944 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 16:20:31,944 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 16:20:31,945 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 16:20:31,945 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:20:31,945 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 16:20:31,945 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 16:20:31,945 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 16:20:31,946 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 16:20:31,947 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 16:20:31,947 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:20:31,947 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 16:20:31,947 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 16:20:32,071 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 16:20:32,075 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 16:20:32,076 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-19 16:20:32,076 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 16:20:32,076 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 16:20:32,076 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 16:20:32,077 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 16:20:32,077 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 16:20:32,077 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 16:20:32,077 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 16:20:32,079 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 16:20:32,079 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 16:20:32,080 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-09-19 16:20:32,092 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 16:20:32,093 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 16:20:32,093 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 16:20:32,094 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 16:20:32,094 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 16:20:32,252 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 16:20:32,252 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 16:20:32,252 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 16:20:32,252 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 16:20:32,252 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 16:20:32,252 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 16:20:32,319 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 16:20:32,319 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 16:20:32,322 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 16:20:32,322 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 16:20:32,322 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 16:20:32,322 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 16:20:32,322 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 16:20:32,323 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 16:20:32,323 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:32,323 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 16:20:32,323 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:32,323 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 16:20:32,323 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 16:20:32,323 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 16:20:32,323 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 16:20:32,323 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 16:20:32,324 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 16:20:32,326 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 16:20:32,327 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 16:20:32,327 - mms_extractor - INFO - _load_data 실행완료: 0.46초
2025-09-19 16:20:32,327 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 16:20:32,327 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 16:20:32,327 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 16:20:32,327 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 16:20:32,327 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 16:20:32,327 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 16:20:32,327 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 16:20:32,327 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 16:20:32,327 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 16:20:32,327 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 16:20:32,327 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 16:20:32,337 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 16:20:32,337 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 16:20:41,575 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 16:20:41,575 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 16:20:41,575 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 16:20:41,575 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:20:41,575 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:41,575 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:20:41,575 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:41,575 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:20:41,575 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:20:41,575 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:20:41,575 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:20:41,575 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:20:41,575 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:20:41,575 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:20:41,575 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:20:41,575 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:20:41,575 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:20:41,575 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:20:41,575 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:20:41,577 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:20:42,062 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:20:42,063 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:20:42,064 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:20:42,064 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:20:42,064 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '시크릿', '에이닷이빵쏜닷', '데일리']
2025-09-19 16:20:42,064 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:20:49,516 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:20:49,516 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:20:49,518 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:20:49,518 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:20:49,574 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:20:49,575 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:20:49,575 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:20:49,578 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:20:49,580 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:20:49,581 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:20:49,581 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:20:49,581 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.01초
2025-09-19 16:20:49,581 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:20:49,581 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:20:49,581 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:20:49,849 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:20:49,850 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:20:49,850 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:20:49,850 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:20:49,850 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:20:49,850 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:20:49,850 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:20:49,850 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:20:49,850 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:20:49,850 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:20:49,850 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:20:49,850 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:20:49,850 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:20:49,850 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:20:49,850 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:20:57,679 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:20:57,689 - mms_extractor - INFO - LLM 응답 길이: 952 문자
2025-09-19 16:20:57,690 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
          ...
2025-09-19 16:20:57,690 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:20:57,690 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:20:57,690 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:20:57,690 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:20:57,690 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:20:57,690 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:20:58,070 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:20:58,070 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:20:58,070 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:20:58,070 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:20:59,161 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:20:59,302 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.61초
2025-09-19 16:20:59,305 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:20:59,305 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:59,305 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:20:59,305 - mms_extractor - INFO - ============================================================
2025-09-19 16:20:59,305 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:20:59,305 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도', '웹/앱 접속 유도']
2025-09-19 16:20:59,305 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:20:59,305 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:20:59,305 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:20:59,306 - mms_extractor - INFO - process_message 실행완료: 17.73초
2025-09-19 16:20:59,306 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:20:59,306 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:20:59,306 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:20:59,306 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:20:59,306 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x35b315d30> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35b315880> root_client=<openai.OpenAI object at 0x3503b66f0> root_async_client=<openai.AsyncOpenAI object at 0x35b315d60> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:20:59,306 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:20:59,306 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:21:19,402 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:21:19,404 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1902자
2025-09-19 16:21:19,404 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 16:21:19,404 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:21:19,405 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-09-19 16:21:19,405 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:21:19,406 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-09-19 16:21:19,406 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:21:19,406 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:21:19,406 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:21:19,406 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:21:19,406 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-09-19 16:21:19,407 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:21:19,660 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:21:19,660 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:21:19,660 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.355초
2025-09-19 16:21:19,660 - mms_extractor - INFO - 📏 DAG 섹션 길이: 89자
2025-09-19 16:21:19,660 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)
(앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:21:19,660 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:21:19,660 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 16:21:19,749 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:21:19,750 - mongodb_utils - INFO - 문서 저장 성공: 68cd046f3b5ff7f54c2f6e3f
2025-09-19 16:21:19,750 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:21:19,750 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 16:21:19,751 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 16:21:19,751 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 16:21:19,751 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(앱:접속) -[접속하면]-> (시크릿코드:입력)', '(웹사이트:접속) -[접속하면]-> (베어유쿠폰:수령)']...
2025-09-19 16:21:19,751 - __main__ - INFO - 추출 완료: 38.176초
2025-09-19 16:21:19,752 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:21:19] "POST /extract HTTP/1.1" 200 -
2025-09-19 16:21:50,327 - __main__ - INFO - 🎯 배치 DAG 추출 요청됨 - 1개 메시지, 워커: None
2025-09-19 16:21:50,328 - __main__ - INFO - 배치 처리 시작: 1/1개 유효한 메시지
2025-09-19 16:21:50,328 - mms_extractor - INFO - 배치 처리 시작: 1개 메시지, 1개 워커
2025-09-19 16:21:50,328 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 16:21:50,328 - mms_extractor - INFO - ============================================================
2025-09-19 16:21:50,328 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 16:21:50,328 - mms_extractor - INFO - ============================================================
2025-09-19 16:21:50,328 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 16:21:50,328 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 16:21:50,328 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 16:21:50,328 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 16:21:50,328 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 16:21:50,328 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 16:21:50,328 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 16:21:50,328 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 16:21:50,328 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 16:21:50,328 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 16:21:50,328 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 16:21:50,328 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 16:21:50,331 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 16:21:50,339 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 16:21:50,339 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 16:21:50,342 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 16:21:50,342 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 16:21:50,342 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['뚜레쥬르', '시크릿', '에이닷이빵쏜닷', '데일리']
2025-09-19 16:21:50,342 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 16:21:50,753 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 16:21:50,754 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 16:21:50,754 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 16:21:50,754 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 16:21:50,810 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 16:21:50,810 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 16:21:50,810 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 16:21:50,813 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 16:21:50,815 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 16:21:50,815 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 16:21:50,815 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 16:21:50,815 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.49초
2025-09-19 16:21:50,815 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 16:21:50,815 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 16:21:50,815 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 16:21:50,864 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 16:21:50,864 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 16:21:50,864 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 16:21:50,864 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 16:21:50,864 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 16:21:50,864 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 16:21:50,864 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 16:21:50,864 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 16:21:50,864 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 16:21:50,864 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 16:21:50,864 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 16:21:50,864 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 16:21:50,864 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 16:21:50,864 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 16:21:50,864 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 16:21:58,204 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:21:58,205 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 16:21:58,205 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 16:21:58,205 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 16:21:58,206 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 16:21:58,206 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 16:21:58,206 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 16:21:58,206 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 16:21:58,206 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 16:21:58,588 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 16:21:58,589 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 16:21:58,589 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 16:21:58,589 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 16:21:59,609 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:21:59,753 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.55초
2025-09-19 16:21:59,756 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 16:21:59,756 - mms_extractor - INFO - ============================================================
2025-09-19 16:21:59,756 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 16:21:59,756 - mms_extractor - INFO - ============================================================
2025-09-19 16:21:59,757 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 16:21:59,757 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 16:21:59,757 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 16:21:59,757 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 16:21:59,757 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 16:21:59,757 - mms_extractor - INFO - process_message 실행완료: 9.43초
2025-09-19 16:21:59,757 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 16:21:59,757 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 16:21:59,757 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 16:21:59,757 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 16:21:59,757 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x35b315d30> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35b315880> root_client=<openai.OpenAI object at 0x3503b66f0> root_async_client=<openai.AsyncOpenAI object at 0x35b315d60> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 16:21:59,757 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 16:21:59,757 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 16:22:20,711 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 16:22:20,712 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2127자
2025-09-19 16:22:20,712 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 16:22:20,712 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 96자
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 3
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트/앱:접속', '베어유쿠폰:수령', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트/앱:접속', '베어유쿠폰:수령'), ('웹사이트/앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 16:22:20,713 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 16:22:20,713 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:22:20,713 - utils - INFO - 📊 입력 그래프 - 노드 수: 4, 엣지 수: 3
2025-09-19 16:22:20,714 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 16:22:20,944 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 16:22:20,944 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 16:22:20,944 - mms_extractor - INFO - 🕒 DAG 처리 시간: 21.188초
2025-09-19 16:22:20,944 - mms_extractor - INFO - 📏 DAG 섹션 길이: 96자
2025-09-19 16:22:20,945 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트/앱:접속) -[접속하면]-> (베어유쿠폰:수령)
(웹사이트/앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 16:22:20,945 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 16:22:20,945 - mms_extractor - INFO - 배치 처리 진행률: 1/1 (100.0%)
2025-09-19 16:22:20,945 - mms_extractor - INFO - 배치 처리 완료: 1개 메시지, 30.62초
2025-09-19 16:22:20,945 - mms_extractor - INFO - 평균 처리 시간: 30.62초/메시지
2025-09-19 16:22:20,950 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 16:22:20,951 - mongodb_utils - INFO - 문서 저장 성공: 68cd04ac3b5ff7f54c2f6e41
2025-09-19 16:22:20,951 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 16:22:20,951 - __main__ - INFO - MongoDB 저장 완료: 1/1개 메시지
2025-09-19 16:22:20,951 - __main__ - INFO - 배치 추출 과정에서 캡처된 프롬프트: 0개
2025-09-19 16:22:20,952 - __main__ - INFO - 배치 추출 완료: 1/1개 성공, 30.624초 소요
2025-09-19 16:22:20,952 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 16:22:20] "POST /extract/batch HTTP/1.1" 200 -
2025-09-19 17:42:10,869 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:42:10] "GET /health HTTP/1.1" 200 -
2025-09-19 17:42:30,259 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:42:30] "GET /health HTTP/1.1" 200 -
2025-09-19 17:42:35,496 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:42:35] "GET /health HTTP/1.1" 200 -
2025-09-19 17:42:35,543 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:42:35] "GET /health HTTP/1.1" 200 -
2025-09-19 17:42:37,051 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:42:37] "GET /health HTTP/1.1" 200 -
2025-09-19 17:42:37,071 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 17:42:37,072 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 17:42:37,072 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 17:42:37,072 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 17:42:37,072 - mms_extractor - INFO - ============================================================
2025-09-19 17:42:37,072 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 17:42:37,072 - mms_extractor - INFO - ============================================================
2025-09-19 17:42:37,072 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 17:42:37,072 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 17:42:37,072 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 17:42:37,072 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 17:42:37,072 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 17:42:37,072 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 17:42:37,072 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 17:42:37,072 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 17:42:37,072 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 17:42:37,073 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 17:42:37,073 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 17:42:37,073 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 17:42:37,077 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 17:42:37,108 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 17:42:37,109 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 17:42:37,115 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 17:42:37,115 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 17:42:37,115 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', 'Netflix', '넷플릭스']
2025-09-19 17:42:37,115 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 17:42:55,718 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 17:42:55,718 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 17:42:55,719 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 17:42:55,719 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 17:42:55,801 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 17:42:55,801 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 17:42:55,801 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 17:42:55,804 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 17:42:55,806 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 17:42:55,807 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 17:42:55,808 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:42:55,811 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 17:42:55,811 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 17:42:55,811 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 18.74초
2025-09-19 17:42:55,811 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:42:55,811 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 17:42:55,811 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 17:42:55,962 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 17:42:55,962 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 17:42:55,962 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 17:42:55,962 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 17:42:55,962 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 17:42:55,962 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:42:55,962 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 17:42:55,962 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 17:42:55,962 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 17:42:55,963 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 17:42:55,963 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 17:42:55,964 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 17:42:55,964 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 17:42:55,964 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 17:42:55,964 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 17:42:55,964 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 17:42:55,964 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 17:43:02,842 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:43:02,848 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-19 17:43:02,848 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-19 17:43:02,848 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 17:43:02,850 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 17:43:02,850 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 17:43:02,850 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 17:43:02,851 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 17:43:02,851 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-19 17:43:03,823 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 17:43:03,823 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 17:43:03,823 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 17:43:03,823 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 17:43:06,731 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:43:06,888 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.04초
2025-09-19 17:43:06,892 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 17:43:06,892 - mms_extractor - INFO - ============================================================
2025-09-19 17:43:06,892 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 17:43:06,892 - mms_extractor - INFO - ============================================================
2025-09-19 17:43:06,892 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 17:43:06,892 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-19 17:43:06,892 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 17:43:06,892 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 17:43:06,892 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 17:43:06,892 - mms_extractor - INFO - process_message 실행완료: 29.82초
2025-09-19 17:43:06,892 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 17:43:06,892 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 17:43:06,892 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 17:43:06,892 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 17:43:06,893 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x35b315d30> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35b315880> root_client=<openai.OpenAI object at 0x3503b66f0> root_async_client=<openai.AsyncOpenAI object at 0x35b315d60> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 17:43:06,893 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 17:43:06,893 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 17:43:30,063 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:43:30,067 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2448자
2025-09-19 17:43:30,068 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 17:43:30,068 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 17:43:30,068 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 246자
2025-09-19 17:43:30,068 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 17:43:30,069 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 17:43:30,069 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 17:43:30,070 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 17:43:30,070 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 17:43:30,070 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 17:43:30,071 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 17:43:30,072 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 17:43:31,168 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 17:43:31,168 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 17:43:31,168 - mms_extractor - INFO - 🕒 DAG 처리 시간: 24.276초
2025-09-19 17:43:31,168 - mms_extractor - INFO - 📏 DAG 섹션 길이: 246자
2025-09-19 17:43:31,168 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -[가...
2025-09-19 17:43:31,169 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 17:43:31,169 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 17:43:31,173 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 17:43:31,174 - mongodb_utils - INFO - 문서 저장 성공: 68cd17b33b5ff7f54c2f6e43
2025-09-19 17:43:31,175 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 17:43:31,175 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 17:43:31,175 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 17:43:31,175 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 17:43:31,175 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)']...
2025-09-19 17:43:31,175 - __main__ - INFO - 추출 완료: 54.104초
2025-09-19 17:43:31,176 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:43:31] "POST /extract HTTP/1.1" 200 -
2025-09-19 17:43:31,201 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:43:31] "GET /health HTTP/1.1" 200 -
2025-09-19 17:48:10,163 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:48:10] "GET /health HTTP/1.1" 200 -
2025-09-19 17:48:10,236 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:48:10] "GET /health HTTP/1.1" 200 -
2025-09-19 17:48:14,459 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:48:14] "GET /health HTTP/1.1" 200 -
2025-09-19 17:48:14,474 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-19 17:48:14,475 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 17:48:14,475 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 17:48:14,475 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-19 17:48:14,475 - mms_extractor - INFO - ============================================================
2025-09-19 17:48:14,475 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 17:48:14,475 - mms_extractor - INFO - ============================================================
2025-09-19 17:48:14,475 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-19 17:48:14,475 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-19 17:48:14,475 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 17:48:14,475 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 17:48:14,475 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 17:48:14,475 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 17:48:14,475 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 17:48:14,475 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 17:48:14,475 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 17:48:14,475 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 17:48:14,475 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 17:48:14,475 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-19 17:48:14,478 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 17:48:14,482 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-19 17:48:14,482 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-19 17:48:14,484 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-19 17:48:14,484 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-19 17:48:14,484 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-19 17:48:14,484 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 17:48:21,548 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-19 17:48:21,549 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-19 17:48:21,551 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-19 17:48:21,551 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 17:48:21,666 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-19 17:48:21,666 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-19 17:48:21,666 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 17:48:21,668 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-19 17:48:21,670 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-19 17:48:21,671 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-19 17:48:21,672 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 17:48:21,674 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-19 17:48:21,674 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-19 17:48:21,675 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.20초
2025-09-19 17:48:21,675 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 17:48:21,675 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-19 17:48:21,675 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 17:48:21,850 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 17:48:21,850 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 17:48:21,850 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-19 17:48:21,850 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 17:48:21,851 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-19 17:48:21,851 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 17:48:21,851 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-19 17:48:21,851 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 17:48:21,851 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-19 17:48:21,852 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-09-19 17:48:21,852 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'CU 할인', 'action': '기타'}, {'name': 'GALAXY', 'action': '기타'}]
2025-09-19 17:48:21,852 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 17:48:21,852 - mms_extractor - INFO - 구성된 프롬프트 길이: 5621 문자
2025-09-19 17:48:21,852 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 17:48:21,852 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5621)
2025-09-19 17:48:21,852 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 17:48:21,852 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 17:48:30,492 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:48:30,493 - mms_extractor - INFO - LLM 응답 길이: 1173 문자
2025-09-19 17:48:30,493 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 S24 Ultra",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24+",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24",
            "action": "구매"
        },
        {
            "name": "갤럭시 워치6",
            "action": "구매"
        },
        {
            "name": "무선충전기",
            "a...
2025-09-19 17:48:30,494 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 17:48:30,494 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 17:48:30,494 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 17:48:30,494 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '증정'}, {'name': '케어플러스', 'action': '무료 이용'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '가입'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '가입'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-19 17:48:30,494 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 17:48:30,494 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-19 17:48:30,917 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 17:48:30,918 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 21696)
2025-09-19 17:48:30,918 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 17:48:30,918 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 17:48:33,078 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:48:33,258 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.76초
2025-09-19 17:48:33,262 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 17:48:33,262 - mms_extractor - INFO - ============================================================
2025-09-19 17:48:33,262 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 17:48:33,262 - mms_extractor - INFO - ============================================================
2025-09-19 17:48:33,262 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-19 17:48:33,262 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-19 17:48:33,262 - mms_extractor - INFO - 상품 수: 6개
2025-09-19 17:48:33,262 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 17:48:33,262 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 17:48:33,262 - mms_extractor - INFO - process_message 실행완료: 18.79초
2025-09-19 17:48:33,262 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 17:48:33,262 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 17:48:33,262 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 17:48:33,262 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-19 17:48:33,262 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x35b315d30> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x35b315880> root_client=<openai.OpenAI object at 0x3503b66f0> root_async_client=<openai.AsyncOpenAI object at 0x35b315d60> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 17:48:33,262 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 17:48:33,262 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-19 17:49:05,339 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:49:05,341 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 3043자
2025-09-19 17:49:05,341 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱과 온라인 매장 예약 ...
2025-09-19 17:49:05,341 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 17:49:05,342 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 587자
2025-09-19 17:49:05,342 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 17:49:05,342 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 2
2025-09-19 17:49:05,343 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:접속', '갤럭시 S24:사전예약', '온라인 매장:방문', '할인:수령']
2025-09-19 17:49:05,343 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:접속', '갤럭시 S24:사전예약'), ('온라인 매장:방문', '갤럭시 S24:사전예약')]
2025-09-19 17:49:05,343 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 17:49:05,343 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-19 17:49:05,343 - utils - INFO - 📊 입력 그래프 - 노드 수: 4, 엣지 수: 2
2025-09-19 17:49:05,344 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 17:49:05,580 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-19 17:49:05,581 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-19 17:49:05,581 - mms_extractor - INFO - 🕒 DAG 처리 시간: 32.319초
2025-09-19 17:49:05,581 - mms_extractor - INFO - 📏 DAG 섹션 길이: 587자
2025-09-19 17:49:05,581 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (할인:수령)
(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50% 할인)
(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료 증정)
(T world 앱:...
2025-09-19 17:49:05,581 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 17:49:05,581 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 17:49:05,586 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 17:49:05,588 - mongodb_utils - INFO - 문서 저장 성공: 68cd19013b5ff7f54c2f6e45
2025-09-19 17:49:05,589 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 17:49:05,589 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 17:49:05,589 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 17:49:05,589 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 12자
2025-09-19 17:49:05,589 - __main__ - INFO - DAG 내용 미리보기: ['  - (갤럭시 S24 Ultra:최대 30만원 할인)', '  - (갤럭시 S24+:최대 25만원 할인)', '  - (갤럭시 S24:최대 20만원 할인)', '(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50% 할인)', '(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료 증정)', '(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월 무료)', '(T world 앱:접속) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (할인:수령)', '(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50% 할인)', '(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료 증정)', '(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월 무료)', '(온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약) -[사전예약하면]-> (할인:수령)', '(할인:수령)']...
2025-09-19 17:49:05,589 - __main__ - INFO - 추출 완료: 51.114초
2025-09-19 17:49:05,590 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:49:05] "POST /extract HTTP/1.1" 200 -
2025-09-19 17:49:05,622 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:49:05] "GET /health HTTP/1.1" 200 -
2025-09-19 17:56:31,536 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 17:56:31,536 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 17:56:31,536 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 17:56:31,536 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 17:56:31,536 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 17:56:31,536 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 17:56:31,536 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 17:56:31,537 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 17:56:31,595 - mms_extractor - INFO - Using device: mps
2025-09-19 17:56:31,595 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-09-19 17:56:31,595 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 17:56:31,596 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 17:56:31,596 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 17:56:31,596 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 17:56:31,596 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 17:56:31,596 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 17:56:31,596 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 17:56:37,231 - mms_extractor - INFO - Model loaded on mps
2025-09-19 17:56:37,231 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.64초
2025-09-19 17:56:37,231 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 17:56:37,698 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 17:56:37,698 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.47초
2025-09-19 17:56:37,698 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 17:56:37,698 - mms_extractor - INFO - ============================================================
2025-09-19 17:56:37,698 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 17:56:37,698 - mms_extractor - INFO - ============================================================
2025-09-19 17:56:37,698 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 17:56:37,698 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 17:56:37,698 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 17:56:37,698 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 17:56:37,698 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 17:56:37,770 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 17:56:37,770 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 17:56:37,770 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 17:56:37,773 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 17:56:37,774 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 17:56:37,774 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 17:56:37,775 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 17:56:37,775 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 17:56:37,775 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 17:56:37,783 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 17:56:37,786 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 17:56:37,786 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 17:56:37,786 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 17:56:37,786 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 17:56:37,786 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 17:56:37,787 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 17:56:37,787 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 17:56:37,787 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 17:56:37,787 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 17:56:37,787 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 17:56:37,794 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 17:56:37,794 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 17:56:37,794 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 17:56:37,794 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 17:56:37,795 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 17:56:37,919 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 17:56:37,923 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 17:56:37,923 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 17:56:37,923 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 17:56:37,924 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 17:56:37,924 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 17:56:37,925 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 17:56:37,925 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 17:56:37,925 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 17:56:37,925 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 17:56:37,927 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 17:56:37,927 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 17:56:37,928 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증']
2025-09-19 17:56:37,941 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 17:56:37,942 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 17:56:37,942 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 17:56:37,954 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 17:56:37,954 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 17:56:38,167 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 17:56:38,168 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 17:56:38,168 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 17:56:38,168 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 17:56:38,168 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 17:56:38,168 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 17:56:38,234 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 17:56:38,234 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 17:56:38,236 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 17:56:38,237 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 17:56:38,237 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 17:56:38,237 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 17:56:38,237 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 17:56:38,237 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 17:56:38,237 - mms_extractor - INFO - ============================================================
2025-09-19 17:56:38,237 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 17:56:38,237 - mms_extractor - INFO - ============================================================
2025-09-19 17:56:38,237 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 17:56:38,237 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 17:56:38,237 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 17:56:38,237 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 17:56:38,237 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 17:56:38,239 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 17:56:38,241 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 17:56:38,241 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 17:56:38,241 - mms_extractor - INFO - _load_data 실행완료: 0.54초
2025-09-19 17:56:38,241 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 17:56:38,242 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 17:56:38,242 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 17:56:38,242 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 17:56:38,242 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 17:56:38,242 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 17:56:38,242 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 17:56:38,242 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 17:56:38,242 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 17:56:38,242 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 17:56:38,242 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 17:56:38,269 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 17:56:38,269 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 17:57:00,640 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:00] "GET /health HTTP/1.1" 200 -
2025-09-19 17:57:05,127 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:05] "GET /health HTTP/1.1" 200 -
2025-09-19 17:57:09,265 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:09] "GET /health HTTP/1.1" 200 -
2025-09-19 17:57:09,316 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:09] "GET /health HTTP/1.1" 200 -
2025-09-19 17:57:10,586 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:10] "GET /health HTTP/1.1" 200 -
2025-09-19 17:57:10,603 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 17:57:10,603 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 17:57:10,604 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 17:57:10,604 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 17:57:10,604 - mms_extractor - INFO - ============================================================
2025-09-19 17:57:10,604 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 17:57:10,604 - mms_extractor - INFO - ============================================================
2025-09-19 17:57:10,604 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 17:57:10,604 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 17:57:10,604 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 17:57:10,604 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 17:57:10,604 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 17:57:10,604 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 17:57:10,604 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 17:57:10,604 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 17:57:10,604 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 17:57:10,604 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 17:57:10,604 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 17:57:10,604 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 17:57:10,606 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 17:57:11,085 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 17:57:11,085 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 17:57:11,088 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 17:57:11,088 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 17:57:11,088 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 17:57:11,088 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 17:57:18,728 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 17:57:18,728 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 17:57:18,729 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 17:57:18,729 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 17:57:18,824 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 17:57:18,825 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 17:57:18,825 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 17:57:18,837 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 17:57:18,847 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 17:57:18,849 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 17:57:18,870 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:57:18,873 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 17:57:18,874 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 17:57:18,874 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 8.27초
2025-09-19 17:57:18,874 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:57:18,874 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 17:57:18,874 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 17:57:19,087 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 17:57:19,087 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 17:57:19,087 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 17:57:19,087 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 17:57:19,087 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 17:57:19,087 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 17:57:19,087 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 17:57:19,087 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 17:57:19,088 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 17:57:19,089 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 17:57:19,089 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 17:57:19,089 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 17:57:19,089 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 17:57:19,089 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 17:57:19,089 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 17:57:19,089 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 17:57:19,089 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 17:57:25,676 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:57:25,691 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-19 17:57:25,691 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-19 17:57:25,691 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 17:57:25,692 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 17:57:25,692 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 17:57:25,692 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 17:57:25,692 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 17:57:25,692 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-19 17:57:26,662 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 17:57:26,662 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 17:57:26,662 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 17:57:26,662 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 17:57:30,108 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:57:30,245 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.55초
2025-09-19 17:57:30,249 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 17:57:30,249 - mms_extractor - INFO - ============================================================
2025-09-19 17:57:30,249 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 17:57:30,249 - mms_extractor - INFO - ============================================================
2025-09-19 17:57:30,249 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 17:57:30,249 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-19 17:57:30,249 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 17:57:30,249 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 17:57:30,249 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 17:57:30,249 - mms_extractor - INFO - process_message 실행완료: 19.65초
2025-09-19 17:57:30,249 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 17:57:30,249 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 17:57:30,250 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 17:57:30,250 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 17:57:30,250 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x34d1ad010> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x356625a30> root_client=<openai.OpenAI object at 0x34d17f560> root_async_client=<openai.AsyncOpenAI object at 0x34d1ac8f0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 17:57:30,250 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 17:57:30,250 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 17:57:49,940 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 17:57:49,943 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2003자
2025-09-19 17:57:49,943 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 17:57:49,944 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 17:57:49,945 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 178자
2025-09-19 17:57:49,945 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 17:57:49,946 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-09-19 17:57:49,946 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 정보:확인', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인']
2025-09-19 17:57:49,946 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 정보:확인', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인')]
2025-09-19 17:57:49,947 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 17:57:49,947 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 17:57:49,947 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-09-19 17:57:49,949 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 17:57:50,556 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 17:57:50,556 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 17:57:50,556 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.306초
2025-09-19 17:57:50,556 - mms_extractor - INFO - 📏 DAG 섹션 길이: 178자
2025-09-19 17:57:50,556 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)...
2025-09-19 17:57:50,556 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 17:57:50,556 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 17:57:50,688 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 17:57:50,690 - mongodb_utils - INFO - 문서 저장 성공: 68cd1b0e6ef3f7d28e3070e3
2025-09-19 17:57:50,690 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 17:57:50,690 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 17:57:50,690 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 17:57:50,690 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 4자
2025-09-19 17:57:50,690 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(프로모션 정보:확인) -[확인후]-> (우주패스 Netflix:가입)']...
2025-09-19 17:57:50,690 - __main__ - INFO - 추출 완료: 40.087초
2025-09-19 17:57:50,691 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:50] "POST /extract HTTP/1.1" 200 -
2025-09-19 17:57:50,724 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 17:57:50] "GET /health HTTP/1.1" 200 -
2025-09-19 18:02:09,404 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-19 18:02:09,405 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-19 18:02:09,405 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-19 18:02:09,405 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-19 18:02:09,405 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-19 18:02:09,405 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-19 18:02:09,405 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-19 18:02:09,406 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-19 18:02:09,423 - mms_extractor - INFO - Using device: mps
2025-09-19 18:02:09,424 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-19 18:02:09,424 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-19 18:02:09,424 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-19 18:02:09,424 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-19 18:02:09,424 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-19 18:02:09,424 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-19 18:02:09,424 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-19 18:02:09,424 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-19 18:02:10,655 - mms_extractor - INFO - Model loaded on mps
2025-09-19 18:02:10,655 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.23초
2025-09-19 18:02:10,655 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-19 18:02:11,072 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-19 18:02:11,072 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.42초
2025-09-19 18:02:11,072 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-19 18:02:11,072 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:11,073 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-19 18:02:11,073 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:11,073 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-19 18:02:11,073 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-19 18:02:11,073 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-19 18:02:11,073 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-19 18:02:11,073 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 18:02:11,139 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-19 18:02:11,139 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 18:02:11,139 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-19 18:02:11,142 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-19 18:02:11,143 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-19 18:02:11,143 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 18:02:11,144 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 18:02:11,144 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-19 18:02:11,144 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-19 18:02:11,145 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-19 18:02:11,148 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-19 18:02:11,148 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-19 18:02:11,148 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 18:02:11,148 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-19 18:02:11,148 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-19 18:02:11,149 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-19 18:02:11,149 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 18:02:11,149 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-19 18:02:11,149 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-19 18:02:11,149 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-19 18:02:11,150 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-19 18:02:11,151 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-19 18:02:11,151 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 18:02:11,151 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-19 18:02:11,151 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-19 18:02:11,273 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-19 18:02:11,278 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-19 18:02:11,278 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 18:02:11,278 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-19 18:02:11,279 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-19 18:02:11,279 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-19 18:02:11,280 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-19 18:02:11,280 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-19 18:02:11,280 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-19 18:02:11,280 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-19 18:02:11,282 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-19 18:02:11,282 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-19 18:02:11,282 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-19 18:02:11,295 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-19 18:02:11,295 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-19 18:02:11,295 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-19 18:02:11,297 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-19 18:02:11,297 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-19 18:02:11,450 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-19 18:02:11,450 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-19 18:02:11,450 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-19 18:02:11,450 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-19 18:02:11,450 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-19 18:02:11,450 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-19 18:02:11,515 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-19 18:02:11,515 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-19 18:02:11,517 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-19 18:02:11,518 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-19 18:02:11,518 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-19 18:02:11,518 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-19 18:02:11,518 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-19 18:02:11,519 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-19 18:02:11,519 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:11,519 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-19 18:02:11,519 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:11,519 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-19 18:02:11,519 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-19 18:02:11,519 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-19 18:02:11,519 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-19 18:02:11,519 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-19 18:02:11,520 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-19 18:02:11,522 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-19 18:02:11,523 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-19 18:02:11,523 - mms_extractor - INFO - _load_data 실행완료: 0.45초
2025-09-19 18:02:11,523 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-19 18:02:11,523 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-19 18:02:11,523 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-19 18:02:11,523 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-19 18:02:11,523 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-19 18:02:11,523 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-19 18:02:11,523 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-19 18:02:11,523 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-19 18:02:11,523 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-19 18:02:11,523 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-19 18:02:11,523 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-19 18:02:11,532 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.35:8000
2025-09-19 18:02:11,532 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-19 18:02:54,066 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:02:54] "GET /health HTTP/1.1" 200 -
2025-09-19 18:02:57,486 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:02:57] "GET /health HTTP/1.1" 200 -
2025-09-19 18:02:57,550 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:02:57] "GET /health HTTP/1.1" 200 -
2025-09-19 18:02:59,172 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:02:59] "GET /health HTTP/1.1" 200 -
2025-09-19 18:02:59,188 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:02:59,189 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:02:59,189 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:02:59,189 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:02:59,189 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:59,189 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:02:59,189 - mms_extractor - INFO - ============================================================
2025-09-19 18:02:59,189 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:02:59,189 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:02:59,189 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:02:59,189 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:02:59,189 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:02:59,189 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:02:59,189 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:02:59,189 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:02:59,189 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:02:59,190 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:02:59,190 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:02:59,190 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:02:59,192 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:02:59,672 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:02:59,673 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:02:59,676 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:02:59,676 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:02:59,676 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:02:59,676 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:03:06,368 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:03:06,368 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:03:06,369 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:03:06,369 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:03:06,473 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:03:06,473 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:03:06,473 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:03:06,476 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:03:06,478 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:03:06,478 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:03:06,480 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:03:06,482 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:03:06,483 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:03:06,483 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.29초
2025-09-19 18:03:06,483 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:03:06,483 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:03:06,483 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:03:06,571 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:03:06,571 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:03:06,571 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:03:06,571 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:03:06,571 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:03:06,571 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:03:06,571 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:03:06,571 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:03:06,571 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:03:06,573 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:03:06,573 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:03:06,573 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:03:06,573 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:03:06,573 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:03:06,573 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:03:06,573 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:03:06,573 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:03:13,261 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:03:13,276 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-19 18:03:13,276 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-19 18:03:13,276 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:03:13,276 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:03:13,276 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:03:13,276 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:03:13,277 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:03:13,277 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-19 18:03:14,222 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:03:14,222 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:03:14,223 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:03:14,223 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:03:15,164 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:03:15,296 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.02초
2025-09-19 18:03:15,300 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:03:15,300 - mms_extractor - INFO - ============================================================
2025-09-19 18:03:15,300 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:03:15,300 - mms_extractor - INFO - ============================================================
2025-09-19 18:03:15,300 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:03:15,300 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-19 18:03:15,300 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:03:15,300 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:03:15,300 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:03:15,300 - mms_extractor - INFO - process_message 실행완료: 16.11초
2025-09-19 18:03:15,300 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:03:15,300 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:03:15,301 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:03:15,301 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:03:15,301 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:03:15,301 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:03:15,301 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:03:37,899 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:03:37,902 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2558자
2025-09-19 18:03:37,902 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 18:03:37,902 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:03:37,903 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-09-19 18:03:37,903 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:03:37,904 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 18:03:37,904 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 18:03:37,904 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 18:03:37,905 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:03:37,905 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:03:37,906 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 18:03:37,907 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:03:38,177 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:03:38,177 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:03:38,177 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.877초
2025-09-19 18:03:38,177 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-09-19 18:03:38,177 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-09-19 18:03:38,177 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:03:38,177 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:03:38,258 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:03:38,259 - mongodb_utils - INFO - 문서 저장 성공: 68cd1c6a2c09526a55b24b1c
2025-09-19 18:03:38,260 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:03:38,260 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:03:38,260 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:03:38,260 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:03:38,260 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 18:03:38,260 - __main__ - INFO - 추출 완료: 39.071초
2025-09-19 18:03:38,260 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:03:38] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:03:38,287 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:03:38] "GET /health HTTP/1.1" 200 -
2025-09-19 18:07:54,723 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 370자
2025-09-19 18:07:54,724 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:07:54,724 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:07:54,724 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 ...
2025-09-19 18:07:54,724 - mms_extractor - INFO - ============================================================
2025-09-19 18:07:54,724 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:07:54,724 - mms_extractor - INFO - ============================================================
2025-09-19 18:07:54,724 - mms_extractor - INFO - 메시지 내용: 광고 제목:[SK텔레콤] 2월 0 day 혜택 안내
광고 내용:(광고)[SKT] 2월 0 day 혜택 안내__[2월 10일(토) 혜택]_만 13~34세 고객이라면_베어유 모든 강의 14일 무료 수강 쿠폰 드립니다!_(선착순 3만 명 증정)_▶ 자세히 보기: http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3...
2025-09-19 18:07:54,724 - mms_extractor - INFO - 메시지 길이: 370 문자
2025-09-19 18:07:54,724 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:07:54,724 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:07:54,724 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-19 18:07:54,724 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:07:54,724 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:07:54,724 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:07:54,724 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:07:54,724 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:07:54,725 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:07:54,725 - mms_extractor - INFO - 처리할 메시지 길이: 370 문자
2025-09-19 18:07:54,727 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:07:54,734 - mms_extractor - INFO - 분할된 문장 수: 14개
2025-09-19 18:07:54,735 - mms_extractor - INFO - 필터링된 문장들: ['광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', ' 토 혜택 ', '만 13 고객이라면']...
2025-09-19 18:07:54,738 - mms_extractor - INFO - 전체 토큰 수: 138개
2025-09-19 18:07:54,738 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '에이닷', '시크릿', '에이닷', '에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 18:07:54,738 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에이닷이빵쏜닷', '뚜레쥬르', '데일리', '시크릿']
2025-09-19 18:07:54,738 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:07:55,022 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (3746, 3)
2025-09-19 18:07:55,022 - mms_extractor - INFO - 퍼지 매칭 성공: 3746개 결과
2025-09-19 18:07:55,023 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.5}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.4}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.4}]
2025-09-19 18:07:55,023 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:07:55,065 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (3746, 3)
2025-09-19 18:07:55,066 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '해지번호안내', 'sim': 0.26666666666666666}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': 'T_변경번호안내', 'sim': 0.25}, {'sent': '광고 제목 SK텔레콤 0 day 혜택 안내 광고 내용 광고 SKT 0 day 혜택 안내', 'item_nm_alias': '시내버스', 'sim': 0.2}]
2025-09-19 18:07:55,066 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:07:55,069 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 0개
2025-09-19 18:07:55,071 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 18:07:55,072 - mms_extractor - INFO - 통합된 후보 아이템 수: 0개
2025-09-19 18:07:55,072 - mms_extractor - WARNING - 통합된 후보 아이템이 없습니다!
2025-09-19 18:07:55,072 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.35초
2025-09-19 18:07:55,072 - mms_extractor - INFO - 추출된 후보 엔티티: []
2025-09-19 18:07:55,072 - mms_extractor - INFO - 매칭된 상품 정보: (0, 0)
2025-09-19 18:07:55,072 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:07:55,195 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:07:55,195 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:07:55,195 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 387 문자
2025-09-19 18:07:55,195 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:07:55,195 - mms_extractor - WARNING - 후보 아이템이 없습니다!
2025-09-19 18:07:55,195 - mms_extractor - WARNING - 이는 다음 중 하나의 문제일 수 있습니다:
2025-09-19 18:07:55,195 - mms_extractor - WARNING - 1. 상품 데이터 로딩 실패
2025-09-19 18:07:55,195 - mms_extractor - WARNING - 2. 엔티티 추출 실패
2025-09-19 18:07:55,195 - mms_extractor - WARNING - 3. 유사도 매칭 임계값 문제
2025-09-19 18:07:55,195 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:07:55,195 - mms_extractor - INFO - 구성된 프롬프트 길이: 5817 문자
2025-09-19 18:07:55,195 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:07:55,195 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5817)
2025-09-19 18:07:55,195 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:07:55,195 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:08:02,424 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:08:02,426 - mms_extractor - INFO - LLM 응답 길이: 931 문자
2025-09-19 18:08:02,426 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 2월 0 day 혜택 안내",
    "purpose": [
        "혜택 안내",
        "쿠폰 제공 안내",
        "이벤트 응모 유도"
    ],
    "product": [
        {
            "name": "베어유 모든 강의",
            "action": "사용"
        },
        {
            "name": "뚜레쥬르 데일리우유식빵 무료 쿠폰",
            "action": "쿠폰다운로드"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc",
            "action": "추가 정보"
 ...
2025-09-19 18:08:02,426 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:08:02,426 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:08:02,426 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:08:02,426 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 2월 0 day 혜택 안내', 'purpose': ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도'], 'product': [{'name': '베어유 모든 강의', 'action': '사용'}, {'name': '뚜레쥬르 데일리우유식빵 무료 쿠폰', 'action': '쿠폰다운로드'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&s=24589&a=&u=https://bit.ly/3SfBjjc', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://bit.ly/3HCUhLM', 'action': '참여'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['사용법/혜택/이벤트안내_SKT', '사용법/혜택/이벤트안내_T멤버십']}
2025-09-19 18:08:02,426 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:08:02,426 - mms_extractor - INFO - LLM 추출 엔티티: ['베어유 모든 강의', '뚜레쥬르 데일리우유식빵 무료 쿠폰']
2025-09-19 18:08:02,854 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:08:02,854 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 15941)
2025-09-19 18:08:02,854 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:08:02,855 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:08:03,938 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:08:04,164 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.74초
2025-09-19 18:08:04,167 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:08:04,167 - mms_extractor - INFO - ============================================================
2025-09-19 18:08:04,168 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:08:04,168 - mms_extractor - INFO - ============================================================
2025-09-19 18:08:04,168 - mms_extractor - INFO - 제목: [SK텔레콤] 2월 0 day 혜택 안내
2025-09-19 18:08:04,168 - mms_extractor - INFO - 목적: ['혜택 안내', '쿠폰 제공 안내', '이벤트 응모 유도']
2025-09-19 18:08:04,168 - mms_extractor - INFO - 상품 수: 1개
2025-09-19 18:08:04,168 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 18:08:04,168 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:08:04,168 - mms_extractor - INFO - process_message 실행완료: 9.44초
2025-09-19 18:08:04,168 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:08:04,168 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:08:04,168 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:08:04,168 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-09-19 18:08:04,168 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:08:04,168 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:08:04,168 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-09-19 18:08:23,227 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:08:23,231 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1926자
2025-09-19 18:08:23,231 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-09-19 18:08:23,231 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:08:23,232 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 96자
2025-09-19 18:08:23,232 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:08:23,232 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 3
2025-09-19 18:08:23,232 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트/앱:접속', '베어유쿠폰:수령', '시크릿코드:입력', '식빵쿠폰:수령']
2025-09-19 18:08:23,233 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트/앱:접속', '베어유쿠폰:수령'), ('웹사이트/앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-09-19 18:08:23,233 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:08:23,233 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 18:08:23,233 - utils - INFO - 📊 입력 그래프 - 노드 수: 4, 엣지 수: 3
2025-09-19 18:08:23,234 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:08:23,527 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-09-19 18:08:23,527 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-09-19 18:08:23,527 - mms_extractor - INFO - 🕒 DAG 처리 시간: 19.360초
2025-09-19 18:08:23,527 - mms_extractor - INFO - 📏 DAG 섹션 길이: 96자
2025-09-19 18:08:23,527 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트/앱:접속) -[접속하면]-> (베어유쿠폰:수령)
(웹사이트/앱:접속) -[접속하면]-> (시크릿코드:입력)
(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)...
2025-09-19 18:08:23,527 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:08:23,527 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:08:23,533 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:08:23,534 - mongodb_utils - INFO - 문서 저장 성공: 68cd1d872c09526a55b24b1e
2025-09-19 18:08:23,534 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:08:23,534 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:08:23,534 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:08:23,534 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 3자
2025-09-19 18:08:23,534 - __main__ - INFO - DAG 내용 미리보기: ['(시크릿코드:입력) -[입력하면]-> (식빵쿠폰:수령)', '(웹사이트/앱:접속) -[접속하면]-> (베어유쿠폰:수령)', '(웹사이트/앱:접속) -[접속하면]-> (시크릿코드:입력)']...
2025-09-19 18:08:23,534 - __main__ - INFO - 추출 완료: 28.810초
2025-09-19 18:08:23,535 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:08:23] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:11:58,915 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:11:58] "GET /health HTTP/1.1" 200 -
2025-09-19 18:12:02,521 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:02] "GET /health HTTP/1.1" 200 -
2025-09-19 18:12:05,310 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:05] "GET /health HTTP/1.1" 200 -
2025-09-19 18:12:05,371 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:05] "GET /health HTTP/1.1" 200 -
2025-09-19 18:12:07,564 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:07] "GET /health HTTP/1.1" 200 -
2025-09-19 18:12:07,583 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:12:07,584 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:12:07,584 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:12:07,584 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:12:07,584 - mms_extractor - INFO - ============================================================
2025-09-19 18:12:07,584 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:12:07,584 - mms_extractor - INFO - ============================================================
2025-09-19 18:12:07,584 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:12:07,584 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:12:07,584 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:12:07,584 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:12:07,584 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:12:07,584 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:12:07,584 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:12:07,584 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:12:07,584 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:12:07,584 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:12:07,584 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:12:07,584 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:12:07,587 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:12:07,604 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:12:07,604 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:12:07,609 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:12:07,610 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:12:07,610 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:12:07,610 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:12:07,840 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:12:07,840 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:12:07,841 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:12:07,841 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:12:07,929 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:12:07,929 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:12:07,929 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:12:07,932 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:12:07,934 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:12:07,934 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:12:07,935 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:12:07,938 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:12:07,938 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:12:07,938 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.35초
2025-09-19 18:12:07,938 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:12:07,938 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:12:07,938 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:12:08,049 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:12:08,049 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:12:08,049 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:12:08,049 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:12:08,049 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:12:08,049 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:12:08,049 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:12:08,049 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:12:08,049 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:12:08,051 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:12:08,051 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:12:08,051 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:12:08,051 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:12:08,051 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:12:08,051 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:12:08,051 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:12:08,051 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:12:14,853 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:12:14,858 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-19 18:12:14,858 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-19 18:12:14,858 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:12:14,860 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:12:14,860 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:12:14,860 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:12:14,860 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:12:14,861 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-19 18:12:15,813 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:12:15,813 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:12:15,813 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:12:15,813 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:12:16,671 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:12:16,853 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.99초
2025-09-19 18:12:16,857 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:12:16,857 - mms_extractor - INFO - ============================================================
2025-09-19 18:12:16,857 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:12:16,857 - mms_extractor - INFO - ============================================================
2025-09-19 18:12:16,857 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:12:16,857 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-19 18:12:16,857 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:12:16,857 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:12:16,857 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:12:16,857 - mms_extractor - INFO - process_message 실행완료: 9.27초
2025-09-19 18:12:16,857 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:12:16,857 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:12:16,857 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:12:16,857 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:12:16,857 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:12:16,857 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:12:16,857 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:12:40,394 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2627자
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 18:12:40,395 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:12:40,395 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:12:40,395 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 18:12:40,396 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:12:40,881 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:12:40,881 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:12:40,881 - mms_extractor - INFO - 🕒 DAG 처리 시간: 24.024초
2025-09-19 18:12:40,882 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-09-19 18:12:40,882 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-09-19 18:12:40,882 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:12:40,882 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:12:40,886 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:12:40,888 - mongodb_utils - INFO - 문서 저장 성공: 68cd1e882c09526a55b24b20
2025-09-19 18:12:40,888 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:12:40,888 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:12:40,888 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:12:40,888 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:12:40,888 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 18:12:40,889 - __main__ - INFO - 추출 완료: 33.305초
2025-09-19 18:12:40,889 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:40] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:12:40,914 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:12:40] "GET /health HTTP/1.1" 200 -
2025-09-19 18:18:45,286 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:18:45] "GET /health HTTP/1.1" 200 -
2025-09-19 18:18:57,935 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:18:57] "GET /health HTTP/1.1" 200 -
2025-09-19 18:19:00,479 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:19:00] "GET /health HTTP/1.1" 200 -
2025-09-19 18:19:00,529 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:19:00] "GET /health HTTP/1.1" 200 -
2025-09-19 18:19:01,843 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:19:01] "GET /health HTTP/1.1" 200 -
2025-09-19 18:19:01,864 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:19:01,864 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:19:01,864 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:19:01,864 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:19:01,864 - mms_extractor - INFO - ============================================================
2025-09-19 18:19:01,864 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:19:01,864 - mms_extractor - INFO - ============================================================
2025-09-19 18:19:01,864 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:19:01,864 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:19:01,864 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:19:01,864 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:19:01,864 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:19:01,865 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:19:01,865 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:19:01,865 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:19:01,865 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:19:01,865 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:19:01,865 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:19:01,865 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:19:01,868 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:19:01,877 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:19:01,878 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:19:01,884 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:19:01,885 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:19:01,885 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:19:01,885 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:19:19,732 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:19:19,732 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:19:19,733 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:19:19,733 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:19:19,827 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:19:19,828 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:19:19,828 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:19:19,830 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:19:19,835 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:19:19,839 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:19:19,841 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:19:19,844 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:19:19,844 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:19:19,844 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 17.98초
2025-09-19 18:19:19,844 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:19:19,844 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:19:19,844 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:19:20,044 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:19:20,044 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:19:20,044 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:19:20,044 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:19:20,044 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:19:20,044 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:19:20,044 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:19:20,044 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:19:20,045 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:19:20,046 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:19:20,046 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:19:20,046 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:19:20,046 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:19:20,046 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:19:20,046 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:19:20,046 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:19:20,046 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:19:27,765 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:19:27,768 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-09-19 18:19:27,768 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-09-19 18:19:27,769 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:19:27,769 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:19:27,770 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:19:27,770 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:19:27,770 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:19:27,770 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-09-19 18:19:28,710 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:19:28,710 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:19:28,711 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:19:28,711 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:19:29,605 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:19:29,757 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.99초
2025-09-19 18:19:29,761 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:19:29,761 - mms_extractor - INFO - ============================================================
2025-09-19 18:19:29,761 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:19:29,761 - mms_extractor - INFO - ============================================================
2025-09-19 18:19:29,761 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:19:29,761 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내']
2025-09-19 18:19:29,761 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:19:29,761 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:19:29,761 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:19:29,761 - mms_extractor - INFO - process_message 실행완료: 27.90초
2025-09-19 18:19:29,761 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:19:29,761 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:19:29,761 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:19:29,761 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:19:29,761 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:19:29,761 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:19:29,761 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:19:54,787 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:19:54,790 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2673자
2025-09-19 18:19:54,790 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 18:19:54,790 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:19:54,791 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 247자
2025-09-19 18:19:54,791 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:19:54,792 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 18:19:54,792 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 링크:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 18:19:54,792 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 링크:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 18:19:54,792 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:19:54,793 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:19:54,793 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 18:19:54,794 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:19:55,047 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:19:55,047 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:19:55,047 - mms_extractor - INFO - 🕒 DAG 처리 시간: 25.286초
2025-09-19 18:19:55,047 - mms_extractor - INFO - 📏 DAG 섹션 길이: 247자
2025-09-19 18:19:55,047 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 링크:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -[...
2025-09-19 18:19:55,047 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:19:55,047 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:19:55,052 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:19:55,053 - mongodb_utils - INFO - 문서 저장 성공: 68cd203b2c09526a55b24b22
2025-09-19 18:19:55,053 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:19:55,053 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:19:55,053 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:19:55,053 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:19:55,053 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 링크:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 18:19:55,053 - __main__ - INFO - 추출 완료: 53.189초
2025-09-19 18:19:55,054 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:19:55] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:19:55,077 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:19:55] "GET /health HTTP/1.1" 200 -
2025-09-19 18:26:17,998 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:26:17] "GET /health HTTP/1.1" 200 -
2025-09-19 18:26:18,060 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:26:18] "GET /health HTTP/1.1" 200 -
2025-09-19 18:26:23,064 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:26:23] "GET /health HTTP/1.1" 200 -
2025-09-19 18:26:23,081 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-19 18:26:23,082 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:26:23,082 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:26:23,082 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-19 18:26:23,082 - mms_extractor - INFO - ============================================================
2025-09-19 18:26:23,082 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:26:23,082 - mms_extractor - INFO - ============================================================
2025-09-19 18:26:23,082 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-19 18:26:23,082 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-19 18:26:23,082 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:26:23,082 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:26:23,082 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:26:23,082 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:26:23,082 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:26:23,083 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:26:23,083 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:26:23,083 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:26:23,083 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:26:23,083 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-19 18:26:23,086 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:26:23,092 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-19 18:26:23,092 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-19 18:26:23,094 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-19 18:26:23,094 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-19 18:26:23,094 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['갤럭시', '충전기']
2025-09-19 18:26:23,094 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:26:42,810 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-19 18:26:42,810 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-19 18:26:42,811 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-19 18:26:42,811 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:26:42,865 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-19 18:26:42,865 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-19 18:26:42,866 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:26:42,867 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-19 18:26:42,869 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-19 18:26:42,870 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-19 18:26:42,871 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 18:26:42,873 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-19 18:26:42,873 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-19 18:26:42,873 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 19.79초
2025-09-19 18:26:42,873 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 18:26:42,873 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-19 18:26:42,873 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:26:43,033 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:26:43,033 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:26:43,033 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-19 18:26:43,033 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:26:43,033 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-19 18:26:43,033 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-19 18:26:43,033 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-19 18:26:43,033 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:26:43,033 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-19 18:26:43,034 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-09-19 18:26:43,035 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'CU 할인', 'action': '기타'}, {'name': 'GALAXY', 'action': '기타'}]
2025-09-19 18:26:43,035 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:26:43,035 - mms_extractor - INFO - 구성된 프롬프트 길이: 5621 문자
2025-09-19 18:26:43,035 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:26:43,035 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5621)
2025-09-19 18:26:43,035 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:26:43,035 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:26:51,917 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:26:51,918 - mms_extractor - INFO - LLM 응답 길이: 1173 문자
2025-09-19 18:26:51,918 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "갤럭시 S24 Ultra",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24+",
            "action": "구매"
        },
        {
            "name": "갤럭시 S24",
            "action": "구매"
        },
        {
            "name": "갤럭시 워치6",
            "action": "구매"
        },
        {
            "name": "무선충전기",
            "a...
2025-09-19 18:26:51,918 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:26:51,919 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:26:51,919 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:26:51,919 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '증정'}, {'name': '케어플러스', 'action': '무료 이용'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '가입'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '가입'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-19 18:26:51,919 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:26:51,919 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-19 18:26:52,367 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:26:52,367 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 21696)
2025-09-19 18:26:52,367 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:26:52,367 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:26:53,193 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:26:53,367 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.45초
2025-09-19 18:26:53,371 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:26:53,371 - mms_extractor - INFO - ============================================================
2025-09-19 18:26:53,371 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:26:53,371 - mms_extractor - INFO - ============================================================
2025-09-19 18:26:53,371 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-19 18:26:53,371 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-19 18:26:53,371 - mms_extractor - INFO - 상품 수: 6개
2025-09-19 18:26:53,371 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 18:26:53,371 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:26:53,371 - mms_extractor - INFO - process_message 실행완료: 30.29초
2025-09-19 18:26:53,371 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:26:53,371 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:26:53,371 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:26:53,371 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-19 18:26:53,371 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:26:53,371 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:26:53,371 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-19 18:27:24,287 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:27:24,291 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2992자
2025-09-19 18:27:24,291 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인과 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱과 온라인 매장 예약 링...
2025-09-19 18:27:24,292 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:27:24,292 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 218자
2025-09-19 18:27:24,292 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:27:24,293 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 5
2025-09-19 18:27:24,294 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:접속', '온라인 매장:방문', '갤럭시 S24:사전예약', '기기할인:수령', '갤럭시 워치6:50%할인', '무선충전기:무료증정', '케어플러스:6개월무료']
2025-09-19 18:27:24,295 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:접속', '온라인 매장:방문'), ('갤럭시 S24:사전예약', '기기할인:수령'), ('갤럭시 S24:사전예약', '갤럭시 워치6:50%할인'), ('갤럭시 S24:사전예약', '무선충전기:무료증정'), ('갤럭시 S24:사전예약', '케어플러스:6개월무료')]
2025-09-19 18:27:24,295 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:27:24,296 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-19 18:27:24,296 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 5
2025-09-19 18:27:24,297 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:27:24,923 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-19 18:27:24,923 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-19 18:27:24,923 - mms_extractor - INFO - 🕒 DAG 처리 시간: 31.552초
2025-09-19 18:27:24,923 - mms_extractor - INFO - 📏 DAG 섹션 길이: 218자
2025-09-19 18:27:24,923 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:접속) -[또는]-> (온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약)
(갤럭시 S24:사전예약) -[사전예약하면]-> (기기할인:수령)
(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)
(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)
(갤럭시 S24:사전예약) -[사전예약하...
2025-09-19 18:27:24,923 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:27:24,923 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:27:24,930 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:27:24,931 - mongodb_utils - INFO - 문서 저장 성공: 68cd21fc2c09526a55b24b24
2025-09-19 18:27:24,931 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:27:24,931 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:27:24,931 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:27:24,931 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:27:24,931 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:접속) -[또는]-> (온라인 매장:방문) -[통해]-> (갤럭시 S24:사전예약)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (갤럭시 워치6:50%할인)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (기기할인:수령)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (무선충전기:무료증정)', '(갤럭시 S24:사전예약) -[사전예약하면]-> (케어플러스:6개월무료)']...
2025-09-19 18:27:24,931 - __main__ - INFO - 추출 완료: 61.850초
2025-09-19 18:27:24,932 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:27:24] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:27:24,963 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:27:24] "GET /health HTTP/1.1" 200 -
2025-09-19 18:28:05,159 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:28:05] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:10,733 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:10] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:22,029 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:29,289 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:29] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:31,501 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:31] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:31,528 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:31] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:33,340 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:29:33] "GET /health HTTP/1.1" 200 -
2025-09-19 18:29:33,349 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:29:33,349 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:29:33,349 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:29:33,349 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:29:33,349 - mms_extractor - INFO - ============================================================
2025-09-19 18:29:33,349 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:29:33,350 - mms_extractor - INFO - ============================================================
2025-09-19 18:29:33,350 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:29:33,350 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:29:33,350 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:29:33,350 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:29:33,350 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:29:33,350 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:29:33,350 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:29:33,350 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:29:33,350 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:29:33,350 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:29:33,350 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:29:33,351 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:29:33,355 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:29:33,367 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:29:33,368 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:29:33,373 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:29:33,373 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:29:33,373 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:29:33,373 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:29:33,605 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:29:33,605 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:29:33,606 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:29:33,606 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:29:33,696 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:29:33,696 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:29:33,697 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:29:33,700 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:29:33,702 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:29:33,702 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:29:33,704 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:29:33,707 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:29:33,707 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:29:33,707 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.36초
2025-09-19 18:29:33,707 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:29:33,707 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:29:33,707 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:29:33,816 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:29:33,816 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:29:33,816 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:29:33,816 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:29:33,816 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:29:33,816 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:29:33,816 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:29:33,816 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:29:33,817 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:29:33,818 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:29:33,818 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:29:33,818 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:29:33,818 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:29:33,818 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:29:33,818 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:29:33,818 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:29:33,818 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:29:42,049 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:29:42,054 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-09-19 18:29:42,055 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-09-19 18:29:42,056 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:29:42,057 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:29:42,057 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:29:42,057 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:29:42,058 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:29:42,058 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-09-19 18:29:43,013 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:29:43,013 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:29:43,013 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:29:43,013 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:29:43,996 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:29:44,146 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.09초
2025-09-19 18:29:44,150 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:29:44,150 - mms_extractor - INFO - ============================================================
2025-09-19 18:29:44,150 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:29:44,150 - mms_extractor - INFO - ============================================================
2025-09-19 18:29:44,150 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:29:44,150 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내']
2025-09-19 18:29:44,150 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:29:44,150 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:29:44,150 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:29:44,150 - mms_extractor - INFO - process_message 실행완료: 10.80초
2025-09-19 18:29:44,150 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:29:44,150 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:29:44,150 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:29:44,150 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:29:44,150 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:29:44,150 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:29:44,150 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:30:08,505 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:30:08,508 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2405자
2025-09-19 18:30:08,508 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 8월 31일까지 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용할 수 있는 쿠폰을 제공하며, 이를 통해 고객의 구독 서비스 가입을 유도하고 있습니다.

[식별된 가치...
2025-09-19 18:30:08,508 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:30:08,508 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 301자
2025-09-19 18:30:08,508 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:30:08,509 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 9, 엣지 수: 8
2025-09-19 18:30:08,509 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '프로모션:확인', '쿠폰:다운로드', '우주패스Netflix:가입', '넷플릭스:사용', '웨이브:사용', 'Wavve콘텐츠팩:사용', '요금할인:수령', '추가요금:지불']
2025-09-19 18:30:08,509 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '프로모션:확인'), ('프로모션:확인', '쿠폰:다운로드'), ('쿠폰:다운로드', '우주패스Netflix:가입'), ('우주패스Netflix:가입', '넷플릭스:사용'), ('우주패스Netflix:가입', '웨이브:사용'), ('우주패스Netflix:가입', '요금할인:수령'), ('넷플릭스:사용', '추가요금:지불'), ('웨이브:사용', 'Wavve콘텐츠팩:사용')]
2025-09-19 18:30:08,509 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:30:08,510 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:30:08,510 - utils - INFO - 📊 입력 그래프 - 노드 수: 9, 엣지 수: 8
2025-09-19 18:30:08,511 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:30:08,720 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:30:08,720 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:30:08,720 - mms_extractor - INFO - 🕒 DAG 처리 시간: 24.570초
2025-09-19 18:30:08,720 - mms_extractor - INFO - 📏 DAG 섹션 길이: 301자
2025-09-19 18:30:08,720 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (웹사이트:접속) -[접속하면]-> (프로모션:확인)
(프로모션:확인) -[확인후]-> (쿠폰:다운로드)
(쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)
(우주패스Netflix:가입) -[가입하면]-> (넷플릭스:사용)
(우주패스Netflix:가입) -[가입하면]-> (웨이브:사용)
(웨이브:사용) -[사용하면]-> (Wavve콘텐츠팩:...
2025-09-19 18:30:08,720 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:30:08,720 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:30:08,725 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:30:08,726 - mongodb_utils - INFO - 문서 저장 성공: 68cd22a02c09526a55b24b26
2025-09-19 18:30:08,727 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:30:08,727 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:30:08,727 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:30:08,727 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 8자
2025-09-19 18:30:08,727 - __main__ - INFO - DAG 내용 미리보기: ['(넷플릭스:사용) -[사용후]-> (추가요금:지불) -[지불하면]-> (넷플릭스스탠다드/프리미엄:업그레이드)', '(우주패스Netflix:가입) -[가입하면]-> (넷플릭스:사용)', '(우주패스Netflix:가입) -[가입하면]-> (요금할인:수령)', '(우주패스Netflix:가입) -[가입하면]-> (웨이브:사용)', '(웨이브:사용) -[사용하면]-> (Wavve콘텐츠팩:사용)', '(웹사이트:접속) -[접속하면]-> (프로모션:확인)', '(쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)', '(프로모션:확인) -[확인후]-> (쿠폰:다운로드)']...
2025-09-19 18:30:08,727 - __main__ - INFO - 추출 완료: 35.378초
2025-09-19 18:30:08,727 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:30:08] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:31:45,237 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:31:45] "GET /health HTTP/1.1" 200 -
2025-09-19 18:31:57,515 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:31:57] "GET /health HTTP/1.1" 200 -
2025-09-19 18:32:00,406 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:32:00] "GET /health HTTP/1.1" 200 -
2025-09-19 18:32:00,447 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:32:00] "GET /health HTTP/1.1" 200 -
2025-09-19 18:32:01,956 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:32:01] "GET /health HTTP/1.1" 200 -
2025-09-19 18:32:01,967 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:32:01,967 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:32:01,967 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:32:01,967 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:32:01,967 - mms_extractor - INFO - ============================================================
2025-09-19 18:32:01,967 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:32:01,967 - mms_extractor - INFO - ============================================================
2025-09-19 18:32:01,967 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:32:01,967 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:32:01,967 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:32:01,967 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:32:01,967 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:32:01,967 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:32:01,968 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:32:01,968 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:32:01,968 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:32:01,968 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:32:01,968 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:32:01,968 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:32:01,971 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:32:01,988 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:32:01,989 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:32:01,996 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:32:01,996 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:32:01,996 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:32:01,996 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:32:02,230 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:32:02,230 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:32:02,230 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:32:02,230 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:32:02,334 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:32:02,334 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:32:02,335 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:32:02,337 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:32:02,339 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:32:02,339 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:32:02,340 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:32:02,343 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:32:02,343 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:32:02,343 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.38초
2025-09-19 18:32:02,343 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:32:02,343 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:32:02,343 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:32:02,446 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:32:02,446 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:32:02,446 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:32:02,446 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:32:02,446 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:32:02,446 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:32:02,446 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:32:02,446 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:32:02,446 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:32:02,447 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:32:02,447 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:32:02,447 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:32:02,448 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:32:02,448 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:32:02,448 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:32:02,448 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:32:02,448 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:32:10,608 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:32:10,612 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-09-19 18:32:10,612 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-09-19 18:32:10,612 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:32:10,613 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:32:10,613 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:32:10,613 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:32:10,614 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:32:10,614 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-09-19 18:32:11,568 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:32:11,569 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:32:11,569 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:32:11,569 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:32:12,354 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:32:12,505 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.89초
2025-09-19 18:32:12,509 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:32:12,509 - mms_extractor - INFO - ============================================================
2025-09-19 18:32:12,509 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:32:12,509 - mms_extractor - INFO - ============================================================
2025-09-19 18:32:12,509 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:32:12,509 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내']
2025-09-19 18:32:12,509 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:32:12,509 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:32:12,509 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:32:12,509 - mms_extractor - INFO - process_message 실행완료: 10.54초
2025-09-19 18:32:12,509 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:32:12,509 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:32:12,510 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:32:12,510 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:32:12,510 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:32:12,510 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:32:12,510 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:32:37,322 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:32:37,325 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2594자
2025-09-19 18:32:37,326 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 18:32:37,326 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:32:37,326 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-09-19 18:32:37,326 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:32:37,327 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 18:32:37,327 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 18:32:37,327 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 18:32:37,328 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:32:37,328 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:32:37,329 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 18:32:37,330 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:32:37,608 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:32:37,608 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:32:37,608 - mms_extractor - INFO - 🕒 DAG 처리 시간: 25.098초
2025-09-19 18:32:37,608 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-09-19 18:32:37,608 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-09-19 18:32:37,608 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:32:37,608 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:32:37,613 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:32:37,615 - mongodb_utils - INFO - 문서 저장 성공: 68cd23352c09526a55b24b28
2025-09-19 18:32:37,615 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:32:37,615 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:32:37,615 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:32:37,615 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:32:37,615 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 18:32:37,615 - __main__ - INFO - 추출 완료: 35.648초
2025-09-19 18:32:37,616 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:32:37] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:32:37,632 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:32:37] "GET /health HTTP/1.1" 200 -
2025-09-19 18:33:20,135 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:33:20] "GET /health HTTP/1.1" 200 -
2025-09-19 18:33:20,161 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:33:20] "GET /health HTTP/1.1" 200 -
2025-09-19 18:33:22,234 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:33:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:33:22,246 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 323자
2025-09-19 18:33:22,247 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:33:22,247 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:33:22,247 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰,...
2025-09-19 18:33:22,247 - mms_extractor - INFO - ============================================================
2025-09-19 18:33:22,247 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:33:22,247 - mms_extractor - INFO - ============================================================
2025-09-19 18:33:22,247 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!

✨ 특별 혜택
- 월 요금 20% 할인 (첫 6개월)
-...
2025-09-19 18:33:22,247 - mms_extractor - INFO - 메시지 길이: 323 문자
2025-09-19 18:33:22,247 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:33:22,247 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:33:22,247 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:33:22,247 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:33:22,247 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:33:22,247 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:33:22,247 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:33:22,247 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:33:22,247 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:33:22,247 - mms_extractor - INFO - 처리할 메시지 길이: 323 문자
2025-09-19 18:33:22,251 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:33:22,256 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-19 18:33:22,257 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-09-19 18:33:22,260 - mms_extractor - INFO - 전체 토큰 수: 129개
2025-09-19 18:33:22,260 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '포켓몬', '에디션', '스마트폰', '포켓몬', '에디션', '포켓몬']
2025-09-19 18:33:22,260 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['에디션', '포켓몬']
2025-09-19 18:33:22,260 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:33:22,405 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1354, 3)
2025-09-19 18:33:22,405 - mms_extractor - INFO - 퍼지 매칭 성공: 1354개 결과
2025-09-19 18:33:22,406 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.5}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4444444444444444}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.4}]
2025-09-19 18:33:22,406 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:33:22,454 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1354, 3)
2025-09-19 18:33:22,455 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.4}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.35555555555555557}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.32000000000000006}]
2025-09-19 18:33:22,455 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:33:22,457 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 6개
2025-09-19 18:33:22,458 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-09-19 18:33:22,459 - mms_extractor - INFO - 통합된 후보 아이템 수: 6개
2025-09-19 18:33:22,460 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-19 18:33:22,463 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (5, 2)
2025-09-19 18:33:22,463 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'K3', 'item_id': ['XXC5']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}]
2025-09-19 18:33:22,463 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.22초
2025-09-19 18:33:22,463 - mms_extractor - INFO - 추출된 후보 엔티티: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-19 18:33:22,463 - mms_extractor - INFO - 매칭된 상품 정보: (5, 2)
2025-09-19 18:33:22,463 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:33:22,509 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:33:22,509 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:33:22,509 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-09-19 18:33:22,509 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:33:22,509 - mms_extractor - INFO - 후보 아이템 리스트 크기: 5개
2025-09-19 18:33:22,509 - mms_extractor - INFO - 후보 아이템 리스트: ['0서비스', 'K3', '리안', '포미', 'T 서비스']
2025-09-19 18:33:22,509 - mms_extractor - INFO - extra_item_pdf 크기: (5, 2)
2025-09-19 18:33:22,509 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:33:22,510 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-19 18:33:22,511 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 5개
2025-09-19 18:33:22,511 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '0서비스', 'action': '기타'}, {'name': 'K3', 'action': '기타'}]
2025-09-19 18:33:22,511 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:33:22,511 - mms_extractor - INFO - 구성된 프롬프트 길이: 5197 문자
2025-09-19 18:33:22,511 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:33:22,511 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5197)
2025-09-19 18:33:22,511 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:33:22,511 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:33:30,220 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:33:30,224 - mms_extractor - INFO - LLM 응답 길이: 942 문자
2025-09-19 18:33:30,224 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 프리미엄 서비스",
            "action": "가입"
        },
        {
            "name": "포켓몬 케이스",
            "action": "증정"
        }
    ],
    "channel": [
        {
            "type": "전화번호",
            "value": "1588-0011",
            "action": "문의"
    ...
2025-09-19 18:33:30,224 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:33:30,225 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:33:30,225 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:33:30,226 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 프리미엄 서비스', 'action': '가입'}, {'name': '포켓몬 케이스', 'action': '증정'}], 'channel': [{'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '대리점', 'value': '가까운 T world 매장', 'action': '추가 정보'}, {'type': 'URL', 'value': 'www.tworld.co.kr', 'action': '추가 정보'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-19 18:33:30,226 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:33:30,227 - mms_extractor - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 프리미엄 서비스', '포켓몬 케이스']
2025-09-19 18:33:30,606 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:33:30,606 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 18937)
2025-09-19 18:33:30,606 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:33:30,606 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:33:32,308 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:33:32,428 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.20초
2025-09-19 18:33:32,445 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:33:32,445 - mms_extractor - INFO - ============================================================
2025-09-19 18:33:32,445 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:33:32,445 - mms_extractor - INFO - ============================================================
2025-09-19 18:33:32,445 - mms_extractor - INFO - 제목: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
2025-09-19 18:33:32,445 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-19 18:33:32,445 - mms_extractor - INFO - 상품 수: 3개
2025-09-19 18:33:32,445 - mms_extractor - INFO - 채널 수: 4개
2025-09-19 18:33:32,445 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:33:32,446 - mms_extractor - INFO - process_message 실행완료: 10.20초
2025-09-19 18:33:32,446 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:33:32,446 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:33:32,446 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:33:32,446 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 323자
2025-09-19 18:33:32,446 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:33:32,446 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:33:32,446 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3308자
2025-09-19 18:33:58,343 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:33:58,345 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2505자
2025-09-19 18:33:58,346 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 자녀의 첫 스마트폰으로 ZEM폰 포켓몬에디션3을 추천하며, 안전한 사용 환경과 다양한 특별 혜택을 강조합니다. 주요 혜택으로는 월 요금 20% 할인(첫 6개월), 포켓몬 케이스 무료 증정, ZEM 프리미엄 서비스 3개월 무료 이용이 제공됩니다.

[식별된 가치 제안 목록]
- ZEM...
2025-09-19 18:33:58,346 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:33:58,346 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 299자
2025-09-19 18:33:58,346 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:33:58,347 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 8, 엣지 수: 7
2025-09-19 18:33:58,347 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령', '포켓몬 케이스:수령', 'ZEM 프리미엄 서비스 3개월 무료:수령', 'ZEM 앱:사용', '자녀 스마트폰 관리:효과', '안전한 키즈폰:사용']
2025-09-19 18:33:58,348 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매'), ('ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령'), ('ZEM폰 포켓몬에디션3:구매', '포켓몬 케이스:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 프리미엄 서비스 3개월 무료:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 앱:사용'), ('ZEM폰 포켓몬에디션3:구매', '안전한 키즈폰:사용'), ('ZEM 앱:사용', '자녀 스마트폰 관리:효과')]
2025-09-19 18:33:58,348 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:33:58,348 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-09-19 18:33:58,348 - utils - INFO - 📊 입력 그래프 - 노드 수: 8, 엣지 수: 7
2025-09-19 18:33:58,349 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:33:58,635 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be.png
2025-09-19 18:33:58,635 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-09-19 18:33:58,635 - mms_extractor - INFO - 🕒 DAG 처리 시간: 26.190초
2025-09-19 18:33:58,635 - mms_extractor - INFO - 📏 DAG 섹션 길이: 299자
2025-09-19 18:33:58,635 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)
(ZEM폰 포켓몬에디션3:구매)...
2025-09-19 18:33:58,635 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:33:58,635 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:33:58,640 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:33:58,641 - mongodb_utils - INFO - 문서 저장 성공: 68cd23862c09526a55b24b2a
2025-09-19 18:33:58,641 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:33:58,641 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:33:58,641 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:33:58,641 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 7자
2025-09-19 18:33:58,642 - __main__ - INFO - DAG 내용 미리보기: ['(T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)', '(ZEM 앱:사용) -[사용하면]-> (자녀 스마트폰 관리:효과)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 앱:사용)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (안전한 키즈폰:사용)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)']...
2025-09-19 18:33:58,642 - __main__ - INFO - 추출 완료: 36.395초
2025-09-19 18:33:58,642 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:33:58] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:33:58,658 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:33:58] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:11,815 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:11] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:15,016 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:15] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:22,444 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:22,480 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:22,952 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:22,979 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:22] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:24,813 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:38:24] "GET /health HTTP/1.1" 200 -
2025-09-19 18:38:24,823 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-09-19 18:38:24,823 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-19 18:38:24,823 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-19 18:38:24,823 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-09-19 18:38:24,823 - mms_extractor - INFO - ============================================================
2025-09-19 18:38:24,823 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-19 18:38:24,823 - mms_extractor - INFO - ============================================================
2025-09-19 18:38:24,823 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-19 18:38:24,823 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-19 18:38:24,823 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-19 18:38:24,823 - mms_extractor - INFO - 데이터 소스: local
2025-09-19 18:38:24,823 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-19 18:38:24,823 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-19 18:38:24,823 - mms_extractor - INFO - LLM 모델: ax
2025-09-19 18:38:24,823 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-19 18:38:24,823 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-19 18:38:24,824 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-19 18:38:24,824 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-19 18:38:24,824 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-19 18:38:24,826 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-19 18:38:24,834 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-19 18:38:24,835 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-19 18:38:24,840 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-19 18:38:24,840 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-19 18:38:24,840 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Wavve 콘텐츠 팩', '넷플릭스', 'Netflix']
2025-09-19 18:38:24,840 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-19 18:38:25,074 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2742, 3)
2025-09-19 18:38:25,074 - mms_extractor - INFO - 퍼지 매칭 성공: 2742개 결과
2025-09-19 18:38:25,074 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-19 18:38:25,074 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-19 18:38:25,178 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2742, 3)
2025-09-19 18:38:25,179 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-19 18:38:25,179 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-19 18:38:25,181 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-19 18:38:25,183 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-19 18:38:25,183 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-19 18:38:25,184 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:38:25,186 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-19 18:38:25,186 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-19 18:38:25,186 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.36초
2025-09-19 18:38:25,186 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:38:25,186 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-19 18:38:25,187 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-19 18:38:25,228 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-19 18:38:25,228 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-19 18:38:25,228 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-19 18:38:25,228 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-19 18:38:25,228 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-19 18:38:25,229 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-19 18:38:25,229 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-19 18:38:25,229 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-19 18:38:25,229 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-19 18:38:25,230 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-19 18:38:25,231 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-19 18:38:25,231 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-19 18:38:25,231 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-19 18:38:25,231 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-19 18:38:25,231 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-19 18:38:25,231 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-19 18:38:25,231 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-19 18:38:33,350 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:38:33,355 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-09-19 18:38:33,356 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-09-19 18:38:33,356 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-19 18:38:33,358 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-19 18:38:33,359 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-19 18:38:33,359 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-19 18:38:33,359 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-19 18:38:33,359 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-09-19 18:38:34,324 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-19 18:38:34,325 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31430)
2025-09-19 18:38:34,325 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-19 18:38:34,325 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-19 18:38:35,316 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:38:35,477 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.12초
2025-09-19 18:38:35,480 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-19 18:38:35,480 - mms_extractor - INFO - ============================================================
2025-09-19 18:38:35,481 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-19 18:38:35,481 - mms_extractor - INFO - ============================================================
2025-09-19 18:38:35,481 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-19 18:38:35,481 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내']
2025-09-19 18:38:35,481 - mms_extractor - INFO - 상품 수: 5개
2025-09-19 18:38:35,481 - mms_extractor - INFO - 채널 수: 3개
2025-09-19 18:38:35,481 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-19 18:38:35,481 - mms_extractor - INFO - process_message 실행완료: 10.66초
2025-09-19 18:38:35,481 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-19 18:38:35,481 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-19 18:38:35,481 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-19 18:38:35,481 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-09-19 18:38:35,481 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x358225b80> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x358225940> root_client=<openai.OpenAI object at 0x32e6e8200> root_async_client=<openai.AsyncOpenAI object at 0x3582259a0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-19 18:38:35,481 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-19 18:38:35,481 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-09-19 18:39:01,148 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-19 18:39:01,151 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2707자
2025-09-19 18:39:01,151 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-09-19 18:39:01,152 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-19 18:39:01,152 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-09-19 18:39:01,152 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-19 18:39:01,153 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-09-19 18:39:01,153 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-09-19 18:39:01,153 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-09-19 18:39:01,153 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-19 18:39:01,153 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:39:01,155 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-09-19 18:39:01,157 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-19 18:39:01,436 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-09-19 18:39:01,436 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-09-19 18:39:01,436 - mms_extractor - INFO - 🕒 DAG 처리 시간: 25.955초
2025-09-19 18:39:01,436 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-09-19 18:39:01,436 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-09-19 18:39:01,436 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-19 18:39:01,436 - __main__ - INFO - MongoDB 저장 중...
2025-09-19 18:39:01,442 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-19 18:39:01,443 - mongodb_utils - INFO - 문서 저장 성공: 68cd24b52c09526a55b24b2c
2025-09-19 18:39:01,444 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-19 18:39:01,444 - __main__ - INFO - MongoDB 저장 완료!
2025-09-19 18:39:01,444 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-19 18:39:01,444 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-09-19 18:39:01,444 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-09-19 18:39:01,444 - __main__ - INFO - 추출 완료: 36.621초
2025-09-19 18:39:01,445 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:39:01] "POST /extract HTTP/1.1" 200 -
2025-09-19 18:39:01,462 - werkzeug - INFO - 127.0.0.1 - - [19/Sep/2025 18:39:01] "GET /health HTTP/1.1" 200 -
2025-09-22 09:19:55,878 - werkzeug - INFO - 127.0.0.1 - - [22/Sep/2025 09:19:55] "GET /health HTTP/1.1" 200 -
2025-09-23 13:28:48,344 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-23 13:28:48,344 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-23 13:28:48,344 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-23 13:28:48,344 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-23 13:28:48,344 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-23 13:28:48,344 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-23 13:28:48,344 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-23 13:28:48,345 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-23 13:28:48,362 - mms_extractor - INFO - Using device: mps
2025-09-23 13:28:48,362 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-23 13:28:48,362 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-23 13:28:48,362 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-23 13:28:48,362 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-23 13:28:48,362 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-23 13:28:48,362 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-23 13:28:48,363 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-23 13:28:48,363 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-23 13:28:50,951 - mms_extractor - INFO - Model loaded on mps
2025-09-23 13:28:50,951 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 2.59초
2025-09-23 13:28:50,951 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-23 13:28:51,499 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-23 13:28:51,499 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.55초
2025-09-23 13:28:51,499 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-23 13:28:51,499 - mms_extractor - INFO - ============================================================
2025-09-23 13:28:51,499 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-23 13:28:51,499 - mms_extractor - INFO - ============================================================
2025-09-23 13:28:51,499 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-23 13:28:51,499 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-23 13:28:51,499 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-23 13:28:51,499 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-23 13:28:51,499 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-23 13:28:51,574 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-23 13:28:51,574 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-23 13:28:51,574 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-23 13:28:51,580 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-23 13:28:51,581 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-23 13:28:51,581 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-23 13:28:51,582 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-23 13:28:51,582 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-23 13:28:51,582 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-23 13:28:51,589 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-23 13:28:51,593 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-23 13:28:51,593 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-23 13:28:51,593 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-23 13:28:51,593 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-23 13:28:51,593 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-23 13:28:51,593 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-23 13:28:51,593 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-23 13:28:51,593 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-23 13:28:51,593 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-23 13:28:51,593 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-23 13:28:51,598 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-23 13:28:51,598 - mms_extractor - INFO - null이 아닌 상품명 수: 10551개
2025-09-23 13:28:51,598 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-23 13:28:51,598 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-23 13:28:51,599 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-23 13:28:51,724 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-23 13:28:51,731 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 21522
2025-09-23 13:28:51,731 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-23 13:28:51,731 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-23 13:28:51,732 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (21522, 9)
2025-09-23 13:28:51,732 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-23 13:28:51,733 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-23 13:28:51,733 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-23 13:28:51,733 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-23 13:28:51,733 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-23 13:28:51,735 - mms_extractor - INFO - 등록할 고유 별칭 수: 16403개
2025-09-23 13:28:51,735 - mms_extractor - INFO - 유효한 별칭 수: 16403개
2025-09-23 13:28:51,735 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증']
2025-09-23 13:28:51,750 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16403개 성공, 0개 실패
2025-09-23 13:28:51,750 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-23 13:28:51,750 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-23 13:28:51,758 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-23 13:28:51,758 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-23 13:28:51,991 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-23 13:28:51,991 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-23 13:28:51,991 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-23 13:28:51,991 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-23 13:28:51,991 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-23 13:28:51,991 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-23 13:28:52,060 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-23 13:28:52,060 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-23 13:28:52,062 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-23 13:28:52,063 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-23 13:28:52,063 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-23 13:28:52,063 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-23 13:28:52,063 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-23 13:28:52,063 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-23 13:28:52,063 - mms_extractor - INFO - ============================================================
2025-09-23 13:28:52,063 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-23 13:28:52,063 - mms_extractor - INFO - ============================================================
2025-09-23 13:28:52,064 - mms_extractor - INFO - ✅ 상품 데이터: (21522, 9)
2025-09-23 13:28:52,064 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-23 13:28:52,064 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-23 13:28:52,064 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-23 13:28:52,064 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-23 13:28:52,065 - mms_extractor - INFO - 고유 상품명 수: 6847개
2025-09-23 13:28:52,067 - mms_extractor - INFO - 고유 별칭 수: 16403개
2025-09-23 13:28:52,068 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-23 13:28:52,068 - mms_extractor - INFO - _load_data 실행완료: 0.57초
2025-09-23 13:28:52,068 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-23 13:28:52,068 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-23 13:28:52,068 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-23 13:28:52,068 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-23 13:28:52,068 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-23 13:28:52,068 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-23 13:28:52,068 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-23 13:28:52,068 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-23 13:28:52,068 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-23 13:28:52,068 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-23 13:28:52,068 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-23 13:28:52,084 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.0.34:8000
2025-09-23 13:28:52,084 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-23 13:28:52,251 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:28:52] "GET /health HTTP/1.1" 200 -
2025-09-23 13:28:52,406 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:28:52] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:07,166 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:29:07] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:10,929 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:29:10] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:19,086 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:29:19] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:19,120 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:29:19] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:20,742 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:29:20] "GET /health HTTP/1.1" 200 -
2025-09-23 13:29:20,751 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 328자
2025-09-23 13:29:20,751 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-23 13:29:20,751 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-09-23 13:29:20,751 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 ...
2025-09-23 13:29:20,751 - mms_extractor - INFO - ============================================================
2025-09-23 13:29:20,751 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-23 13:29:20,752 - mms_extractor - INFO - ============================================================
2025-09-23 13:29:20,752 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 갤럭시 S24 사전예약
(광고) 갤럭시 S24 시리즈 사전예약 시작!

🌟 사전예약 혜택
- 갤럭시 S24 Ultra: 최대 30만원 할인
- 갤럭시 S24+: 최대 25만원 할인  
- 갤럭시 S24: 최대 20만원 할인

🎁 추가 혜택
- 갤럭시 워치6 50% 할인
- 무선충전기 무료 증정
- 케어플러스 6개월 무료

📅 사전예약: 202...
2025-09-23 13:29:20,752 - mms_extractor - INFO - 메시지 길이: 328 문자
2025-09-23 13:29:20,752 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-23 13:29:20,752 - mms_extractor - INFO - 데이터 소스: local
2025-09-23 13:29:20,752 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-09-23 13:29:20,752 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-23 13:29:20,752 - mms_extractor - INFO - LLM 모델: ax
2025-09-23 13:29:20,752 - mms_extractor - INFO - 상품 데이터 크기: (21522, 9)
2025-09-23 13:29:20,752 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-23 13:29:20,752 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-23 13:29:20,752 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-23 13:29:20,752 - mms_extractor - INFO - 처리할 메시지 길이: 328 문자
2025-09-23 13:29:20,755 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16403개
2025-09-23 13:29:21,239 - mms_extractor - INFO - 분할된 문장 수: 6개
2025-09-23 13:29:21,239 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', '🌟 사전예약 혜택 갤럭시 S24 Ultra 최대 30만원 할인 갤럭시 S24 최대 25만원 할인 갤럭시 S24 최대 20만원 할인', '🎁 추가 혜택 갤럭시 워치6 50 할인 무선충전기 무료 증정 케어플러스 무료']...
2025-09-23 13:29:21,240 - mms_extractor - INFO - 전체 토큰 수: 106개
2025-09-23 13:29:21,240 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '갤럭시', '충전기']
2025-09-23 13:29:21,240 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '갤럭시']
2025-09-23 13:29:21,240 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-23 13:29:28,460 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1747, 3)
2025-09-23 13:29:28,460 - mms_extractor - INFO - 퍼지 매칭 성공: 1747개 결과
2025-09-23 13:29:28,461 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.4}]
2025-09-23 13:29:28,461 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-23 13:29:28,512 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1747, 3)
2025-09-23 13:29:28,513 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'T갤럭시클럽N', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'IB 심 2일', 'sim': 0.34285714285714286}, {'sent': ' SK텔레콤 갤럭시 S24 사전예약 광고 갤럭시 S24 시리즈 사전예약 시작 ', 'item_nm_alias': 'TAC+2 금융사고', 'sim': 0.36000000000000004}]
2025-09-23 13:29:28,513 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-23 13:29:28,516 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 12개
2025-09-23 13:29:28,518 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-23 13:29:28,518 - mms_extractor - INFO - 통합된 후보 아이템 수: 13개
2025-09-23 13:29:28,524 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-23 13:29:28,527 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-09-23 13:29:28,527 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}, {'item_nm': 'K3', 'item_id': ['XXC5']}]
2025-09-23 13:29:28,528 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.78초
2025-09-23 13:29:28,528 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-23 13:29:28,528 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-09-23 13:29:28,528 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-23 13:29:28,735 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-23 13:29:28,735 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-23 13:29:28,735 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 406 문자
2025-09-23 13:29:28,735 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-23 13:29:28,735 - mms_extractor - INFO - 후보 아이템 리스트 크기: 10개
2025-09-23 13:29:28,735 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시', 'K3', '충전', 'T Golf', 'CU 할인', 'T 탭 18', 'T 탭 24', 'T 탭 9', '갤럭시S22 Ultra 클럽', '일상플러스(무료)']
2025-09-23 13:29:28,735 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-09-23 13:29:28,735 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-23 13:29:28,735 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'CU 할인', 'item_id': ['PR00000344']}, {'item_nm': 'GALAXY', 'item_id': ['SSM2']}]
2025-09-23 13:29:28,735 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-09-23 13:29:28,735 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-23 13:29:28,735 - mms_extractor - INFO - 구성된 프롬프트 길이: 6233 문자
2025-09-23 13:29:28,735 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-09-23 13:29:28,735 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6233)
2025-09-23 13:29:28,735 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-23 13:29:28,735 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-23 13:29:35,065 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-23 13:29:35,080 - mms_extractor - INFO - LLM 응답 길이: 788 문자
2025-09-23 13:29:35,080 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 갤럭시 S24 사전예약",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {"name": "갤럭시 S24 Ultra", "action": "구매"},
        {"name": "갤럭시 S24+", "action": "구매"},
        {"name": "갤럭시 S24", "action": "구매"},
        {"name": "갤럭시 워치6", "action": "구매"},
        {"name": "무선충전기", "action": "구매"},
        {"name": "케어플러스", "action": "가입"}
    ],
    "channel": [
        {"type": "앱", "value": "T world 앱", "action": "추가 정보"},
        {"type":...
2025-09-23 13:29:35,080 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-23 13:29:35,080 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-23 13:29:35,080 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-23 13:29:35,080 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 갤럭시 S24 사전예약', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '갤럭시 S24 Ultra', 'action': '구매'}, {'name': '갤럭시 S24+', 'action': '구매'}, {'name': '갤럭시 S24', 'action': '구매'}, {'name': '갤럭시 워치6', 'action': '구매'}, {'name': '무선충전기', 'action': '구매'}, {'name': '케어플러스', 'action': '가입'}], 'channel': [{'type': '앱', 'value': 'T world 앱', 'action': '추가 정보'}, {'type': 'URL', 'value': 'tworldfriends.co.kr/D123456789', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-23 13:29:35,081 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-23 13:29:35,081 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 S24 Ultra', '갤럭시 S24+', '갤럭시 S24', '갤럭시 워치6', '무선충전기', '케어플러스']
2025-09-23 13:29:35,081 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-23 13:29:35,082 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: gpt (azure/openai/gpt-4o-2024-08-06)
2025-09-23 13:29:35,082 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-23 13:29:35,508 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 21696)
2025-09-23 13:29:35,508 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-23 13:29:35,508 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-23 13:29:35,508 - mms_extractor - INFO - 🔄 3개 LLM 모델로 엔티티 추출 시작
2025-09-23 13:29:35,523 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-23 13:29:35,523 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-23 13:29:35,523 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-23 13:29:37,382 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-23 13:29:37,784 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-23 13:29:39,008 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-23 13:29:39,010 - mms_extractor - INFO - ✅ LLM 추출 완료: ['무선충전기', 'T world 앱', '갤럭시 S24 시리즈 사전예약', '갤럭시 S24 사전예약', 'T world', '갤럭시 S24', '갤럭시 워치6', '케어플러스', '갤럭시 S24 Ultra', '갤럭시 S24+']
2025-09-23 13:29:39,253 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.17초
2025-09-23 13:29:39,257 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-23 13:29:39,257 - mms_extractor - INFO - ============================================================
2025-09-23 13:29:39,257 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-23 13:29:39,257 - mms_extractor - INFO - ============================================================
2025-09-23 13:29:39,257 - mms_extractor - INFO - 제목: [SK텔레콤] 갤럭시 S24 사전예약
2025-09-23 13:29:39,257 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-23 13:29:39,257 - mms_extractor - INFO - 상품 수: 8개
2025-09-23 13:29:39,257 - mms_extractor - INFO - 채널 수: 4개
2025-09-23 13:29:39,257 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-23 13:29:39,257 - mms_extractor - INFO - process_message 실행완료: 18.51초
2025-09-23 13:29:39,257 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-09-23 13:29:39,257 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-09-23 13:29:39,258 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-09-23 13:29:39,258 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 328자
2025-09-23 13:29:39,258 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x330d195e0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x330d19910> root_client=<openai.OpenAI object at 0x330d19550> root_async_client=<openai.AsyncOpenAI object at 0x330d19a00> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-23 13:29:39,258 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-09-23 13:29:39,258 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3313자
2025-09-23 13:30:00,171 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-23 13:30:00,174 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2224자
2025-09-23 13:30:00,175 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 갤럭시 S24 시리즈의 사전예약을 시작하며, 다양한 할인 및 추가 혜택을 제공하여 고객의 구매를 유도하고자 합니다. 사전예약을 통해 기기 할인, 갤럭시 워치6 할인, 무선충전기 무료 증정, 케어플러스 6개월 무료 혜택을 제공합니다. 예약 방법은 T world 앱 또는 매장 예약 웹사...
2025-09-23 13:30:00,175 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-09-23 13:30:00,176 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 281자
2025-09-23 13:30:00,176 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-09-23 13:30:00,177 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-09-23 13:30:00,177 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 앱:예약', '갤럭시 S24 시리즈:구매', '매장:방문', '할인:수령', '갤럭시 워치6:구매', '무선충전기:수령', '케어플러스 6개월 무료:수령']
2025-09-23 13:30:00,177 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 앱:예약', '갤럭시 S24 시리즈:구매'), ('T world 앱:예약', '매장:방문'), ('갤럭시 S24 시리즈:구매', '할인:수령'), ('갤럭시 S24 시리즈:구매', '갤럭시 워치6:구매'), ('갤럭시 S24 시리즈:구매', '무선충전기:수령'), ('갤럭시 S24 시리즈:구매', '케어플러스 6개월 무료:수령')]
2025-09-23 13:30:00,177 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-09-23 13:30:00,178 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-23 13:30:00,178 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-09-23 13:30:00,179 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-09-23 13:30:01,253 - utils - INFO - ✅ DAG 다이어그램 생성 완료: dag_images/dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753.png
2025-09-23 13:30:01,254 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_cde17c728469553c86e0a126b0eae19295d966bb880276643d1ecf6fb5f9a753
2025-09-23 13:30:01,254 - mms_extractor - INFO - 🕒 DAG 처리 시간: 21.996초
2025-09-23 13:30:01,254 - mms_extractor - INFO - 📏 DAG 섹션 길이: 281자
2025-09-23 13:30:01,254 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)
(T world 앱:예약) -[예약하면]-> (매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)
(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:구매) -[구매하면]-> (50% 할인:수령)
(...
2025-09-23 13:30:01,254 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-09-23 13:30:01,254 - __main__ - INFO - MongoDB 저장 중...
2025-09-23 13:30:01,883 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-23 13:30:01,887 - mongodb_utils - INFO - 문서 저장 성공: 68d2224954393ca21590762d
2025-09-23 13:30:01,888 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-23 13:30:01,888 - __main__ - INFO - MongoDB 저장 완료!
2025-09-23 13:30:01,888 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-09-23 13:30:01,888 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-09-23 13:30:01,889 - __main__ - INFO - DAG 내용 미리보기: ['(T world 앱:예약) -[예약하면]-> (갤럭시 S24 시리즈:구매)', '(T world 앱:예약) -[예약하면]-> (매장:방문) -[방문하면]-> (갤럭시 S24 시리즈:구매)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (갤럭시 워치6:구매) -[구매하면]-> (50% 할인:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (무선충전기:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (케어플러스 6개월 무료:수령)', '(갤럭시 S24 시리즈:구매) -[구매하면]-> (할인:수령)']...
2025-09-23 13:30:01,889 - __main__ - INFO - 추출 완료: 41.137초
2025-09-23 13:30:01,891 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:30:01] "POST /extract HTTP/1.1" 200 -
2025-09-23 13:30:01,952 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 13:30:01] "GET /health HTTP/1.1" 200 -
2025-09-23 18:12:24,997 - werkzeug - INFO - 127.0.0.1 - - [23/Sep/2025 18:12:24] "GET /health HTTP/1.1" 200 -
2025-09-24 13:22:48,274 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-24 13:22:48,274 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-24 13:22:48,274 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-24 13:22:48,274 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-24 13:22:48,274 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-24 13:22:48,274 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-24 13:22:48,274 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-24 13:22:48,275 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-24 13:22:48,295 - mms_extractor - INFO - Using device: mps
2025-09-24 13:22:48,295 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-24 13:22:48,295 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-24 13:22:48,295 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-24 13:22:48,295 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-24 13:22:48,295 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-24 13:22:48,295 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-24 13:22:48,296 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-24 13:22:48,296 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-24 13:22:52,404 - mms_extractor - INFO - Model loaded on mps
2025-09-24 13:22:52,405 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 4.11초
2025-09-24 13:22:52,405 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-24 13:22:52,973 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-24 13:22:52,973 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.57초
2025-09-24 13:22:52,973 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-24 13:22:52,973 - mms_extractor - INFO - ============================================================
2025-09-24 13:22:52,973 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-24 13:22:52,973 - mms_extractor - INFO - ============================================================
2025-09-24 13:22:52,973 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-24 13:22:52,973 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-24 13:22:52,973 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-24 13:22:52,973 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-24 13:22:52,973 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-24 13:22:53,088 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-24 13:22:53,088 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-24 13:22:53,088 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-24 13:22:53,093 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-24 13:22:53,094 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-24 13:22:53,094 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:22:53,095 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:22:53,095 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-24 13:22:53,095 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-24 13:22:53,104 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-24 13:22:53,107 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-24 13:22:53,107 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-24 13:22:53,107 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:22:53,107 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-24 13:22:53,107 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-24 13:22:53,107 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-24 13:22:53,107 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:22:53,107 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-24 13:22:53,108 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-24 13:22:53,108 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-24 13:22:53,115 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-24 13:22:53,115 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-09-24 13:22:53,115 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:22:53,116 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-24 13:22:53,116 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:22:53,243 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-24 13:22:53,248 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-09-24 13:22:53,249 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-24 13:22:53,249 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-24 13:22:53,250 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-09-24 13:22:53,250 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-24 13:22:53,251 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-24 13:22:53,251 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-24 13:22:53,251 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-24 13:22:53,251 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-24 13:22:53,252 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-09-24 13:22:53,253 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-09-24 13:22:53,253 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-24 13:22:53,267 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-09-24 13:22:53,268 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-24 13:22:53,268 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-24 13:22:53,279 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-24 13:22:53,280 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-24 13:22:53,674 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-24 13:22:53,674 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-24 13:22:53,674 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-24 13:22:53,674 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-24 13:22:53,674 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-24 13:22:53,674 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-24 13:22:53,744 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-24 13:22:53,744 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-24 13:22:53,746 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-24 13:22:53,747 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-24 13:22:53,747 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-24 13:22:53,747 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:22:53,747 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-24 13:22:53,748 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-24 13:22:53,748 - mms_extractor - INFO - ============================================================
2025-09-24 13:22:53,748 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-24 13:22:53,748 - mms_extractor - INFO - ============================================================
2025-09-24 13:22:53,748 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-09-24 13:22:53,748 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-24 13:22:53,748 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-24 13:22:53,748 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-24 13:22:53,748 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-24 13:22:53,749 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-09-24 13:22:53,750 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-09-24 13:22:53,751 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-24 13:22:53,751 - mms_extractor - INFO - _load_data 실행완료: 0.78초
2025-09-24 13:22:53,751 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-24 13:22:53,751 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-24 13:22:53,752 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-24 13:22:53,752 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-24 13:22:53,752 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-24 13:22:53,752 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-24 13:22:53,752 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-24 13:22:53,752 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-24 13:22:53,752 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-24 13:22:53,752 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-24 13:22:53,752 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-24 13:22:53,779 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.64:8000
2025-09-24 13:22:53,779 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-24 13:23:33,307 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:33] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:38,803 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:38] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:38,887 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:38] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:40,598 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:40] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:43,052 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:43] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:45,499 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:23:45] "GET /health HTTP/1.1" 200 -
2025-09-24 13:23:45,512 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-24 13:23:45,512 - mms_extractor - INFO - ============================================================
2025-09-24 13:23:45,512 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-24 13:23:45,512 - mms_extractor - INFO - ============================================================
2025-09-24 13:23:45,512 - mms_extractor - INFO - 메시지 내용: [Web발신]
(광고)[SKT (을지로점)] 신용욱 단골고객님
9월은 SKT 직영점에서 혜택받9, 구매하9

【갤럭시 마지막 특가】
① 와이드8 ▶기기값 5만원
② A36 ▶기기값 10만원
③ S24 FE ▶기기값 20만원
☞ 제휴카드 사용 시 최대 72만원 추가할인

【SK로 통신사 이동 시】
① 쓰던 폰 그대로 이동시 상품권 20만원
② 인터넷+TV 가...
2025-09-24 13:23:45,512 - mms_extractor - INFO - 메시지 길이: 411 문자
2025-09-24 13:23:45,512 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-24 13:23:45,512 - mms_extractor - INFO - 데이터 소스: local
2025-09-24 13:23:45,512 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-24 13:23:45,512 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-24 13:23:45,512 - mms_extractor - INFO - LLM 모델: ax
2025-09-24 13:23:45,512 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-09-24 13:23:45,512 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-24 13:23:45,512 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-24 13:23:45,512 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-24 13:23:45,512 - mms_extractor - INFO - 처리할 메시지 길이: 407 문자
2025-09-24 13:23:45,514 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-09-24 13:23:46,010 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-24 13:23:46,011 - mms_extractor - INFO - 필터링된 문장들: [' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', ' 갤럭시 마지막 특가 와이드8 기기값 5만원 A36 기기값 10만원 S24 FE 기기값 20만원 제휴카드 사용 시 최대 72만원 추가할인', ' SK로 통신사 이동 시 쓰던 폰 그대로 이동시 상품권 20만원 인터넷 TV 가입 최대 70만원']...
2025-09-24 13:23:46,014 - mms_extractor - INFO - 전체 토큰 수: 154개
2025-09-24 13:23:46,014 - mms_extractor - INFO - NNP 태그 토큰들: ['을지로', '구매하9', '갤럭시', '아이폰 17', '을지로입구역', '하나은행', '명동']
2025-09-24 13:23:46,014 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['을지로입구역', '명동', '갤럭시', '아이폰 17', '하나은행', '구매하9']
2025-09-24 13:23:46,014 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-24 13:23:53,368 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1242, 3)
2025-09-24 13:23:53,369 - mms_extractor - INFO - 퍼지 매칭 성공: 1242개 결과
2025-09-24 13:23:53,370 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.4}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.4}]
2025-09-24 13:23:53,370 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-24 13:23:53,409 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1242, 3)
2025-09-24 13:23:53,409 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '노트7고객', 'sim': 0.32000000000000006}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코web툰프리_할인', 'sim': 0.2}, {'sent': ' Web발신 광고 SKT 을지로점 신용욱 단골고객님 은 SKT 직영점에서 혜택받9 구매하9', 'item_nm_alias': '코미코 web툰 프리_인증', 'sim': 0.22857142857142856}]
2025-09-24 13:23:53,410 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-24 13:23:53,412 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 14개
2025-09-24 13:23:53,414 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 5개
2025-09-24 13:23:53,415 - mms_extractor - INFO - 통합된 후보 아이템 수: 19개
2025-09-24 13:23:53,419 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['갤럭시 S24 FE', '갤럭시 와이드8', '아이폰 17', '갤럭시 A17', '갤럭시 S25 FE', '갤럭시 S25', '갤럭시 S25+', '갤럭시 A36 5G', '갤럭시 탭 S10 FE', '갤럭시 탭 S10 FE+', '(KTF)갤럭시 S24 FE', '(LGU)갤럭시 S24 FE', '갤럭시 탭 A 10.1', '갤럭시 TAB S10 FE', '갤럭시 TAB S10 FE+']
2025-09-24 13:23:53,421 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (13, 2)
2025-09-24 13:23:53,421 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '(KTF)갤럭시 S24 FE', 'item_id': ['A5V7']}, {'item_nm': '(LGU)갤럭시 S24 FE', 'item_id': ['A5V8']}, {'item_nm': 'IPHONE 17', 'item_id': ['A6UD', 'A6SQ', 'A6U2', 'A6U7', 'A6SV']}]
2025-09-24 13:23:53,421 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.91초
2025-09-24 13:23:53,421 - mms_extractor - INFO - 추출된 후보 엔티티: ['갤럭시 S24 FE', '갤럭시 와이드8', '아이폰 17', '갤럭시 A17', '갤럭시 S25 FE', '갤럭시 S25', '갤럭시 S25+', '갤럭시 A36 5G', '갤럭시 탭 S10 FE', '갤럭시 탭 S10 FE+', '(KTF)갤럭시 S24 FE', '(LGU)갤럭시 S24 FE', '갤럭시 탭 A 10.1', '갤럭시 TAB S10 FE', '갤럭시 TAB S10 FE+']
2025-09-24 13:23:53,421 - mms_extractor - INFO - 매칭된 상품 정보: (13, 2)
2025-09-24 13:23:53,421 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-24 13:23:53,762 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-24 13:23:53,762 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-24 13:23:53,762 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 416 문자
2025-09-24 13:23:53,762 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-24 13:23:53,762 - mms_extractor - INFO - 후보 아이템 리스트 크기: 15개
2025-09-24 13:23:53,762 - mms_extractor - INFO - 후보 아이템 리스트: ['갤럭시 S24 FE', '갤럭시 와이드8', '아이폰 17', '갤럭시 A17', '갤럭시 S25 FE', '갤럭시 S25', '갤럭시 S25+', '갤럭시 A36 5G', '갤럭시 탭 S10 FE', '갤럭시 탭 S10 FE+', '(KTF)갤럭시 S24 FE', '(LGU)갤럭시 S24 FE', '갤럭시 탭 A 10.1', '갤럭시 TAB S10 FE', '갤럭시 TAB S10 FE+']
2025-09-24 13:23:53,762 - mms_extractor - INFO - extra_item_pdf 크기: (13, 2)
2025-09-24 13:23:53,762 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-24 13:23:53,762 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '(KTF)갤럭시 S24 FE', 'item_id': ['A5V7']}, {'item_nm': '(LGU)갤럭시 S24 FE', 'item_id': ['A5V8']}]
2025-09-24 13:23:53,764 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 13개
2025-09-24 13:23:53,764 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '(KTF)갤럭시 S24 FE', 'action': '기타'}, {'name': '(LGU)갤럭시 S24 FE', 'action': '기타'}]
2025-09-24 13:23:53,764 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-24 13:23:53,764 - mms_extractor - INFO - 구성된 프롬프트 길이: 6000 문자
2025-09-24 13:23:53,764 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-24 13:23:53,764 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 6000)
2025-09-24 13:23:53,764 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-24 13:23:53,764 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-24 13:24:10,614 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:24:10,627 - mms_extractor - INFO - LLM 응답 길이: 1163 문자
2025-09-24 13:24:10,627 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "9월은 SKT 직영점에서 혜택받9, 구매하9",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "대리점/매장 방문 유도"
    ],
    "product": [
        {
            "name": "갤럭시 와이드8",
            "action": "구매"
        },
        {
            "name": "갤럭시 A36",
            "action": "구매"
        },
        {
            "name": "S24 FE",
            "action": "구매"
        },
        {
            "name": "아이폰17",
            "action": "사전예약"
        }
    ],
    "channel": [
        {...
2025-09-24 13:24:10,627 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-24 13:24:10,628 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-24 13:24:10,628 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-24 13:24:10,628 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '9월은 SKT 직영점에서 혜택받9, 구매하9', 'purpose': ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도'], 'product': [{'name': '갤럭시 와이드8', 'action': '구매'}, {'name': '갤럭시 A36', 'action': '구매'}, {'name': 'S24 FE', 'action': '구매'}, {'name': '아이폰17', 'action': '사전예약'}], 'channel': [{'type': 'URL', 'value': 'https://naver.me/FTM8rdfj', 'action': '추가 정보'}, {'type': 'URL', 'value': 'https://naver.me/GipIR3Lg', 'action': '추가 정보'}, {'type': '전화번호', 'value': '0507-1399-6011', 'action': '문의'}, {'type': '대리점', 'value': 'SKT 을지로점', 'action': '방문'}, {'type': '전화번호', 'value': '080-801-0011', 'action': '수신 거부'}], 'pgm': ['기변유도및해지방어', '상품및부가서비스가입유도_단말']}
2025-09-24 13:24:10,628 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-24 13:24:10,628 - mms_extractor - INFO - LLM 추출 엔티티: ['갤럭시 와이드8', '갤럭시 A36', 'S24 FE', '아이폰17']
2025-09-24 13:24:10,628 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-24 13:24:10,629 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-24 13:24:11,064 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 18377)
2025-09-24 13:24:11,064 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-24 13:24:11,064 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-24 13:24:11,064 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-09-24 13:24:11,079 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:24:11,080 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:24:14,324 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:24:14,727 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:24:14,738 - mms_extractor - INFO - ✅ LLM 추출 완료: ['갤럭시 와이드8', 'S24 FE', 'A36', '와이드8', '아이폰17']
2025-09-24 13:24:14,896 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.27초
2025-09-24 13:24:14,920 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-24 13:24:14,920 - mms_extractor - INFO - ============================================================
2025-09-24 13:24:14,920 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-24 13:24:14,920 - mms_extractor - INFO - ============================================================
2025-09-24 13:24:14,921 - mms_extractor - INFO - 제목: 9월은 SKT 직영점에서 혜택받9, 구매하9
2025-09-24 13:24:14,921 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '대리점/매장 방문 유도']
2025-09-24 13:24:14,921 - mms_extractor - INFO - 상품 수: 4개
2025-09-24 13:24:14,921 - mms_extractor - INFO - 채널 수: 5개
2025-09-24 13:24:14,921 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-24 13:24:14,921 - mms_extractor - INFO - process_message 실행완료: 29.41초
2025-09-24 13:24:14,921 - __main__ - INFO - MongoDB 저장 중...
2025-09-24 13:24:15,525 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-24 13:24:15,527 - mongodb_utils - INFO - 문서 저장 성공: 68d3726fbb5c4be323e45b88
2025-09-24 13:24:15,528 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-24 13:24:15,528 - __main__ - INFO - MongoDB 저장 완료!
2025-09-24 13:24:15,529 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-24 13:24:15,529 - __main__ - INFO - 추출 완료: 30.017초
2025-09-24 13:24:15,530 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:24:15] "POST /extract HTTP/1.1" 200 -
2025-09-24 13:24:15,560 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:24:15] "GET /health HTTP/1.1" 200 -
2025-09-24 13:28:52,056 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:28:52] "GET /health HTTP/1.1" 200 -
2025-09-24 13:28:54,909 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:28:54] "GET /health HTTP/1.1" 200 -
2025-09-24 13:28:59,685 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:28:59] "GET /health HTTP/1.1" 200 -
2025-09-24 13:29:02,121 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:02] "GET /health HTTP/1.1" 200 -
2025-09-24 13:29:02,158 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:02] "GET /health HTTP/1.1" 200 -
2025-09-24 13:29:04,177 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:04] "GET /health HTTP/1.1" 200 -
2025-09-24 13:29:04,189 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-24 13:29:04,189 - mms_extractor - INFO - ============================================================
2025-09-24 13:29:04,189 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-24 13:29:04,189 - mms_extractor - INFO - ============================================================
2025-09-24 13:29:04,189 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-24 13:29:04,189 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-24 13:29:04,189 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-24 13:29:04,189 - mms_extractor - INFO - 데이터 소스: local
2025-09-24 13:29:04,189 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-24 13:29:04,189 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-24 13:29:04,189 - mms_extractor - INFO - LLM 모델: ax
2025-09-24 13:29:04,189 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-09-24 13:29:04,189 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-24 13:29:04,189 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-24 13:29:04,190 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-24 13:29:04,190 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-24 13:29:04,191 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-09-24 13:29:04,207 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-24 13:29:04,208 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-24 13:29:04,214 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-24 13:29:04,214 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-24 13:29:04,214 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-09-24 13:29:04,214 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-24 13:29:04,460 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2775, 3)
2025-09-24 13:29:04,461 - mms_extractor - INFO - 퍼지 매칭 성공: 2775개 결과
2025-09-24 13:29:04,461 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-24 13:29:04,461 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-24 13:29:04,551 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2775, 3)
2025-09-24 13:29:04,552 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-24 13:29:04,552 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-24 13:29:04,554 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-24 13:29:04,555 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-24 13:29:04,556 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-24 13:29:04,557 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:29:04,560 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-24 13:29:04,560 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-24 13:29:04,560 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.37초
2025-09-24 13:29:04,560 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:29:04,560 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-24 13:29:04,560 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-24 13:29:04,732 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-24 13:29:04,732 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-24 13:29:04,732 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-24 13:29:04,733 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-24 13:29:04,733 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-24 13:29:04,733 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:29:04,733 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-24 13:29:04,733 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-24 13:29:04,733 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-24 13:29:04,734 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-24 13:29:04,734 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-24 13:29:04,734 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-24 13:29:04,734 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-24 13:29:04,734 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-24 13:29:04,734 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 8276)
2025-09-24 13:29:04,734 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-24 13:29:04,734 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-24 13:29:15,856 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:29:15,861 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-24 13:29:15,862 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-24 13:29:15,862 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-24 13:29:15,863 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-24 13:29:15,863 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-24 13:29:15,864 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-24 13:29:15,864 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-24 13:29:15,864 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-24 13:29:15,865 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-24 13:29:15,865 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-24 13:29:16,966 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 31977)
2025-09-24 13:29:16,967 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-24 13:29:16,967 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-24 13:29:16,967 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-09-24 13:29:16,967 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:29:16,967 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:29:20,926 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:29:21,956 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:29:21,964 - mms_extractor - INFO - ✅ LLM 추출 완료: ['Netflix 스탠다드', 'Netflix 프리미엄 멤버십', 'T 우주', '우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', '우주패스 Netflix 런칭 프로모션', '우주패스 Netflix', '넷플릭스', '웨이브', 'Wavve 콘텐츠 팩']
2025-09-24 13:29:22,193 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 6.33초
2025-09-24 13:29:22,198 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-24 13:29:22,198 - mms_extractor - INFO - ============================================================
2025-09-24 13:29:22,198 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-24 13:29:22,198 - mms_extractor - INFO - ============================================================
2025-09-24 13:29:22,198 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-24 13:29:22,198 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-24 13:29:22,198 - mms_extractor - INFO - 상품 수: 10개
2025-09-24 13:29:22,198 - mms_extractor - INFO - 채널 수: 3개
2025-09-24 13:29:22,198 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-24 13:29:22,198 - mms_extractor - INFO - process_message 실행완료: 18.01초
2025-09-24 13:29:22,198 - __main__ - INFO - MongoDB 저장 중...
2025-09-24 13:29:22,203 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-24 13:29:22,205 - mongodb_utils - INFO - 문서 저장 성공: 68d373a2bb5c4be323e45b8a
2025-09-24 13:29:22,205 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-24 13:29:22,205 - __main__ - INFO - MongoDB 저장 완료!
2025-09-24 13:29:22,205 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-24 13:29:22,205 - __main__ - INFO - 추출 완료: 18.016초
2025-09-24 13:29:22,206 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:22] "POST /extract HTTP/1.1" 200 -
2025-09-24 13:29:22,222 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:22] "GET /health HTTP/1.1" 200 -
2025-09-24 13:29:40,482 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:29:40] "GET /health HTTP/1.1" 200 -
2025-09-24 13:31:16,660 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:31:16] "GET /health HTTP/1.1" 200 -
2025-09-24 13:31:16,683 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:31:16] "GET /health HTTP/1.1" 200 -
2025-09-24 13:31:19,390 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:31:19] "GET /health HTTP/1.1" 200 -
2025-09-24 13:31:19,401 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-24 13:31:19,401 - mms_extractor - INFO - ============================================================
2025-09-24 13:31:19,401 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-24 13:31:19,401 - mms_extractor - INFO - ============================================================
2025-09-24 13:31:19,401 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!

✨ 특별 혜택
- 월 요금 20% 할인 (첫 6개월)
-...
2025-09-24 13:31:19,401 - mms_extractor - INFO - 메시지 길이: 323 문자
2025-09-24 13:31:19,401 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-24 13:31:19,401 - mms_extractor - INFO - 데이터 소스: local
2025-09-24 13:31:19,401 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-24 13:31:19,401 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-24 13:31:19,401 - mms_extractor - INFO - LLM 모델: ax
2025-09-24 13:31:19,401 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-09-24 13:31:19,401 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-24 13:31:19,402 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-24 13:31:19,402 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-24 13:31:19,402 - mms_extractor - INFO - 처리할 메시지 길이: 323 문자
2025-09-24 13:31:19,404 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-09-24 13:31:19,410 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-24 13:31:19,411 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-09-24 13:31:19,413 - mms_extractor - INFO - 전체 토큰 수: 121개
2025-09-24 13:31:19,413 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', 'ZEM폰 포켓몬에디션3', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '포켓몬']
2025-09-24 13:31:19,413 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['키즈폰', 'ZEM폰 포켓몬에디션3']
2025-09-24 13:31:19,413 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-24 13:31:19,555 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1371, 3)
2025-09-24 13:31:19,555 - mms_extractor - INFO - 퍼지 매칭 성공: 1371개 결과
2025-09-24 13:31:19,555 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.5}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4444444444444444}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.4}]
2025-09-24 13:31:19,555 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-24 13:31:19,596 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1371, 3)
2025-09-24 13:31:19,597 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.4}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.35555555555555557}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.32000000000000006}]
2025-09-24 13:31:19,597 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-24 13:31:19,599 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 6개
2025-09-24 13:31:19,600 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-24 13:31:19,600 - mms_extractor - INFO - 통합된 후보 아이템 수: 7개
2025-09-24 13:31:19,601 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:31:19,603 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (5, 2)
2025-09-24 13:31:19,604 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}, {'item_nm': 'ZEM폰 포켓몬에디션3', 'item_id': ['A5V5']}]
2025-09-24 13:31:19,604 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.20초
2025-09-24 13:31:19,604 - mms_extractor - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:31:19,604 - mms_extractor - INFO - 매칭된 상품 정보: (5, 2)
2025-09-24 13:31:19,604 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-24 13:31:19,646 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-24 13:31:19,646 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-24 13:31:19,646 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-09-24 13:31:19,646 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-24 13:31:19,646 - mms_extractor - INFO - 후보 아이템 리스트 크기: 5개
2025-09-24 13:31:19,646 - mms_extractor - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:31:19,646 - mms_extractor - INFO - extra_item_pdf 크기: (5, 2)
2025-09-24 13:31:19,646 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-24 13:31:19,646 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}]
2025-09-24 13:31:19,647 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 5개
2025-09-24 13:31:19,647 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '0서비스', 'action': '기타'}, {'name': 'T 서비스', 'action': '기타'}]
2025-09-24 13:31:19,648 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-24 13:31:19,648 - mms_extractor - INFO - 구성된 프롬프트 길이: 5207 문자
2025-09-24 13:31:19,648 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-24 13:31:19,648 - mms_extractor - INFO - 프롬프트 저장됨: main_extraction_prompt (길이: 5207)
2025-09-24 13:31:19,648 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 1
2025-09-24 13:31:19,648 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-24 13:31:31,370 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:31:31,374 - mms_extractor - INFO - LLM 응답 길이: 942 문자
2025-09-24 13:31:31,375 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 프리미엄 서비스",
            "action": "가입"
        },
        {
            "name": "포켓몬 케이스",
            "action": "증정"
        }
    ],
    "channel": [
        {
            "type": "전화번호",
            "value": "1588-0011",
            "action": "문의"
    ...
2025-09-24 13:31:31,375 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-24 13:31:31,376 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-24 13:31:31,376 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-24 13:31:31,376 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 프리미엄 서비스', 'action': '가입'}, {'name': '포켓몬 케이스', 'action': '증정'}], 'channel': [{'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '대리점', 'value': '가까운 T world 매장', 'action': '추가 정보'}, {'type': 'URL', 'value': 'www.tworld.co.kr', 'action': '추가 정보'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-24 13:31:31,377 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-24 13:31:31,377 - mms_extractor - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 프리미엄 서비스', '포켓몬 케이스']
2025-09-24 13:31:31,378 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-24 13:31:31,379 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-24 13:31:31,775 - mms_extractor - INFO - 프롬프트 저장됨: entity_extraction_prompt (길이: 19139)
2025-09-24 13:31:31,775 - mms_extractor - INFO - 현재 저장된 프롬프트 수: 2
2025-09-24 13:31:31,775 - mms_extractor - INFO - 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-24 13:31:31,775 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-09-24 13:31:31,776 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:31:31,776 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:31:35,595 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:31:38,872 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:31:38,887 - mms_extractor - INFO - ✅ LLM 추출 완료: ['ZEM', 'ZEM 프리미엄 서비스', 'ZEM폰 포켓몬에디션3', 'T world']
2025-09-24 13:31:39,015 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 7.64초
2025-09-24 13:31:39,033 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-24 13:31:39,034 - mms_extractor - INFO - ============================================================
2025-09-24 13:31:39,034 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-24 13:31:39,034 - mms_extractor - INFO - ============================================================
2025-09-24 13:31:39,034 - mms_extractor - INFO - 제목: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
2025-09-24 13:31:39,034 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-24 13:31:39,034 - mms_extractor - INFO - 상품 수: 1개
2025-09-24 13:31:39,034 - mms_extractor - INFO - 채널 수: 4개
2025-09-24 13:31:39,034 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-24 13:31:39,034 - mms_extractor - INFO - process_message 실행완료: 19.63초
2025-09-24 13:31:39,034 - __main__ - INFO - MongoDB 저장 중...
2025-09-24 13:31:39,038 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-24 13:31:39,039 - mongodb_utils - INFO - 문서 저장 성공: 68d3742bbb5c4be323e45b8c
2025-09-24 13:31:39,039 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-24 13:31:39,039 - __main__ - INFO - MongoDB 저장 완료!
2025-09-24 13:31:39,039 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-24 13:31:39,039 - __main__ - INFO - 추출 완료: 19.639초
2025-09-24 13:31:39,040 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:31:39] "POST /extract HTTP/1.1" 200 -
2025-09-24 13:31:39,056 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:31:39] "GET /health HTTP/1.1" 200 -
2025-09-24 13:43:38,924 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-09-24 13:43:38,924 - __main__ - INFO - 전역 추출기 초기화 중...
2025-09-24 13:43:38,924 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-09-24 13:43:38,924 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-09-24 13:43:38,924 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-09-24 13:43:38,924 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-09-24 13:43:38,924 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-09-24 13:43:38,925 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-09-24 13:43:38,946 - mms_extractor - INFO - Using device: mps
2025-09-24 13:43:38,947 - mms_extractor - INFO - _initialize_device 실행완료: 0.02초
2025-09-24 13:43:38,947 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-09-24 13:43:38,947 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-09-24 13:43:38,947 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-09-24 13:43:38,947 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-09-24 13:43:38,947 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-09-24 13:43:38,947 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-09-24 13:43:38,947 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-09-24 13:43:44,727 - mms_extractor - INFO - Model loaded on mps
2025-09-24 13:43:44,727 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 5.78초
2025-09-24 13:43:44,727 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-09-24 13:43:45,184 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-09-24 13:43:45,185 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.46초
2025-09-24 13:43:45,185 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-09-24 13:43:45,185 - mms_extractor - INFO - ============================================================
2025-09-24 13:43:45,185 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-09-24 13:43:45,185 - mms_extractor - INFO - ============================================================
2025-09-24 13:43:45,185 - mms_extractor - INFO - 데이터 소스 모드: local
2025-09-24 13:43:45,185 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-09-24 13:43:45,185 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-09-24 13:43:45,185 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-09-24 13:43:45,185 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-24 13:43:45,289 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-09-24 13:43:45,289 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-24 13:43:45,289 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-09-24 13:43:45,292 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-09-24 13:43:45,293 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-09-24 13:43:45,293 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:43:45,294 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:43:45,294 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-09-24 13:43:45,294 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-09-24 13:43:45,302 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-09-24 13:43:45,304 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-09-24 13:43:45,304 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-09-24 13:43:45,304 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:43:45,305 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-09-24 13:43:45,305 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-09-24 13:43:45,305 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-09-24 13:43:45,305 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:43:45,305 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-09-24 13:43:45,305 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-09-24 13:43:45,305 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-09-24 13:43:45,306 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-09-24 13:43:45,307 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-09-24 13:43:45,307 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:43:45,307 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-09-24 13:43:45,307 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-09-24 13:43:45,428 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-09-24 13:43:45,432 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-09-24 13:43:45,433 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-24 13:43:45,433 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-09-24 13:43:45,433 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-09-24 13:43:45,433 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-09-24 13:43:45,434 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-09-24 13:43:45,434 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-09-24 13:43:45,434 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-09-24 13:43:45,434 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-09-24 13:43:45,435 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-09-24 13:43:45,435 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-09-24 13:43:45,436 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-09-24 13:43:45,449 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-09-24 13:43:45,449 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-09-24 13:43:45,449 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-09-24 13:43:45,451 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-09-24 13:43:45,451 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-09-24 13:43:45,622 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-09-24 13:43:45,622 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-09-24 13:43:45,622 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-09-24 13:43:45,622 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-09-24 13:43:45,622 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-09-24 13:43:45,622 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-09-24 13:43:45,684 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-09-24 13:43:45,684 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-09-24 13:43:45,686 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-09-24 13:43:45,686 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-09-24 13:43:45,687 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-09-24 13:43:45,687 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-09-24 13:43:45,687 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-09-24 13:43:45,687 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-09-24 13:43:45,687 - mms_extractor - INFO - ============================================================
2025-09-24 13:43:45,687 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-09-24 13:43:45,687 - mms_extractor - INFO - ============================================================
2025-09-24 13:43:45,687 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-09-24 13:43:45,687 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-09-24 13:43:45,687 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-09-24 13:43:45,687 - mms_extractor - INFO - ✅ 정지어: 166개
2025-09-24 13:43:45,687 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-09-24 13:43:45,688 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-09-24 13:43:45,689 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-09-24 13:43:45,690 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-09-24 13:43:45,690 - mms_extractor - INFO - _load_data 실행완료: 0.51초
2025-09-24 13:43:45,690 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-09-24 13:43:45,690 - __main__ - INFO - 전역 추출기 초기화 완료
2025-09-24 13:43:45,690 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-09-24 13:43:45,690 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-09-24 13:43:45,690 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-09-24 13:43:45,690 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-09-24 13:43:45,690 - __main__ - INFO -   GET  /health - 헬스체크
2025-09-24 13:43:45,690 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-09-24 13:43:45,690 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-09-24 13:43:45,690 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-09-24 13:43:45,690 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-09-24 13:43:45,716 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.64:8000
2025-09-24 13:43:45,716 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-24 13:44:22,851 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:44:22] "GET /health HTTP/1.1" 200 -
2025-09-24 13:44:22,859 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-24 13:44:22,859 - mms_extractor - INFO - ============================================================
2025-09-24 13:44:22,859 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-24 13:44:22,859 - mms_extractor - INFO - ============================================================
2025-09-24 13:44:22,859 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!

✨ 특별 혜택
- 월 요금 20% 할인 (첫 6개월)
-...
2025-09-24 13:44:22,859 - mms_extractor - INFO - 메시지 길이: 323 문자
2025-09-24 13:44:22,859 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-24 13:44:22,859 - mms_extractor - INFO - 데이터 소스: local
2025-09-24 13:44:22,859 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-24 13:44:22,859 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-24 13:44:22,860 - mms_extractor - INFO - LLM 모델: ax
2025-09-24 13:44:22,860 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-09-24 13:44:22,860 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-24 13:44:22,860 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-24 13:44:22,860 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-24 13:44:22,860 - mms_extractor - INFO - 처리할 메시지 길이: 323 문자
2025-09-24 13:44:22,861 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-09-24 13:44:23,340 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-09-24 13:44:23,341 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-09-24 13:44:23,342 - mms_extractor - INFO - 전체 토큰 수: 121개
2025-09-24 13:44:23,342 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', 'ZEM폰 포켓몬에디션3', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '포켓몬']
2025-09-24 13:44:23,342 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['ZEM폰 포켓몬에디션3', '키즈폰']
2025-09-24 13:44:23,342 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-24 13:44:29,884 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1371, 3)
2025-09-24 13:44:29,884 - mms_extractor - INFO - 퍼지 매칭 성공: 1371개 결과
2025-09-24 13:44:29,885 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.5}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4444444444444444}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.4}]
2025-09-24 13:44:29,885 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-24 13:44:29,926 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1371, 3)
2025-09-24 13:44:29,927 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.4}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.35555555555555557}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.32000000000000006}]
2025-09-24 13:44:29,927 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-24 13:44:29,929 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 6개
2025-09-24 13:44:29,933 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-09-24 13:44:29,933 - mms_extractor - INFO - 통합된 후보 아이템 수: 7개
2025-09-24 13:44:29,936 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:44:29,938 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (5, 2)
2025-09-24 13:44:29,938 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}, {'item_nm': 'ZEM폰 포켓몬에디션3', 'item_id': ['A5V5']}]
2025-09-24 13:44:29,939 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.08초
2025-09-24 13:44:29,939 - mms_extractor - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:44:29,939 - mms_extractor - INFO - 매칭된 상품 정보: (5, 2)
2025-09-24 13:44:29,939 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-24 13:44:30,151 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-24 13:44:30,151 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-24 13:44:30,151 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-09-24 13:44:30,151 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-24 13:44:30,151 - mms_extractor - INFO - 후보 아이템 리스트 크기: 5개
2025-09-24 13:44:30,151 - mms_extractor - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-09-24 13:44:30,151 - mms_extractor - INFO - extra_item_pdf 크기: (5, 2)
2025-09-24 13:44:30,151 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-24 13:44:30,152 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}]
2025-09-24 13:44:30,153 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 5개
2025-09-24 13:44:30,153 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '0서비스', 'action': '기타'}, {'name': 'T 서비스', 'action': '기타'}]
2025-09-24 13:44:30,153 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-24 13:44:30,153 - mms_extractor - INFO - 구성된 프롬프트 길이: 5207 문자
2025-09-24 13:44:30,153 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-24 13:44:30,153 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-09-24 13:44:30,153 - mms_extractor - INFO - 📝 프롬프트 길이: 5,207 문자
2025-09-24 13:44:30,153 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-09-24 13:44:30,153 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-24 13:44:42,053 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:44:42,064 - mms_extractor - INFO - LLM 응답 길이: 863 문자
2025-09-24 13:44:42,064 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 프리미엄 서비스",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "전화번호",
            "value": "1588-0011",
            "action": "문의"
        },
        {
            "type": "대리점",
            "value": "가까운 T world 매...
2025-09-24 13:44:42,064 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-24 13:44:42,065 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-24 13:44:42,065 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-24 13:44:42,065 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 프리미엄 서비스', 'action': '가입'}], 'channel': [{'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '대리점', 'value': '가까운 T world 매장', 'action': '추가 정보'}, {'type': 'URL', 'value': 'www.tworld.co.kr', 'action': '추가 정보'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-09-24 13:44:42,065 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-24 13:44:42,065 - mms_extractor - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 프리미엄 서비스']
2025-09-24 13:44:42,066 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-24 13:44:42,066 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-24 13:44:42,066 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-09-24 13:44:42,066 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-09-24 13:44:42,450 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1108개
2025-09-24 13:44:42,450 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(LGU)갤럭시 A16 키즈폰 무너에디션', '(신)무료SMS2000', '(신)무료문자2000', '+국제전화발신(00700)', '0 청년 37', '0 청년 43', '0 청년 49', '0 청년 59', '0 청년 59 100GB업', '0 청년 59 100기가업']
2025-09-24 13:44:42,451 - mms_extractor - INFO - 필터링 후 엔티티 수: 1105개
2025-09-24 13:44:42,451 - mms_extractor - INFO - 제거된 엔티티 수: 3개
2025-09-24 13:44:42,451 - mms_extractor - INFO - 최종 후보 엔티티 수: 1105개
2025-09-24 13:44:42,451 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1105개
2025-09-24 13:44:42,451 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-09-24 13:44:42,451 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1105개)
2025-09-24 13:44:42,451 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(LGU)갤럭시 A16 키즈폰 무너에디션', '(신)무료SMS2000', '(신)무료문자2000', '+국제전화발신(00700)', '0 청년 37', '0 청년 43', '0 청년 49', '0 청년 59', '0 청년 59 100GB업', '0 청년 59 100기가업']
2025-09-24 13:44:42,451 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-09-24 13:44:42,451 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,515 문자
2025-09-24 13:44:42,451 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,255 문자
2025-09-24 13:44:42,451 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-09-24 13:44:42,451 - mms_extractor - INFO - 📝 프롬프트 길이: 4,255 문자
2025-09-24 13:44:42,451 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-09-24 13:44:42,451 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-24 13:44:42,451 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-09-24 13:44:42,461 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:44:42,462 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x349e1f4d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x34cc008f0> root_client=<openai.OpenAI object at 0x36fbbccb0> root_async_client=<openai.AsyncOpenAI object at 0x34cc00140> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x36fb9b1a0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x36fb9b080> root_client=<openai.OpenAI object at 0x36fbbce60> root_async_client=<openai.AsyncOpenAI object at 0x36fb9b6e0> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,352 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,352 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 메시지 길이: 323 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 메시지 길이: 323 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,123 문자
2025-09-24 13:44:42,462 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,123 문자
2025-09-24 13:44:43,502 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:44:46,018 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:44:46,031 - mms_extractor - INFO - ✅ LLM 추출 완료: ['T world', 'ZEM', 'ZEM 프리미엄 서비스', 'ZEM폰 포켓몬에디션3']
2025-09-24 13:44:46,166 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.10초
2025-09-24 13:44:46,187 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-24 13:44:46,187 - mms_extractor - INFO - ============================================================
2025-09-24 13:44:46,187 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-24 13:44:46,187 - mms_extractor - INFO - ============================================================
2025-09-24 13:44:46,187 - mms_extractor - INFO - 제목: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
2025-09-24 13:44:46,187 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-09-24 13:44:46,187 - mms_extractor - INFO - 상품 수: 1개
2025-09-24 13:44:46,187 - mms_extractor - INFO - 채널 수: 4개
2025-09-24 13:44:46,187 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-24 13:44:46,188 - mms_extractor - INFO - process_message 실행완료: 23.33초
2025-09-24 13:44:46,188 - __main__ - INFO - MongoDB 저장 중...
2025-09-24 13:44:46,781 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-24 13:44:46,782 - mongodb_utils - INFO - 문서 저장 성공: 68d3773eb1414d391cc66d4e
2025-09-24 13:44:46,782 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-24 13:44:46,783 - __main__ - INFO - MongoDB 저장 완료!
2025-09-24 13:44:46,783 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-24 13:44:46,783 - __main__ - INFO - 추출 완료: 23.924초
2025-09-24 13:44:46,784 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:44:46] "POST /extract HTTP/1.1" 200 -
2025-09-24 13:44:46,816 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:44:46] "GET /health HTTP/1.1" 200 -
2025-09-24 13:45:30,545 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:45:30] "GET /health HTTP/1.1" 200 -
2025-09-24 13:45:30,588 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:45:30] "GET /health HTTP/1.1" 200 -
2025-09-24 13:45:32,011 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:45:32] "GET /health HTTP/1.1" 200 -
2025-09-24 13:45:32,017 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-09-24 13:45:32,018 - mms_extractor - INFO - ============================================================
2025-09-24 13:45:32,018 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-09-24 13:45:32,018 - mms_extractor - INFO - ============================================================
2025-09-24 13:45:32,018 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-09-24 13:45:32,018 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-09-24 13:45:32,018 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-09-24 13:45:32,018 - mms_extractor - INFO - 데이터 소스: local
2025-09-24 13:45:32,018 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-09-24 13:45:32,018 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-09-24 13:45:32,018 - mms_extractor - INFO - LLM 모델: ax
2025-09-24 13:45:32,018 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-09-24 13:45:32,018 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-09-24 13:45:32,018 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-09-24 13:45:32,018 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-09-24 13:45:32,018 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-09-24 13:45:32,019 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-09-24 13:45:32,034 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-09-24 13:45:32,035 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-09-24 13:45:32,041 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-09-24 13:45:32,042 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-09-24 13:45:32,042 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', 'Wavve 콘텐츠 팩', '넷플릭스']
2025-09-24 13:45:32,042 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-09-24 13:45:32,283 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2775, 3)
2025-09-24 13:45:32,283 - mms_extractor - INFO - 퍼지 매칭 성공: 2775개 결과
2025-09-24 13:45:32,283 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-09-24 13:45:32,283 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-09-24 13:45:32,387 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2775, 3)
2025-09-24 13:45:32,387 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-09-24 13:45:32,387 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-09-24 13:45:32,389 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-09-24 13:45:32,391 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-09-24 13:45:32,392 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-09-24 13:45:32,393 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:45:32,395 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-09-24 13:45:32,395 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-09-24 13:45:32,395 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.38초
2025-09-24 13:45:32,395 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:45:32,395 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-09-24 13:45:32,395 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-09-24 13:45:32,512 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-09-24 13:45:32,512 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-09-24 13:45:32,512 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-09-24 13:45:32,512 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-09-24 13:45:32,512 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-09-24 13:45:32,512 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-09-24 13:45:32,512 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-09-24 13:45:32,512 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-09-24 13:45:32,513 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-09-24 13:45:32,514 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-09-24 13:45:32,514 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-09-24 13:45:32,514 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-09-24 13:45:32,514 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-09-24 13:45:32,514 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-09-24 13:45:32,514 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-09-24 13:45:32,514 - mms_extractor - INFO - 📝 프롬프트 길이: 8,276 문자
2025-09-24 13:45:32,514 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-09-24 13:45:32,514 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-09-24 13:45:47,273 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:45:47,276 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-09-24 13:45:47,276 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-09-24 13:45:47,276 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-09-24 13:45:47,277 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-09-24 13:45:47,277 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-09-24 13:45:47,277 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-09-24 13:45:47,277 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-09-24 13:45:47,277 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-09-24 13:45:47,278 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-09-24 13:45:47,278 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-09-24 13:45:47,278 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-09-24 13:45:47,278 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-09-24 13:45:48,247 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1747개
2025-09-24 13:45:48,247 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-09-24 13:45:48,249 - mms_extractor - INFO - 필터링 후 엔티티 수: 1743개
2025-09-24 13:45:48,249 - mms_extractor - INFO - 제거된 엔티티 수: 4개
2025-09-24 13:45:48,249 - mms_extractor - INFO - 최종 후보 엔티티 수: 1743개
2025-09-24 13:45:48,249 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1743개
2025-09-24 13:45:48,249 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-09-24 13:45:48,249 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1743개)
2025-09-24 13:45:48,249 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-09-24 13:45:48,249 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-09-24 13:45:48,249 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,760 문자
2025-09-24 13:45:48,249 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,790 문자
2025-09-24 13:45:48,249 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-09-24 13:45:48,249 - mms_extractor - INFO - 📝 프롬프트 길이: 4,790 문자
2025-09-24 13:45:48,249 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-09-24 13:45:48,249 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-09-24 13:45:48,249 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-09-24 13:45:48,250 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:45:48,250 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x36fce30e0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x36fba9460> root_client=<openai.OpenAI object at 0x36fce07a0> root_async_client=<openai.AsyncOpenAI object at 0x36fc06150> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x36fba9a90> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x36fba88c0> root_client=<openai.OpenAI object at 0x36fba9640> root_async_client=<openai.AsyncOpenAI object at 0x36fba9e50> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-09-24 13:45:48,250 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-09-24 13:45:49,274 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:45:50,979 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-24 13:45:50,984 - mms_extractor - INFO - ✅ LLM 추출 완료: ['우주패스 Netflix', '웨이브', 'Netflix', 'Wavve 콘텐츠 팩', 'T 우주', '넷플릭스']
2025-09-24 13:45:51,160 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 3.88초
2025-09-24 13:45:51,164 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-09-24 13:45:51,165 - mms_extractor - INFO - ============================================================
2025-09-24 13:45:51,165 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-09-24 13:45:51,165 - mms_extractor - INFO - ============================================================
2025-09-24 13:45:51,165 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-09-24 13:45:51,165 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-09-24 13:45:51,165 - mms_extractor - INFO - 상품 수: 6개
2025-09-24 13:45:51,165 - mms_extractor - INFO - 채널 수: 3개
2025-09-24 13:45:51,165 - mms_extractor - INFO - 프로그램 수: 2개
2025-09-24 13:45:51,165 - mms_extractor - INFO - process_message 실행완료: 19.15초
2025-09-24 13:45:51,165 - __main__ - INFO - MongoDB 저장 중...
2025-09-24 13:45:51,169 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-09-24 13:45:51,170 - mongodb_utils - INFO - 문서 저장 성공: 68d3777fb1414d391cc66d50
2025-09-24 13:45:51,171 - mongodb_utils - INFO - MongoDB 연결 해제
2025-09-24 13:45:51,171 - __main__ - INFO - MongoDB 저장 완료!
2025-09-24 13:45:51,171 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-09-24 13:45:51,171 - __main__ - INFO - 추출 완료: 19.154초
2025-09-24 13:45:51,171 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:45:51] "POST /extract HTTP/1.1" 200 -
2025-09-24 13:45:51,190 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:45:51] "GET /health HTTP/1.1" 200 -
2025-09-24 13:48:41,044 - werkzeug - INFO - 127.0.0.1 - - [24/Sep/2025 13:48:41] "GET /health HTTP/1.1" 200 -
