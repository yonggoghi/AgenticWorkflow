{
  "paragraphs": [
    {
      "text": "%pyspark\n\nimport pyspark.sql.functions as SF\nfrom pyspark.ml.functions import vector_to_array\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.types import *",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:51.627",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/python",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764650590181_2011778621",
      "id": "paragraph_1764650590181_2011778621",
      "dateCreated": "2025-12-02 04:43:10.181",
      "dateStarted": "2025-12-17 01:59:51.724",
      "dateFinished": "2025-12-17 01:59:53.096",
      "status": "FINISHED"
    },
    {
      "text": "import com.microsoft.azure.synapse.ml.causal\nimport com.skt.mno.dt.utils.commfunc._\nimport ml.dmlc.xgboost4j.scala.spark.{XGBoostClassificationModel, XGBoostClassifier, XGBoostRegressor}\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.{Pipeline, PipelineModel, linalg}\nimport org.apache.spark.mllib.evaluation.MulticlassMetrics\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions.explode\nimport org.apache.spark.sql.types.{DateType, StringType, TimestampType}\nimport org.apache.spark.sql.{DataFrame, SparkSession, functions \u003d\u003e F}\nimport org.apache.spark.storage.StorageLevel\nimport org.joda.time.{LocalDate, Years}\nimport org.riversun.ml.spark.FeatureImportance.Order\nimport org.riversun.ml.spark.{FeatureImportance, Importance}\n\nimport java.sql.Date\nimport java.text.DecimalFormat\nimport java.time.format.DateTimeFormatter\nimport java.time.{ZoneId, ZonedDateTime}\nimport com.microsoft.azure.synapse.{ml \u003d\u003e sml}\n\nimport collection.JavaConverters._\nimport scala.collection.JavaConverters._\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:53.125",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import com.microsoft.azure.synapse.ml.causal\nimport com.skt.mno.dt.utils.commfunc._\nimport ml.dmlc.xgboost4j.scala.spark.{XGBoostClassificationModel, XGBoostClassifier, XGBoostRegressor}\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.ml.{Pipeline, PipelineModel, linalg}\nimport org.apache.spark.mllib.evaluation.MulticlassMetrics\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.sql.functions.explode\nimport org.apache.spark.sql.types.{DateType, StringType, TimestampType}\nimport org.apache.spark.sql.{DataFrame, SparkSession, functions\u003d\u003eF}\nimport org.apache.spark.storage.StorageLevel\nimport org.joda.time.{LocalDate, Years}\nimport org.riversun.ml.spark.FeatureImportance.Or...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764658338256_686533166",
      "id": "paragraph_1764658338256_686533166",
      "dateCreated": "2025-12-02 06:52:18.256",
      "dateStarted": "2025-12-17 01:59:53.239",
      "dateFinished": "2025-12-17 01:59:53.964",
      "status": "FINISHED"
    },
    {
      "text": "import java.time.YearMonth\r\nimport java.time.format.DateTimeFormatter\r\n\r\ndef getPreviousMonths(startMonthStr: String, periodM: Int): Array[String] \u003d {\r\n  val formatter \u003d DateTimeFormatter.ofPattern(\"yyyyMM\")\r\n\r\n  // 입력 월 파싱\r\n  val startMonth \u003d YearMonth.parse(startMonthStr, formatter)\r\n\r\n  // 결과를 저장할 가변 리스트 (순서를 위해 ListBuffer 사용)\r\n  var resultMonths \u003d scala.collection.mutable.ListBuffer[String]()\r\n  var currentMonth \u003d startMonth\r\n\r\n  // M번 반복하여 월을 계산하고 리스트에 추가\r\n  for (i \u003c- 0 until periodM) {\r\n    // 현재 월을 리스트 맨 앞에 추가\r\n    resultMonths.prepend(currentMonth.format(formatter))\r\n    // 다음 반복을 위해 이전 달로 이동\r\n    currentMonth \u003d currentMonth.minusMonths(1)\r\n  }\r\n\r\n  // 리스트를 Array로 반환\r\n  resultMonths.toArray\r\n}\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:54.040",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import java.time.YearMonth\nimport java.time.format.DateTimeFormatter\n\u001b[1m\u001b[34mgetPreviousMonths\u001b[0m: \u001b[1m\u001b[32m(startMonthStr: String, periodM: Int)Array[String]\u001b[0m\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764742922351_426209997",
      "id": "paragraph_1764742922351_426209997",
      "dateCreated": "2025-12-03 06:22:02.351",
      "dateStarted": "2025-12-17 01:59:54.110",
      "dateFinished": "2025-12-17 01:59:54.710",
      "status": "FINISHED"
    },
    {
      "title": "Response Data Loading - Hive",
      "text": "\nval df \u003d spark.sql(\"\"\"\nwith ract as\n(\nselect A.cmpgn_num\n    ,A.cmpgn_obj_num\n    ,B.svc_mgmt_num\n    ,A.extrt_seq\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270802\u0027 THEN 1 ELSE 0 END AS send_yn\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270810\u0027 THEN 1 ELSE 0 END AS click_yn\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270811\u0027 THEN 1 ELSE 0 END AS read_yn\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270802\u0027 THEN A.cont_dt ELSE null END AS send_dt\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270810\u0027 THEN A.cont_dt ELSE null END AS click_dt\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270811\u0027 THEN A.cont_dt ELSE null END AS read_dt\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270802\u0027 THEN A.cont_tm ELSE null END AS send_tm\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270810\u0027 THEN A.cont_tm ELSE null END AS click_tm\n    ,CASE WHEN A.ract_typ_cd \u003d \u00270811\u0027 THEN A.cont_tm ELSE null END AS read_tm\n    ,CASE WHEN A.cont_chnl_cd \u003d \u0027C18001\u0027 THEN \u0027MMS\u0027\n            WHEN A.cont_chnl_cd \u003d \u0027C28001\u0027 THEN \u0027RCS\u0027 END AS chnl_typ\n    ,CASE WHEN C.cmpgn_purp_typ_cd IN (\u0027S01\u0027, \u0027S06\u0027) THEN \u0027Sales\u0027\n                WHEN C.cmpgn_purp_typ_cd \u003d \u0027C01\u0027 THEN \u0027Care\u0027\n                WHEN C.cmpgn_purp_typ_cd \u003d \u0027B01\u0027 THEN \u0027Bmarketing\u0027 END AS cmpgn_typ\n    ,CASE WHEN D.cmpgn_num IS NOT NULL THEN \u0027url_Y\u0027 ELSE \u0027url_N\u0027 END AS url_yn\nfrom tos.od_tcam_cmpgn_obj_cont as A\nLEFT JOIN (SELECT DISTINCT cmpgn_num, cmpgn_obj_num, svc_mgmt_num FROM tos.od_tcam_cmpgn_obj) AS B\nON A.cmpgn_obj_num \u003d B.cmpgn_obj_num AND A.cmpgn_num \u003d B.cmpgn_num\nLEFT JOIN tos.od_tcam_cmpgn_brief AS C\nON A.cmpgn_num \u003d C.cmpgn_num\nLEFT JOIN (SELECT DISTINCT cmpgn_num FROM tos.od_tcam_cmpgn_obj WHERE ract_typ_cd \u003d \u00270810\u0027) AS D\nON A.cmpgn_num \u003d D.cmpgn_num\nwhere A.ract_typ_cd in (\u00270802\u0027,\u00270810\u0027, \u00270811\u0027)\nAND A.cont_chnl_cd in (\u0027C18001\u0027,\u0027C28001\u0027)\nAND B.svc_mgmt_num !\u003d \u00270\u0027\n)\n\n,ract2 as(\n\nselect cmpgn_num\n    ,svc_mgmt_num\n    ,extrt_seq\n    ,chnl_typ\n    ,cmpgn_typ\n    ,url_yn\n    ,send_yn\n    ,read_yn\n    ,click_yn\n    ,send_dt\n    ,read_dt\n    ,click_dt\n    ,CASE WHEN LENGTH(send_dt) \u003d 8 AND LENGTH(send_tm) \u003d 6 THEN TO_TIMESTAMP(send_dt || send_tm, \u0027yyyyMMddHHmmss\u0027) ELSE NULL END AS send_time\n    ,CASE WHEN LENGTH(read_dt) \u003d 8 AND LENGTH(read_tm) \u003d 6 THEN TO_TIMESTAMP(read_dt || read_tm, \u0027yyyyMMddHHmmss\u0027) ELSE NULL END AS read_time\n    ,CASE WHEN LENGTH(click_dt) \u003d 8 AND LENGTH(click_tm) \u003d 6 THEN TO_TIMESTAMP(click_dt || click_tm, \u0027yyyyMMddHHmmss\u0027) ELSE NULL END AS click_time\nfrom ract\nwhere (send_dt IS NULL OR LENGTH(send_dt) \u003d 8)\nand (send_tm IS NULL OR LENGTH(send_tm) \u003d 6)\nand (read_dt IS NULL OR LENGTH(read_dt) \u003d 8)\nand (read_tm IS NULL OR LENGTH(read_tm) \u003d 6)\nand (click_dt IS NULL OR LENGTH(click_dt) \u003d 8)\nand (click_tm IS NULL OR LENGTH(click_tm) \u003d 6)\n)\n\n,ract3 as(\nselect cmpgn_num\n    , svc_mgmt_num\n    , extrt_seq\n    , chnl_typ\n    , cmpgn_typ\n    , url_yn\n    , sum(send_yn) as send_yn\n    , sum(read_yn) as read_yn\n    , sum(click_yn) as click_yn\n    , min(send_dt) as send_dt\n    , min(send_time) as send_time\n    , min(read_dt) as read_dt\n    , min(read_time) as read_time\n    , min(click_dt) as click_dt\n    , min(click_time) as click_time\nfrom ract2\ngroup by cmpgn_num, svc_mgmt_num, extrt_seq, chnl_typ, cmpgn_typ, url_yn\n),\n\ntmp AS\n(\nselect *\nfrom ract3\nwhere (send_yn \u003d 1 OR (send_yn \u003d 2 AND chnl_typ \u003d \u0027MMS\u0027))\nand (read_yn IS NULL OR read_yn \u003c\u003d 1)\n)\n\n\nSELECT *\n    ,dayofweek(to_date(send_dt, \u0027yyyyMMdd\u0027)) as send_daynum\n    ,dayofweek(to_date(click_dt, \u0027yyyyMMdd\u0027)) as click_daynum\n    ,hour(send_time) as send_hournum\n    ,hour(click_time) as click_hournum\n    ,CAST(datediff(click_time, send_time) AS INTEGER) AS day_gap\n    ,CAST((unix_timestamp(click_time) - unix_timestamp(send_time))/3600 AS INTEGER) AS hour_gap\n    ,CAST((unix_timestamp(click_time) - unix_timestamp(send_time))/60 AS INTEGER) AS minute_gap\n    ,CAST(unix_timestamp(click_time) - unix_timestamp(send_time) AS INTEGER) AS second_gap\n    ,substring(send_dt,1,6) as send_ym\nFROM tmp\n\n\"\"\").cache()\n\ndf.createOrReplaceTempView(\"df_view\")",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:54.810",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764638859660_1599316492",
      "id": "paragraph_1764638859660_1599316492",
      "dateCreated": "2025-12-02 01:27:39.660",
      "dateStarted": "2025-12-02 06:53:23.243",
      "dateFinished": "2025-12-02 06:53:29.570",
      "status": "FINISHED"
    },
    {
      "title": "Response Data Saving",
      "text": "\ndf.write.mode(\"overwrite\").partitionBy(\"send_ym\").parquet(\"aos/sto/response\")",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:54.942",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": true,
        "title": true,
        "results": {},
        "enabled": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764656596503_575732907",
      "id": "paragraph_1764656596503_575732907",
      "dateCreated": "2025-12-02 06:23:16.503",
      "dateStarted": "2025-12-02 06:53:32.443",
      "dateFinished": "2025-12-02 07:09:49.222",
      "status": "FINISHED"
    },
    {
      "title": "Response Data Loading - HDFS",
      "text": "\nval resDF \u003d spark.read.parquet(\"aos/sto/response\").cache()\nresDF.createOrReplaceTempView(\"res_df\")",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:59:55.079",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mresDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 22 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d2"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d3"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764659911196_1763551717",
      "id": "paragraph_1764659911196_1763551717",
      "dateCreated": "2025-12-02 07:18:31.196",
      "dateStarted": "2025-12-17 01:59:55.147",
      "dateFinished": "2025-12-17 02:00:00.436",
      "status": "FINISHED"
    },
    {
      "text": "\nz.show(resDF.filter(\"click_hournum is not null\"))\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:00.452",
      "progress": 75,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "cmpgn_num": "string",
                      "svc_mgmt_num": "string",
                      "extrt_seq": "string",
                      "chnl_typ": "string",
                      "cmpgn_typ": "string",
                      "url_yn": "string",
                      "send_yn": "string",
                      "read_yn": "string",
                      "click_yn": "string",
                      "send_dt": "string",
                      "send_time": "string",
                      "read_dt": "string",
                      "read_time": "string",
                      "click_dt": "string",
                      "click_time": "string",
                      "send_daynum": "string",
                      "click_daynum": "string",
                      "send_hournum": "string",
                      "click_hournum": "string",
                      "day_gap": "string",
                      "hour_gap": "string",
                      "minute_gap": "string",
                      "second_gap": "string",
                      "send_ym": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": true
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "send_hournum",
                  "index": 17.0,
                  "aggr": "sum"
                }
              ],
              "groups": [
                {
                  "name": "hour_gap",
                  "index": 20.0,
                  "aggr": "sum"
                }
              ],
              "values": [
                {
                  "name": "svc_mgmt_num",
                  "index": 1.0,
                  "aggr": "count"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764638864655_898851625",
      "id": "paragraph_1764638864655_898851625",
      "dateCreated": "2025-12-02 01:27:44.655",
      "dateStarted": "2025-12-04 08:29:46.920",
      "dateFinished": "2025-12-04 08:30:13.914",
      "status": "FINISHED"
    },
    {
      "text": "val sendMonth \u003d \"202512\"\r\nval featureMonth \u003d \"202511\"\r\nval period \u003d 6\r\nval sendYmList \u003d getPreviousMonths(sendMonth, period+2)\r\nval featureYmList \u003d getPreviousMonths(featureMonth, period+2)\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:00.658",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34msendMonth\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 202512\n\u001b[1m\u001b[34mfeatureMonth\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 202511\n\u001b[1m\u001b[34mperiod\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 6\n\u001b[1m\u001b[34msendYmList\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(202505, 202506, 202507, 202508, 202509, 202510, 202511, 202512)\n\u001b[1m\u001b[34mfeatureYmList\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(202504, 202505, 202506, 202507, 202508, 202509, 202510, 202511)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764742953919_436300403",
      "id": "paragraph_1764742953919_436300403",
      "dateCreated": "2025-12-03 06:22:33.919",
      "dateStarted": "2025-12-17 02:00:00.727",
      "dateFinished": "2025-12-17 02:00:00.937",
      "status": "FINISHED"
    },
    {
      "text": "val upperHourGap \u003d 1\nval startHour \u003d 10\nval endHour \u003d 17\n\nval resDFFiltered \u003d resDF\n    .filter(s\"\"\"send_ym in (${sendYmList.mkString(\",\")})\"\"\")\n    .filter(s\"hour_gap is null or (hour_gap between 0 and 5)\")\n    .filter(s\"send_hournum between $startHour and $endHour\")\n    // .filter(\"cmpgn_typ\u003d\u003d\u0027Sales\u0027\")\n    .selectExpr(\"cmpgn_num\",\"svc_mgmt_num\",\"chnl_typ\",\"cmpgn_typ\",\"send_ym\",\"send_dt\",\"send_time\",\"send_daynum\",\"send_hournum\",\"click_dt\",\"click_time\",\"click_daynum\",\"click_hournum\",\"case when hour_gap is null then 0 else 1 end click_yn\",\"hour_gap\")\n    .withColumn(\"res_utility\", F.expr(s\"case when hour_gap is null then 0.0 else 1.0 / (1 + hour_gap) end\"))\n    .dropDuplicates()\n    .cache()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:01.026",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "multiBarChart",
              "height": 300.0,
              "optionOpen": true,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "svc_mgmt_num": "string",
                      "send_cnt": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": false
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "send_cnt",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "svc_mgmt_num",
                  "index": 0.0,
                  "aggr": "count"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mupperHourGap\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 1\n\u001b[1m\u001b[34mstartHour\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 10\n\u001b[1m\u001b[34mendHour\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 17\n\u001b[1m\u001b[34mresDFFiltered\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 14 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764641394585_598529380",
      "id": "paragraph_1764641394585_598529380",
      "dateCreated": "2025-12-02 02:09:54.585",
      "dateStarted": "2025-12-17 02:00:01.097",
      "dateFinished": "2025-12-17 02:00:01.754",
      "status": "FINISHED"
    },
    {
      "text": "val allFeaturesMMKT \u003d spark.sql(\"describe wind_tmt.mmkt_svc_bas_f\").select(\"col_name\").collect().map(_.getString(0))\r\nval sigFeaturesMMKT \u003d spark.read.option(\"header\", \"true\").csv(\"feature_importance/table\u003dmmkt_bas/creation_dt\u003d20230407\").filter(\"rank\u003c\u003d100\").select(\"col\").collect().map(_ (0).toString()).map(_.trim)\r\nval colListForMMKT \u003d (Array(\"svc_mgmt_num\", \"strd_ym feature_ym\", \"mst_work_dt\", \"cust_birth_dt\", \"prcpln_last_chg_dt\", \"fee_prod_id\", \"eqp_mdl_cd\", \"eqp_acqr_dt\", \"equip_chg_cnt\", \"svc_scrb_dt\", \"chg_dt\", \"cust_age_cd\", \"sex_cd\", \"equip_chg_day\", \"last_equip_chg_dt\", \"prev_equip_chg_dt\", \"rten_pen_amt\", \"agrmt_brch_amt\", \"eqp_mfact_cd\"\r\n  , \"allot_mth_cnt\", \"mbr_use_cnt\", \"mbr_use_amt\", \"tyr_mbr_use_cnt\", \"tyr_mbr_use_amt\", \"mth_cnsl_cnt\", \"dsat_cnsl_cnt\", \"simpl_ref_cnsl_cnt\", \"arpu\", \"bf_m1_arpu\", \"voc_arpu\", \"bf_m3_avg_arpu\"\r\n  , \"tfmly_nh39_scrb_yn\", \"prcpln_chg_cnt\", \"email_inv_yn\", \"copn_use_psbl_cnt\", \"data_gift_send_yn\", \"data_gift_recv_yn\", \"equip_chg_mth_cnt\", \"dom_tot_pckt_cnt\", \"scrb_sale_chnl_cl_cd\", \"op_sale_chnl_cl_cd\", \"agrmt_dc_end_dt\"\r\n  , \"svc_cd\", \"svc_st_cd\", \"pps_yn\", \"svc_use_typ_cd\", \"indv_corp_cl_cd\", \"frgnr_yn\", \"nm_cust_num\", \"wlf_dc_cd\"\r\n)\r\n  ++ sigFeaturesMMKT).filter(c \u003d\u003e allFeaturesMMKT.contains(c.trim.split(\" \")(0).trim)).distinct\r\n\r\nval mmktDFTemp \u003d spark.sql(s\"\"\"select ${colListForMMKT.mkString(\",\")}, strd_ym from wind_tmt.mmkt_svc_bas_f a where strd_ym in (${featureYmList.mkString(\",\")})\"\"\")\r\n\r\nval mmktDF \u003d {\r\n  mmktDFTemp\r\n    .join(spark.sql(\"select prod_id fee_prod_id, prod_nm fee_prod_nm from wind.td_zprd_prod\"), Seq(\"fee_prod_id\"), \"left\")\r\n    .filter(\"cust_birth_dt not like \u00279999%\u0027\")\r\n    // .cache()\r\n}\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:01.797",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mallFeaturesMMKT\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(svc_mgmt_num, cntrct_mgmt_num, mst_work_dt, main_oper_dt, svc_scrb_term_yn, scrb_req_rsn_cd, acnt_num, eqp_mdl_cd, eqp_ser_num, tmth_scrb_term_cl_cd, tday_scrb_term_yn, grtm_cl_cd, svc_subsc_ym, svc_scrb_dt, svc_cd, svc_st_chg_cd, svc_chg_rsn_cd, svc_st_dtl_cd, svc_st_cd, svc_cnt, svc_use_typ_cd, svc_term_ym, svc_term_dt, idnt_num_cd, fee_prod_id, fst_scrb_org_id, term_rsn_cd, term_org_id, pps_yn, usim_mdl_cd, usim_ser_num, scrb_cl_cd, term_cl_cd, tfmly_nh39_scrb_yn, tfmly_nh39_scrb_dt, tfmly_nh39_term_dt, mng_nice_cb_scr, mng_nice_cb_grd, mng_ccrm_scr, mng_ccrm_grd, mng_ccbm_scr, mng_ccbm_grd, mng_recr_scr, mng_ccrm_as_grd, mng_ccrm_cb_grd, mng_ccbm_as_grd, mng_ccbm_ceo_cb_grd, google_dcb_cnt, google_dcb_amt, asgn_svc_num...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d4"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d5"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764739202982_181479704",
      "id": "paragraph_1764739202982_181479704",
      "dateCreated": "2025-12-03 05:20:02.982",
      "dateStarted": "2025-12-17 02:00:01.894",
      "dateFinished": "2025-12-17 02:00:11.915",
      "status": "FINISHED"
    },
    {
      "text": "val predictionDTSta \u003d \"20251101\"\nval predictionDTEnd \u003d \"20251201\"\n\n\nval resDFSelected \u003d resDFFiltered\n    .withColumn(\"feature_ym\", F.date_format(F.add_months(F.unix_timestamp($\"send_dt\", \"yyyyMMdd\").cast(TimestampType), -1), \"yyyyMM\").cast(StringType))\n    .selectExpr(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"send_daynum\", \"send_hournum send_hournum_cd\", \"click_yn\", \"res_utility\")\n    .dropDuplicates(\"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_hournum_cd\", \"click_yn\")\n    // .cache()\n\nval resDFSelectedTr \u003d resDFSelected.filter(s\"send_dt\u003c$predictionDTSta\")\n// .groupBy(\"svc_mgmt_num\",\"send_ym\",\"feature_ym\").agg(F.sum(\"click_yn\").alias(\"click_yn\"))\n// .withColumn(\"click_yn\", F.expr(\"case when click_yn\u003e0 then 1 else 0 end\"))\n//.cache()\n\nvar resDFSelectedTs \u003d resDFSelected.filter(s\"send_dt\u003e\u003d$predictionDTSta and send_dt\u003c$predictionDTEnd\")\n    .selectExpr(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"send_hournum_cd\", \"click_yn\", \"res_utility\")\n    // .cache()\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:12.002",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredictionDTSta\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 20251101\n\u001b[1m\u001b[34mpredictionDTEnd\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 20251201\n\u001b[1m\u001b[34mresDFSelected\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 9 more fields]\n\u001b[1m\u001b[34mresDFSelectedTr\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 9 more fields]\n\u001b[1m\u001b[34mresDFSelectedTs\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764739017819_1458690185",
      "id": "paragraph_1764739017819_1458690185",
      "dateCreated": "2025-12-03 05:16:57.819",
      "dateStarted": "2025-12-17 02:00:12.073",
      "dateFinished": "2025-12-17 02:00:12.448",
      "status": "FINISHED"
    },
    {
      "text": "val samplingKeyCols \u003d Array(\"chnl_typ\",\"cmpgn_typ\",\"send_daynum\",\"send_hournum_cd\",\"click_yn\")\n// val samplingKeyCols \u003d Array(\"send_ym\", \"feature_ym\", \"click_yn\")\n\nval genSampleNumMulti \u003d 3.0\n\nval samplingRatioMapDF \u003d {\n  resDFSelectedTr\n    .sample(0.3)\n    .groupBy(samplingKeyCols.map(F.col(_)):_*).agg(F.count(\"*\").alias(\"cnt\"))\n    .withColumn(\"min_cnt\", F.min(\"cnt\").over(Window.partitionBy(samplingKeyCols.filter(_!\u003d\"click_yn\").map(F.col(_)):_*)))\n    .withColumn(\"ratio\", F.col(\"min_cnt\") / F.col(\"cnt\"))\n    .withColumn(\"sampling_col\", F.expr(s\"\"\"concat_ws(\u0027-\u0027, ${samplingKeyCols.mkString(\",\")})\"\"\"))\n    .selectExpr(\"sampling_col\", s\"least(1.0, ratio*${genSampleNumMulti}) ratio\")\n    .sort(\"sampling_col\")\n    // .cache()\n}\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:12.473",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34msamplingKeyCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(chnl_typ, cmpgn_typ, send_daynum, send_hournum_cd, click_yn)\n\u001b[1m\u001b[34mgenSampleNumMulti\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m \u003d 3.0\n\u001b[1m\u001b[34msamplingRatioMapDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [sampling_col: string, ratio: double]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764738582669_1614068999",
      "id": "paragraph_1764738582669_1614068999",
      "dateCreated": "2025-12-03 05:09:42.669",
      "dateStarted": "2025-12-17 02:00:12.587",
      "dateFinished": "2025-12-17 02:00:12.906",
      "status": "FINISHED"
    },
    {
      "text": "var resDFSelectedTrBal \u003d resDFSelectedTr\n    .withColumn(\"sampling_col\", F.expr(s\"\"\"concat_ws(\u0027-\u0027, ${samplingKeyCols.mkString(\",\")})\"\"\"))\n    .join(F.broadcast(samplingRatioMapDF), \"sampling_col\")\n    .withColumn(\"rand\", F.rand())\n    .filter(\"rand\u003c\u003dratio\")\n    // .drop(\"sampling_col\",\"rand\",\"ratio\")\n    // .withColumn(\"feature_ym\", F.date_format(F.add_months(F.unix_timestamp($\"send_dt\", \"yyyyMMdd\").cast(TimestampType), -1), \"yyyyMM\").cast(StringType))\n    // .selectExpr(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"send_hournum\", \"click_yn\")\n    // .cache()\n\n// resDFSelectedTrBal.groupBy(\"click_yn\").count().sort(\"click_yn\").show()\n// resDFSelectedTs.groupBy(\"click_yn\").count().show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:12.987",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mresDFSelectedTrBal\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [sampling_col: string, cmpgn_num: string ... 12 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764756027560_85739584",
      "id": "paragraph_1764756027560_85739584",
      "dateCreated": "2025-12-03 10:00:27.560",
      "dateStarted": "2025-12-17 02:00:13.056",
      "dateFinished": "2025-12-17 02:00:13.274",
      "status": "FINISHED"
    },
    {
      "text": "\nval trainDF \u003d resDFSelectedTrBal.join(mmktDF,Seq(\"svc_mgmt_num\",\"feature_ym\"))\nval testDF \u003d resDFSelectedTs.join(mmktDF,Seq(\"svc_mgmt_num\",\"feature_ym\"))",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:13.356",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtrainDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [svc_mgmt_num: string, feature_ym: string ... 123 more fields]\n\u001b[1m\u001b[34mtestDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [svc_mgmt_num: string, feature_ym: string ... 119 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764755002817_1620624445",
      "id": "paragraph_1764755002817_1620624445",
      "dateCreated": "2025-12-03 09:43:22.818",
      "dateStarted": "2025-12-17 02:00:13.425",
      "dateFinished": "2025-12-17 02:00:13.619",
      "status": "FINISHED"
    },
    {
      "text": "val noFeatureCols \u003d Array(\"click_yn\")\r\n\r\n\r\nval tokenCols \u003d trainDF.columns.filter(x \u003d\u003e x.endsWith(\"_token\")).distinct\r\nval continuousCols \u003d (trainDF.columns.filter(x \u003d\u003e numericColNameList.map(x.endsWith(_)).reduceOption(_ || _).getOrElse(false)).distinct.filter(x \u003d\u003e !tokenCols.contains(x) \u0026\u0026 !noFeatureCols.contains(x))).distinct\r\nval categoryCols \u003d (trainDF.columns.filter(x \u003d\u003e categoryColNameList.map(x.endsWith(_)).reduceOption(_ || _).getOrElse(false)).distinct.filter(x \u003d\u003e !tokenCols.contains(x) \u0026\u0026 !noFeatureCols.contains(x) \u0026\u0026 !continuousCols.contains(x))).distinct\r\nval vectorCols \u003d trainDF.columns.filter(x \u003d\u003e x.endsWith(\"_vec\"))\r\n\r\nval trainDFRev \u003d trainDF.select(\r\n        // (Array(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"click_yn\").map(F.col(_))\r\n        (Array(\"svc_mgmt_num\", \"send_ym\", \"feature_ym\", \"click_yn\", \"res_utility\").map(F.col(_))\r\n        ++ tokenCols.map(cl \u003d\u003e F.coalesce(F.col(cl), F.array(F.lit(\"#\"))).alias(cl))\r\n        ++ vectorCols.map(cl \u003d\u003e F.col(cl).alias(cl))\r\n        ++ categoryCols.map(cl \u003d\u003e F.when(F.col(cl) \u003d\u003d\u003d \"\", F.lit(\"UKV\")).otherwise(F.coalesce(F.col(cl).cast(\"string\"), F.lit(\"UKV\"))).alias(cl))\r\n        ++ continuousCols.map(cl \u003d\u003e F.coalesce(F.col(cl).cast(\"float\"), F.lit(Double.NaN)).alias(cl))\r\n        ).distinct\r\n        : _*)\r\n        //.cache()\r\n\r\nval testDFRev \u003d testDF.select(\r\n        (Array(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"click_yn\", \"res_utility\").map(F.col(_))\r\n        ++ tokenCols.map(cl \u003d\u003e F.coalesce(F.col(cl), F.array(F.lit(\"#\"))).alias(cl))\r\n        ++ vectorCols.map(cl \u003d\u003e F.col(cl).alias(cl))\r\n        ++ categoryCols.map(cl \u003d\u003e F.when(F.col(cl) \u003d\u003d\u003d \"\", F.lit(\"UKV\")).otherwise(F.coalesce(F.col(cl).cast(\"string\"), F.lit(\"UKV\"))).alias(cl))\r\n        ++ continuousCols.map(cl \u003d\u003e F.coalesce(F.col(cl).cast(\"float\"), F.lit(Double.NaN)).alias(cl))\r\n        ).distinct\r\n        : _*)\r\n        //.cache()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:13.625",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mnoFeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(click_yn)\n\u001b[1m\u001b[34mtokenCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array()\n\u001b[1m\u001b[34mcontinuousCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(equip_chg_cnt, rten_pen_amt, agrmt_brch_amt, allot_mth_cnt, mbr_use_cnt, mbr_use_amt, tyr_mbr_use_cnt, tyr_mbr_use_amt, mth_cnsl_cnt, dsat_cnsl_cnt, simpl_ref_cnsl_cnt, bf_m1_arpu, voc_arpu, bf_m3_avg_arpu, prcpln_chg_cnt, copn_use_psbl_cnt, equip_chg_mth_cnt, dom_tot_pckt_cnt, voc_base_arpu, pmth_pen_amt, m3_cnst_iocall_voice_line_cnt, tworld_visit_cnt, sale_amt, ym_age, use_mbl_phon_svc_cnt, bf_m4_arpu, ref_dat_rcv_pkt_cnt, allot_prn_amt, voice_arpu, bf_m5_arpu, voc_etc_arpu, fst_eqp_amt, bf_m3_avg_inv_amt, bf_m6_avg_inv_amt, data_call_arpu, sms_arpu, disp_phon_arpu, data_arpu, gift_rcv_pkt...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764832142136_413314670",
      "id": "paragraph_1764832142136_413314670",
      "dateCreated": "2025-12-04 07:09:02.136",
      "dateStarted": "2025-12-17 02:00:13.760",
      "dateFinished": "2025-12-17 02:00:14.667",
      "status": "FINISHED"
    },
    {
      "text": "val predDT \u003d \"20251201\"\nval predFeatureYM \u003d getPreviousMonths(predDT.take(6), 2)(0)\nval predSendYM \u003d predDT.take(6)\nval predDF \u003d mmktDF.filter(s\"strd_ym\u003d\u003d\u0027${predFeatureYM}\u0027\")\n            .withColumn(\"feature_ym\", F.col(\"strd_ym\"))\n            .withColumn(\"send_ym\", F.expr(predSendYM))\n            .withColumn(\"send_dt\", F.expr(predDT))\n            .withColumn(\"cmpgn_num\", F.expr(\"\u0027#\u0027\"))\n            .withColumn(\"cmpgn_typ\", F.expr(\"\u0027#\u0027\"))\n            .withColumn(\"chnl_typ\", F.expr(\"\u0027#\u0027\"))\n            .withColumn(\"click_yn\", F.expr(\"0\"))\n            .withColumn(\"res_utility\", F.expr(\"0.0\"))\n            .withColumn(\"send_hournum_cd\", F.explode(F.expr(s\"array(${(startHour to endHour).toArray.mkString(\",\")})\")))\n\nval predDFRev \u003d predDF.select(\n        (Array(\"cmpgn_num\", \"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_dt\", \"feature_ym\", \"click_yn\", \"res_utility\").map(F.col(_))\n        ++ tokenCols.map(cl \u003d\u003e F.coalesce(F.col(cl), F.array(F.lit(\"#\"))).alias(cl))\n        ++ vectorCols.map(cl \u003d\u003e F.col(cl).alias(cl))\n        ++ categoryCols.map(cl \u003d\u003e F.when(F.col(cl) \u003d\u003d\u003d \"\", F.lit(\"UKV\")).otherwise(F.coalesce(F.col(cl).cast(\"string\"), F.lit(\"UKV\"))).alias(cl))\n        ++ continuousCols.map(cl \u003d\u003e F.coalesce(F.col(cl).cast(\"float\"), F.lit(Double.NaN)).alias(cl))\n        ).distinct\n        : _*)\n        //.cache()\n        ",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:14.761",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredDT\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 20251201\n\u001b[1m\u001b[34mpredFeatureYM\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 202511\n\u001b[1m\u001b[34mpredSendYM\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 202512\n\u001b[1m\u001b[34mpredDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [fee_prod_id: string, svc_mgmt_num: string ... 119 more fields]\n\u001b[1m\u001b[34mpredDFRev\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 102 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765765120629_645290475",
      "id": "paragraph_1765765120629_645290475",
      "dateCreated": "2025-12-15 02:18:40.629",
      "dateStarted": "2025-12-17 02:00:14.829",
      "dateFinished": "2025-12-17 02:00:15.317",
      "status": "FINISHED"
    },
    {
      "text": "\ndef makePipeline(\n        labelCol: String, \n        indexedLabelCol: String, \n        indexedFeatureCol: String, \n        scaledFeatureCol: String, \n        selectedFeatureCol: String,\n        tokenCols:Array[String], \n        vectorCols:Array[String], \n        continuousCols:Array[String], \n        categoryCols:Array[String],\n        doNotHashingCateCols: Array[String],\n        doNotHashingContCols: Array[String],\n        useSelector:Boolean \u003d false,\n        useScaling:Boolean \u003d false,\n        tokenColsEmbStr:String \u003d \"#\",\n        featureHasherNumFeature:Int \u003d 256,\n        params:Map[String, Any]\n    ) \u003d {\n        \n    val minDF \u003d params.get(\"minDF\").getOrElse(1).asInstanceOf[Int]\n    val minTF \u003d params.get(\"minTF\").getOrElse(5).asInstanceOf[Int]\n    val embSize \u003d params.get(\"embSize\").getOrElse(10).asInstanceOf[Int]\n    val vocabSize \u003d params.get(\"vocabSize\").getOrElse(30).asInstanceOf[Int]\n    val numParts \u003d params.get(\"numParts\").getOrElse(10).asInstanceOf[Int]\n\n    var featureListForAssembler \u003d continuousCols ++ vectorCols\n    \n    import org.apache.spark.ml.{Pipeline, PipelineStage}\n    val transformPipeline \u003d new Pipeline().setStages(Array[PipelineStage]())//\n    \n    if (labelCol!\u003d\"\"){\n        transformPipeline.setStages(Array(new StringIndexer().setInputCol(labelCol).setOutputCol(indexedLabelCol).setHandleInvalid(\"skip\")))\n    }\n    \n    val tokenColsEmb \u003d tokenCols.filter(x \u003d\u003e tokenColsEmbStr.split(\",\").map(x.contains(_)).reduceOption(_ || _).getOrElse(false))\n    val tokenColsCnt \u003d tokenCols.filter(!tokenColsEmb.contains(_))\n    \n    if (embSize \u003e 0 \u0026\u0026 tokenColsEmb.size \u003e 0) {\n      val embEncoder \u003d tokenColsEmb.map(c \u003d\u003e new Word2Vec().setNumPartitions(numParts).setSeed(46).setVectorSize(embSize).setMinCount(minTF).setInputCol(c).setOutputCol(c + \"_embvec\"))\n      transformPipeline.setStages(if(transformPipeline.getStages.isEmpty){embEncoder}else{transformPipeline.getStages++embEncoder})\n      featureListForAssembler ++\u003d tokenColsEmb.map(_ + \"_embvec\")\n    }\n    \n    if (tokenColsCnt.size \u003e 0) {\n      val cntVerctorizer \u003d tokenColsCnt.map(c \u003d\u003e new HashingTF().setInputCol(c).setOutputCol(c + \"_cntvec\").setNumFeatures(vocabSize))\n      transformPipeline.setStages(if(transformPipeline.getStages.isEmpty){cntVerctorizer\n      }else{transformPipeline.getStages++cntVerctorizer\n      })\n      featureListForAssembler ++\u003d tokenColsCnt.map(_ + \"_cntvec\")\n      \n    }\n    \n    if (featureHasherNumFeature \u003e 0 \u0026\u0026 categoryCols.size \u003e 0) {\n        \n      val featureHasher \u003d new FeatureHasher().setNumFeatures(featureHasherNumFeature)\n      .setInputCols((continuousCols++categoryCols)\n      .filter(c \u003d\u003e !doNotHashingContCols.contains(c))\n      .filter(c \u003d\u003e !doNotHashingCateCols.contains(c))\n      ).setOutputCol(\"feature_hashed\")\n      \n    \n      transformPipeline.setStages(if(transformPipeline.getStages.isEmpty){Array(featureHasher)}else{transformPipeline.getStages++Array(featureHasher)})\n      featureListForAssembler \u003d featureListForAssembler.filter(!continuousCols.contains(_))\n      featureListForAssembler ++\u003d Array(\"feature_hashed\")\n    \n      if (doNotHashingCateCols.size\u003e0) {\n          val catetoryIndexerList \u003d doNotHashingCateCols.map(c \u003d\u003e new StringIndexer().setInputCol(c).setOutputCol(c + \"_index\").setHandleInvalid(\"keep\"))\n          val encoder \u003d new OneHotEncoder().setInputCols(doNotHashingCateCols.map(c \u003d\u003e c + \"_index\")).setOutputCols(doNotHashingCateCols.map(c \u003d\u003e c + \"_enc\")).setHandleInvalid(\"keep\")\n          transformPipeline.setStages(if(transformPipeline.getStages.isEmpty){catetoryIndexerList ++ Array(encoder)}else{transformPipeline.getStages++catetoryIndexerList ++ Array(encoder)})\n          featureListForAssembler ++\u003d doNotHashingCateCols.map(_ + \"_enc\")\n      }\n      \n      if (doNotHashingContCols.size\u003e0){\n          featureListForAssembler ++\u003d doNotHashingContCols\n      }\n      \n    } else if (featureHasherNumFeature \u003c 1 \u0026\u0026 categoryCols.size \u003e 0) {\n      val catetoryIndexerList \u003d categoryCols.map(c \u003d\u003e new StringIndexer().setInputCol(c).setOutputCol(c + \"_index\").setHandleInvalid(\"keep\"))\n      val encoder \u003d new OneHotEncoder().setInputCols(categoryCols.map(c \u003d\u003e c + \"_index\")).setOutputCols(categoryCols.map(c \u003d\u003e c + \"_enc\")).setHandleInvalid(\"keep\")\n      transformPipeline.setStages(if(transformPipeline.getStages.isEmpty){catetoryIndexerList ++ Array(encoder)}else{transformPipeline.getStages++catetoryIndexerList ++ Array(encoder)})\n      featureListForAssembler ++\u003d categoryCols.map(_ + \"_enc\")\n    }\n    \n    val assembler \u003d new VectorAssembler().setInputCols(featureListForAssembler).setOutputCol(indexedFeatureCol).setHandleInvalid(\"keep\")\n    \n    transformPipeline.setStages(transformPipeline.getStages++Array(assembler))\n     \n    if(useSelector){\n        val selector \u003d new VarianceThresholdSelector().setVarianceThreshold(8.0).setFeaturesCol(indexedFeatureCol).setOutputCol(selectedFeatureCol)\n        transformPipeline.setStages(transformPipeline.getStages++Array(selector))\n    }\n    \n    if(useScaling){\n        val inputFeautreCol \u003d if(useSelector){selectedFeatureCol}else{indexedFeatureCol}\n        val scaler \u003d new MinMaxScaler().setInputCol(inputFeautreCol).setOutputCol(scaledFeatureCol)\n      transformPipeline.setStages(transformPipeline.getStages++Array(scaler))\n    }\n    \n    transformPipeline\n}\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:15.329",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mmakePipeline\u001b[0m: \u001b[1m\u001b[32m(labelCol: String, indexedLabelCol: String, indexedFeatureCol: String, scaledFeatureCol: String, selectedFeatureCol: String, tokenCols: Array[String], vectorCols: Array[String], continuousCols: Array[String], categoryCols: Array[String], doNotHashingCateCols: Array[String], doNotHashingContCols: Array[String], useSelector: Boolean, useScaling: Boolean, tokenColsEmbStr: String, featureHasherNumFeature: Int, params: Map[String,Any])org.apache.spark.ml.Pipeline\u001b[0m\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765330122144_909170709",
      "id": "paragraph_1765330122144_909170709",
      "dateCreated": "2025-12-10 01:28:42.144",
      "dateStarted": "2025-12-17 02:00:15.457",
      "dateFinished": "2025-12-17 02:00:16.327",
      "status": "FINISHED"
    },
    {
      "text": "\nval tokenColsEmbStr \u003d \"#\"\nval featureHasherNumFeature \u003d 128\n\nvar nodeNumber \u003d 10\nvar coreNumber \u003d 32\ntry {\n  nodeNumber \u003d spark.conf.get(\"spark.executor.instances\").toInt\n  coreNumber \u003d spark.conf.get(\"spark.executor.cores\").toInt\n} catch {\n  case ex: Exception \u003d\u003e {}\n}\n\nval params:Map[String, Any] \u003d Map(\"minDF\"-\u003e1,\"minTF\"-\u003e5,\"embSize\"-\u003e10,\"vocabSize\"-\u003e30, \"numParts\"-\u003enodeNumber)\n\nval labelCol \u003d \"click_yn\"\nval indexedLabelColCls \u003d \"indexedLabelCls\"\nval indexedLabelColReg \u003d \"res_utility\"\nval indexedFeatureCol \u003d \"indexedFeatures\"\nval scaledFeatureCol \u003d \"scaledFeatures\"\nval selectedFeatureCol \u003d \"selectedFeatures\"\n\n// val tokenCols \u003d tokenCols\n// val vectorCols \u003d vectorCols\n// val continuousCols \u003d continuousCols\n// val categoryCols \u003d categoryCols\n\nval doNotHashingCateCols \u003d Array[String](\"send_hournum_cd\")\nval doNotHashingContCols \u003d Array[String]()\n\nval transformPipeline \u003d makePipeline(\n    labelCol, \n    indexedLabelColCls, \n    indexedFeatureCol, \n    scaledFeatureCol,\n    selectedFeatureCol,\n    tokenCols, \n    vectorCols, \n    continuousCols, \n    categoryCols,\n    doNotHashingCateCols,\n    doNotHashingContCols,\n    params \u003d params,\n    useSelector \u003d false,\n    featureHasherNumFeature \u003d featureHasherNumFeature\n)\n\n// val transformer \u003d transformPipeline.fit(trainDFRev.sample(0.3))\n// val transformedTrainDF \u003d transformer.transform(trainDFRev).cache()\n// val transformedTestDF \u003d transformer.transform(testDFRev).cache()\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:00:16.357",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtokenColsEmbStr\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d #\n\u001b[1m\u001b[34mfeatureHasherNumFeature\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 128\n\u001b[1m\u001b[34mnodeNumber\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 100\n\u001b[1m\u001b[34mcoreNumber\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 4\n\u001b[1m\u001b[34mparams\u001b[0m: \u001b[1m\u001b[32mMap[String,Any]\u001b[0m \u003d Map(embSize -\u003e 10, numParts -\u003e 100, vocabSize -\u003e 30, minTF -\u003e 5, minDF -\u003e 1)\n\u001b[1m\u001b[34mlabelCol\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d click_yn\n\u001b[1m\u001b[34mindexedLabelColCls\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d indexedLabelCls\n\u001b[1m\u001b[34mindexedLabelColReg\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d res_utility\n\u001b[1m\u001b[34mindexedFeatureCol\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d indexedFeatures\n\u001b[1m\u001b[34mscaledFeatureCol\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d scaledFeatures\n\u001b[1m\u001b[34mselectedFeatureCol\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d selectedFeatures\n\u001b[1m\u001b[34mdoNotHashingCateCols\u001b[0m: \u001b[1m\u001b[32mArray[String]...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764833771372_1110341451",
      "id": "paragraph_1764833771372_1110341451",
      "dateCreated": "2025-12-04 07:36:11.373",
      "dateStarted": "2025-12-17 02:00:16.468",
      "dateFinished": "2025-12-17 02:00:16.943",
      "status": "FINISHED"
    },
    {
      "title": "Transformer Saving",
      "text": "transformer.write.overwrite().save(\"aos/sto/transformPipeline\")\n\ntransformedTrainDF.write.mode(\"overwrite\").partitionBy(\"send_ym\").parquet(\"aos/sto/transformedTrainDF\")\ntransformedTestDF.write.mode(\"overwrite\").partitionBy(\"send_ym\").parquet(\"aos/sto/transformedTestDF\")",
      "user": "anonymous",
      "dateUpdated": "2025-12-16 23:44:59.516",
      "progress": 83,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765520460775_2098641576",
      "id": "paragraph_1765520460775_2098641576",
      "dateCreated": "2025-12-12 06:21:00.775",
      "dateStarted": "2025-12-15 02:17:24.142",
      "dateFinished": "2025-12-15 02:39:44.302",
      "status": "FINISHED"
    },
    {
      "title": "Transformer Loading",
      "text": "val transformer \u003d PipelineModel.load(\"aos/sto/transformPipeline\")\r\nval transformedTrainDF \u003d spark.read.parquet(\"aos/sto/transformedTrainDF\").cache()\r\nval transformedTestDF \u003d spark.read.parquet(\"aos/sto/transformedTestDF\").cache()\r\n\r\nval transformedPredDF \u003d transformer.transform(predDFRev).cache()\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 02:02:45.735",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtransformer\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m \u003d pipeline_a0951b72df02\n\u001b[1m\u001b[34mtransformedTrainDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [svc_mgmt_num: string, feature_ym: string ... 103 more fields]\n\u001b[1m\u001b[34mtransformedTestDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 107 more fields]\n\u001b[1m\u001b[34mtransformedPredDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 107 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d6"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d7"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d8"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d9"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d10"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d11"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d12"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d13"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d14"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d15"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d16"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d17"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d18"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d19"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d20"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d21"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d22"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d23"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d24"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765521446308_1651058139",
      "id": "paragraph_1765521446308_1651058139",
      "dateCreated": "2025-12-12 06:37:26.308",
      "dateStarted": "2025-12-17 02:02:45.832",
      "dateFinished": "2025-12-17 02:03:17.216",
      "status": "FINISHED"
    },
    {
      "text": "val labelIndexer: Option[StringIndexerModel] \u003d transformer.stages.collectFirst {\r\n  case sim: StringIndexerModel \u003d\u003e sim\r\n}\r\n\r\nlabelIndexer.get.labelsArray(0)",
      "user": "anonymous",
      "dateUpdated": "2025-12-16 23:46:10.228",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mlabelIndexer\u001b[0m: \u001b[1m\u001b[32mOption[org.apache.spark.ml.feature.StringIndexerModel]\u001b[0m \u003d Some(StringIndexerModel: uid\u003dstrIdx_8330f538cf13, handleInvalid\u003dskip)\n\u001b[1m\u001b[34mres2\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(0, 1)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765445117259_700668975",
      "id": "paragraph_1765445117259_700668975",
      "dateCreated": "2025-12-11 09:25:17.260",
      "dateStarted": "2025-12-16 23:46:10.320",
      "dateFinished": "2025-12-16 23:46:10.654",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.ml.classification._\r\nimport org.apache.spark.ml.regression._\r\n\r\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\r\nimport org.apache.spark.ml.feature.StringIndexerModel\r\n\r\nval labelIndexer: Option[StringIndexerModel] \u003d transformer.stages.collectFirst {\r\n  case sim: StringIndexerModel \u003d\u003e sim\r\n}\r\n\r\nval featureColName \u003d indexedFeatureCol//selectedFeatureCol\r\n\r\nval gbtc \u003d new GBTClassifier()\r\n  .setLabelCol(indexedLabelColCls)\r\n  .setFeaturesCol(featureColName)\r\n  .setMaxIter(100)\r\n//   .setMaxDepth(4)\r\n  .setFeatureSubsetStrategy(\"auto\")\r\n//   .setWeightCol(\"sample_weight\")\r\n    .setPredictionCol(\"pred_gbtc\")\r\n  .setProbabilityCol(\"prob_gbtc\")\r\n  .setRawPredictionCol(\"pred_raw_gbtc\")\r\n  \r\nval fmc \u003d new FMClassifier()\r\n    .setLabelCol(indexedLabelColCls)\r\n    .setFeaturesCol(featureColName)\r\n    .setStepSize(0.01)\r\n    .setPredictionCol(\"pred_fmc\")\r\n    .setProbabilityCol(\"prob_fmc\")\r\n    .setRawPredictionCol(\"pred_raw_fmc\")\r\n\r\nval xgbParamC \u003d Map(\r\n  \"eta\" -\u003e 0.01,\r\n  \"max_depth\" -\u003e 6,\r\n  \"objective\" -\u003e \"binary:logistic\",\r\n  \"num_round\" -\u003e 100,\r\n  \"num_workers\" -\u003e 10,\r\n//   \"num_early_stopping_rounds\" -\u003e 10,  // early stopping\r\n//   \"maximize_evaluation_metrics\" -\u003e true,  // loss 기준이면 false\r\n  \"eval_metric\" -\u003e \"error\",\r\n//   \"scale_pos_weight\" -\u003e 1.0\r\n)\r\n\r\nval xgbc \u003d {\r\n  new XGBoostClassifier(xgbParamC)\r\n    .setFeaturesCol(featureColName)\r\n    .setLabelCol(indexedLabelColCls)\r\n    .setMissing(0)\r\n    .setSeed(0)\r\n    // .setWeightCol(\"sample_weight\")\r\n    .setProbabilityCol(\"prob_xgbc\")\r\n    .setPredictionCol(\"pred_xgbc\")\r\n      .setRawPredictionCol(\"pred_raw_xgbc\")\r\n    // .setThresholds(Array(0.4, 0.6))\r\n    // .setEvalSets(Map(\"validation\" -\u003e valData))\r\n}\r\n\r\nval gbtr \u003d new GBTRegressor()\r\n  .setLabelCol(indexedLabelColReg)\r\n  .setFeaturesCol(featureColName)\r\n  .setMaxIter(100)\r\n//   .setMaxDepth(4)\r\n  .setFeatureSubsetStrategy(\"auto\")\r\n//   .setWeightCol(\"sample_weight\")\r\n    .setPredictionCol(\"pred_gbtr\")\r\n\r\nval fmr \u003d new FMRegressor()\r\n    .setLabelCol(indexedLabelColReg)\r\n    .setFeaturesCol(featureColName)\r\n    .setStepSize(0.01)\r\n    .setPredictionCol(\"pred_fmr\")\r\n\r\nval xgbParamR \u003d Map(\r\n  \"eta\" -\u003e 0.01,\r\n  \"max_depth\" -\u003e 6,\r\n  \"objective\" -\u003e \"reg:squarederror\",\r\n  \"num_round\" -\u003e 100,\r\n  \"num_workers\" -\u003e 10,\r\n//   \"num_early_stopping_rounds\" -\u003e 10,  // early stopping\r\n//   \"maximize_evaluation_metrics\" -\u003e true,  // loss 기준이면 false\r\n  \"eval_metric\" -\u003e \"rmse\",\r\n//   \"scale_pos_weight\" -\u003e 1.0\r\n)\r\n\r\nval xgbr \u003d {\r\n  new XGBoostRegressor(xgbParamR)\r\n    .setFeaturesCol(featureColName)\r\n    .setLabelCol(indexedLabelColReg)\r\n    .setMissing(0)\r\n    .setSeed(0)\r\n    // .setWeightCol(\"sample_weight\")\r\n    .setPredictionCol(\"pred_xgbr\")\r\n    // .setThresholds(Array(0.4, 0.6))\r\n    // .setEvalSets(Map(\"validation\" -\u003e valData))\r\n}\r\n\r\nval labelConverter \u003d new IndexToString()\r\n  .setInputCol(\"prediction_cls\")\r\n  .setOutputCol(\"predictedLabel\")\r\n  .setLabels(labelIndexer.get.labelsArray(0))\r\n\r\nval Array(trainData, valData) \u003d transformedTrainDF.randomSplit(Array(0.8, 0.2), seed \u003d 42)\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-16 23:46:10.720",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.classification._\nimport org.apache.spark.ml.regression._\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.feature.StringIndexerModel\n\u001b[1m\u001b[34mlabelIndexer\u001b[0m: \u001b[1m\u001b[32mOption[org.apache.spark.ml.feature.StringIndexerModel]\u001b[0m \u003d Some(StringIndexerModel: uid\u003dstrIdx_8330f538cf13, handleInvalid\u003dskip)\n\u001b[1m\u001b[34mfeatureColName\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d indexedFeatures\n\u001b[1m\u001b[34mgbtc\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.GBTClassifier\u001b[0m \u003d gbtc_741d1b3c5feb\n\u001b[1m\u001b[34mfmc\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.FMClassifier\u001b[0m \u003d fmc_f78a0521a97b\n\u001b[1m\u001b[34mxgbParamC\u001b[0m: \u001b[1m\u001b[32mscala.collection.immutable.Map[String,Any]\u001b[0m \u003d Map(num_workers -\u003e 10, max_depth -\u003e 6, objective -\u003e binary:logistic, eva...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764836200898_700489598",
      "id": "paragraph_1764836200898_700489598",
      "dateCreated": "2025-12-04 08:16:40.898",
      "dateStarted": "2025-12-16 23:46:10.788",
      "dateFinished": "2025-12-16 23:46:11.352",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.ml.param.ParamMap\r\nprintln(gbtc.explainParams())\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-16 23:46:11.389",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "cacheNodeIds: If false, the algorithm will pass trees to executors to match instances with nodes. If true, the algorithm will cache node IDs for each instance. Caching can speed up training of deeper trees. (default: false)\ncheckpointInterval: set checkpoint interval (\u003e\u003d 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations. Note: this setting will be ignored if the checkpoint directory is not set in the SparkContext (default: 10)\nfeatureSubsetStrategy: The number of features to consider for splits at each tree node. Supported options: auto, all, onethird, sqrt, log2, (0.0-1.0], [1-n]. (default: all, current: auto)\nfeaturesCol: features column name (default: features, current: indexedFeatures)\nimpurity: Criterion used for information gain calculation (case-insensitive). Supported options: variance (default: variance)\nlabelCol: label column name (default: label, current: indexedLabelCls)\nleafCol: Leaf indices column name. Predicted leaf index of each instance in each tree by preorder (default: )\nlossType: Loss function which GBT tries to minimize (case-insensitive). Supported options: logistic (default: logistic)\nmaxBins: Max number of bins for discretizing continuous features.  Must be at least 2 and at least number of categories for any categorical feature. (default: 32)\nmaxDepth: Maximum depth of the tree. (Nonnegative) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes. (default: 5)\nmaxIter: maximum number of iterations (\u003e\u003d 0) (default: 20, current: 100)\nmaxMemoryInMB: Maximum memory in MB allocated to histogram aggregation. (default: 256)\nminInfoGain: Minimum information gain for a split to be considered at a tree node. (default: 0.0)\nminInstancesPerNode: Minimum number of instances each child must have after split.  If a split causes the left or right child to have fewer than minInstancesPerNode, the split will be discarded as invalid. Must be at least 1. (default: 1)\nminWeightFractionPerNode: Minimum fraction of the weighted sample count that each child must have after split. If a split causes the fraction of the total weight in the left or right child to be less than minWeightFractionPerNode, the split will be discarded as invalid. Should be in interval [0.0, 0.5) (default: 0.0)\npredictionCol: prediction column name (default: prediction, current: pred_gbtc)\nprobabilityCol: Column name for predicted class conditional probabilities. Note: Not all models output well-calibrated probability estimates! These probabilities should be treated as confidences, not precise probabilities (default: probability, current: prob_gbtc)\nrawPredictionCol: raw prediction (a.k.a. confidence) column name (default: rawPrediction, current: pred_raw_gbtc)\nseed: random seed (default: -1287390502)\nstepSize: Step size (a.k.a. learning rate) in interval (0, 1] for shrinking the contribution of each estimator. (default: 0.1)\nsubsamplingRate: Fraction of the training data used for learning each decision tree, in range (0, 1]. (default: 1.0)\nthresholds: Thresholds in multi-class classification to adjust the probability of predicting each class. Array must have length equal to the number of classes, with values \u003e 0 excepting that at most one value may be 0. The class with largest value p/t is predicted, where p is the original probability of that class and t is the class\u0027s threshold (undefined)\nvalidationIndicatorCol: name of the column that indicates whether each row is for training or for validation. False indicates training; true indicates validation. (undefined)\nvalidationTol: Threshold for stopping early when fit with validation is used.If the error rate on the validation input changes by less than the validationTol,then learning will stop early (before `maxIter`).This parameter is ignored when fit without validation is used. (default: 0.01)\nweightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0 (undefined)\nimport org.apache.spark.ml.param.ParamMap\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765841941095_360008212",
      "id": "paragraph_1765841941095_360008212",
      "dateCreated": "2025-12-15 23:39:01.095",
      "dateStarted": "2025-12-16 23:46:11.484",
      "dateFinished": "2025-12-16 23:46:11.681",
      "status": "FINISHED"
    },
    {
      "text": "\r\nimport org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\r\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\r\n\r\nval modelforCV \u003d gbtc\r\n\r\n// val paramGridXGB \u003d new ParamGridBuilder()\r\n//         .addGrid(xgbc.maxDepth, Array(6))\r\n//         .addGrid(xgbc.numRound, Array(100))\r\n//         .addGrid(xgbc.eta, Array(0.1))\r\n//         // .addGrid(xgbc.scalePosWeight, Array(3.0))\r\n//         .build()\r\n\r\n// val paramGridGBT \u003d new ParamGridBuilder()\r\n//         .addGrid(gbtc.maxDepth, Array(5))\r\n//         .addGrid(gbtc.maxIter, Array(100))\r\n//         .addGrid(gbtc.stepSize, Array(0.1))\r\n//         .build()\r\n\r\n// val paramGrid \u003d if(modelforCV.uid.startsWith(\"xgb\")){\r\n//     paramGridXGB\r\n// }else{\r\n//     paramGridGBT\r\n// }\r\n\r\n// val pipelineMLCls \u003d new CrossValidator()\r\n//   .setEstimator(new Pipeline().setStages(Array(modelforCV)))\r\n//   .setEvaluator(new BinaryClassificationEvaluator().setLabelCol(modelforCV.getLabelCol).setRawPredictionCol(modelforCV.getPredictionCol))\r\n//   .setEstimatorParamMaps(paramGrid)\r\n//   .setNumFolds(3)  // Use 3+ in practice\r\n//   .setParallelism(6)  // Evaluate up to 2 parameter settings in parallel\r\n  \r\nval pipelineMLCls \u003d new Pipeline().setStages(Array(modelforCV))\r\n\r\nval pipelineModelCls \u003d pipelineMLCls.fit(transformedTrainDF\r\n    // .withColumn(\"sample_weight\", F.expr(\"case when click_yn\u003d\u003d0.0 then 1.0 else 1.0 end\"))\r\n    .stat.sampleBy(\r\n            F.col(\"click_yn\"),\r\n            Map(\r\n                0.0 -\u003e 0.6,\r\n                1.0 -\u003e 1.0,\r\n            ),\r\n            42L\r\n        )\r\n)\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-16 23:46:11.684",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.tuning.{CrossValidator, ParamGridBuilder}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\n\u001b[1m\u001b[34mmodelforCV\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.GBTClassifier\u001b[0m \u003d gbtc_741d1b3c5feb\n\u001b[1m\u001b[34mpipelineMLCls\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m \u003d pipeline_e6edbd679815\n\u001b[1m\u001b[34mpipelineModelCls\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m \u003d pipeline_e6edbd679815\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d23"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d24"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d25"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d26"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d27"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d28"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d29"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d30"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d31"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d32"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d33"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d34"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d35"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d36"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d37"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d38"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d39"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d40"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d41"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d42"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d43"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d44"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d45"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d46"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d47"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d48"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d49"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d50"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d51"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d52"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d53"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d54"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d55"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d56"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d57"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d58"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d59"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d60"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d61"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d62"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d63"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d64"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d65"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d66"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d67"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d68"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d69"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d70"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d71"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d72"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d73"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d74"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d75"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d76"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d77"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d78"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d79"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d80"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d81"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d82"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d83"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d84"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d85"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d86"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d87"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d88"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d89"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d90"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d91"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d92"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d93"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d94"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d95"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d96"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d97"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d98"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d99"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d100"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d101"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d102"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d103"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d104"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d105"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d106"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d107"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d108"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d109"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d110"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d111"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d112"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d113"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d114"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d115"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d116"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d117"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d118"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d119"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d120"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d121"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d122"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d123"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d124"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d125"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d126"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d127"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d128"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d129"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d130"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d131"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d132"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d133"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d134"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d135"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d136"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d137"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d138"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d139"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d140"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d141"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d142"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d143"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d144"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d145"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d146"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d147"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d148"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d149"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d150"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d151"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d152"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d153"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d154"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d155"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d156"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d157"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d158"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d159"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d160"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d161"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d162"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d163"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d164"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d165"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d166"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d167"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d168"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d169"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d170"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d171"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d172"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d173"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d174"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d175"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d176"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d177"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d178"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d179"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d180"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d181"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d182"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d183"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d184"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d185"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d186"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d187"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d188"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d189"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d190"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d191"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d192"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d193"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d194"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d195"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d196"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d197"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d198"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d199"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d200"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d201"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d202"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d203"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d204"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d205"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d206"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d207"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d208"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d209"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d210"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d211"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d212"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d213"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d214"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d215"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d216"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d217"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d218"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d219"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d220"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d221"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d222"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d223"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d224"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d225"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d226"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d227"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d228"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d229"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d230"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d231"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d232"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d233"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d234"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d235"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d236"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d237"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d238"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d239"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d240"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d241"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d242"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d243"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d244"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d245"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d246"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d247"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d248"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d249"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d250"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d251"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d252"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d253"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d254"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d255"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d256"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d257"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d258"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d259"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d260"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d261"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d262"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d263"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d264"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d265"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d266"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d267"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d268"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d269"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d270"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d271"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d272"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d273"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d274"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d275"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d276"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d277"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d278"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d279"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d280"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d281"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d282"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d283"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d284"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d285"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d286"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d287"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d288"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d289"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d290"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d291"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d292"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d293"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d294"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d295"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d296"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d297"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d298"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d299"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d300"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d301"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d302"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d303"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d304"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d305"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d306"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d307"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d308"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d309"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d310"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d311"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d312"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d313"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d314"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d315"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d316"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d317"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d318"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d319"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d320"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d321"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d322"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d323"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d324"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d325"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d326"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d327"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d328"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d329"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d330"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d331"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d332"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d333"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d334"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d335"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d336"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d337"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d338"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d339"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d340"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d341"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d342"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d343"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d344"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d345"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d346"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d347"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d348"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d349"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d350"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d351"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d352"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d353"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d354"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d355"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d356"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d357"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d358"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d359"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d360"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d361"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d362"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d363"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d364"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d365"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d366"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d367"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d368"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d369"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d370"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d371"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d372"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d373"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d374"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d375"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d376"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d377"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d378"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d379"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d380"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d381"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d382"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d383"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d384"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d385"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d386"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d387"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d388"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d389"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d390"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d391"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d392"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d393"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d394"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d395"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d396"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d397"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d398"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d399"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d400"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d401"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d402"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d403"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d404"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d405"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d406"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d407"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d408"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d409"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d410"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d411"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d412"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d413"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d414"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d415"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d416"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d417"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d418"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d419"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d420"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d421"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d422"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d423"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d424"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d425"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d426"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d427"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d428"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d429"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d430"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d431"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d432"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d433"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d434"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d435"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d436"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d437"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d438"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d439"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d440"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d441"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d442"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d443"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d444"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d445"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d446"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d447"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d448"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d449"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d450"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d451"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d452"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d453"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d454"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d455"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d456"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d457"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d458"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d459"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d460"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d461"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d462"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d463"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d464"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d465"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d466"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d467"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d468"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d469"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d470"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d471"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d472"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d473"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d474"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d475"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d476"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d477"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d478"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d479"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d480"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d481"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d482"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d483"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d484"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d485"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d486"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d487"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d488"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d489"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d490"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d491"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d492"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d493"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d494"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d495"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d496"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d497"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d498"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d499"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d500"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d501"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d502"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d503"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d504"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d505"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d506"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d507"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d508"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d509"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d510"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d511"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d512"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d513"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d514"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d515"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d516"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d517"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d518"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d519"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d520"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d521"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d522"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d523"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d524"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d525"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765789893517_1550413688",
      "id": "paragraph_1765789893517_1550413688",
      "dateCreated": "2025-12-15 09:11:33.517",
      "dateStarted": "2025-12-16 23:46:11.815",
      "dateFinished": "2025-12-16 23:59:39.829",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.ml.evaluation.RegressionEvaluator\r\n\r\nval modelRegforCV \u003d xgbr\r\n\r\n// val paramGridXGB \u003d new ParamGridBuilder()\r\n//         .addGrid(xgbc.maxDepth, Array(6))\r\n//         .addGrid(xgbc.numRound, Array(100))\r\n//         .addGrid(xgbc.eta, Array(0.1))\r\n//         // .addGrid(xgbc.scalePosWeight, Array(3.0))\r\n//         .build()\r\n\r\n// val paramGridGBT \u003d new ParamGridBuilder()\r\n//         .addGrid(gbtc.maxDepth, Array(5))\r\n//         .addGrid(gbtc.maxIter, Array(100))\r\n//         .addGrid(gbtc.stepSize, Array(0.1))\r\n//         .build()\r\n\r\n// val paramGrid \u003d if(modelRegforCV.uid.startsWith(\"xgb\")){\r\n//     paramGridXGB\r\n// }else{\r\n//     paramGridGBT\r\n// }\r\n\r\n// val pipelineMLReg \u003d new CrossValidator()\r\n//   .setEstimator(new Pipeline().setStages(Array(modelRegforCV)))\r\n//   .setEvaluator(new RegressionEvaluator().setLabelCol(modelRegforCV.getLabelCol).setPredictionCol(modelRegforCV.getPredictionCol))\r\n//   .setEstimatorParamMaps(paramGrid)\r\n//   .setNumFolds(3)  // Use 3+ in practice\r\n//   .setParallelism(6)  // Evaluate up to 2 parameter settings in parallel\r\n  \r\nval pipelineMLReg \u003d new Pipeline().setStages(Array(modelRegforCV))\r\n\r\nval pipelineModelReg \u003d pipelineMLReg.fit(\r\n    transformedTrainDF\r\n    .filter(\"click_yn\u003e0\")\r\n// .withColumn(\"sample_weight\", F.expr(\"case when click_yn\u003d\u003d0.0 then 1.0 else 1.0 end\"))\r\n)",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 00:20:44.681",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.evaluation.RegressionEvaluator\n\u001b[1m\u001b[34mmodelRegforCV\u001b[0m: \u001b[1m\u001b[32mml.dmlc.xgboost4j.scala.spark.XGBoostRegressor\u001b[0m \u003d xgbr_a8e907780099\n\u001b[1m\u001b[34mpipelineMLReg\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m \u003d pipeline_f6128736f8a5\n\u001b[1m\u001b[34mpipelineModelReg\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m \u003d pipeline_f6128736f8a5\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1033"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1034"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765764610094_1504595267",
      "id": "paragraph_1765764610094_1504595267",
      "dateCreated": "2025-12-15 02:10:10.095",
      "dateStarted": "2025-12-17 00:20:44.766",
      "dateFinished": "2025-12-17 00:22:26.002",
      "status": "FINISHED"
    },
    {
      "text": "\n// Make predictions.\nvar predictionsDev \u003d pipelineModelCls\n.transform(transformedTestDF\n.dropDuplicates(\"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_hournum_cd\", \"click_yn\")\n)//.cache()\n\npredictionsDev \u003d pipelineModelReg.transform(predictionsDev).cache()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 00:20:48.709",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredictionsDev\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 111 more fields]\npredictionsDev: org.apache.spark.sql.DataFrame \u003d [cmpgn_num: string, svc_mgmt_num: string ... 111 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1035"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765345345715_612147457",
      "id": "paragraph_1765345345715_612147457",
      "dateCreated": "2025-12-10 05:42:25.715",
      "dateStarted": "2025-12-17 00:20:48.787",
      "dateFinished": "2025-12-17 00:22:48.473",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.mllib.evaluation.MulticlassMetrics\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.DataFrame\r\nimport org.apache.spark.ml.tuning.CrossValidatorModel\r\n\r\nimport org.apache.spark.ml.linalg.Vector\r\n\r\nspark.udf.register(\"vector_to_array\", (v: Vector) \u003d\u003e v.toArray)\r\n\r\nval topK \u003d 50000\r\n\r\n// val stages \u003d pipelineModelCls.bestModel.asInstanceOf[PipelineModel].stages\r\nval stages \u003d pipelineModelCls.stages\r\n\r\nstages.foreach{stage \u003d\u003e \r\n    \r\n    val modelName \u003d stage.uid.split(\"_\")(0)\r\n    \r\n    predictionsDev\r\n    .filter(\"cmpgn_typ\u003d\u003d\u0027Sales\u0027\")\r\n    .groupBy(\"svc_mgmt_num\", \"send_ym\", s\"prob_$modelName\").agg(F.sum(indexedLabelColCls).alias(indexedLabelColCls))\r\n\r\n    // 1. prediction DataFrame에서 (prediction, indexedLabel) RDD[(Double, Double)] 생성\r\n    val predictionAndLabels \u003d labelConverter.transform(\r\n    predictionsDev\r\n    .filter(\"cmpgn_typ\u003d\u003d\u0027Sales\u0027\")\r\n    .groupBy(\"svc_mgmt_num\", \"send_ym\", s\"prob_$modelName\").agg(F.sum(indexedLabelColCls).alias(indexedLabelColCls))\r\n    .withColumn(indexedLabelColCls, F.expr(s\"case when $indexedLabelColCls\u003e0 then cast(1.0 AS DOUBLE) else cast(0.0 AS DOUBLE) end\"))\r\n    .withColumn(\"prob\", F.expr(s\"vector_to_array(prob_$modelName)[1]\"))\r\n    .groupBy(\"svc_mgmt_num\", \"send_ym\", indexedLabelColCls).agg(F.avg(\"prob\").alias(\"prob\"))\r\n    .withColumn(\"rank\", F.rank().over(Window.orderBy(F.desc(\"prob\"))))\r\n    .withColumn(\"prediction_cls\", F.expr(\"case when prob\u003e\u003d0.5 then cast(1.0 AS DOUBLE) else cast(0.0 AS DOUBLE) end\"))\r\n    // .withColumn(\"prediction_cls\", F.expr(s\"case when rank\u003c\u003d${topK} then cast(1.0 AS DOUBLE) else cast(0.0 AS DOUBLE) end\"))\r\n    // .filter(f\"rank\u003c\u003d${topK}\")\r\n    )\r\n    .selectExpr(\"prediction_cls\", s\"cast($indexedLabelColCls as double)\")\r\n                                         .rdd\r\n                                         .map(row \u003d\u003e (row.getDouble(0), row.getDouble(1)))\r\n    \r\n    // 2. MulticlassMetrics 인스턴스 생성\r\n    val metrics \u003d new MulticlassMetrics(predictionAndLabels)\r\n    \r\n    // 3. 레이블별 지표 추출\r\n    val labels \u003d metrics.labels // 사용된 모든 고유 레이블 목록\r\n    \r\n    println(s\"######### $modelName 예측 결과 #########\")\r\n    \r\n    println(\"--- 레이블별 성능 지표 ---\")\r\n    labels.foreach { label \u003d\u003e\r\n      val precision \u003d metrics.precision(label) // 특정 레이블의 Precision\r\n      val recall \u003d metrics.recall(label)     // 특정 레이블의 Recall\r\n      val f1 \u003d metrics.fMeasure(label)       // 특정 레이블의 F1-Score\r\n    \r\n      println(f\"Label $label (클래스): Precision \u003d $precision%.4f, Recall \u003d $recall%.4f, F1 \u003d $f1%.4f\")\r\n    }\r\n    \r\n    // 4. (선택사항) 전체 가중 평균 지표 확인\r\n    println(s\"\\nWeighted Precision (전체 평균): ${metrics.weightedPrecision}\")\r\n    println(s\"Weighted Recall (전체 평균): ${metrics.weightedRecall}\")\r\n    println(s\"Accuracy (전체 정확도): ${metrics.accuracy}\")\r\n    \r\n    // 5. (선택사항) 혼동 행렬 출력\r\n    println(\"\\n--- Confusion Matrix (혼동 행렬) ---\")\r\n    println(metrics.confusionMatrix)\r\n}",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 00:10:11.742",
      "progress": 23,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "######### gbtc 예측 결과 #########\n--- 레이블별 성능 지표 ---\nLabel 0.0 (클래스): Precision \u003d 0.9888, Recall \u003d 0.8768, F1 \u003d 0.9294\nLabel 1.0 (클래스): Precision \u003d 0.0221, Recall \u003d 0.2179, F1 \u003d 0.0401\n\nWeighted Precision (전체 평균): 0.9765915786520533\nWeighted Recall (전체 평균): 0.8685203773683466\nAccuracy (전체 정확도): 0.8685203773683466\n\n--- Confusion Matrix (혼동 행렬) ---\n6066091.0  852248.0  \n68967.0    19217.0   \nimport org.apache.spark.mllib.evaluation.MulticlassMetrics\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.ml.tuning.CrossValidatorModel\nimport org.apache.spark.ml.linalg.Vector\n\u001b[1m\u001b[34mtopK\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 50000\n\u001b[1m\u001b[34mstages\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.Transformer]\u001b[0m \u003d Array(GBTClassificationModel: uid \u003d gbtc_741d1b3c5feb, numTrees\u003d100, numClasses\u003d2, numFeatures\u003d137)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1029"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1030"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1031"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764838154931_1623772564",
      "id": "paragraph_1764838154931_1623772564",
      "dateCreated": "2025-12-04 08:49:14.931",
      "dateStarted": "2025-12-17 00:10:11.882",
      "dateFinished": "2025-12-17 00:13:07.459",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.ml.evaluation.RegressionEvaluator\r\n\r\n// val stages \u003d pipelineModelReg.bestModel.asInstanceOf[PipelineModel].stages\r\nval stages \u003d pipelineModelReg.stages\r\n\r\nstages.foreach{stage \u003d\u003e \r\n\r\n    val modelName \u003d stage.uid.split(\"_\")(0)\r\n\r\n    val evaluator \u003d new RegressionEvaluator()\r\n      .setLabelCol(indexedLabelColReg)\r\n      .setPredictionCol(s\"pred_${modelName}\")\r\n      .setMetricName(\"rmse\")\r\n    val rmse \u003d evaluator.evaluate(predictionsDev)\r\n    println(s\"######### $modelName 예측 결과 #########\")\r\n    println(f\"Root Mean Squared Error (RMSE) : $rmse%.4f\")\r\n}",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 00:20:53.423",
      "progress": 33,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "######### xgbr 예측 결과 #########\nRoot Mean Squared Error (RMSE) : 0.7766\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\n\u001b[1m\u001b[34mstages\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.Transformer]\u001b[0m \u003d Array(xgbr_a8e907780099)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1036"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765786040626_1985577608",
      "id": "paragraph_1765786040626_1985577608",
      "dateCreated": "2025-12-15 08:07:20.626",
      "dateStarted": "2025-12-17 00:22:26.079",
      "dateFinished": "2025-12-17 00:24:27.912",
      "status": "FINISHED"
    },
    {
      "text": "val predictionsSVCCls \u003d pipelineModelCls.transform(transformedPredDF.filter(\"svc_mgmt_num like \u0027%00\u0027\").dropDuplicates(\"svc_mgmt_num\", \"chnl_typ\", \"cmpgn_typ\", \"send_ym\", \"send_hournum_cd\", \"click_yn\"))\nval predictionsSVCFinal \u003d pipelineModelReg.transform(predictionsSVCCls)\n\nimport org.apache.spark.ml.linalg.Vector\n\nspark.udf.register(\"vector_to_array\", (v: Vector) \u003d\u003e v.toArray)\n\nvar predictedPropensityScoreDF \u003d predictionsSVCFinal\n.withColumn(\"prob_click\", F.expr(s\"\"\"aggregate(array(${pipelineModelCls.stages.map(m \u003d\u003e s\"vector_to_array(prob_${m.uid.split(\"_\")(0)})[1]\").mkString(\",\")}), 0D, (acc, x) -\u003e acc + x)\"\"\"))\n.withColumn(\"res_utility\", F.expr(s\"\"\"aggregate(array(${pipelineModelReg.stages.map(m \u003d\u003e s\"pred_${m.uid.split(\"_\")(0)}\").mkString(\",\")}), 0D, (acc, x) -\u003e acc + x)\"\"\"))\n.withColumn(\"propensity_score\", F.expr(\"prob_click*res_utility\"))\n\npredictedPropensityScoreDF.selectExpr(\"svc_mgmt_num\",\"send_hournum_cd send_hour\",\"ROUND(prob_click, 4) prob_click\",\"ROUND(res_utility, 4) res_utility\",\"ROUND(propensity_score, 4) propensity_score\")\n.write.mode(\"overwrite\").partitionBy(\"send_hour\").parquet(\"aos/sto/propensityScoreDF\")\n// .show()\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 00:36:24.853",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpredictionsSVCCls\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 110 more fields]\n\u001b[1m\u001b[34mpredictionsSVCFinal\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 111 more fields]\nimport org.apache.spark.ml.linalg.Vector\n\u001b[1m\u001b[34mpredictedPropensityScoreDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [cmpgn_num: string, svc_mgmt_num: string ... 113 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1037"
            },
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1038"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765768974381_910321724",
      "id": "paragraph_1765768974381_910321724",
      "dateCreated": "2025-12-15 03:22:54.381",
      "dateStarted": "2025-12-17 00:36:24.950",
      "dateFinished": "2025-12-17 01:39:20.634",
      "status": "FINISHED"
    },
    {
      "text": "val pdf \u003d spark.read.parquet(\"aos/sto/propensityScoreDF\")\n.select(\"svc_mgmt_num\",\"send_hour\",\"propensity_score\").cache()\n\n// pdf.sort(\"svc_mgmt_num\")\n// .show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:43:13.613",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mpdf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [svc_mgmt_num: string, send_hour: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d0"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765935603309_1543411151",
      "id": "paragraph_1765935603309_1543411151",
      "dateCreated": "2025-12-17 01:40:03.310",
      "dateStarted": "2025-12-17 01:43:13.690",
      "dateFinished": "2025-12-17 01:45:40.115",
      "status": "FINISHED"
    },
    {
      "text": "pdf.sort(\"svc_mgmt_num\",\"send_hour\")\n.show()",
      "user": "anonymous",
      "dateUpdated": "2025-12-17 01:43:23.542",
      "progress": 98,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+---------+----------------+\n|        svc_mgmt_num|send_hour|propensity_score|\n+--------------------+---------+----------------+\n|s:0002206534ab438...|       10|          0.5091|\n|s:0002206534ab438...|       11|          0.5091|\n|s:0002206534ab438...|       12|          0.5091|\n|s:0002206534ab438...|       13|          0.5091|\n|s:0002206534ab438...|       14|          0.5091|\n|s:0002206534ab438...|       15|          0.5091|\n|s:0002206534ab438...|       16|          0.5091|\n|s:0002206534ab438...|       17|          0.5091|\n|s:0003473b9eb01d6...|       10|          0.0738|\n|s:0003473b9eb01d6...|       11|          0.0738|\n|s:0003473b9eb01d6...|       12|          0.0738|\n|s:0003473b9eb01d6...|       13|          0.0738|\n|s:0003473b9eb01d6...|       14|          0.0738|\n|s:0003473b9eb01d6...|       15|          0.0738|\n|s:0003473b9eb01d6...|       16|          0.0738|\n|s:0003473b9eb01d6...|       17|          0.0769|\n|s:00035d6150da200...|       10|          0.2683|\n|s:00035d6150da200...|       11|          0.2715|\n|s:00035d6150da200...|       12|          0.2715|\n|s:00035d6150da200...|       13|          0.2715|\n+--------------------+---------+----------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ats-01-16:30431/jobs/job?id\u003d1"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765935760016_917799410",
      "id": "paragraph_1765935760016_917799410",
      "dateCreated": "2025-12-17 01:42:40.017",
      "dateStarted": "2025-12-17 01:43:26.702",
      "dateFinished": "2025-12-17 01:45:51.740",
      "status": "FINISHED"
    },
    {
      "text": "%md\r\n\r\n--- 2.0 레이블별 성능 지표 ---\r\nLabel 0.0 (클래스): Precision \u003d 0.9878, Recall \u003d 0.9182, F1 \u003d 0.9517\r\nLabel 1.0 (클래스): Precision \u003d 0.0330, Recall \u003d 0.1972, F1 \u003d 0.0565\r\n\r\n--- 3.0 레이블별 성능 지표 ---\r\nLabel 0.0 (클래스): Precision \u003d 0.9866, Recall \u003d 0.9837, F1 \u003d 0.9852\r\nLabel 1.0 (클래스): Precision \u003d 0.0474, Recall \u003d 0.0574, F1 \u003d 0.0519\r\n\r\n--- 4.0 레이블별 성능 지표 ---\r\nLabel 0.0 (클래스): Precision \u003d 0.9863, Recall \u003d 0.9942, F1 \u003d 0.9902\r\nLabel 1.0 (클래스): Precision \u003d 0.0552, Recall \u003d 0.0241, F1 \u003d 0.0336\r\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-11 13:41:35.180",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003e\u0026mdash; 2.0 레이블별 성능 지표 \u0026mdash;\u003cbr /\u003e\nLabel 0.0 (클래스): Precision \u003d 0.9878, Recall \u003d 0.9182, F1 \u003d 0.9517\u003cbr /\u003e\nLabel 1.0 (클래스): Precision \u003d 0.0330, Recall \u003d 0.1972, F1 \u003d 0.0565\u003c/p\u003e\n\u003cp\u003e\u0026mdash; 3.0 레이블별 성능 지표 \u0026mdash;\u003cbr /\u003e\nLabel 0.0 (클래스): Precision \u003d 0.9866, Recall \u003d 0.9837, F1 \u003d 0.9852\u003cbr /\u003e\nLabel 1.0 (클래스): Precision \u003d 0.0474, Recall \u003d 0.0574, F1 \u003d 0.0519\u003c/p\u003e\n\u003cp\u003e\u0026mdash; 4.0 레이블별 성능 지표 \u0026mdash;\u003cbr /\u003e\nLabel 0.0 (클래스): Precision \u003d 0.9863, Recall \u003d 0.9942, F1 \u003d 0.9902\u003cbr /\u003e\nLabel 1.0 (클래스): Precision \u003d 0.0552, Recall \u003d 0.0241, F1 \u003d 0.0336\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1764902404285_1154494058",
      "id": "paragraph_1764902404285_1154494058",
      "dateCreated": "2025-12-05 02:40:04.285",
      "dateStarted": "2025-12-11 13:41:35.315",
      "dateFinished": "2025-12-11 13:41:35.324",
      "status": "FINISHED"
    },
    {
      "text": "%md\n",
      "user": "anonymous",
      "dateUpdated": "2025-12-11 13:41:35.415",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1765254401639_1757217419",
      "id": "paragraph_1765254401639_1757217419",
      "dateCreated": "2025-12-09 04:26:41.639",
      "dateStarted": "2025-12-11 13:41:35.488",
      "dateFinished": "2025-12-11 13:41:35.491",
      "status": "FINISHED"
    }
  ],
  "name": "predict_ost",
  "id": "2MC68ADVY",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {
    "isRunning": false
  }
}