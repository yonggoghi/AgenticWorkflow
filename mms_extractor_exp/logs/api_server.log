2025-10-15 09:07:27,981 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:07:27,981 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:07:27,981 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:07:27,981 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:07:27,981 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:07:27,981 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:07:27,981 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:07:27,982 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:07:27,982 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:07:27,984 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:07:28,153 - mms_extractor - INFO - Using device: mps
2025-10-15 09:07:28,153 - mms_extractor - INFO - _initialize_device 실행완료: 0.17초
2025-10-15 09:07:28,153 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:07:28,153 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:07:28,153 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:07:28,153 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:07:28,153 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:07:28,154 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:07:28,154 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:07:28,901 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:07:28,901 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.75초
2025-10-15 09:07:28,901 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:07:29,707 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:07:29,707 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.81초
2025-10-15 09:07:29,707 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:07:29,708 - mms_extractor - INFO - ============================================================
2025-10-15 09:07:29,708 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:07:29,708 - mms_extractor - INFO - ============================================================
2025-10-15 09:07:29,708 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:07:29,708 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:07:29,708 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:07:29,708 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:07:29,708 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:07:29,884 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:07:29,884 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:07:29,884 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:07:29,894 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:07:29,895 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:07:29,896 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:07:29,896 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:07:29,897 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:07:29,897 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:07:29,904 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:07:29,909 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:07:29,910 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:07:29,910 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:07:29,910 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:07:29,910 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:07:29,910 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:07:29,910 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:07:29,910 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:07:29,910 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:07:29,910 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:07:29,915 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:07:29,915 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:07:29,915 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:07:29,916 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:07:29,916 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:07:30,272 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:07:30,283 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:07:30,283 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:07:30,283 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:07:30,284 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:07:30,284 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:07:30,285 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:07:30,285 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:07:30,285 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:07:30,285 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:07:30,287 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:07:30,288 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:07:30,288 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:07:30,311 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:07:30,311 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:07:30,311 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:07:30,319 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:07:30,319 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:07:30,738 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:07:30,738 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:07:30,739 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:07:30,739 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:07:30,739 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:07:30,739 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:07:30,833 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:07:30,833 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:07:30,837 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:07:30,837 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:07:30,837 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:07:30,837 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:07:30,837 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:07:30,838 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:07:30,838 - mms_extractor - INFO - ============================================================
2025-10-15 09:07:30,838 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:07:30,838 - mms_extractor - INFO - ============================================================
2025-10-15 09:07:30,838 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:07:30,839 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:07:30,839 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:07:30,839 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:07:30,839 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:07:30,840 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:07:30,842 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:07:30,844 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:07:30,845 - mms_extractor - INFO - _load_data 실행완료: 1.14초
2025-10-15 09:07:30,845 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:07:30,845 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:07:30,845 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:07:30,845 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:07:30,845 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:07:30,845 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:07:30,845 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:07:30,845 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:07:30,845 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:07:30,845 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:07:30,845 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:07:30,845 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:07:30,914 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:07:30,914 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:07:38,179 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:07:38] "GET /health HTTP/1.1" 200 -
2025-10-15 09:07:49,551 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:07:49] "GET /health HTTP/1.1" 200 -
2025-10-15 09:07:53,691 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:07:53] "GET /health HTTP/1.1" 200 -
2025-10-15 09:07:56,555 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:07:56] "GET /health HTTP/1.1" 200 -
2025-10-15 09:07:58,138 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:07:58] "GET /health HTTP/1.1" 200 -
2025-10-15 09:08:02,137 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:08:02] "GET /health HTTP/1.1" 200 -
2025-10-15 09:08:02,166 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:08:02] "GET /health HTTP/1.1" 200 -
2025-10-15 09:08:03,220 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:08:03] "GET /health HTTP/1.1" 200 -
2025-10-15 09:08:03,231 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: claude, 메시지 길이: 614자
2025-10-15 09:08:03,231 - __main__ - INFO - LLM 모델이 ax -> claude로 변경됨. 재초기화 중...
2025-10-15 09:08:03,232 - mms_extractor - INFO - LLM 초기화 완료: claude (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-15 09:08:03,232 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:08:03,232 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 09:08:03,232 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 09:08:03,232 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-10-15 09:08:03,232 - mms_extractor - INFO - ============================================================
2025-10-15 09:08:03,232 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 09:08:03,232 - mms_extractor - INFO - ============================================================
2025-10-15 09:08:03,232 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-10-15 09:08:03,232 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-10-15 09:08:03,232 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 09:08:03,232 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 09:08:03,232 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-15 09:08:03,232 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-15 09:08:03,232 - mms_extractor - INFO - LLM 모델: claude
2025-10-15 09:08:03,232 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 09:08:03,232 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 09:08:03,232 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 09:08:03,232 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 09:08:03,232 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-10-15 09:08:03,234 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 09:08:04,016 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-10-15 09:08:04,017 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-10-15 09:08:04,022 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-10-15 09:08:04,022 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-10-15 09:08:04,023 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-10-15 09:08:04,023 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 09:08:18,378 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2775, 3)
2025-10-15 09:08:18,378 - mms_extractor - INFO - 퍼지 매칭 성공: 2775개 결과
2025-10-15 09:08:18,379 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-10-15 09:08:18,380 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 09:08:18,525 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2775, 3)
2025-10-15 09:08:18,526 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-10-15 09:08:18,529 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 09:08:18,536 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-10-15 09:08:18,539 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-10-15 09:08:18,540 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-10-15 09:08:18,545 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:08:18,549 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-10-15 09:08:18,549 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-10-15 09:08:18,550 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 15.32초
2025-10-15 09:08:18,550 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:08:18,550 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-10-15 09:08:18,550 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 09:08:18,934 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 09:08:18,935 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 09:08:18,935 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-10-15 09:08:18,935 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 09:08:18,935 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-10-15 09:08:18,935 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:08:18,935 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-10-15 09:08:18,935 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 09:08:18,935 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-10-15 09:08:18,935 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-15 09:08:18,936 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 09:08:18,936 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-10-15 09:08:18,936 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-15 09:08:18,936 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 09:08:18,936 - mms_extractor - INFO - 📝 프롬프트 길이: 7,454 문자
2025-10-15 09:08:18,936 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 09:08:18,936 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 09:08:24,837 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:08:24,853 - mms_extractor - INFO - LLM 응답 길이: 549 문자
2025-10-15 09:08:24,853 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": ["상품 가입 유도", "혜택 안내"],
    "product": [
        {"name": "우주패스 Netflix", "action": "가입"},
        {"name": "Netflix 광고형 스탠다드 멤버십", "action": "가입"},
        {"name": "Wavve 콘텐츠 팩", "action": "가입"}
    ],
    "channel": [
        {"type": "URL", "value": "http://t-mms.kr/jAs/#74", "action": "추가 정보"},
        {"type": "전화번호", "value": "1505", "action": "문의"},
        {"type": "전화번호", "value": "1504", "action": "수신 거부"}
    ],
    "p...
2025-10-15 09:08:24,853 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 09:08:24,854 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 09:08:24,854 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 09:08:24,854 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-10-15 09:08:24,854 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 09:08:24,854 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩']
2025-10-15 09:08:24,855 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-15 09:08:24,855 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-15 09:08:24,855 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-15 09:08:24,855 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-15 09:08:26,487 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1747개
2025-10-15 09:08:26,487 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-10-15 09:08:26,489 - mms_extractor - INFO - 필터링 후 엔티티 수: 1743개
2025-10-15 09:08:26,489 - mms_extractor - INFO - 제거된 엔티티 수: 4개
2025-10-15 09:08:26,489 - mms_extractor - INFO - 최종 후보 엔티티 수: 1743개
2025-10-15 09:08:26,489 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1743개
2025-10-15 09:08:26,489 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-10-15 09:08:26,489 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1743개)
2025-10-15 09:08:26,489 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-10-15 09:08:26,489 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-10-15 09:08:26,490 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,760 문자
2025-10-15 09:08:26,490 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,790 문자
2025-10-15 09:08:26,490 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-15 09:08:26,490 - mms_extractor - INFO - 📝 프롬프트 길이: 4,790 문자
2025-10-15 09:08:26,490 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-15 09:08:26,490 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-15 09:08:26,490 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-10-15 09:08:26,500 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 09:08:26,500 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 09:08:26,500 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x16233b6b0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x161d18230> root_client=<openai.OpenAI object at 0x16233a2d0> root_async_client=<openai.AsyncOpenAI object at 0x16233bdd0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:08:26,500 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1ab3260f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1ab325040> root_client=<openai.OpenAI object at 0x161d186e0> root_async_client=<openai.AsyncOpenAI object at 0x1ab325fa0> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:08:26,500 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 09:08:26,500 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-10-15 09:08:26,501 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-10-15 09:08:26,502 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-10-15 09:08:27,342 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:08:28,609 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:08:28,612 - mms_extractor - INFO - ✅ LLM 추출 완료: ['Wavve 콘텐츠 팩', 'Netflix 스탠다드', 'Netflix 광고형 스탠다드 멤버십', 'Netflix 프리미엄', '넷플릭스', '우주패스 Netflix', 'T 우주', '웨이브']
2025-10-15 09:08:28,953 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 4.10초
2025-10-15 09:08:28,962 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 09:08:28,962 - mms_extractor - INFO - ============================================================
2025-10-15 09:08:28,962 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 09:08:28,962 - mms_extractor - INFO - ============================================================
2025-10-15 09:08:28,962 - mms_extractor - INFO - 제목: 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-10-15 09:08:28,962 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-15 09:08:28,962 - mms_extractor - INFO - 상품 수: 8개
2025-10-15 09:08:28,962 - mms_extractor - INFO - 채널 수: 3개
2025-10-15 09:08:28,962 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 09:08:28,963 - mms_extractor - INFO - process_message 실행완료: 25.73초
2025-10-15 09:08:28,963 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 09:08:28,963 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 09:08:28,963 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:08:28,963 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-10-15 09:08:28,963 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x16213eba0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x16213e3c0> root_client=<openai.OpenAI object at 0x16213e5d0> root_async_client=<openai.AsyncOpenAI object at 0x16213eb10> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:08:28,963 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:08:28,963 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-10-15 09:08:49,632 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:08:49,635 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1689자
2025-10-15 09:08:49,635 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

**메시지 요약 및 핵심 의도:**
SKT가 T우주 플랫폼을 통해 넷플릭스와 웨이브를 결합한 우주패스 Netflix 상품을 프로모션 가격(2개월간 월 9,900원)으로 제공하는 광고입니다. 고객이 온라인 링크를 통해 접속하여 프로모션 쿠폰을 다운로드하고 서비스에 가입하도록 유도하는 것이 핵심 의도입니다.

**식별된 가치 제안 목록...
2025-10-15 09:08:49,635 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:08:49,636 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 153자
2025-10-15 09:08:49,637 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:08:49,638 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-10-15 09:08:49,638 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션링크:접속', '프로모션쿠폰:다운로드', '우주패스Netflix:가입', '할인혜택:수령', 'OTT서비스:사용']
2025-10-15 09:08:49,638 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션링크:접속', '프로모션쿠폰:다운로드'), ('프로모션쿠폰:다운로드', '우주패스Netflix:가입'), ('우주패스Netflix:가입', '할인혜택:수령'), ('우주패스Netflix:가입', 'OTT서비스:사용')]
2025-10-15 09:08:49,639 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:08:49,639 - utils - INFO - 📁 저장 위치: ./dag_images_local (local 모드)
2025-10-15 09:08:49,639 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 09:08:49,639 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-10-15 09:08:49,641 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:08:49,678 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:08:49,678 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 09:08:49,678 - mms_extractor - INFO - 🕒 DAG 처리 시간: 20.716초
2025-10-15 09:08:49,678 - mms_extractor - INFO - 📏 DAG 섹션 길이: 153자
2025-10-15 09:08:49,678 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션링크:접속) -[접속하면]-> (프로모션쿠폰:다운로드)
(프로모션쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)
(우주패스Netflix:가입) -[가입하면]-> (할인혜택:수령)
(우주패스Netflix:가입) -[가입하면]-> (OTT서비스:사용)...
2025-10-15 09:08:49,678 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 09:08:49,678 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 09:08:50,236 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 09:08:50,249 - mongodb_utils - INFO - 문서 저장 성공: 68eee612bb63762f539666a6
2025-10-15 09:08:50,251 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 09:08:50,251 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 09:08:50,251 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-10-15 09:08:50,252 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 4자
2025-10-15 09:08:50,252 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스Netflix:가입) -[가입하면]-> (OTT서비스:사용)', '(우주패스Netflix:가입) -[가입하면]-> (할인혜택:수령)', '(프로모션링크:접속) -[접속하면]-> (프로모션쿠폰:다운로드)', '(프로모션쿠폰:다운로드) -[다운로드후]-> (우주패스Netflix:가입)']...
2025-10-15 09:08:50,252 - __main__ - INFO - 추출 완료: 47.021초
2025-10-15 09:08:50,255 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:08:50] "POST /extract HTTP/1.1" 200 -
2025-10-15 09:08:50,285 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:08:50] "GET /health HTTP/1.1" 200 -
2025-10-15 09:09:13,879 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:09:13,880 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:09:13,880 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:09:13,880 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1608c9490> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1608c97c0> root_client=<openai.OpenAI object at 0x1608c9370> root_async_client=<openai.AsyncOpenAI object at 0x1608c95e0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:09:13,880 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:09:13,880 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:09:31,687 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:09:31,689 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1922자
2025-10-15 09:09:31,689 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-10-15 09:09:31,689 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:09:31,689 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:09:31,690 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:09:31,690 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:09:31,690 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:09:31,690 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:09:31,690 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:09:31,693 - utils - INFO - 📁 저장 위치: ./dag_images_local (local 모드)
2025-10-15 09:09:31,693 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-10-15 09:09:31,694 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:09:31,696 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:09:31,730 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:09:31,731 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png (local 모드)
2025-10-15 09:09:31,731 - __main__ - INFO - 🌐 DAG 이미지 URL: http://skt-tosaipoc01:8000/dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-10-15 09:09:31,731 - __main__ - INFO - ✅ DAG 추출 완료: 17.811초, 노드: 5, 엣지: 3
2025-10-15 09:09:31,732 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:09:31] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:14:44,793 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:14:44,793 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:14:44,793 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:14:44,793 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:14:44,793 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:14:44,793 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:14:44,793 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:14:44,793 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:14:44,793 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:14:44,795 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:14:44,847 - mms_extractor - INFO - Using device: mps
2025-10-15 09:14:44,850 - mms_extractor - INFO - _initialize_device 실행완료: 0.06초
2025-10-15 09:14:44,850 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:14:44,851 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:14:44,851 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:14:44,851 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:14:44,851 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:14:44,851 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:14:44,851 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:14:45,407 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:14:45,407 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.56초
2025-10-15 09:14:45,407 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:14:46,096 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:14:46,096 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.69초
2025-10-15 09:14:46,096 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:14:46,096 - mms_extractor - INFO - ============================================================
2025-10-15 09:14:46,096 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:14:46,096 - mms_extractor - INFO - ============================================================
2025-10-15 09:14:46,096 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:14:46,096 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:14:46,097 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:14:46,097 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:14:46,097 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:14:46,267 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:14:46,267 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:14:46,267 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:14:46,274 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:14:46,275 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:14:46,276 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:14:46,277 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:14:46,277 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:14:46,278 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:14:46,279 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:14:46,284 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:14:46,284 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:14:46,284 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:14:46,284 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:14:46,284 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:14:46,285 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:14:46,285 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:14:46,285 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:14:46,285 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:14:46,285 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:14:46,287 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:14:46,287 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:14:46,287 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:14:46,287 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:14:46,288 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:14:46,618 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:14:46,629 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:14:46,629 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:14:46,629 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:14:46,630 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:14:46,630 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:14:46,631 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:14:46,631 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:14:46,631 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:14:46,631 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:14:46,633 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:14:46,634 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:14:46,634 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:14:46,656 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:14:46,657 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:14:46,657 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:14:46,658 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:14:46,658 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:14:47,004 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:14:47,005 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:14:47,005 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:14:47,005 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:14:47,005 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:14:47,005 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:14:47,100 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:14:47,100 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:14:47,103 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:14:47,103 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:14:47,103 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:14:47,103 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:14:47,103 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:14:47,104 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:14:47,104 - mms_extractor - INFO - ============================================================
2025-10-15 09:14:47,104 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:14:47,104 - mms_extractor - INFO - ============================================================
2025-10-15 09:14:47,104 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:14:47,104 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:14:47,104 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:14:47,104 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:14:47,104 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:14:47,106 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:14:47,108 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:14:47,110 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:14:47,110 - mms_extractor - INFO - _load_data 실행완료: 1.01초
2025-10-15 09:14:47,110 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:14:47,111 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:14:47,111 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:14:47,111 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:14:47,111 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:14:47,111 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:14:47,111 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:14:47,111 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:14:47,111 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:14:47,111 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:14:47,111 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:14:47,111 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:14:47,154 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:14:47,154 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:18:48,178 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:18:48,178 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:18:48,178 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:18:48,178 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:18:48,178 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:18:48,179 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:18:48,179 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:18:48,179 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:18:48,179 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:18:48,179 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:18:48,180 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:18:48,222 - mms_extractor - INFO - Using device: mps
2025-10-15 09:18:48,222 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-10-15 09:18:48,222 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:18:48,222 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:18:48,222 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:18:48,223 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:18:48,223 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:18:48,223 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:18:48,223 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:18:48,585 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:18:48,585 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.36초
2025-10-15 09:18:48,585 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:18:49,244 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:18:49,244 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.66초
2025-10-15 09:18:49,244 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:18:49,244 - mms_extractor - INFO - ============================================================
2025-10-15 09:18:49,244 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:18:49,244 - mms_extractor - INFO - ============================================================
2025-10-15 09:18:49,244 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:18:49,244 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:18:49,244 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:18:49,244 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:18:49,244 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:18:49,424 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:18:49,424 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:18:49,425 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:18:49,433 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:18:49,434 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:18:49,435 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:18:49,435 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:18:49,436 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:18:49,436 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:18:49,438 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:18:49,443 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:18:49,443 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:18:49,443 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:18:49,443 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:18:49,443 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:18:49,444 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:18:49,444 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:18:49,444 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:18:49,444 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:18:49,444 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:18:49,445 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:18:49,446 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:18:49,446 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:18:49,446 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:18:49,446 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:18:49,765 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:18:49,775 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:18:49,776 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:18:49,776 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:18:49,776 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:18:49,776 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:18:49,778 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:18:49,778 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:18:49,778 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:18:49,778 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:18:49,779 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:18:49,781 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:18:49,781 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:18:49,803 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:18:49,803 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:18:49,803 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:18:49,805 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:18:49,805 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:18:50,135 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:18:50,136 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:18:50,136 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:18:50,136 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:18:50,136 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:18:50,136 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:18:50,232 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:18:50,233 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:18:50,235 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:18:50,236 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:18:50,236 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:18:50,236 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:18:50,236 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:18:50,237 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:18:50,237 - mms_extractor - INFO - ============================================================
2025-10-15 09:18:50,237 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:18:50,237 - mms_extractor - INFO - ============================================================
2025-10-15 09:18:50,237 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:18:50,237 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:18:50,237 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:18:50,237 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:18:50,237 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:18:50,238 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:18:50,240 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:18:50,242 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:18:50,243 - mms_extractor - INFO - _load_data 실행완료: 1.00초
2025-10-15 09:18:50,243 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:18:50,243 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:18:50,243 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:18:50,243 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:18:50,243 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:18:50,243 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:18:50,243 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:18:50,243 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:18:50,243 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:18:50,243 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:18:50,243 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:18:50,243 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:18:50,259 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:18:50,259 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:18:54,410 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:18:54,410 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:18:54,410 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:18:54,410 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1612654c0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x161265940> root_client=<openai.OpenAI object at 0x161265700> root_async_client=<openai.AsyncOpenAI object at 0x1612658e0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:18:54,410 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:18:54,410 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:19:12,919 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:19:12,933 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1971자
2025-10-15 09:19:12,933 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 2월 0 day 혜택으로 두 가지 주요 프로모션을 안내하고 있습니다. 첫 번째는 만 13~34세 고객을 대상으로 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하는 이벤트입니다. 두 번째는 에이닷 T 멤버십 쿠폰함에 특정 시크릿코드('에이닷이빵쏜닷')를 입력하면 뚜레쥬...
2025-10-15 09:19:12,934 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:19:12,934 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:19:12,934 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:19:12,939 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:19:12,939 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:19:12,939 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:19:12,939 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:19:12,943 - utils - INFO - 📁 저장 위치: ./dag_images_local (local 모드)
2025-10-15 09:19:12,947 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d
2025-10-15 09:19:12,947 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:19:12,948 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:19:12,981 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:19:12,981 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png (local 모드)
2025-10-15 09:19:12,982 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png
2025-10-15 09:19:12,982 - __main__ - INFO - ✅ DAG 추출 완료: 18.532초, 노드: 5, 엣지: 3
2025-10-15 09:19:12,984 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:19:12] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:19:41,207 - __main__ - INFO - 📊 DAG 이미지 요청: dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png (from dag_images_local)
2025-10-15 09:19:41,208 - __main__ - INFO - 📁 대체 경로에서 찾음: dag_images
2025-10-15 09:19:41,214 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:19:41] "GET /dag_images/dag_7624a7d9dc579604383d572d683a433d2c942896ac4eaab92562f8ebd1814b0d.png HTTP/1.1" 200 -
2025-10-15 09:19:41,353 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:19:41] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-10-15 09:26:34,955 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:26:34,956 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:26:34,956 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:26:34,956 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:26:34,956 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:26:34,956 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:26:34,956 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:26:34,956 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:26:34,956 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:26:34,956 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:26:34,958 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:26:35,001 - mms_extractor - INFO - Using device: mps
2025-10-15 09:26:35,001 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-10-15 09:26:35,001 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:26:35,001 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:26:35,001 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:26:35,001 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:26:35,001 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:26:35,002 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:26:35,002 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:26:35,617 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:26:35,617 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.62초
2025-10-15 09:26:35,617 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:26:36,394 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:26:36,394 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.78초
2025-10-15 09:26:36,394 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:26:36,394 - mms_extractor - INFO - ============================================================
2025-10-15 09:26:36,394 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:26:36,394 - mms_extractor - INFO - ============================================================
2025-10-15 09:26:36,394 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:26:36,394 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:26:36,394 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:26:36,394 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:26:36,394 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:26:36,578 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:26:36,579 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:26:36,579 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:26:36,587 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:26:36,588 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:26:36,589 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:26:36,590 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:26:36,590 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:26:36,590 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:26:36,593 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:26:36,598 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:26:36,598 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:26:36,598 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:26:36,598 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:26:36,598 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:26:36,599 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:26:36,599 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:26:36,599 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:26:36,599 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:26:36,599 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:26:36,602 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:26:36,602 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:26:36,602 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:26:36,603 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:26:36,603 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:26:36,945 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:26:36,956 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:26:36,957 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-10-15 09:26:36,957 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:26:36,957 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:26:36,957 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:26:36,959 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:26:36,959 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:26:36,959 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:26:36,959 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:26:36,960 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:26:36,962 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:26:36,962 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-10-15 09:26:36,986 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:26:36,986 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:26:36,986 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:26:36,988 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:26:36,988 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:26:37,352 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:26:37,352 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:26:37,352 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:26:37,352 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:26:37,352 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:26:37,352 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:26:37,459 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:26:37,459 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:26:37,462 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:26:37,462 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:26:37,462 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:26:37,463 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:26:37,463 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:26:37,463 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:26:37,463 - mms_extractor - INFO - ============================================================
2025-10-15 09:26:37,463 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:26:37,463 - mms_extractor - INFO - ============================================================
2025-10-15 09:26:37,463 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:26:37,463 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:26:37,463 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:26:37,464 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:26:37,464 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:26:37,465 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:26:37,467 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:26:37,469 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:26:37,469 - mms_extractor - INFO - _load_data 실행완료: 1.08초
2025-10-15 09:26:37,469 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:26:37,470 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:26:37,470 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:26:37,470 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:26:37,470 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:26:37,470 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:26:37,470 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:26:37,470 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:26:37,470 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:26:37,470 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:26:37,470 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:26:37,470 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:26:37,515 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:26:37,515 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:27:01,591 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:27:01,591 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:27:01,591 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:27:01,592 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15ed61c40> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15ed61f10> root_client=<openai.OpenAI object at 0x15ec03170> root_async_client=<openai.AsyncOpenAI object at 0x15ed61d90> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:27:01,592 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:27:01,592 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:27:19,016 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:27:19,029 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1794자
2025-10-15 09:27:19,029 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:27:19,030 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:27:19,032 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:27:19,032 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:27:19,033 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:27:19,066 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:27:19,066 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:27:19,066 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:27:19,067 - __main__ - INFO - ✅ DAG 추출 완료: 17.439초, 노드: 5, 엣지: 3
2025-10-15 09:27:19,069 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:27:19] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:28:42,368 - __main__ - INFO - 📊 DAG 이미지 요청: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (from dag_images_local)
2025-10-15 09:28:42,369 - __main__ - ERROR - ❌ DAG 이미지 제공 오류: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-15 09:28:42,370 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:28:42] "[35m[1mGET /dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1[0m" 500 -
2025-10-15 09:29:39,105 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:29:39] "[33mGET /dag_images_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1[0m" 404 -
2025-10-15 09:29:44,000 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:29:44] "[33mGET /dag_image_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1[0m" 404 -
2025-10-15 09:31:59,875 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:31:59] "GET /health HTTP/1.1" 200 -
2025-10-15 09:32:18,186 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:32:18,186 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:32:18,186 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:32:18,186 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:32:18,186 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:32:18,186 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:32:18,186 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:32:18,186 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:32:18,186 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:32:18,186 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:32:18,188 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:32:18,237 - mms_extractor - INFO - Using device: mps
2025-10-15 09:32:18,237 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 09:32:18,237 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:32:18,238 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:32:18,238 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:32:18,238 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:32:18,238 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:32:18,238 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:32:18,238 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:32:18,849 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:32:18,849 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.61초
2025-10-15 09:32:18,849 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:32:19,531 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:32:19,531 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.68초
2025-10-15 09:32:19,531 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:32:19,531 - mms_extractor - INFO - ============================================================
2025-10-15 09:32:19,531 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:32:19,531 - mms_extractor - INFO - ============================================================
2025-10-15 09:32:19,531 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:32:19,531 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:32:19,531 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:32:19,531 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:32:19,531 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:32:19,708 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:32:19,708 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:32:19,708 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:32:19,716 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:32:19,717 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:32:19,718 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:32:19,718 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:32:19,719 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:32:19,719 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:32:19,721 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:32:19,725 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:32:19,725 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:32:19,725 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:32:19,725 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:32:19,725 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:32:19,726 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:32:19,726 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:32:19,726 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:32:19,726 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:32:19,726 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:32:19,728 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:32:19,728 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:32:19,728 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:32:19,728 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:32:19,729 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:32:20,051 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:32:20,062 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:32:20,063 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:32:20,063 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:32:20,063 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:32:20,063 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:32:20,066 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:32:20,066 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:32:20,066 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:32:20,066 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:32:20,067 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:32:20,069 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:32:20,069 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:32:20,091 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:32:20,091 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:32:20,091 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:32:20,093 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:32:20,093 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:32:20,426 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:32:20,426 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:32:20,426 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:32:20,426 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:32:20,426 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:32:20,426 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:32:20,530 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:32:20,530 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:32:20,533 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:32:20,534 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:32:20,534 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:32:20,534 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:32:20,534 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:32:20,535 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:32:20,535 - mms_extractor - INFO - ============================================================
2025-10-15 09:32:20,535 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:32:20,535 - mms_extractor - INFO - ============================================================
2025-10-15 09:32:20,535 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:32:20,535 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:32:20,535 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:32:20,535 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:32:20,535 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:32:20,536 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:32:20,538 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:32:20,540 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:32:20,541 - mms_extractor - INFO - _load_data 실행완료: 1.01초
2025-10-15 09:32:20,541 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:32:20,541 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:32:20,541 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:32:20,541 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:32:20,541 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:32:20,541 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:32:20,541 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:32:20,541 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:32:20,541 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:32:20,541 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:32:20,541 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:32:20,541 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:32:20,570 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:32:20,570 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:34:06,491 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:34:06,491 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:34:06,491 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:34:06,491 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15e9dec90> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15ea45d90> root_client=<openai.OpenAI object at 0x15e9afd70> root_async_client=<openai.AsyncOpenAI object at 0x15ea45cd0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:34:06,492 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:34:06,492 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:34:24,528 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:34:24,542 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1871자
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:34:24,543 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:34:24,544 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:34:24,545 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:34:24,545 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:34:24,546 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:34:24,580 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:34:24,581 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:34:24,581 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:34:24,581 - __main__ - INFO - ✅ DAG 추출 완료: 18.053초, 노드: 5, 엣지: 3
2025-10-15 09:34:24,583 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:34:24] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:34:33,267 - __main__ - INFO - 📊 DAG 이미지 요청: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (from dag_images_local)
2025-10-15 09:34:33,268 - __main__ - ERROR - ❌ DAG 이미지 제공 오류: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-10-15 09:34:33,268 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 09:34:33] "[35m[1mGET /dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1[0m" 500 -
2025-10-15 09:38:48,375 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:38:48,375 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:38:48,375 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:38:48,375 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:38:48,375 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:38:48,375 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:38:48,375 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:38:48,375 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:38:48,375 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:38:48,375 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:38:48,377 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:38:48,427 - mms_extractor - INFO - Using device: mps
2025-10-15 09:38:48,427 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 09:38:48,427 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:38:48,427 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:38:48,427 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:38:48,427 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:38:48,427 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:38:48,428 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:38:48,428 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:38:49,187 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:38:49,188 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.76초
2025-10-15 09:38:49,188 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:38:49,946 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:38:49,946 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.76초
2025-10-15 09:38:49,946 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:38:49,946 - mms_extractor - INFO - ============================================================
2025-10-15 09:38:49,946 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:38:49,946 - mms_extractor - INFO - ============================================================
2025-10-15 09:38:49,946 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:38:49,946 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:38:49,947 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:38:49,947 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:38:49,947 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:38:50,141 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:38:50,141 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:38:50,142 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:38:50,150 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:38:50,151 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:38:50,152 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:38:50,152 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:38:50,153 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:38:50,153 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:38:50,154 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:38:50,160 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:38:50,160 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:38:50,160 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:38:50,160 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:38:50,160 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:38:50,161 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:38:50,161 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:38:50,161 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:38:50,161 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:38:50,161 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:38:50,163 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:38:50,163 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:38:50,163 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:38:50,164 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:38:50,164 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:38:50,520 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:38:50,530 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:38:50,531 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-10-15 09:38:50,531 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:38:50,532 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:38:50,532 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:38:50,533 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:38:50,534 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:38:50,534 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:38:50,534 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:38:50,535 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:38:50,537 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:38:50,537 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증']
2025-10-15 09:38:50,571 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:38:50,572 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:38:50,572 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:38:50,575 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:38:50,575 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:38:50,951 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:38:50,952 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:38:50,952 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:38:50,952 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:38:50,952 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:38:50,952 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:38:51,055 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:38:51,055 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:38:51,059 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:38:51,059 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:38:51,059 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:38:51,059 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:38:51,059 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:38:51,060 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:38:51,060 - mms_extractor - INFO - ============================================================
2025-10-15 09:38:51,060 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:38:51,060 - mms_extractor - INFO - ============================================================
2025-10-15 09:38:51,060 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:38:51,060 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:38:51,060 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:38:51,060 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:38:51,060 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:38:51,062 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:38:51,064 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:38:51,067 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:38:51,067 - mms_extractor - INFO - _load_data 실행완료: 1.12초
2025-10-15 09:38:51,067 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:38:51,067 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:38:51,067 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:38:51,067 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:38:51,067 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:38:51,067 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:38:51,067 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:38:51,067 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:38:51,067 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:38:51,067 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:38:51,067 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:38:51,068 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:38:51,202 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:38:51,202 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:38:59,931 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:38:59,931 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:38:59,931 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:38:59,932 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15e359880> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15e359ac0> root_client=<openai.OpenAI object at 0x15e280d70> root_async_client=<openai.AsyncOpenAI object at 0x15e3598e0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:38:59,932 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:38:59,932 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:39:17,807 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1842자
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:39:17,821 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:39:17,822 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:39:17,822 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:39:17,823 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:39:17,823 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:39:17,824 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:39:17,856 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:39:17,921 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:39:17,922 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:39:17,922 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:39:17,922 - __main__ - INFO - ✅ DAG 추출 완료: 17.890초, 노드: 5, 엣지: 3
2025-10-15 09:39:17,924 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:39:17] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:44:45,952 - __main__ - INFO - 📁 DAG 저장 모드: local - Local disk storage (no NAS required)
2025-10-15 09:44:45,952 - __main__ - INFO - 📂 DAG 저장 경로: dag_images_local
2025-10-15 09:44:45,952 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:44:45,952 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:44:45,952 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:44:45,952 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:44:45,952 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:44:45,952 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:44:45,953 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:44:45,953 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:44:45,955 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:44:46,009 - mms_extractor - INFO - Using device: mps
2025-10-15 09:44:46,009 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 09:44:46,009 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:44:46,010 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:44:46,010 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:44:46,010 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:44:46,010 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:44:46,010 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:44:46,010 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:44:46,744 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:44:46,745 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.73초
2025-10-15 09:44:46,745 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:44:47,532 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:44:47,532 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.79초
2025-10-15 09:44:47,532 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:44:47,532 - mms_extractor - INFO - ============================================================
2025-10-15 09:44:47,532 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:44:47,532 - mms_extractor - INFO - ============================================================
2025-10-15 09:44:47,532 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:44:47,532 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:44:47,532 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:44:47,532 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:44:47,532 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:44:47,713 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:44:47,713 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:44:47,713 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:44:47,722 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:44:47,723 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:44:47,723 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:44:47,724 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:44:47,724 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:44:47,725 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:44:47,727 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:44:47,731 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:44:47,732 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:44:47,732 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:44:47,732 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:44:47,732 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:44:47,732 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:44:47,733 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:44:47,733 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:44:47,733 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:44:47,733 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:44:47,734 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:44:47,735 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:44:47,735 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:44:47,735 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:44:47,736 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:44:48,074 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:44:48,085 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:44:48,085 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:44:48,085 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:44:48,086 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:44:48,086 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:44:48,087 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:44:48,087 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:44:48,087 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:44:48,087 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:44:48,088 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:44:48,090 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:44:48,090 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 09:44:48,112 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:44:48,112 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:44:48,113 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:44:48,115 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:44:48,115 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:44:48,473 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:44:48,474 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:44:48,474 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:44:48,474 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:44:48,474 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:44:48,474 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:44:48,581 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:44:48,581 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:44:48,584 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:44:48,584 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:44:48,584 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:44:48,584 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:44:48,584 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:44:48,585 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:44:48,585 - mms_extractor - INFO - ============================================================
2025-10-15 09:44:48,585 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:44:48,585 - mms_extractor - INFO - ============================================================
2025-10-15 09:44:48,585 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:44:48,585 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:44:48,585 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:44:48,586 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:44:48,586 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:44:48,587 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:44:48,589 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:44:48,592 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:44:48,592 - mms_extractor - INFO - _load_data 실행완료: 1.06초
2025-10-15 09:44:48,592 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:44:48,592 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:44:48,592 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:44:48,592 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:44:48,592 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:44:48,592 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:44:48,592 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:44:48,592 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:44:48,592 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:44:48,592 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:44:48,592 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:44:48,592 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:44:48,608 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:44:48,608 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:44:52,704 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:44:52,705 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:44:52,705 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:44:52,705 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x162a75e50> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x162a76060> root_client=<openai.OpenAI object at 0x1624eb3b0> root_async_client=<openai.AsyncOpenAI object at 0x162a75eb0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:44:52,705 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:44:52,705 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:45:10,056 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:45:10,065 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1829자
2025-10-15 09:45:10,065 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:45:10,065 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:45:10,066 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:45:10,067 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:45:10,067 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:45:10,068 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:45:10,097 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:45:10,125 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:45:10,126 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images_local/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:45:10,126 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:45:10,126 - __main__ - INFO - ✅ DAG 추출 완료: 17.361초, 노드: 5, 엣지: 3
2025-10-15 09:45:10,128 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:45:10] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:47:55,669 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 09:47:55,670 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 09:47:55,670 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:47:55,670 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:47:55,670 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:47:55,670 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:47:55,670 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:47:55,670 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:47:55,670 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:47:55,670 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:47:55,671 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:47:55,719 - mms_extractor - INFO - Using device: mps
2025-10-15 09:47:55,720 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 09:47:55,720 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:47:55,720 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:47:55,720 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:47:55,720 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:47:55,720 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:47:55,721 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:47:55,721 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:47:56,605 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:47:56,605 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.89초
2025-10-15 09:47:56,605 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:47:57,399 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:47:57,399 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.79초
2025-10-15 09:47:57,399 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:47:57,400 - mms_extractor - INFO - ============================================================
2025-10-15 09:47:57,400 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:47:57,400 - mms_extractor - INFO - ============================================================
2025-10-15 09:47:57,400 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:47:57,400 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:47:57,400 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:47:57,400 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:47:57,400 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:47:57,571 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:47:57,571 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:47:57,571 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:47:57,579 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:47:57,580 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:47:57,581 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:47:57,582 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:47:57,582 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:47:57,582 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:47:57,584 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:47:57,590 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:47:57,590 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:47:57,590 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:47:57,590 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:47:57,590 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:47:57,591 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:47:57,591 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:47:57,591 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:47:57,591 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:47:57,591 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:47:57,592 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:47:57,593 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:47:57,593 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:47:57,593 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:47:57,593 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:47:57,936 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:47:57,946 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:47:57,947 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:47:57,947 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:47:57,948 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:47:57,948 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:47:57,949 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:47:57,949 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:47:57,949 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:47:57,949 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:47:57,950 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:47:57,952 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:47:57,952 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 09:47:57,974 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:47:57,974 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:47:57,974 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:47:57,976 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:47:57,976 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:47:58,334 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:47:58,335 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:47:58,335 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:47:58,335 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:47:58,335 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:47:58,335 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:47:58,437 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:47:58,438 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:47:58,441 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:47:58,442 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:47:58,442 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:47:58,442 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:47:58,442 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:47:58,443 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:47:58,443 - mms_extractor - INFO - ============================================================
2025-10-15 09:47:58,443 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:47:58,443 - mms_extractor - INFO - ============================================================
2025-10-15 09:47:58,443 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:47:58,443 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:47:58,443 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:47:58,443 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:47:58,443 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:47:58,444 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:47:58,447 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:47:58,449 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:47:58,449 - mms_extractor - INFO - _load_data 실행완료: 1.05초
2025-10-15 09:47:58,449 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:47:58,449 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:47:58,449 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:47:58,449 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:47:58,449 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:47:58,449 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:47:58,449 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:47:58,449 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:47:58,449 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:47:58,449 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:47:58,449 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:47:58,449 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:47:58,526 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:47:58,527 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:48:12,848 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:48:12,848 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:48:12,848 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:48:12,849 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x16254d1f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x16254d3d0> root_client=<openai.OpenAI object at 0x16254d1c0> root_async_client=<openai.AsyncOpenAI object at 0x16254d190> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:48:12,849 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:48:12,849 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:48:29,906 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:48:29,920 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1799자
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:48:29,921 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:48:29,922 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:48:29,923 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:48:29,923 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:48:29,924 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:48:29,955 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:48:29,965 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:48:29,965 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:48:29,965 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:48:29,965 - __main__ - INFO - ✅ DAG 추출 완료: 17.073초, 노드: 5, 엣지: 3
2025-10-15 09:48:29,967 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:48:29] "POST /dag HTTP/1.1" 200 -
2025-10-15 09:49:11,270 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:49:11] "GET /health HTTP/1.1" 200 -
2025-10-15 09:49:11,318 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:49:11] "GET /health HTTP/1.1" 200 -
2025-10-15 09:49:14,321 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:49:14] "GET /health HTTP/1.1" 200 -
2025-10-15 09:49:14,336 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 614자
2025-10-15 09:49:14,336 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 09:49:14,336 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 09:49:14,337 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-10-15 09:49:14,337 - mms_extractor - INFO - ============================================================
2025-10-15 09:49:14,337 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 09:49:14,337 - mms_extractor - INFO - ============================================================
2025-10-15 09:49:14,337 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-10-15 09:49:14,337 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-10-15 09:49:14,337 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 09:49:14,337 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 09:49:14,337 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-10-15 09:49:14,337 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-10-15 09:49:14,337 - mms_extractor - INFO - LLM 모델: ax
2025-10-15 09:49:14,338 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 09:49:14,338 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 09:49:14,338 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 09:49:14,338 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 09:49:14,338 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-10-15 09:49:14,341 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 09:49:15,116 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-10-15 09:49:15,117 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-10-15 09:49:15,122 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-10-15 09:49:15,123 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-10-15 09:49:15,123 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-10-15 09:49:15,123 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 09:49:30,161 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2775, 3)
2025-10-15 09:49:30,162 - mms_extractor - INFO - 퍼지 매칭 성공: 2775개 결과
2025-10-15 09:49:30,163 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-10-15 09:49:30,163 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 09:49:30,313 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2775, 3)
2025-10-15 09:49:30,314 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-10-15 09:49:30,314 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 09:49:30,318 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-10-15 09:49:30,320 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-10-15 09:49:30,321 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-10-15 09:49:30,325 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:49:30,330 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-10-15 09:49:30,331 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-10-15 09:49:30,331 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 15.99초
2025-10-15 09:49:30,331 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:49:30,331 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-10-15 09:49:30,331 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 09:49:30,719 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 09:49:30,719 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 09:49:30,719 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-10-15 09:49:30,719 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 09:49:30,719 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-10-15 09:49:30,719 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:49:30,719 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-10-15 09:49:30,720 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 09:49:30,720 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-10-15 09:49:30,722 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-10-15 09:49:30,722 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-10-15 09:49:30,722 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 09:49:30,722 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-10-15 09:49:30,722 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-10-15 09:49:30,722 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 09:49:30,722 - mms_extractor - INFO - 📝 프롬프트 길이: 8,276 문자
2025-10-15 09:49:30,722 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 09:49:30,722 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 09:49:37,963 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:49:37,968 - mms_extractor - INFO - LLM 응답 길이: 1045 문자
2025-10-15 09:49:37,968 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "쿠폰 제공 안내",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix(광고형 스탠다드)",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드 멤버십",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        },
        {
            "name": "Netflix 스탠다드 멤버십",
            "action": "가입"...
2025-10-15 09:49:37,969 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 09:49:37,970 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 09:49:37,970 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 09:49:37,970 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내'], 'product': [{'name': '우주패스 Netflix(광고형 스탠다드)', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}, {'name': 'Netflix 스탠다드 멤버십', 'action': '가입'}, {'name': 'Netflix 프리미엄 멤버십', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-10-15 09:49:37,970 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 09:49:37,970 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix(광고형 스탠다드)', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩', 'Netflix 스탠다드 멤버십', 'Netflix 프리미엄 멤버십']
2025-10-15 09:49:38,149 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 09:49:38,150 - mms_extractor - INFO - ============================================================
2025-10-15 09:49:38,150 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 09:49:38,150 - mms_extractor - INFO - ============================================================
2025-10-15 09:49:38,150 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-10-15 09:49:38,150 - mms_extractor - INFO - 목적: ['상품 가입 유도', '쿠폰 제공 안내', '혜택 안내']
2025-10-15 09:49:38,150 - mms_extractor - INFO - 상품 수: 5개
2025-10-15 09:49:38,150 - mms_extractor - INFO - 채널 수: 3개
2025-10-15 09:49:38,150 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 09:49:38,150 - mms_extractor - INFO - process_message 실행완료: 23.81초
2025-10-15 09:49:38,150 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 09:49:38,150 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 09:49:38,150 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:49:38,150 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-10-15 09:49:38,151 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x161bed1f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x16254deb0> root_client=<openai.OpenAI object at 0x1622f20c0> root_async_client=<openai.AsyncOpenAI object at 0x16200a360> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:49:38,151 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:49:38,151 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-10-15 09:49:59,142 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:49:59,146 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2516자
2025-10-15 09:49:59,146 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-10-15 09:49:59,146 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:49:59,146 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 248자
2025-10-15 09:49:59,146 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:49:59,147 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 6, 엣지 수: 5
2025-10-15 09:49:59,147 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션 페이지:접속', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용', '웨이브 콘텐츠 팩:이용', '2개월 동안 월 9,900원:할인', '추가 요금:지불']
2025-10-15 09:49:59,147 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션 페이지:접속', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:이용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:이용'), ('우주패스 Netflix:가입', '2개월 동안 월 9,900원:할인'), ('우주패스 Netflix:가입', '추가 요금:지불')]
2025-10-15 09:49:59,147 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:49:59,147 - utils - INFO - 📁 저장 위치: ./dag_images (local 모드)
2025-10-15 09:49:59,147 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 09:49:59,147 - utils - INFO - 📊 입력 그래프 - 노드 수: 6, 엣지 수: 5
2025-10-15 09:49:59,149 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:49:59,176 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:49:59,178 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:49:59,179 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 09:49:59,179 - mms_extractor - INFO - 🕒 DAG 처리 시간: 21.028초
2025-10-15 09:49:59,179 - mms_extractor - INFO - 📏 DAG 섹션 길이: 248자
2025-10-15 09:49:59,179 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)
(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)
(우주패스 Netflix:가입) -...
2025-10-15 09:49:59,179 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 09:49:59,179 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 09:49:59,350 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 09:49:59,352 - mongodb_utils - INFO - 문서 저장 성공: 68eeefb70e0555891c1e4b16
2025-10-15 09:49:59,353 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 09:49:59,353 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 09:49:59,353 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-15 09:49:59,353 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 5자
2025-10-15 09:49:59,353 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스 Netflix:가입) -[가입하면]-> (2개월 동안 월 9,900원:할인)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:이용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:이용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:이용)', '(프로모션 페이지:접속) -[접속하면]-> (우주패스 Netflix:가입)']...
2025-10-15 09:49:59,353 - __main__ - INFO - 추출 완료: 45.016초
2025-10-15 09:49:59,355 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:49:59] "POST /extract HTTP/1.1" 200 -
2025-10-15 09:49:59,388 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:49:59] "GET /health HTTP/1.1" 200 -
2025-10-15 09:51:03,976 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:51:03] "GET /health HTTP/1.1" 200 -
2025-10-15 09:51:04,106 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:51:04] "GET /health HTTP/1.1" 200 -
2025-10-15 09:51:04,116 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 613자
2025-10-15 09:51:04,120 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 09:51:04,120 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 09:51:04,120 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-10-15 09:51:04,120 - mms_extractor - INFO - ============================================================
2025-10-15 09:51:04,120 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 09:51:04,120 - mms_extractor - INFO - ============================================================
2025-10-15 09:51:04,120 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-10-15 09:51:04,120 - mms_extractor - INFO - 메시지 길이: 613 문자
2025-10-15 09:51:04,120 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 09:51:04,120 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 09:51:04,120 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-10-15 09:51:04,120 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-10-15 09:51:04,120 - mms_extractor - INFO - LLM 모델: ax
2025-10-15 09:51:04,120 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 09:51:04,120 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 09:51:04,120 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 09:51:04,120 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 09:51:04,120 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-10-15 09:51:04,124 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 09:51:04,155 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-10-15 09:51:04,156 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-10-15 09:51:04,164 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-10-15 09:51:04,164 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-10-15 09:51:04,165 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['Netflix', '넷플릭스', 'Wavve 콘텐츠 팩']
2025-10-15 09:51:04,165 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 09:51:04,564 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2778, 3)
2025-10-15 09:51:04,564 - mms_extractor - INFO - 퍼지 매칭 성공: 2778개 결과
2025-10-15 09:51:04,565 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-10-15 09:51:04,565 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 09:51:04,713 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2778, 3)
2025-10-15 09:51:04,713 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-10-15 09:51:04,713 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 09:51:04,717 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-10-15 09:51:04,719 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-10-15 09:51:04,720 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-10-15 09:51:04,722 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:51:04,725 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-10-15 09:51:04,725 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-10-15 09:51:04,726 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.61초
2025-10-15 09:51:04,726 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:51:04,726 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-10-15 09:51:04,726 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 09:51:05,101 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 09:51:05,101 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 09:51:05,101 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-10-15 09:51:05,101 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 09:51:05,101 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-10-15 09:51:05,101 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 09:51:05,101 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-10-15 09:51:05,101 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 09:51:05,102 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-10-15 09:51:05,104 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 37개
2025-10-15 09:51:05,104 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 콘텐츠 팩', 'action': '기타'}, {'name': 'FLO 콘텐츠 팩 플러스', 'action': '기타'}]
2025-10-15 09:51:05,104 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 09:51:05,104 - mms_extractor - INFO - 구성된 프롬프트 길이: 8276 문자
2025-10-15 09:51:05,104 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-10-15 09:51:05,104 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 09:51:05,104 - mms_extractor - INFO - 📝 프롬프트 길이: 8,276 문자
2025-10-15 09:51:05,104 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 09:51:05,104 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 09:51:11,381 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:51:11,383 - mms_extractor - INFO - LLM 응답 길이: 855 문자
2025-10-15 09:51:11,383 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "쿠폰 제공 안내"
    ],
    "product": [
        {
            "name": "우주패스 Netflix",
            "action": "가입"
        },
        {
            "name": "Netflix 광고형 스탠다드",
            "action": "가입"
        },
        {
            "name": "Wavve 콘텐츠 팩",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "URL",
            "value": "http://t...
2025-10-15 09:51:11,383 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 09:51:11,384 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 09:51:11,384 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 09:51:11,384 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1503', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-10-15 09:51:11,384 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 09:51:11,384 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드', 'Wavve 콘텐츠 팩']
2025-10-15 09:51:11,552 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 09:51:11,552 - mms_extractor - INFO - ============================================================
2025-10-15 09:51:11,552 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 09:51:11,552 - mms_extractor - INFO - ============================================================
2025-10-15 09:51:11,552 - mms_extractor - INFO - 제목: [SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-10-15 09:51:11,552 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '쿠폰 제공 안내']
2025-10-15 09:51:11,552 - mms_extractor - INFO - 상품 수: 3개
2025-10-15 09:51:11,552 - mms_extractor - INFO - 채널 수: 3개
2025-10-15 09:51:11,552 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 09:51:11,552 - mms_extractor - INFO - process_message 실행완료: 7.43초
2025-10-15 09:51:11,552 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 09:51:11,552 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 09:51:11,553 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:51:11,553 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 613자
2025-10-15 09:51:11,553 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x161bed1f0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x16254deb0> root_client=<openai.OpenAI object at 0x1622f20c0> root_async_client=<openai.AsyncOpenAI object at 0x16200a360> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:51:11,553 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:51:11,553 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3598자
2025-10-15 09:51:32,930 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2521자
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 넷플릭스와 웨이브를 동시에 저렴하게 이용할 수 있는 '우주패스 Netflix' 프로모션을 광고하고 있습니다. 주요 의도는 고객이 해당 프로모션에 가입하여 2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 이용하도록 유도하는 것입니다.

[식별된 가치 제안 목록]
- 2개월 동안 월...
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 276자
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['2개월 할인 쿠폰:다운로드', '우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용', '웨이브 콘텐츠 팩:사용', '넷플릭스:사용', '웨이브:사용', '추가 요금:지불']
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('2개월 할인 쿠폰:다운로드', '우주패스 Netflix:가입'), ('우주패스 Netflix:가입', '넷플릭스 광고형 스탠다드:사용'), ('우주패스 Netflix:가입', '웨이브 콘텐츠 팩:사용'), ('우주패스 Netflix:가입', '추가 요금:지불'), ('넷플릭스 광고형 스탠다드:사용', '넷플릭스:사용'), ('웨이브 콘텐츠 팩:사용', '웨이브:사용')]
2025-10-15 09:51:32,931 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:51:32,931 - utils - INFO - 📁 저장 위치: ./dag_images (local 모드)
2025-10-15 09:51:32,931 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_8a58d64a32112a00e17243c596fdf03f92760c87f597f8ddb2a5fe91e07cb15a
2025-10-15 09:51:32,931 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-10-15 09:51:32,932 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:51:32,960 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:51:32,961 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:51:32,962 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_8a58d64a32112a00e17243c596fdf03f92760c87f597f8ddb2a5fe91e07cb15a
2025-10-15 09:51:32,962 - mms_extractor - INFO - 🕒 DAG 처리 시간: 21.409초
2025-10-15 09:51:32,962 - mms_extractor - INFO - 📏 DAG 섹션 길이: 276자
2025-10-15 09:51:32,962 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (2개월 할인 쿠폰:다운로드) -[다운로드후]-> (우주패스 Netflix:가입)
(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)
(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)
(넷플릭스 광고형 스탠다드:사용) -[사용하면]-> (넷플릭스:사용)
(웨이브 콘텐츠 팩:사용) -[사용하면]-> ...
2025-10-15 09:51:32,962 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 09:51:32,962 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 09:51:32,970 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 09:51:32,972 - mongodb_utils - INFO - 문서 저장 성공: 68eef0140e0555891c1e4b18
2025-10-15 09:51:32,973 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 09:51:32,973 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 09:51:32,973 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-15 09:51:32,973 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-10-15 09:51:32,973 - __main__ - INFO - DAG 내용 미리보기: ['(2개월 할인 쿠폰:다운로드) -[다운로드후]-> (우주패스 Netflix:가입)', '(넷플릭스 광고형 스탠다드:사용) -[사용하면]-> (넷플릭스:사용)', '(우주패스 Netflix:가입) -[가입하면]-> (넷플릭스 광고형 스탠다드:사용)', '(우주패스 Netflix:가입) -[가입하면]-> (웨이브 콘텐츠 팩:사용)', '(우주패스 Netflix:가입) -[가입후]-> (추가 요금:지불) -[지불하면]-> (넷플릭스 스탠다드/프리미엄:사용)', '(웨이브 콘텐츠 팩:사용) -[사용하면]-> (웨이브:사용)']...
2025-10-15 09:51:32,973 - __main__ - INFO - 추출 완료: 28.853초
2025-10-15 09:51:32,974 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:51:32] "POST /extract HTTP/1.1" 200 -
2025-10-15 09:51:33,001 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:51:33] "GET /health HTTP/1.1" 200 -
2025-10-15 09:59:14,461 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 09:59:14,461 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 09:59:14,461 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 09:59:14,461 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 09:59:14,461 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 09:59:14,461 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 09:59:14,461 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 09:59:14,461 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 09:59:14,461 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 09:59:14,461 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 09:59:14,463 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 09:59:14,512 - mms_extractor - INFO - Using device: mps
2025-10-15 09:59:14,512 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 09:59:14,512 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 09:59:14,513 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 09:59:14,513 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 09:59:14,513 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 09:59:14,513 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 09:59:14,513 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 09:59:14,514 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 09:59:15,427 - mms_extractor - INFO - Model loaded on mps
2025-10-15 09:59:15,427 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.91초
2025-10-15 09:59:15,428 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 09:59:16,227 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 09:59:16,227 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.80초
2025-10-15 09:59:16,227 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 09:59:16,227 - mms_extractor - INFO - ============================================================
2025-10-15 09:59:16,227 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 09:59:16,227 - mms_extractor - INFO - ============================================================
2025-10-15 09:59:16,227 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 09:59:16,227 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 09:59:16,227 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 09:59:16,227 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 09:59:16,227 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:59:16,419 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 09:59:16,423 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:59:16,423 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 09:59:16,432 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 09:59:16,436 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 09:59:16,437 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:59:16,439 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:59:16,439 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 09:59:16,439 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 09:59:16,442 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 09:59:16,447 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 09:59:16,448 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 09:59:16,448 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:59:16,448 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 09:59:16,448 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 09:59:16,448 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 09:59:16,448 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:59:16,448 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 09:59:16,448 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 09:59:16,448 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 09:59:16,451 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 09:59:16,453 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 09:59:16,453 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:59:16,454 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 09:59:16,454 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 09:59:16,799 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 09:59:16,811 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 09:59:16,812 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 09:59:16,812 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 09:59:16,812 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 09:59:16,812 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 09:59:16,813 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 09:59:16,813 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 09:59:16,813 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 09:59:16,813 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 09:59:16,815 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 09:59:16,816 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 09:59:16,816 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 09:59:16,838 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 09:59:16,838 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 09:59:16,838 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 09:59:16,841 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 09:59:16,841 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 09:59:17,204 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 09:59:17,204 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 09:59:17,204 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 09:59:17,204 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 09:59:17,205 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 09:59:17,205 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 09:59:17,303 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 09:59:17,304 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 09:59:17,307 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 09:59:17,308 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 09:59:17,308 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 09:59:17,308 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 09:59:17,308 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 09:59:17,309 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 09:59:17,309 - mms_extractor - INFO - ============================================================
2025-10-15 09:59:17,309 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 09:59:17,309 - mms_extractor - INFO - ============================================================
2025-10-15 09:59:17,309 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 09:59:17,309 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 09:59:17,309 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 09:59:17,309 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 09:59:17,309 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 09:59:17,310 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 09:59:17,312 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 09:59:17,314 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 09:59:17,315 - mms_extractor - INFO - _load_data 실행완료: 1.09초
2025-10-15 09:59:17,315 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 09:59:17,315 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 09:59:17,315 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 09:59:17,315 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 09:59:17,315 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 09:59:17,315 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 09:59:17,315 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 09:59:17,315 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 09:59:17,315 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 09:59:17,315 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 09:59:17,315 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 09:59:17,315 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 09:59:17,410 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 09:59:17,410 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 09:59:21,737 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 09:59:21,737 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 09:59:21,737 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 09:59:21,738 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1629bd6a0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1629bd8e0> root_client=<openai.OpenAI object at 0x1629bd5e0> root_async_client=<openai.AsyncOpenAI object at 0x1629bd700> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 09:59:21,738 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 09:59:21,738 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 09:59:38,891 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 09:59:38,904 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1799자
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 09:59:38,905 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 09:59:38,907 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 09:59:38,907 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 09:59:38,908 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 09:59:38,939 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 09:59:38,947 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 09:59:38,947 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 09:59:38,947 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 09:59:38,947 - __main__ - INFO - ✅ DAG 추출 완료: 17.168초, 노드: 5, 엣지: 3
2025-10-15 09:59:38,949 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 09:59:38] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:01:55,455 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 10:01:55,456 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 10:01:55,456 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 10:01:55,456 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 10:01:55,456 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 10:01:55,456 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 10:01:55,456 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 10:01:55,456 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 10:01:55,456 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 10:01:55,456 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 10:01:55,458 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 10:01:55,508 - mms_extractor - INFO - Using device: mps
2025-10-15 10:01:55,508 - mms_extractor - INFO - _initialize_device 실행완료: 0.05초
2025-10-15 10:01:55,508 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 10:01:55,508 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 10:01:55,508 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 10:01:55,508 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 10:01:55,508 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 10:01:55,509 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 10:01:55,509 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 10:01:56,364 - mms_extractor - INFO - Model loaded on mps
2025-10-15 10:01:56,365 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.86초
2025-10-15 10:01:56,365 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 10:01:57,181 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 10:01:57,181 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.82초
2025-10-15 10:01:57,181 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 10:01:57,181 - mms_extractor - INFO - ============================================================
2025-10-15 10:01:57,181 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 10:01:57,181 - mms_extractor - INFO - ============================================================
2025-10-15 10:01:57,181 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 10:01:57,181 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 10:01:57,181 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 10:01:57,181 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 10:01:57,181 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:01:57,354 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 10:01:57,354 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:01:57,354 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 10:01:57,363 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 10:01:57,363 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 10:01:57,364 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:01:57,365 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:01:57,366 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 10:01:57,366 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 10:01:57,368 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 10:01:57,372 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 10:01:57,372 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 10:01:57,372 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:01:57,372 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 10:01:57,372 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 10:01:57,373 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 10:01:57,373 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:01:57,373 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 10:01:57,373 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 10:01:57,373 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 10:01:57,375 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 10:01:57,375 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 10:01:57,375 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:01:57,375 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 10:01:57,376 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:01:57,699 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 10:01:57,709 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 10:01:57,710 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-10-15 10:01:57,710 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 10:01:57,711 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 10:01:57,711 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 10:01:57,713 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 10:01:57,713 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 10:01:57,713 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 10:01:57,713 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 10:01:57,714 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 10:01:57,715 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 10:01:57,715 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주Pass Netflix 인증']
2025-10-15 10:01:57,738 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 10:01:57,738 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 10:01:57,738 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 10:01:57,740 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 10:01:57,740 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 10:01:58,105 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 10:01:58,106 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 10:01:58,106 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 10:01:58,106 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 10:01:58,106 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 10:01:58,106 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:01:58,205 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 10:01:58,205 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:01:58,208 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 10:01:58,208 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 10:01:58,209 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 10:01:58,209 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:01:58,209 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 10:01:58,209 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 10:01:58,209 - mms_extractor - INFO - ============================================================
2025-10-15 10:01:58,209 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 10:01:58,209 - mms_extractor - INFO - ============================================================
2025-10-15 10:01:58,209 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 10:01:58,210 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 10:01:58,210 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 10:01:58,210 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 10:01:58,210 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 10:01:58,211 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 10:01:58,213 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 10:01:58,214 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 10:01:58,215 - mms_extractor - INFO - _load_data 실행완료: 1.03초
2025-10-15 10:01:58,215 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 10:01:58,215 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 10:01:58,215 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 10:01:58,215 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 10:01:58,215 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 10:01:58,215 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 10:01:58,215 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 10:01:58,215 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 10:01:58,215 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 10:01:58,215 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 10:01:58,215 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 10:01:58,215 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 10:01:58,253 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 10:01:58,253 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 10:02:10,377 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:02:10] "GET /health HTTP/1.1" 200 -
2025-10-15 10:02:20,550 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 10:02:20,550 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:02:20,550 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 10:02:20,550 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f0956d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f095910> root_client=<openai.OpenAI object at 0x15f0954f0> root_async_client=<openai.AsyncOpenAI object at 0x15f095730> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:02:20,550 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:02:20,550 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 10:02:37,666 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:02:37,681 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1799자
2025-10-15 10:02:37,681 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 10:02:37,681 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:02:37,681 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 10:02:37,681 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:02:37,682 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 10:02:37,682 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:02:37,682 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:02:37,682 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:02:37,683 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 10:02:37,683 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 10:02:37,684 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:02:37,711 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 10:02:37,717 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 10:02:37,718 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 10:02:37,718 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:02:37,718 - __main__ - INFO - ✅ DAG 추출 완료: 17.132초, 노드: 5, 엣지: 3
2025-10-15 10:02:37,719 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:02:37] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:02:58,656 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 10:02:58,656 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:02:58,657 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 10:02:58,657 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f0956d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f095910> root_client=<openai.OpenAI object at 0x15f0954f0> root_async_client=<openai.AsyncOpenAI object at 0x15f095730> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:02:58,657 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:02:58,657 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 10:03:15,555 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:03:15,558 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1799자
2025-10-15 10:03:15,558 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 10:03:15,559 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:03:15,559 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 10:03:15,559 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:03:15,559 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 10:03:15,560 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:03:15,560 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:03:15,560 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:03:15,561 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 10:03:15,561 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 10:03:15,562 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:03:15,594 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 10:03:15,596 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 10:03:15,596 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 10:03:15,596 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:03:15,597 - __main__ - INFO - ✅ DAG 추출 완료: 16.904초, 노드: 5, 엣지: 3
2025-10-15 10:03:15,597 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:03:15] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:03:48,728 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 48자
2025-10-15 10:03:48,729 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:03:48,729 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 48자
2025-10-15 10:03:48,729 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f0956d0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f095910> root_client=<openai.OpenAI object at 0x15f0954f0> root_async_client=<openai.AsyncOpenAI object at 0x15f095730> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:03:48,729 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:03:48,729 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3033자
2025-10-15 10:04:09,868 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:04:09,870 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2271자
2025-10-15 10:04:09,870 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
베어유 웹사이트에 접속하여 쿠폰을 받고, 앱에서 시크릿코드를 입력하면 식빵쿠폰을 받을 수 있다는 혜택을 안내하고 있습니다. 광고주는 사용자가 웹사이트와 앱을 통해 특정 코드를 입력함으로써 추가 혜택을 얻도록 유도하고 있습니다.

[식별된 가치 제안 목록]
- 베어유 웹사이트 접속 시 쿠폰 제공
...
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 127자
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['베어유 웹사이트:접속', '쿠폰:수령', '베어유 앱:사용', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:04:09,871 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('베어유 웹사이트:접속', '쿠폰:수령'), ('베어유 웹사이트:접속', '베어유 앱:사용'), ('베어유 앱:사용', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:04:09,872 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:04:09,872 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_d87909be0d3c46ab49f237c717a99cfb0f3d5e5126d8232d639d9d99d752b642
2025-10-15 10:04:09,872 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-10-15 10:04:09,873 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:04:09,906 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 10:04:09,907 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 10:04:09,908 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_d87909be0d3c46ab49f237c717a99cfb0f3d5e5126d8232d639d9d99d752b642.png (local 모드)
2025-10-15 10:04:09,908 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_d87909be0d3c46ab49f237c717a99cfb0f3d5e5126d8232d639d9d99d752b642.png
2025-10-15 10:04:09,908 - __main__ - INFO - ✅ DAG 추출 완료: 21.143초, 노드: 5, 엣지: 4
2025-10-15 10:04:09,909 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:04:09] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:06:40,288 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 10:06:40,289 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 10:06:40,290 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 10:06:40,290 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 10:06:40,290 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 10:06:40,290 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 10:06:40,290 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 10:06:40,290 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 10:06:40,290 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 10:06:40,290 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 10:06:40,293 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 10:06:40,402 - mms_extractor - INFO - Using device: mps
2025-10-15 10:06:40,402 - mms_extractor - INFO - _initialize_device 실행완료: 0.11초
2025-10-15 10:06:40,402 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 10:06:40,403 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 10:06:40,403 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 10:06:40,403 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 10:06:40,403 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 10:06:40,404 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 10:06:40,404 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 10:06:41,462 - mms_extractor - INFO - Model loaded on mps
2025-10-15 10:06:41,462 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.06초
2025-10-15 10:06:41,462 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 10:06:42,269 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 10:06:42,269 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.81초
2025-10-15 10:06:42,269 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 10:06:42,269 - mms_extractor - INFO - ============================================================
2025-10-15 10:06:42,269 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 10:06:42,269 - mms_extractor - INFO - ============================================================
2025-10-15 10:06:42,269 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 10:06:42,269 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 10:06:42,269 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 10:06:42,269 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 10:06:42,270 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:06:42,468 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 10:06:42,468 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:06:42,468 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 10:06:42,477 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 10:06:42,478 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 10:06:42,479 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:06:42,479 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:06:42,480 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 10:06:42,480 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 10:06:42,488 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 10:06:42,493 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 10:06:42,493 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 10:06:42,493 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:06:42,494 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 10:06:42,494 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 10:06:42,494 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 10:06:42,494 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:06:42,494 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 10:06:42,494 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 10:06:42,494 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 10:06:42,502 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 10:06:42,502 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 10:06:42,502 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:06:42,503 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 10:06:42,503 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:06:42,864 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 10:06:42,877 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 10:06:42,878 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 10:06:42,878 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 10:06:42,879 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 10:06:42,879 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 10:06:42,881 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 10:06:42,881 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 10:06:42,881 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 10:06:42,881 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 10:06:42,882 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 10:06:42,884 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 10:06:42,884 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 10:06:42,908 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 10:06:42,908 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 10:06:42,908 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 10:06:42,919 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 10:06:42,919 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 10:06:43,304 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 10:06:43,304 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 10:06:43,304 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 10:06:43,304 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 10:06:43,304 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 10:06:43,304 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:06:43,400 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 10:06:43,400 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:06:43,403 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 10:06:43,403 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 10:06:43,403 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 10:06:43,403 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:06:43,403 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 10:06:43,404 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 10:06:43,404 - mms_extractor - INFO - ============================================================
2025-10-15 10:06:43,404 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 10:06:43,404 - mms_extractor - INFO - ============================================================
2025-10-15 10:06:43,404 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 10:06:43,404 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 10:06:43,404 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 10:06:43,404 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 10:06:43,405 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 10:06:43,406 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 10:06:43,408 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 10:06:43,410 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 10:06:43,410 - mms_extractor - INFO - _load_data 실행완료: 1.14초
2025-10-15 10:06:43,410 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 10:06:43,411 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 10:06:43,411 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 10:06:43,411 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 10:06:43,411 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 10:06:43,411 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 10:06:43,411 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 10:06:43,411 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 10:06:43,411 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 10:06:43,411 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 10:06:43,411 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 10:06:43,411 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 10:06:43,470 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 10:06:43,470 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 10:07:10,391 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 10:07:10,391 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:07:10,391 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 10:07:10,392 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x160a2d730> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x160a2d970> root_client=<openai.OpenAI object at 0x160913ef0> root_async_client=<openai.AsyncOpenAI object at 0x160a2d8e0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:07:10,392 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:07:10,392 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 10:07:27,583 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:07:27,596 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1799자
2025-10-15 10:07:27,597 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 10:07:27,597 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:07:27,597 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 10:07:27,600 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:07:27,601 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 10:07:27,601 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:07:27,601 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:07:27,601 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:07:27,607 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 10:07:27,607 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 10:07:27,608 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:07:27,643 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH
2025-10-15 10:07:27,700 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 76, in run_check
    proc = _run_input_lines(cmd, input_lines, kwargs=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 96, in _run_input_lines
    popen = subprocess.Popen(cmd, stdin=subprocess.PIPE, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1026, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/Cellar/python@3.12/3.12.11_1/Frameworks/Python.framework/Versions/3.12/lib/python3.12/subprocess.py", line 1955, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: PosixPath('dot')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    png_data = dot.pipe(format='png')
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 104, in pipe
    return self._pipe_legacy(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/_tools.py", line 185, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 121, in _pipe_legacy
    return self._pipe_future(format,
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/piping.py", line 161, in _pipe_future
    return self._pipe_lines(*args, input_encoding=self.encoding, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/piping.py", line 161, in pipe_lines
    proc = execute.run_check(cmd, capture_output=True, quiet=quiet, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/backend/execute.py", line 81, in run_check
    raise ExecutableNotFound(cmd) from e
graphviz.backend.execute.ExecutableNotFound: failed to execute PosixPath('dot'), make sure the Graphviz executables are on your systems' PATH

2025-10-15 10:07:27,700 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 10:07:27,701 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:07:27,701 - __main__ - INFO - ✅ DAG 추출 완료: 17.214초, 노드: 5, 엣지: 3
2025-10-15 10:07:27,703 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:07:27] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:11:57,785 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 10:11:57,786 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 10:11:57,786 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 10:11:57,786 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 10:11:57,786 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 10:11:57,786 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 10:11:57,786 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 10:11:57,786 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 10:11:57,786 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 10:11:57,786 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 10:11:57,788 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 10:11:57,873 - mms_extractor - INFO - Using device: mps
2025-10-15 10:11:57,873 - mms_extractor - INFO - _initialize_device 실행완료: 0.09초
2025-10-15 10:11:57,873 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 10:11:57,874 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 10:11:57,874 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 10:11:57,874 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 10:11:57,874 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 10:11:57,874 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 10:11:57,874 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 10:11:58,795 - mms_extractor - INFO - Model loaded on mps
2025-10-15 10:11:58,795 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.92초
2025-10-15 10:11:58,795 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 10:11:59,718 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 10:11:59,718 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.92초
2025-10-15 10:11:59,718 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 10:11:59,718 - mms_extractor - INFO - ============================================================
2025-10-15 10:11:59,719 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 10:11:59,719 - mms_extractor - INFO - ============================================================
2025-10-15 10:11:59,719 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 10:11:59,719 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 10:11:59,719 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 10:11:59,719 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 10:11:59,719 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:11:59,932 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 10:11:59,932 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:11:59,932 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 10:11:59,942 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 10:11:59,942 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 10:11:59,943 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:11:59,944 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:11:59,944 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 10:11:59,944 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 10:11:59,953 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 10:11:59,958 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 10:11:59,958 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 10:11:59,958 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:11:59,958 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 10:11:59,958 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 10:11:59,958 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 10:11:59,958 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:11:59,959 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 10:11:59,959 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 10:11:59,959 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 10:11:59,968 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 10:11:59,968 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 10:11:59,968 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:11:59,969 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 10:11:59,969 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:12:00,296 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 10:12:00,307 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 10:12:00,308 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 10:12:00,308 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 10:12:00,308 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 10:12:00,308 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 10:12:00,310 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 10:12:00,310 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 10:12:00,310 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 10:12:00,310 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 10:12:00,311 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 10:12:00,313 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 10:12:00,313 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-15 10:12:00,336 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 10:12:00,336 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 10:12:00,336 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 10:12:00,343 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 10:12:00,344 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 10:12:00,779 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 10:12:00,780 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 10:12:00,780 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 10:12:00,780 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 10:12:00,780 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 10:12:00,780 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:12:00,878 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 10:12:00,878 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:12:00,881 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 10:12:00,881 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 10:12:00,881 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 10:12:00,882 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:12:00,882 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 10:12:00,882 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 10:12:00,883 - mms_extractor - INFO - ============================================================
2025-10-15 10:12:00,883 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 10:12:00,883 - mms_extractor - INFO - ============================================================
2025-10-15 10:12:00,883 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 10:12:00,883 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 10:12:00,883 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 10:12:00,883 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 10:12:00,883 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 10:12:00,884 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 10:12:00,886 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 10:12:00,888 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 10:12:00,888 - mms_extractor - INFO - _load_data 실행완료: 1.17초
2025-10-15 10:12:00,888 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 10:12:00,888 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 10:12:00,888 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 10:12:00,888 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 10:12:00,888 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 10:12:00,888 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 10:12:00,888 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 10:12:00,888 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 10:12:00,888 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 10:12:00,888 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 10:12:00,888 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 10:12:00,888 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 10:12:00,911 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 10:12:00,911 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 10:12:12,799 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 10:12:12,799 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:12:12,799 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 10:12:12,800 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x162dbd550> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x162dbd730> root_client=<openai.OpenAI object at 0x162d4f6b0> root_async_client=<openai.AsyncOpenAI object at 0x162dbd700> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:12:12,800 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:12:12,800 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 10:12:30,447 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:12:30,462 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1851자
2025-10-15 10:12:30,462 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 10:12:30,462 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:12:30,463 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:12:30,464 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 10:12:30,464 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 10:12:30,465 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:12:30,466 - utils - ERROR - ❌ DAG 렌더링 중 오류 발생: unknown engine: '/usr/local/bin/dot' (must be one of ['circo', 'dot', 'fdp', 'neato', 'osage', 'patchwork', 'sfdp', 'twopi'])
2025-10-15 10:12:30,478 - utils - ERROR - Traceback (most recent call last):
  File "/Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/utils.py", line 172, in create_dag_diagram
    dot.engine = '/usr/local/bin/dot'
    ^^^^^^^^^^
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/parameters/engines.py", line 61, in engine
    self._verify_engine(engine)
  File "/Users/yongwook/workspace/AgenticWorkflow/venv/lib/python3.12/site-packages/graphviz/parameters/engines.py", line 28, in verify_engine
    raise ValueError(f'unknown engine: {engine!r}'
ValueError: unknown engine: '/usr/local/bin/dot' (must be one of ['circo', 'dot', 'fdp', 'neato', 'osage', 'patchwork', 'sfdp', 'twopi'])

2025-10-15 10:12:30,479 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 10:12:30,479 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:12:30,479 - __main__ - INFO - ✅ DAG 추출 완료: 17.664초, 노드: 5, 엣지: 3
2025-10-15 10:12:30,482 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:12:30] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:13:44,539 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 10:13:44,540 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 10:13:44,540 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 10:13:44,540 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 10:13:44,540 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 10:13:44,540 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 10:13:44,540 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 10:13:44,540 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 10:13:44,540 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 10:13:44,540 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 10:13:44,542 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 10:13:44,584 - mms_extractor - INFO - Using device: mps
2025-10-15 10:13:44,585 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-10-15 10:13:44,585 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 10:13:44,585 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 10:13:44,585 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 10:13:44,585 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 10:13:44,585 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 10:13:44,586 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 10:13:44,586 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 10:13:45,394 - mms_extractor - INFO - Model loaded on mps
2025-10-15 10:13:45,394 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.81초
2025-10-15 10:13:45,394 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 10:13:46,151 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 10:13:46,151 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.76초
2025-10-15 10:13:46,151 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 10:13:46,151 - mms_extractor - INFO - ============================================================
2025-10-15 10:13:46,151 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 10:13:46,151 - mms_extractor - INFO - ============================================================
2025-10-15 10:13:46,151 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 10:13:46,151 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 10:13:46,151 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 10:13:46,151 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 10:13:46,151 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:13:46,327 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 10:13:46,327 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:13:46,327 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 10:13:46,336 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 10:13:46,337 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 10:13:46,338 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:13:46,339 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:13:46,339 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 10:13:46,339 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 10:13:46,341 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 10:13:46,347 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 10:13:46,347 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 10:13:46,347 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:13:46,347 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 10:13:46,347 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 10:13:46,348 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 10:13:46,348 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:13:46,348 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 10:13:46,348 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 10:13:46,348 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 10:13:46,350 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 10:13:46,350 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 10:13:46,350 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:13:46,350 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 10:13:46,351 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:13:46,685 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 10:13:46,695 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 10:13:46,696 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 10:13:46,696 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 10:13:46,697 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 10:13:46,697 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 10:13:46,698 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 10:13:46,699 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 10:13:46,699 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 10:13:46,699 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 10:13:46,700 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 10:13:46,701 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 10:13:46,701 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증']
2025-10-15 10:13:46,724 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 10:13:46,724 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 10:13:46,724 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 10:13:46,726 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 10:13:46,726 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 10:13:47,110 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 10:13:47,110 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 10:13:47,110 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 10:13:47,110 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 10:13:47,110 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 10:13:47,110 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:13:47,211 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 10:13:47,212 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:13:47,214 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 10:13:47,215 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 10:13:47,215 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 10:13:47,215 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:13:47,215 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 10:13:47,216 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 10:13:47,216 - mms_extractor - INFO - ============================================================
2025-10-15 10:13:47,216 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 10:13:47,216 - mms_extractor - INFO - ============================================================
2025-10-15 10:13:47,216 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 10:13:47,216 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 10:13:47,216 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 10:13:47,216 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 10:13:47,216 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 10:13:47,217 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 10:13:47,219 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 10:13:47,221 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 10:13:47,221 - mms_extractor - INFO - _load_data 실행완료: 1.07초
2025-10-15 10:13:47,221 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 10:13:47,222 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 10:13:47,222 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 10:13:47,223 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 10:13:47,223 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 10:13:47,223 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 10:13:47,223 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 10:13:47,223 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 10:13:47,223 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 10:13:47,223 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 10:13:47,223 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 10:13:47,223 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 10:13:47,295 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 10:13:47,295 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 10:13:52,788 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 10:13:52,789 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:13:52,789 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 10:13:52,789 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1623e5310> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1623e5670> root_client=<openai.OpenAI object at 0x16215b170> root_async_client=<openai.AsyncOpenAI object at 0x1623e54c0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:13:52,789 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:13:52,789 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 10:14:10,662 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:14:10,678 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1871자
2025-10-15 10:14:10,678 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 10:14:10,678 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:14:10,678 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 89자
2025-10-15 10:14:10,678 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:14:10,679 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 3
2025-10-15 10:14:10,679 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트:접속', '베어유쿠폰:수령', '앱:접속', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 10:14:10,679 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트:접속', '베어유쿠폰:수령'), ('앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 10:14:10,679 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:14:10,680 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 10:14:10,680 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 3
2025-10-15 10:14:10,681 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:14:10,681 - utils - INFO - 📍 PATH에 /usr/local/bin 추가됨
2025-10-15 10:14:11,209 - utils - INFO - ✅ DAG 다이어그램 생성 완료: ./dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:14:11,210 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 10:14:11,210 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 10:14:11,210 - __main__ - INFO - ✅ DAG 추출 완료: 17.890초, 노드: 5, 엣지: 3
2025-10-15 10:14:11,212 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:11] "POST /dag HTTP/1.1" 200 -
2025-10-15 10:14:30,221 - __main__ - INFO - 📊 DAG 이미지 요청: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (from dag_images)
2025-10-15 10:14:30,240 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 10:14:30] "GET /dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1" 200 -
2025-10-15 10:14:35,724 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:35] "GET /health HTTP/1.1" 200 -
2025-10-15 10:14:35,774 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:35] "GET /health HTTP/1.1" 200 -
2025-10-15 10:14:38,785 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:38] "GET /health HTTP/1.1" 200 -
2025-10-15 10:14:38,810 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:38] "GET /health HTTP/1.1" 200 -
2025-10-15 10:14:40,141 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:14:40] "GET /health HTTP/1.1" 200 -
2025-10-15 10:14:40,153 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 284자
2025-10-15 10:14:40,153 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 10:14:40,153 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 10:14:40,153 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [T world] 5G 요금제 특가 혜택
(광고) 5G 슈퍼플랜 특가 이벤트 진행 중!

...
2025-10-15 10:14:40,154 - mms_extractor - INFO - ============================================================
2025-10-15 10:14:40,154 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 10:14:40,154 - mms_extractor - INFO - ============================================================
2025-10-15 10:14:40,154 - mms_extractor - INFO - 메시지 내용: [T world] 5G 요금제 특가 혜택
(광고) 5G 슈퍼플랜 특가 이벤트 진행 중!

🎯 이달의 특가
- 5G 슈퍼플랜 (데이터 무제한): 월 79,000원 → 39,000원 (50% 할인)
- 가족 추가 회선: 월 29,000원
- YouTube Premium 6개월 무료

📅 이벤트 기간: 2024.01.01 ~ 2024.01.31
🎁 신규 가입 시...
2025-10-15 10:14:40,154 - mms_extractor - INFO - 메시지 길이: 284 문자
2025-10-15 10:14:40,154 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 10:14:40,154 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 10:14:40,154 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-10-15 10:14:40,154 - mms_extractor - INFO - 엔티티 추출 모드: logic
2025-10-15 10:14:40,154 - mms_extractor - INFO - LLM 모델: ax
2025-10-15 10:14:40,154 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 10:14:40,154 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 10:14:40,154 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 10:14:40,154 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 10:14:40,154 - mms_extractor - INFO - 처리할 메시지 길이: 284 문자
2025-10-15 10:14:40,156 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 10:14:40,931 - mms_extractor - INFO - 분할된 문장 수: 5개
2025-10-15 10:14:40,932 - mms_extractor - INFO - 필터링된 문장들: [' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', '🎯 이달의 특가 5G 슈퍼플랜 데이터 무제한 월 79,000원 50 할인 가족 추가 회선 월 YouTube Premium 무료', '📅 이벤트 기간 🎁 신규 가입 시 갤럭시 버즈 증정']...
2025-10-15 10:14:40,934 - mms_extractor - INFO - 전체 토큰 수: 96개
2025-10-15 10:14:40,934 - mms_extractor - INFO - NNP 태그 토큰들: ['YouTube Premium', '갤럭시', '버즈']
2025-10-15 10:14:40,934 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['YouTube Premium', '버즈', '갤럭시']
2025-10-15 10:14:40,934 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 10:14:55,230 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1890, 3)
2025-10-15 10:14:55,231 - mms_extractor - INFO - 퍼지 매칭 성공: 1890개 결과
2025-10-15 10:14:55,232 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': '지정할인요금제', 'sim': 0.4285714285714286}, {'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4}, {'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': 'TAC+3 FAM Fold 예', 'sim': 0.41666666666666663}]
2025-10-15 10:14:55,232 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 10:14:55,339 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1890, 3)
2025-10-15 10:14:55,340 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': '지정할인요금제', 'sim': 0.34285714285714286}, {'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.26666666666666666}, {'sent': ' T world 5G 요금제 특가 혜택 광고 5G 슈퍼플랜 특가 이벤트 진행 중 ', 'item_nm_alias': 'TAC+3 FAM Fold 예', 'sim': 0.30000000000000004}]
2025-10-15 10:14:55,340 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 10:14:55,344 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 14개
2025-10-15 10:14:55,346 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-10-15 10:14:55,347 - mms_extractor - INFO - 통합된 후보 아이템 수: 18개
2025-10-15 10:14:55,350 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['YouTube Premium', '플로 무제한', '클럽T Premium', '클럽T premium', '티빙 Premium', '티빙 premium', '우주패스(YouTube Premium)②ⓐ', '우주패스(YouTube Premium)②ⓑ', '우주패스(YouTube Premium)②ⓒ', 'T메모링 Premium', 'T메모링 premium', '데이터차단 50', '안전결제 Premium', '안전결제 premium']
2025-10-15 10:14:55,352 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-15 10:14:55,353 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 무제한', 'item_id': ['NN00000117']}, {'item_nm': 'T메모링 프리미엄', 'item_id': ['NA00004687', 'NA00004687']}, {'item_nm': 'YouTube Premium', 'item_id': ['PR00000713', 'PR00000015', 'PR00000341', 'PR00000712']}]
2025-10-15 10:14:55,353 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 15.20초
2025-10-15 10:14:55,353 - mms_extractor - INFO - 추출된 후보 엔티티: ['YouTube Premium', '플로 무제한', '클럽T Premium', '클럽T premium', '티빙 Premium', '티빙 premium', '우주패스(YouTube Premium)②ⓐ', '우주패스(YouTube Premium)②ⓑ', '우주패스(YouTube Premium)②ⓒ', 'T메모링 Premium', 'T메모링 premium', '데이터차단 50', '안전결제 Premium', '안전결제 premium']
2025-10-15 10:14:55,353 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-15 10:14:55,353 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 10:14:55,810 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 10:14:55,810 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 10:14:55,810 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 417 문자
2025-10-15 10:14:55,810 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 10:14:55,810 - mms_extractor - INFO - 후보 아이템 리스트 크기: 14개
2025-10-15 10:14:55,811 - mms_extractor - INFO - 후보 아이템 리스트: ['YouTube Premium', '플로 무제한', '클럽T Premium', '클럽T premium', '티빙 Premium', '티빙 premium', '우주패스(YouTube Premium)②ⓐ', '우주패스(YouTube Premium)②ⓑ', '우주패스(YouTube Premium)②ⓒ', 'T메모링 Premium', 'T메모링 premium', '데이터차단 50', '안전결제 Premium', '안전결제 premium']
2025-10-15 10:14:55,811 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-15 10:14:55,811 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 10:14:55,811 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 무제한', 'item_id': ['NN00000117']}, {'item_nm': 'T메모링 프리미엄', 'item_id': ['NA00004687', 'NA00004687']}]
2025-10-15 10:14:55,812 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-10-15 10:14:55,812 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': 'FLO 무제한', 'action': '기타'}, {'name': 'T메모링 프리미엄', 'action': '기타'}]
2025-10-15 10:14:55,813 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 10:14:55,813 - mms_extractor - INFO - 구성된 프롬프트 길이: 5652 문자
2025-10-15 10:14:55,813 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-10-15 10:14:55,813 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 10:14:55,813 - mms_extractor - INFO - 📝 프롬프트 길이: 5,652 문자
2025-10-15 10:14:55,813 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 10:14:55,813 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 10:15:02,820 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:15:02,825 - mms_extractor - INFO - LLM 응답 길이: 1034 문자
2025-10-15 10:15:02,825 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[T world] 5G 요금제 특가 혜택",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "경품 제공 안내"
    ],
    "product": [
        {
            "name": "5G 슈퍼플랜 (데이터 무제한)",
            "action": "가입"
        },
        {
            "name": "가족 추가 회선",
            "action": "가입"
        },
        {
            "name": "YouTube Premium",
            "action": "무료 제공"
        },
        {
            "name": "갤럭시 버즈",
            "action": "경품 제공"
        }
    ],
    "cha...
2025-10-15 10:15:02,825 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 10:15:02,826 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 10:15:02,827 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 10:15:02,827 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[T world] 5G 요금제 특가 혜택', 'purpose': ['상품 가입 유도', '혜택 안내', '경품 제공 안내'], 'product': [{'name': '5G 슈퍼플랜 (데이터 무제한)', 'action': '가입'}, {'name': '가족 추가 회선', 'action': '가입'}, {'name': 'YouTube Premium', 'action': '무료 제공'}, {'name': '갤럭시 버즈', 'action': '경품 제공'}], 'channel': [{'type': 'URL', 'value': 'm.tworld.co.kr', 'action': '가입'}, {'type': '대리점', 'value': '전국 T world 매장', 'action': '가입'}, {'type': '전화번호', 'value': '114', 'action': '문의'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_요금제', '기변유도및해지방어']}
2025-10-15 10:15:02,827 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 10:15:02,828 - mms_extractor - INFO - LLM 추출 엔티티: ['5G 슈퍼플랜 (데이터 무제한)', '가족 추가 회선', 'YouTube Premium', '갤럭시 버즈']
2025-10-15 10:15:03,028 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 10:15:03,028 - mms_extractor - INFO - ============================================================
2025-10-15 10:15:03,028 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 10:15:03,028 - mms_extractor - INFO - ============================================================
2025-10-15 10:15:03,028 - mms_extractor - INFO - 제목: [T world] 5G 요금제 특가 혜택
2025-10-15 10:15:03,028 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '경품 제공 안내']
2025-10-15 10:15:03,028 - mms_extractor - INFO - 상품 수: 1개
2025-10-15 10:15:03,028 - mms_extractor - INFO - 채널 수: 4개
2025-10-15 10:15:03,028 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 10:15:03,028 - mms_extractor - INFO - process_message 실행완료: 22.87초
2025-10-15 10:15:03,028 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 10:15:03,028 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 10:15:03,028 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:15:03,029 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 284자
2025-10-15 10:15:03,029 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x162777da0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x162820740> root_client=<openai.OpenAI object at 0x1623e6a80> root_async_client=<openai.AsyncOpenAI object at 0x162777dd0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:15:03,029 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:15:03,029 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3269자
2025-10-15 10:15:30,004 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:15:30,007 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2954자
2025-10-15 10:15:30,008 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SKT는 5G 슈퍼플랜 요금제를 대상으로 50% 할인, YouTube Premium 6개월 무료, 갤럭시 버즈 증정 등의 혜택을 제공하며, 신규 가입을 유도하고 있다. 가입 채널로는 온라인(m.tworld.co.kr), 전국 T world 매장, 고객센터(114)를 안내하고 있다.

[식별된 가...
2025-10-15 10:15:30,008 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:15:30,008 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 816자
2025-10-15 10:15:30,008 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:15:30,009 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 6
2025-10-15 10:15:30,009 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['온라인:가입', '5G 슈퍼플랜:가입', '매장:방문', '고객센터:연락', '가족 추가 회선:가입']
2025-10-15 10:15:30,009 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('온라인:가입', '5G 슈퍼플랜:가입'), ('온라인:가입', '가족 추가 회선:가입'), ('매장:방문', '5G 슈퍼플랜:가입'), ('매장:방문', '가족 추가 회선:가입'), ('고객센터:연락', '5G 슈퍼플랜:가입'), ('고객센터:연락', '가족 추가 회선:가입')]
2025-10-15 10:15:30,009 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:15:30,010 - utils - INFO - 📁 저장 위치: ./dag_images (local 모드)
2025-10-15 10:15:30,010 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_c131c6fa4c3b3e8cf5c90a6d769ab54d2eda841fc185e5633f1e2c0948a18c00
2025-10-15 10:15:30,010 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 6
2025-10-15 10:15:30,013 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:15:30,476 - utils - INFO - ✅ DAG 다이어그램 생성 완료: ./dag_images/dag_c131c6fa4c3b3e8cf5c90a6d769ab54d2eda841fc185e5633f1e2c0948a18c00.png
2025-10-15 10:15:30,476 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_c131c6fa4c3b3e8cf5c90a6d769ab54d2eda841fc185e5633f1e2c0948a18c00
2025-10-15 10:15:30,476 - mms_extractor - INFO - 🕒 DAG 처리 시간: 27.448초
2025-10-15 10:15:30,476 - mms_extractor - INFO - 📏 DAG 섹션 길이: 816자
2025-10-15 10:15:30,476 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (50%할인:수령)
(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (YouTube Premium:사용)
(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (갤럭시 버즈:수령)
(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입후]...
2025-10-15 10:15:30,477 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 10:15:30,477 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 10:15:31,010 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 10:15:31,012 - mongodb_utils - INFO - 문서 저장 성공: 68eef5b35575e48a782e0f4f
2025-10-15 10:15:31,013 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 10:15:31,014 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 10:15:31,014 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-15 10:15:31,014 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 15자
2025-10-15 10:15:31,014 - __main__ - INFO - DAG 내용 미리보기: ['(고객센터:연락) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (50%할인:수령)', '(고객센터:연락) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (YouTube Premium:사용)', '(고객센터:연락) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (갤럭시 버즈:수령)', '(고객센터:연락) -[통해]-> (5G 슈퍼플랜:가입) -[가입후]-> (5G 서비스:사용)', '(고객센터:연락) -[통해]-> (가족 추가 회선:가입) -[가입하면]-> (29000원:수령)', '(매장:방문) -[방문하면]-> (5G 슈퍼플랜:가입) -[가입하면]-> (50%할인:수령)', '(매장:방문) -[방문하면]-> (5G 슈퍼플랜:가입) -[가입하면]-> (YouTube Premium:사용)', '(매장:방문) -[방문하면]-> (5G 슈퍼플랜:가입) -[가입하면]-> (갤럭시 버즈:수령)', '(매장:방문) -[방문하면]-> (5G 슈퍼플랜:가입) -[가입후]-> (5G 서비스:사용)', '(매장:방문) -[방문하면]-> (가족 추가 회선:가입) -[가입하면]-> (29000원:수령)', '(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (50%할인:수령)', '(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (YouTube Premium:사용)', '(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입하면]-> (갤럭시 버즈:수령)', '(온라인:가입) -[통해]-> (5G 슈퍼플랜:가입) -[가입후]-> (5G 서비스:사용)', '(온라인:가입) -[통해]-> (가족 추가 회선:가입) -[가입하면]-> (29000원:수령)']...
2025-10-15 10:15:31,014 - __main__ - INFO - 추출 완료: 50.860초
2025-10-15 10:15:31,017 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:15:31] "POST /extract HTTP/1.1" 200 -
2025-10-15 10:15:31,041 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:15:31] "GET /health HTTP/1.1" 200 -
2025-10-15 10:52:59,817 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-15 10:52:59,817 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-15 10:52:59,818 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 10:52:59,818 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 10:52:59,818 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 10:52:59,818 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 10:52:59,818 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 10:52:59,818 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 10:52:59,818 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 10:52:59,818 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 10:52:59,818 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 10:52:59,818 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 10:52:59,819 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 10:52:59,862 - mms_extractor - INFO - Using device: mps
2025-10-15 10:52:59,862 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-10-15 10:52:59,862 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 10:52:59,862 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 10:52:59,863 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 10:52:59,863 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 10:52:59,863 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 10:52:59,863 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 10:52:59,863 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 10:53:00,987 - mms_extractor - INFO - Model loaded on mps
2025-10-15 10:53:00,987 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 1.12초
2025-10-15 10:53:00,987 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 10:53:01,790 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 10:53:01,791 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.80초
2025-10-15 10:53:01,791 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 10:53:01,791 - mms_extractor - INFO - ============================================================
2025-10-15 10:53:01,791 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 10:53:01,791 - mms_extractor - INFO - ============================================================
2025-10-15 10:53:01,791 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 10:53:01,791 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 10:53:01,791 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 10:53:01,791 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 10:53:01,791 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:53:01,976 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 10:53:01,977 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:53:01,977 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 10:53:01,985 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 10:53:01,986 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 10:53:01,986 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:53:01,987 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:53:01,987 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 10:53:01,988 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 10:53:01,998 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 10:53:02,003 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 10:53:02,003 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 10:53:02,003 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:53:02,003 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 10:53:02,003 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 10:53:02,003 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 10:53:02,003 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:53:02,004 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 10:53:02,004 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 10:53:02,004 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 10:53:02,008 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 10:53:02,009 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 10:53:02,009 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:53:02,009 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 10:53:02,010 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 10:53:02,332 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 10:53:02,342 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 10:53:02,343 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 10:53:02,343 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 10:53:02,343 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 10:53:02,343 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 10:53:02,344 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 10:53:02,344 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 10:53:02,344 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 10:53:02,345 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 10:53:02,346 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 10:53:02,347 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 10:53:02,347 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주패스 Netflix 인증', '우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증']
2025-10-15 10:53:02,368 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 10:53:02,368 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 10:53:02,368 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 10:53:02,375 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 10:53:02,375 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 10:53:02,777 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 10:53:02,777 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 10:53:02,777 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 10:53:02,777 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 10:53:02,777 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 10:53:02,777 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 10:53:02,873 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 10:53:02,873 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 10:53:02,876 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 10:53:02,877 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 10:53:02,877 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 10:53:02,877 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 10:53:02,877 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 10:53:02,878 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 10:53:02,878 - mms_extractor - INFO - ============================================================
2025-10-15 10:53:02,878 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 10:53:02,878 - mms_extractor - INFO - ============================================================
2025-10-15 10:53:02,878 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 10:53:02,878 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 10:53:02,878 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 10:53:02,878 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 10:53:02,878 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 10:53:02,880 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 10:53:02,882 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 10:53:02,884 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 10:53:02,884 - mms_extractor - INFO - _load_data 실행완료: 1.09초
2025-10-15 10:53:02,884 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 10:53:02,884 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 10:53:02,884 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 10:53:02,884 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 10:53:02,884 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 10:53:02,884 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 10:53:02,884 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 10:53:02,884 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 10:53:02,884 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 10:53:02,884 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 10:53:02,884 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 10:53:02,884 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 10:53:03,033 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 10:53:03,033 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 10:55:01,077 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:01] "GET /health HTTP/1.1" 200 -
2025-10-15 10:55:02,916 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:02] "GET /health HTTP/1.1" 200 -
2025-10-15 10:55:02,945 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:02] "GET /health HTTP/1.1" 200 -
2025-10-15 10:55:04,057 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:04] "GET /health HTTP/1.1" 200 -
2025-10-15 10:55:04,068 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: ax, 메시지 길이: 323자
2025-10-15 10:55:04,068 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 10:55:04,068 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 10:55:04,068 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰,...
2025-10-15 10:55:04,068 - mms_extractor - INFO - ============================================================
2025-10-15 10:55:04,068 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 10:55:04,068 - mms_extractor - INFO - ============================================================
2025-10-15 10:55:04,068 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
(광고)[SKT] 우리 아이 첫 번째 스마트폰, ZEM 키즈폰__#04 고객님, 안녕하세요!
우리 아이 스마트폰 고민 중이셨다면, 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전한 키즈폰,
ZEM폰 포켓몬에디션3으로 우리 아이 취향을 저격해 보세요!

✨ 특별 혜택
- 월 요금 20% 할인 (첫 6개월)
-...
2025-10-15 10:55:04,068 - mms_extractor - INFO - 메시지 길이: 323 문자
2025-10-15 10:55:04,068 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 10:55:04,068 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 10:55:04,068 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-10-15 10:55:04,068 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-15 10:55:04,068 - mms_extractor - INFO - LLM 모델: ax
2025-10-15 10:55:04,068 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 10:55:04,068 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 10:55:04,069 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 10:55:04,069 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 10:55:04,069 - mms_extractor - INFO - 처리할 메시지 길이: 323 문자
2025-10-15 10:55:04,070 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 10:55:04,841 - mms_extractor - INFO - 분할된 문장 수: 7개
2025-10-15 10:55:04,841 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', ' 고객님 안녕하세요 ', '우리 아이 스마트폰 고민 중이셨다면 자녀 스마트폰 관리 앱 ZEM이 설치된 SKT만의 안전 키즈폰 ZEM폰 포켓몬에디션3으로 우리 아이 취향 저격 보세요 ']...
2025-10-15 10:55:04,844 - mms_extractor - INFO - 전체 토큰 수: 121개
2025-10-15 10:55:04,844 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', 'ZEM폰 포켓몬에디션3', '스마트폰', '키즈폰', 'ZEM폰 포켓몬에디션3', '포켓몬']
2025-10-15 10:55:04,844 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['키즈폰', 'ZEM폰 포켓몬에디션3']
2025-10-15 10:55:04,844 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 10:55:19,198 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (1371, 3)
2025-10-15 10:55:19,199 - mms_extractor - INFO - 퍼지 매칭 성공: 1371개 결과
2025-10-15 10:55:19,201 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.5}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.4444444444444444}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.4}]
2025-10-15 10:55:19,201 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 10:55:19,271 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (1371, 3)
2025-10-15 10:55:19,272 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트지킴이', 'sim': 0.4}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '스마트 디지털운행', 'sim': 0.35555555555555557}, {'sent': ' SK텔레콤 ZEM폰 포켓몬에디션3 안내 광고 SKT 우리 아이 첫 번째 스마트폰 ZEM 키즈폰', 'item_nm_alias': '마이스마트콜3_해지', 'sim': 0.32000000000000006}]
2025-10-15 10:55:19,272 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 10:55:19,276 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 6개
2025-10-15 10:55:19,278 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 1개
2025-10-15 10:55:19,279 - mms_extractor - INFO - 통합된 후보 아이템 수: 7개
2025-10-15 10:55:19,284 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-10-15 10:55:19,287 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (5, 2)
2025-10-15 10:55:19,287 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}, {'item_nm': 'ZEM폰 포켓몬에디션3', 'item_id': ['A5V5']}]
2025-10-15 10:55:19,287 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 15.22초
2025-10-15 10:55:19,287 - mms_extractor - INFO - 추출된 후보 엔티티: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-10-15 10:55:19,287 - mms_extractor - INFO - 매칭된 상품 정보: (5, 2)
2025-10-15 10:55:19,287 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 10:55:19,790 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 10:55:19,790 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 10:55:19,790 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-15 10:55:19,790 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 10:55:19,790 - mms_extractor - INFO - 후보 아이템 리스트 크기: 5개
2025-10-15 10:55:19,790 - mms_extractor - INFO - 후보 아이템 리스트: ['ZEM폰 포켓몬에디션3', '0서비스', '리안', '포미', 'T 서비스']
2025-10-15 10:55:19,791 - mms_extractor - INFO - extra_item_pdf 크기: (5, 2)
2025-10-15 10:55:19,791 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 10:55:19,791 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '0서비스', 'item_id': ['NA00008607']}, {'item_nm': 'T 서비스', 'item_id': ['NA00003911']}]
2025-10-15 10:55:19,792 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 5개
2025-10-15 10:55:19,792 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '0서비스', 'action': '기타'}, {'name': 'T 서비스', 'action': '기타'}]
2025-10-15 10:55:19,792 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 10:55:19,793 - mms_extractor - INFO - 구성된 프롬프트 길이: 5207 문자
2025-10-15 10:55:19,793 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-10-15 10:55:19,793 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 10:55:19,793 - mms_extractor - INFO - 📝 프롬프트 길이: 5,207 문자
2025-10-15 10:55:19,793 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 10:55:19,793 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 10:55:26,072 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:55:26,089 - mms_extractor - INFO - LLM 응답 길이: 863 문자
2025-10-15 10:55:26,089 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] ZEM폰 포켓몬에디션3 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "ZEM폰 포켓몬에디션3",
            "action": "가입"
        },
        {
            "name": "ZEM 프리미엄 서비스",
            "action": "가입"
        }
    ],
    "channel": [
        {
            "type": "전화번호",
            "value": "1588-0011",
            "action": "문의"
        },
        {
            "type": "대리점",
            "value": "가까운 T world 매...
2025-10-15 10:55:26,089 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 10:55:26,089 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 10:55:26,089 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 10:55:26,089 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] ZEM폰 포켓몬에디션3 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': 'ZEM폰 포켓몬에디션3', 'action': '가입'}, {'name': 'ZEM 프리미엄 서비스', 'action': '가입'}], 'channel': [{'type': '전화번호', 'value': '1588-0011', 'action': '문의'}, {'type': '대리점', 'value': '가까운 T world 매장', 'action': '추가 정보'}, {'type': 'URL', 'value': 'www.tworld.co.kr', 'action': '추가 정보'}, {'type': '전화번호', 'value': '080-011-0000', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-15 10:55:26,089 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 10:55:26,089 - mms_extractor - INFO - LLM 추출 엔티티: ['ZEM폰 포켓몬에디션3', 'ZEM 프리미엄 서비스']
2025-10-15 10:55:26,090 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-15 10:55:26,090 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-15 10:55:26,090 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-15 10:55:26,090 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-15 10:55:26,713 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1108개
2025-10-15 10:55:26,713 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(LGU)갤럭시 A16 키즈폰 무너에디션', '(신)무료SMS2000', '(신)무료문자2000', '+국제전화발신(00700)', '0 청년 37', '0 청년 43', '0 청년 49', '0 청년 59', '0 청년 59 100GB업', '0 청년 59 100기가업']
2025-10-15 10:55:26,714 - mms_extractor - INFO - 필터링 후 엔티티 수: 1105개
2025-10-15 10:55:26,714 - mms_extractor - INFO - 제거된 엔티티 수: 3개
2025-10-15 10:55:26,715 - mms_extractor - INFO - 최종 후보 엔티티 수: 1105개
2025-10-15 10:55:26,715 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1105개
2025-10-15 10:55:26,715 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-10-15 10:55:26,715 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1105개)
2025-10-15 10:55:26,715 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(LGU)갤럭시 A16 키즈폰 무너에디션', '(신)무료SMS2000', '(신)무료문자2000', '+국제전화발신(00700)', '0 청년 37', '0 청년 43', '0 청년 49', '0 청년 59', '0 청년 59 100GB업', '0 청년 59 100기가업']
2025-10-15 10:55:26,715 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-10-15 10:55:26,715 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,515 문자
2025-10-15 10:55:26,715 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,255 문자
2025-10-15 10:55:26,715 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-15 10:55:26,715 - mms_extractor - INFO - 📝 프롬프트 길이: 4,255 문자
2025-10-15 10:55:26,715 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-15 10:55:26,715 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-15 10:55:26,715 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-10-15 10:55:26,726 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 10:55:26,726 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 10:55:26,727 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15c8a23c0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f457ce0> root_client=<openai.OpenAI object at 0x1607658b0> root_async_client=<openai.AsyncOpenAI object at 0x15c930350> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:55:26,728 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f683110> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f45a7e0> root_client=<openai.OpenAI object at 0x160e2c320> root_async_client=<openai.AsyncOpenAI object at 0x15f681e80> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:55:26,728 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 10:55:26,731 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 10:55:26,731 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,352 문자
2025-10-15 10:55:26,731 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,352 문자
2025-10-15 10:55:26,732 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 10:55:26,732 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 10:55:26,732 - mms_extractor - INFO - 🔍 메시지 길이: 323 문자
2025-10-15 10:55:26,732 - mms_extractor - INFO - 🔍 메시지 길이: 323 문자
2025-10-15 10:55:26,736 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,123 문자
2025-10-15 10:55:26,736 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,123 문자
2025-10-15 10:55:27,333 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:55:28,701 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:55:28,709 - mms_extractor - INFO - ✅ LLM 추출 완료: ['ZEM 프리미엄 서비스', 'ZEM', 'ZEM폰 포켓몬에디션3', 'T world']
2025-10-15 10:55:28,886 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.80초
2025-10-15 10:55:28,926 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 10:55:28,926 - mms_extractor - INFO - ============================================================
2025-10-15 10:55:28,926 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 10:55:28,926 - mms_extractor - INFO - ============================================================
2025-10-15 10:55:28,926 - mms_extractor - INFO - 제목: [SK텔레콤] ZEM폰 포켓몬에디션3 안내
2025-10-15 10:55:28,926 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-15 10:55:28,926 - mms_extractor - INFO - 상품 수: 1개
2025-10-15 10:55:28,926 - mms_extractor - INFO - 채널 수: 4개
2025-10-15 10:55:28,926 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 10:55:28,926 - mms_extractor - INFO - process_message 실행완료: 24.86초
2025-10-15 10:55:28,926 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 10:55:28,927 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 10:55:28,927 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 10:55:28,927 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 323자
2025-10-15 10:55:28,927 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f500980> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f500710> root_client=<openai.OpenAI object at 0x15f5006e0> root_async_client=<openai.AsyncOpenAI object at 0x15f500950> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 10:55:28,927 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 10:55:28,927 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3308자
2025-10-15 10:55:50,836 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 10:55:50,838 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 2304자
2025-10-15 10:55:50,839 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 자녀의 첫 스마트폰으로 ZEM폰 포켓몬에디션3을 추천하며, 안전한 사용 환경과 다양한 특별 혜택을 강조합니다. 이 광고는 ZEM폰 포켓몬에디션3의 구매를 유도하고, 구매 시 제공되는 할인, 무료 케이스, 프리미엄 서비스 무료 체험 등의 혜택을 안내합니다.

[식별된 가치 제안 목록]...
2025-10-15 10:55:50,839 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 10:55:50,840 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 261자
2025-10-15 10:55:50,840 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 10:55:50,842 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 7, 엣지 수: 6
2025-10-15 10:55:50,843 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령', '포켓몬 케이스:수령', 'ZEM 프리미엄 서비스 3개월 무료:수령', 'ZEM 앱:사용', '안전한 스마트폰 사용 환경:경험']
2025-10-15 10:55:50,843 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('T world 매장:방문', 'ZEM폰 포켓몬에디션3:구매'), ('ZEM폰 포켓몬에디션3:구매', '월 요금 20% 할인:수령'), ('ZEM폰 포켓몬에디션3:구매', '포켓몬 케이스:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 프리미엄 서비스 3개월 무료:수령'), ('ZEM폰 포켓몬에디션3:구매', 'ZEM 앱:사용'), ('ZEM 앱:사용', '안전한 스마트폰 사용 환경:경험')]
2025-10-15 10:55:50,844 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 10:55:50,844 - utils - INFO - 📁 저장 위치: ./dag_images (local 모드)
2025-10-15 10:55:50,844 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-10-15 10:55:50,844 - utils - INFO - 📊 입력 그래프 - 노드 수: 7, 엣지 수: 6
2025-10-15 10:55:50,847 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 10:55:50,847 - utils - INFO - 📍 PATH에 /usr/local/bin 추가됨
2025-10-15 10:55:51,908 - utils - INFO - ✅ DAG 다이어그램 생성 완료: ./dag_images/dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be.png
2025-10-15 10:55:51,908 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_7918d9d4d4c330a6d67eec805db2f25918f6da467b9c0f04752a6d08c07595be
2025-10-15 10:55:51,908 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.982초
2025-10-15 10:55:51,909 - mms_extractor - INFO - 📏 DAG 섹션 길이: 261자
2025-10-15 10:55:51,909 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)
(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)
(ZEM폰 포켓몬에디션3:구매)...
2025-10-15 10:55:51,909 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 10:55:51,909 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 10:55:52,394 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 10:55:52,397 - mongodb_utils - INFO - 문서 저장 성공: 68eeff282a08ec83140842dd
2025-10-15 10:55:52,398 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 10:55:52,398 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 10:55:52,399 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-10-15 10:55:52,399 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 6자
2025-10-15 10:55:52,399 - __main__ - INFO - DAG 내용 미리보기: ['(T world 매장:방문) -[방문하면]-> (ZEM폰 포켓몬에디션3:구매)', '(ZEM 앱:사용) -[사용하면]-> (안전한 스마트폰 사용 환경:경험)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (ZEM 프리미엄 서비스 3개월 무료:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (월 요금 20% 할인:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매하면]-> (포켓몬 케이스:수령)', '(ZEM폰 포켓몬에디션3:구매) -[구매후]-> (ZEM 앱:사용)']...
2025-10-15 10:55:52,399 - __main__ - INFO - 추출 완료: 48.331초
2025-10-15 10:55:52,402 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:52] "POST /extract HTTP/1.1" 200 -
2025-10-15 10:55:52,431 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 10:55:52] "GET /health HTTP/1.1" 200 -
2025-10-15 11:19:00,266 - __main__ - INFO - 📊 DAG 이미지 요청: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (from dag_images)
2025-10-15 11:19:00,292 - werkzeug - INFO - 150.2.127.238 - - [15/Oct/2025 11:19:00] "[36mGET /dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png HTTP/1.1[0m" 304 -
2025-10-15 12:44:16,137 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-15 12:44:16,137 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-15 12:44:16,138 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-15 12:44:16,138 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-15 12:44:16,138 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.113.91:8000
2025-10-15 12:44:16,138 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-15 12:44:16,138 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-15 12:44:16,138 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-15 12:44:16,138 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-15 12:44:16,138 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-15 12:44:16,138 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-15 12:44:16,138 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-15 12:44:16,139 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-15 12:44:16,178 - mms_extractor - INFO - Using device: mps
2025-10-15 12:44:16,178 - mms_extractor - INFO - _initialize_device 실행완료: 0.04초
2025-10-15 12:44:16,178 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-15 12:44:16,179 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-15 12:44:16,179 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 12:44:16,179 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-15 12:44:16,179 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-15 12:44:16,179 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-15 12:44:16,179 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-15 12:44:16,819 - mms_extractor - INFO - Model loaded on mps
2025-10-15 12:44:16,820 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.64초
2025-10-15 12:44:16,820 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-15 12:44:17,539 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-15 12:44:17,539 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.72초
2025-10-15 12:44:17,539 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-15 12:44:17,539 - mms_extractor - INFO - ============================================================
2025-10-15 12:44:17,539 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-15 12:44:17,539 - mms_extractor - INFO - ============================================================
2025-10-15 12:44:17,539 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-15 12:44:17,539 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-15 12:44:17,539 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-15 12:44:17,539 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-15 12:44:17,539 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 12:44:17,708 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-15 12:44:17,708 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 12:44:17,708 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-15 12:44:17,716 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-15 12:44:17,717 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-15 12:44:17,718 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 12:44:17,719 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 12:44:17,719 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-15 12:44:17,720 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-15 12:44:17,727 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-15 12:44:17,734 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-15 12:44:17,734 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-15 12:44:17,735 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 12:44:17,735 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-15 12:44:17,735 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-15 12:44:17,736 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-15 12:44:17,736 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 12:44:17,736 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-15 12:44:17,736 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-15 12:44:17,736 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-15 12:44:17,743 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-15 12:44:17,744 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-15 12:44:17,744 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 12:44:17,744 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-15 12:44:17,744 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-15 12:44:18,057 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-15 12:44:18,066 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-15 12:44:18,068 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-10-15 12:44:18,068 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-15 12:44:18,068 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-15 12:44:18,068 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-15 12:44:18,070 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-15 12:44:18,070 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-15 12:44:18,070 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-15 12:44:18,070 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-15 12:44:18,071 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-15 12:44:18,073 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-15 12:44:18,073 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-10-15 12:44:18,094 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-15 12:44:18,094 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-15 12:44:18,094 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-15 12:44:18,103 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-15 12:44:18,103 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-15 12:44:18,450 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-15 12:44:18,451 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-15 12:44:18,451 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-15 12:44:18,451 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-15 12:44:18,451 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-15 12:44:18,451 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-15 12:44:18,539 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-15 12:44:18,539 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-15 12:44:18,542 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-15 12:44:18,543 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-15 12:44:18,543 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-15 12:44:18,543 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-15 12:44:18,543 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-15 12:44:18,543 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-15 12:44:18,543 - mms_extractor - INFO - ============================================================
2025-10-15 12:44:18,543 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-15 12:44:18,543 - mms_extractor - INFO - ============================================================
2025-10-15 12:44:18,544 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-15 12:44:18,544 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-15 12:44:18,544 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-15 12:44:18,544 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-15 12:44:18,544 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-15 12:44:18,545 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-15 12:44:18,547 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-15 12:44:18,549 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-15 12:44:18,550 - mms_extractor - INFO - _load_data 실행완료: 1.01초
2025-10-15 12:44:18,550 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-15 12:44:18,550 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-15 12:44:18,550 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-15 12:44:18,550 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-15 12:44:18,550 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-15 12:44:18,550 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-15 12:44:18,550 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-15 12:44:18,550 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-15 12:44:18,550 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-15 12:44:18,550 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-15 12:44:18,550 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-15 12:44:18,550 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-15 12:44:18,645 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.113.91:8000
2025-10-15 12:44:18,645 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-15 12:44:46,706 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 12:44:46] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:00,959 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:00] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:00,985 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:00] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:03,617 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:03] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:07,903 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:07] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:11,653 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:11] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:13,619 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:04:13] "GET /health HTTP/1.1" 200 -
2025-10-15 16:04:13,635 - __main__ - INFO - 🎯 DAG 추출 요청됨 - LLM: claude, 메시지 길이: 614자
2025-10-15 16:04:13,635 - __main__ - INFO - LLM 모델이 ax -> claude로 변경됨. 재초기화 중...
2025-10-15 16:04:13,638 - mms_extractor - INFO - LLM 초기화 완료: claude (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-15 16:04:13,638 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-15 16:04:13,638 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-15 16:04:13,638 - __main__ - INFO - DAG 추출과 함께 순차 처리 시작
2025-10-15 16:04:13,638 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 시작: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스...
2025-10-15 16:04:13,638 - mms_extractor - INFO - ============================================================
2025-10-15 16:04:13,638 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-15 16:04:13,638 - mms_extractor - INFO - ============================================================
2025-10-15 16:04:13,638 - mms_extractor - INFO - 메시지 내용: (광고)[SKT] 넷플릭스+웨이브 월 9,900원, 이게 되네! 
#04 고객님,
넷플릭스와 웨이브 둘 다 보고 싶었지만, 가격 때문에 망설이셨다면 지금이 바로 기회! 
오직 T 우주에서만, 
2개월 동안 월 9,900원에 넷플릭스와 웨이브를 모두 즐기실 수 있습니다.
8월 31일까지만 드리는 혜택이니, 지금 바로 가입해 보세요! 

■ 우주패스 Netfl...
2025-10-15 16:04:13,638 - mms_extractor - INFO - 메시지 길이: 614 문자
2025-10-15 16:04:13,638 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-15 16:04:13,638 - mms_extractor - INFO - 데이터 소스: local
2025-10-15 16:04:13,638 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-15 16:04:13,639 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-15 16:04:13,639 - mms_extractor - INFO - LLM 모델: claude
2025-10-15 16:04:13,639 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-15 16:04:13,639 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-15 16:04:13,639 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-15 16:04:13,639 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-15 16:04:13,639 - mms_extractor - INFO - 처리할 메시지 길이: 613 문자
2025-10-15 16:04:13,643 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-15 16:04:14,364 - mms_extractor - INFO - 분할된 문장 수: 13개
2025-10-15 16:04:14,365 - mms_extractor - INFO - 필터링된 문장들: [' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', ' 고객님 넷플릭스와 웨이브 둘 다 싶었지만 가격 때문에 망설이셨다면 지금이 바로 기회 ', '오직 T 우주에서만 동안 월 에 넷플릭스와 웨이브 모두 즐기실 수 있습니다 ']...
2025-10-15 16:04:14,369 - mms_extractor - INFO - 전체 토큰 수: 240개
2025-10-15 16:04:14,369 - mms_extractor - INFO - NNP 태그 토큰들: ['넷플릭스', '넷플릭스', '넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩', 'Netflix']
2025-10-15 16:04:14,369 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['넷플릭스', 'Netflix', 'Wavve 콘텐츠 팩']
2025-10-15 16:04:14,369 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-15 16:04:36,952 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2775, 3)
2025-10-15 16:04:36,952 - mms_extractor - INFO - 퍼지 매칭 성공: 2775개 결과
2025-10-15 16:04:36,954 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.5}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.4285714285714286}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.4285714285714286}]
2025-10-15 16:04:36,954 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-15 16:04:37,100 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2775, 3)
2025-10-15 16:04:37,101 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': '우주패스 넷플릭스 인증', 'sim': 0.4666666666666667}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 2일', 'sim': 0.30000000000000004}, {'sent': ' 광고 SKT 넷플릭스 웨이브 월 이게 되네 ', 'item_nm_alias': 'IB 이심 6일', 'sim': 0.30000000000000004}]
2025-10-15 16:04:37,101 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-15 16:04:37,105 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 71개
2025-10-15 16:04:37,108 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 4개
2025-10-15 16:04:37,109 - mms_extractor - INFO - 통합된 후보 아이템 수: 75개
2025-10-15 16:04:37,112 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 16:04:37,115 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (37, 2)
2025-10-15 16:04:37,116 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}, {'item_nm': 'Netflix', 'item_id': ['PR00000501', 'PR00000501']}]
2025-10-15 16:04:37,116 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 23.48초
2025-10-15 16:04:37,116 - mms_extractor - INFO - 추출된 후보 엔티티: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 16:04:37,116 - mms_extractor - INFO - 매칭된 상품 정보: (37, 2)
2025-10-15 16:04:37,116 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-15 16:04:37,416 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-15 16:04:37,416 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-15 16:04:37,416 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 423 문자
2025-10-15 16:04:37,416 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-15 16:04:37,416 - mms_extractor - INFO - 후보 아이템 리스트 크기: 57개
2025-10-15 16:04:37,416 - mms_extractor - INFO - 후보 아이템 리스트: ['Netflix', 'Wavve 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩', '넷플릭스', 'T 우주패스 Netflix', 'Netflix 광고형 스탠다드 이용권', 'Wavve 콘텐츠 팩(TV)', '우주패스 Netflix 추가혜택', 'Netflix 스탠다드 이용권', 'Wavve 콘텐츠 팩 프리미엄 연간', 'FLO 콘텐츠 팩', 'Wavve 콘텐츠 팩 플러스', 'Wavve 콘텐츠 팩(티비)', 'Wavve 콘텐츠 팩 연간', 'Wavve 콘텐츠 팩 프리미엄_인증', '우주패스 Netflix 인증', 'wavve 콘텐츠 팩 프리미엄_할인1', 'Wavve 콘텐츠 팩 plus', '멤버십 미가입자', '멤버십가입', 'Wavve 콘텐츠 팩 PLUS', '오다', 'Wavve 콘텐츠 팩 Plus', 'Wavve 콘텐츠 팩(이벤트)', 'Wavve 콘텐츠 팩 이용권', '티빙 광고형 스탠다드', 'Netflix 프리미엄 이용권', '웨이브 콘텐츠 팩 프리미엄', 'Wavve 콘텐츠 팩_인증', 'tving 광고형 스탠다드', 'TVING 광고형 스탠다드', '우주패스 life_T', 'Wavve 콘텐츠 팩 플러스 (구)', '타다 쿠폰', 'Netflix 단독', 'T 서비스', 'Wavve 콘텐츠 팩 premium', 'Wavve 콘텐츠 팩 Premium', 'Wavve 콘텐츠 팩 PREMIUM', 'Wavve 콘텐츠 팩_할인1', 'Wavve 콘텐츠 팩_할인2', '플로 콘텐츠 팩', 'T 우주패스 넷플릭스', 'Wavve 콘텐츠 팩 플러스 연간', 'Wavve 콘텐츠 팩 PLUS (구)', 'Wavve 콘텐츠 팩 Plus (구)', 'Wavve 콘텐츠 팩 plus (구)', 'FLO 콘텐츠 팩 플러스', 'Wavve 앤 DATA 프리미엄', '넷플릭스 광고형 스탠다드 이용권', 'Wavve 앤 Data 프리미엄', 'Wavve 앤 data 프리미엄', 'T 우주패스 DIY', 'T 우주패스 100', 'Wavve 앤 데이터 프리미엄', '클럽T 스탠다드', '클럽T 프리미엄']
2025-10-15 16:04:37,416 - mms_extractor - INFO - extra_item_pdf 크기: (37, 2)
2025-10-15 16:04:37,416 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-15 16:04:37,416 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': 'FLO 콘텐츠 팩', 'item_id': ['PR00000217', 'PR00000217']}, {'item_nm': 'FLO 콘텐츠 팩 플러스', 'item_id': ['PR00000218']}]
2025-10-15 16:04:37,416 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-15 16:04:37,416 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-15 16:04:37,417 - mms_extractor - INFO - 구성된 프롬프트 길이: 7454 문자
2025-10-15 16:04:37,417 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-15 16:04:37,417 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-15 16:04:37,417 - mms_extractor - INFO - 📝 프롬프트 길이: 7,454 문자
2025-10-15 16:04:37,417 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-15 16:04:37,417 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-15 16:04:43,036 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 16:04:43,050 - mms_extractor - INFO - LLM 응답 길이: 549 문자
2025-10-15 16:04:43,050 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "넷플릭스+웨이브 월 9,900원, 이게 되네!",
    "purpose": ["상품 가입 유도", "혜택 안내"],
    "product": [
        {"name": "우주패스 Netflix", "action": "가입"},
        {"name": "Netflix 광고형 스탠다드 멤버십", "action": "가입"},
        {"name": "Wavve 콘텐츠 팩", "action": "가입"}
    ],
    "channel": [
        {"type": "URL", "value": "http://t-mms.kr/jAs/#74", "action": "추가 정보"},
        {"type": "전화번호", "value": "1505", "action": "문의"},
        {"type": "전화번호", "value": "1504", "action": "수신 거부"}
    ],
    "p...
2025-10-15 16:04:43,050 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-15 16:04:43,051 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-15 16:04:43,051 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-15 16:04:43,051 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '넷플릭스+웨이브 월 9,900원, 이게 되네!', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '우주패스 Netflix', 'action': '가입'}, {'name': 'Netflix 광고형 스탠다드 멤버십', 'action': '가입'}, {'name': 'Wavve 콘텐츠 팩', 'action': '가입'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/jAs/#74', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1505', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_구독', '사용법/혜택/이벤트안내_구독']}
2025-10-15 16:04:43,051 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-15 16:04:43,051 - mms_extractor - INFO - LLM 추출 엔티티: ['우주패스 Netflix', 'Netflix 광고형 스탠다드 멤버십', 'Wavve 콘텐츠 팩']
2025-10-15 16:04:43,052 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-15 16:04:43,052 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-15 16:04:43,052 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-15 16:04:43,052 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-15 16:04:44,614 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1747개
2025-10-15 16:04:44,614 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-10-15 16:04:44,616 - mms_extractor - INFO - 필터링 후 엔티티 수: 1743개
2025-10-15 16:04:44,616 - mms_extractor - INFO - 제거된 엔티티 수: 4개
2025-10-15 16:04:44,616 - mms_extractor - INFO - 최종 후보 엔티티 수: 1743개
2025-10-15 16:04:44,616 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1743개
2025-10-15 16:04:44,616 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-10-15 16:04:44,616 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1743개)
2025-10-15 16:04:44,616 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(N)T 우주패스 할인2④ⓐ', '(N)T 우주패스 할인2④ⓑ', '(N)T 우주패스 할인2④ⓒ', '(N)T 우주패스 할인2④ⓓ', '(N)T 우주패스 할인④ⓐ', '(N)T 우주패스 할인④ⓑ', '(N)T 우주패스 할인④ⓒ', '(N)T 우주패스 할인④ⓓ', '(구)자동연결', '0 청년 109(Netflix)']
2025-10-15 16:04:44,616 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-10-15 16:04:44,616 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,760 문자
2025-10-15 16:04:44,616 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,790 문자
2025-10-15 16:04:44,616 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-15 16:04:44,616 - mms_extractor - INFO - 📝 프롬프트 길이: 4,790 문자
2025-10-15 16:04:44,616 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-15 16:04:44,616 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-15 16:04:44,617 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-10-15 16:04:44,633 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 16:04:44,633 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15fef1040> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15c54aa50> root_client=<openai.OpenAI object at 0x15f282750> root_async_client=<openai.AsyncOpenAI object at 0x1603beae0> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f27ac90> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f27b4d0> root_client=<openai.OpenAI object at 0x1603a9c70> root_async_client=<openai.AsyncOpenAI object at 0x15f278650> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,597 문자
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-15 16:04:44,633 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-10-15 16:04:44,634 - mms_extractor - INFO - 🔍 메시지 길이: 613 문자
2025-10-15 16:04:44,634 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-10-15 16:04:44,634 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,658 문자
2025-10-15 16:04:45,483 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 16:04:48,482 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 16:04:48,498 - mms_extractor - INFO - ✅ LLM 추출 완료: ['T 우주', 'Wavve 콘텐츠 팩', '넷플릭스', '웨이브', 'Netflix', '우주패스 Netflix']
2025-10-15 16:04:48,774 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 5.72초
2025-10-15 16:04:48,781 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-15 16:04:48,781 - mms_extractor - INFO - ============================================================
2025-10-15 16:04:48,782 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-15 16:04:48,782 - mms_extractor - INFO - ============================================================
2025-10-15 16:04:48,782 - mms_extractor - INFO - 제목: 넷플릭스+웨이브 월 9,900원, 이게 되네!
2025-10-15 16:04:48,782 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-15 16:04:48,782 - mms_extractor - INFO - 상품 수: 6개
2025-10-15 16:04:48,782 - mms_extractor - INFO - 채널 수: 3개
2025-10-15 16:04:48,782 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-15 16:04:48,782 - mms_extractor - INFO - process_message 실행완료: 35.14초
2025-10-15 16:04:48,782 - mms_extractor - INFO - 순차적 처리로 메인 추출 및 DAG 추출 수행
2025-10-15 16:04:48,782 - mms_extractor - INFO - ============================== DAG 추출 시작 ==============================
2025-10-15 16:04:48,782 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 16:04:48,782 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 614자
2025-10-15 16:04:48,782 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x1603aac60> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x1603ab500> root_client=<openai.OpenAI object at 0x1603aacf0> root_async_client=<openai.AsyncOpenAI object at 0x1603ab830> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 16:04:48,782 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 16:04:48,782 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3599자
2025-10-15 16:05:10,167 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 16:05:10,172 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1727자
2025-10-15 16:05:10,172 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

**메시지 요약 및 핵심 의도:**
SKT가 T우주 플랫폼을 통해 넷플릭스와 웨이브를 결합한 우주패스 Netflix 상품을 프로모션 가격(2개월간 월 9,900원)으로 제공하는 광고입니다. 고객이 온라인 링크를 통해 접속하여 프로모션 쿠폰을 다운로드하고 서비스에 가입하도록 유도하는 것이 핵심 의도입니다.

**식별된 가치 제안 목록...
2025-10-15 16:05:10,172 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 16:05:10,174 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 157자
2025-10-15 16:05:10,175 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 16:05:10,176 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 5, 엣지 수: 4
2025-10-15 16:05:10,176 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['프로모션링크:접속', '프로모션쿠폰:다운로드', '우주패스Netflix:가입', '넷플릭스:사용', 'Wavve콘텐츠팩:사용']
2025-10-15 16:05:10,176 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('프로모션링크:접속', '프로모션쿠폰:다운로드'), ('프로모션쿠폰:다운로드', '우주패스Netflix:가입'), ('우주패스Netflix:가입', '넷플릭스:사용'), ('우주패스Netflix:가입', 'Wavve콘텐츠팩:사용')]
2025-10-15 16:05:10,176 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 16:05:10,177 - utils - INFO - 📁 저장 위치: ./dag_images (local 모드)
2025-10-15 16:05:10,177 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 16:05:10,177 - utils - INFO - 📊 입력 그래프 - 노드 수: 5, 엣지 수: 4
2025-10-15 16:05:10,179 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 16:05:10,180 - utils - INFO - 📍 PATH에 /usr/local/bin 추가됨
2025-10-15 16:05:11,200 - utils - INFO - ✅ DAG 다이어그램 생성 완료: ./dag_images/dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7.png
2025-10-15 16:05:11,200 - mms_extractor - INFO - ✅ DAG 추출 완료: dag_95754a0322c7153287e6c564437447a1040ee98e573de11f91fc3d4793120ca7
2025-10-15 16:05:11,200 - mms_extractor - INFO - 🕒 DAG 처리 시간: 22.418초
2025-10-15 16:05:11,200 - mms_extractor - INFO - 📏 DAG 섹션 길이: 157자
2025-10-15 16:05:11,200 - mms_extractor - INFO - 📄 DAG 내용 미리보기: (프로모션링크:접속) -[접속하면]-> (프로모션쿠폰:다운로드)
(프로모션쿠폰:다운로드) -[다운로드하면]-> (우주패스Netflix:가입)
(우주패스Netflix:가입) -[가입하면]-> (넷플릭스:사용)
(우주패스Netflix:가입) -[가입하면]-> (Wavve콘텐츠팩:사용)...
2025-10-15 16:05:11,200 - mms_extractor - INFO - 워커 프로세스에서 메시지 처리 완료
2025-10-15 16:05:11,200 - __main__ - INFO - MongoDB 저장 중...
2025-10-15 16:05:11,754 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-15 16:05:11,755 - mongodb_utils - INFO - 문서 저장 성공: 68ef47a7eca943c98ed10c2f
2025-10-15 16:05:11,756 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-15 16:05:11,757 - __main__ - INFO - MongoDB 저장 완료!
2025-10-15 16:05:11,757 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 3개
2025-10-15 16:05:11,757 - __main__ - INFO - ✅ DAG 추출 성공 - 길이: 4자
2025-10-15 16:05:11,757 - __main__ - INFO - DAG 내용 미리보기: ['(우주패스Netflix:가입) -[가입하면]-> (Wavve콘텐츠팩:사용)', '(우주패스Netflix:가입) -[가입하면]-> (넷플릭스:사용)', '(프로모션링크:접속) -[접속하면]-> (프로모션쿠폰:다운로드)', '(프로모션쿠폰:다운로드) -[다운로드하면]-> (우주패스Netflix:가입)']...
2025-10-15 16:05:11,757 - __main__ - INFO - 추출 완료: 58.122초
2025-10-15 16:05:11,759 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:05:11] "POST /extract HTTP/1.1" 200 -
2025-10-15 16:05:11,784 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:05:11] "GET /health HTTP/1.1" 200 -
2025-10-15 16:12:50,319 - __main__ - INFO - 🎯 DAG 추출 요청 - LLM: ax, 메시지 길이: 370자
2025-10-15 16:12:50,319 - entity_dag_extractor - INFO - 🚀 DAG 추출 프로세스 시작
2025-10-15 16:12:50,319 - entity_dag_extractor - INFO - 📝 입력 메시지 길이: 370자
2025-10-15 16:12:50,320 - entity_dag_extractor - INFO - 🤖 사용 LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15eb818e0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15eb81c10> root_client=<openai.OpenAI object at 0x15e988a70> root_async_client=<openai.AsyncOpenAI object at 0x15eb81a30> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-15 16:12:50,320 - entity_dag_extractor - INFO - 🤖 LLM에 DAG 추출 요청 중...
2025-10-15 16:12:50,320 - entity_dag_extractor - INFO - 📏 프롬프트 길이: 3355자
2025-10-15 16:13:08,108 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-15 16:13:08,112 - entity_dag_extractor - INFO - 📝 LLM 응답 길이: 1884자
2025-10-15 16:13:08,112 - entity_dag_extractor - INFO - 📄 LLM 응답 미리보기: ## 1. 메시지 분석

```
[메시지 요약 및 핵심 의도]
SK텔레콤은 만 13~34세 고객을 대상으로 2월 10일(토)에 베어유 강의 14일 무료 수강 쿠폰을 선착순 3만 명에게 제공하며, 에이닷 T 멤버십 쿠폰함에 '에이닷이빵쏜닷' 시크릿코드를 입력하면 뚜레쥬르 데일리우유식빵 무료 쿠폰을 제공하는 이벤트를 안내하고 있다.

[식별된 가치 제안 목록]...
2025-10-15 16:13:08,112 - entity_dag_extractor - INFO - 🔍 DAG 섹션 추출 중...
2025-10-15 16:13:08,113 - entity_dag_extractor - INFO - 📄 추출된 DAG 섹션 길이: 96자
2025-10-15 16:13:08,113 - entity_dag_extractor - INFO - 🔗 DAG 파싱 중...
2025-10-15 16:13:08,114 - entity_dag_extractor - INFO - 📊 파싱된 DAG - 노드 수: 4, 엣지 수: 3
2025-10-15 16:13:08,115 - entity_dag_extractor - INFO - 🎯 DAG 노드 목록: ['웹사이트/앱:접속', '베어유쿠폰:수령', '시크릿코드:입력', '식빵쿠폰:수령']
2025-10-15 16:13:08,115 - entity_dag_extractor - INFO - 🔗 DAG 엣지 목록: [('웹사이트/앱:접속', '베어유쿠폰:수령'), ('웹사이트/앱:접속', '시크릿코드:입력'), ('시크릿코드:입력', '식빵쿠폰:수령')]
2025-10-15 16:13:08,115 - entity_dag_extractor - INFO - ✅ DAG 추출 프로세스 완료
2025-10-15 16:13:08,118 - utils - INFO - 🎨 DAG 다이어그램 생성 시작 - 파일명: dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526
2025-10-15 16:13:08,118 - utils - INFO - 📊 입력 그래프 - 노드 수: 4, 엣지 수: 3
2025-10-15 16:13:08,119 - utils - INFO - 🖼️ DAG 이미지 렌더링 중...
2025-10-15 16:13:08,516 - utils - INFO - ✅ DAG 다이어그램 생성 완료: ./dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 16:13:08,516 - __main__ - INFO - 📊 DAG 이미지 저장됨: /Users/yongwook/workspace/AgenticWorkflow/mms_extractor_exp/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png (local 모드)
2025-10-15 16:13:08,516 - __main__ - INFO - 🌐 DAG 이미지 URL: http://172.23.113.91:8000/dag_images/dag_0bfe9e7c4e4ced70efb921928cdfe1135e34f1e586e8388e4f9a6b76bf826526.png
2025-10-15 16:13:08,517 - __main__ - INFO - ✅ DAG 추출 완료: 17.796초, 노드: 4, 엣지: 3
2025-10-15 16:13:08,517 - werkzeug - INFO - 127.0.0.1 - - [15/Oct/2025 16:13:08] "POST /dag HTTP/1.1" 200 -
2025-10-20 09:10:38,553 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 09:10:38] "GET /health HTTP/1.1" 200 -
2025-10-20 13:50:17,621 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 13:50:17] "GET /health HTTP/1.1" 200 -
2025-10-20 13:50:22,682 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 13:50:22] "GET /health HTTP/1.1" 200 -
2025-10-20 13:50:25,276 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 13:50:25] "GET /health HTTP/1.1" 200 -
2025-10-20 13:50:25,299 - __main__ - INFO - LLM 모델이 claude -> ax로 변경됨. 재초기화 중...
2025-10-20 13:50:25,332 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-20 13:50:25,333 - mms_extractor - INFO - _initialize_llm 실행완료: 0.03초
2025-10-20 13:50:25,333 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 13:50:25,334 - mms_extractor - INFO - ============================================================
2025-10-20 13:50:25,334 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 13:50:25,334 - mms_extractor - INFO - ============================================================
2025-10-20 13:50:25,334 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=#...
2025-10-20 13:50:25,334 - mms_extractor - INFO - 메시지 길이: 816 문자
2025-10-20 13:50:25,334 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 13:50:25,334 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 13:50:25,334 - mms_extractor - INFO - 상품 정보 추출 모드: nlp
2025-10-20 13:50:25,334 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 13:50:25,334 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 13:50:25,338 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 13:50:25,339 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 13:50:25,339 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 13:50:25,339 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 13:50:25,339 - mms_extractor - INFO - 처리할 메시지 길이: 816 문자
2025-10-20 13:50:25,369 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 13:50:25,956 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 13:50:25,960 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 13:50:25,973 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 13:50:25,973 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 13:50:25,973 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['기프트', '죠르디', '아이폰', '택1', '스톤', '스펙', '에이프릴', '사죠영', '실드', '코로나', '한정판', '카카오톡', '프리디', '충전기']
2025-10-20 13:50:25,973 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 13:50:34,961 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 13:50:34,962 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 13:50:34,968 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 13:50:34,968 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 13:50:35,137 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 13:50:35,139 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 13:50:35,139 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 13:50:35,153 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 13:50:35,157 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 13:50:35,159 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 13:50:35,164 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 13:50:35,171 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 13:50:35,172 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 13:50:35,172 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 9.83초
2025-10-20 13:50:35,172 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 13:50:35,172 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 13:50:35,172 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 13:50:36,591 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 13:50:36,591 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 13:50:36,591 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 13:50:36,591 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 13:50:36,591 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 13:50:36,591 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 13:50:36,591 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 13:50:36,591 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 13:50:36,592 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 13:50:36,594 - mms_extractor - INFO - NLP 모드: 제품 요소 준비 완료 - 10개
2025-10-20 13:50:36,595 - mms_extractor - INFO - NLP 모드 제품 요소 샘플: [{'name': '5G 음성', 'action': '기타'}, {'name': 'IPHONE 16', 'action': '기타'}]
2025-10-20 13:50:36,595 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 13:50:36,596 - mms_extractor - INFO - 구성된 프롬프트 길이: 6118 문자
2025-10-20 13:50:36,596 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: False
2025-10-20 13:50:36,596 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 13:50:36,596 - mms_extractor - INFO - 📝 프롬프트 길이: 6,118 문자
2025-10-20 13:50:36,596 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 13:50:36,596 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 13:50:45,779 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 13:50:45,789 - mms_extractor - INFO - LLM 응답 길이: 1288 문자
2025-10-20 13:50:45,789 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내",
        "웹/앱 접속 유도"
    ],
    "product": [
        {
            "name": "아이폰 12",
            "action": "사전예약"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "사전예약"
        },
        {
            "name": "죠르디 한정판 기프트",
            "action": "사은품"
        },
        {
            "name": "멀티 무선 충전기",
            "action": "사은품"
        },
        ...
2025-10-20 13:50:45,789 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 13:50:45,790 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 13:50:45,790 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 13:50:45,790 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내', '웹/앱 접속 유도'], 'product': [{'name': '아이폰 12', 'action': '사전예약'}, {'name': '아이폰 12 Pro', 'action': '사전예약'}, {'name': '죠르디 한정판 기프트', 'action': '사은품'}, {'name': '멀티 무선 충전기', 'action': '사은품'}, {'name': '보조배터리+멀티백', 'action': '사은품'}, {'name': '3in1 무선 충전 살균기', 'action': '사은품'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 13:50:45,790 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 13:50:45,790 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 12', '아이폰 12 Pro', '죠르디 한정판 기프트', '멀티 무선 충전기', '보조배터리+멀티백', '3in1 무선 충전 살균기']
2025-10-20 13:50:45,790 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 13:50:45,790 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-20 13:50:45,791 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-20 13:50:45,791 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-20 13:50:47,360 - mms_extractor - INFO - 로직 기반 추출 원본 엔티티 수: 1301개
2025-10-20 13:50:47,360 - mms_extractor - INFO - 원본 엔티티 샘플 (최대 10개): ['(KTF)아이폰 16E', '(LGU)아이폰 16E', '0 청년 109(T 우주)', '0 청년 109(TVING)', '0 청년 109(tving)', '0 청년 109(스마트기기)', '0 청년 109(티빙)', '0 청년 37', '0 청년 37 DATA 충전 1GB', '0 청년 37 Data 충전 1GB']
2025-10-20 13:50:47,362 - mms_extractor - INFO - 필터링 후 엔티티 수: 1296개
2025-10-20 13:50:47,362 - mms_extractor - INFO - 제거된 엔티티 수: 5개
2025-10-20 13:50:47,362 - mms_extractor - INFO - 최종 후보 엔티티 수: 1296개
2025-10-20 13:50:47,362 - mms_extractor - WARNING - ⚠️ 후보 엔티티가 매우 많습니다: 1296개
2025-10-20 13:50:47,362 - mms_extractor - WARNING - 이는 프롬프트 길이를 크게 증가시킬 수 있습니다.
2025-10-20 13:50:47,362 - mms_extractor - WARNING - 성능을 위해 상위 100개만 사용합니다. (원본: 1296개)
2025-10-20 13:50:47,362 - mms_extractor - INFO - 최종 후보 엔티티 샘플 (최대 10개): ['(KTF)아이폰 16E', '(LGU)아이폰 16E', '0 청년 109(T 우주)', '0 청년 109(TVING)', '0 청년 109(tving)', '0 청년 109(스마트기기)', '0 청년 109(티빙)', '0 청년 37', '0 청년 37 DATA 충전 1GB', '0 청년 37 Data 충전 1GB']
2025-10-20 13:50:47,362 - mms_extractor - INFO - === 후보 엔티티 추출 완료 ===
2025-10-20 13:50:47,362 - mms_extractor - INFO - 🔍 프롬프트에 추가될 엔티티 섹션 길이: 1,734 문자
2025-10-20 13:50:47,362 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 4,967 문자
2025-10-20 13:50:47,362 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-20 13:50:47,362 - mms_extractor - INFO - 📝 프롬프트 길이: 4,967 문자
2025-10-20 13:50:47,362 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-20 13:50:47,363 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-20 13:50:47,363 - mms_extractor - INFO - 🔄 2개 LLM 모델로 엔티티 추출 시작
2025-10-20 13:50:47,365 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-20 13:50:47,365 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-20 13:50:47,366 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f2f1340> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f565250> root_client=<openai.OpenAI object at 0x15f2f1310> root_async_client=<openai.AsyncOpenAI object at 0x15f7dc080> model_name='skt/ax4' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 프롬프트 구성 중 - LLM 모델: client=<openai.resources.chat.completions.completions.Completions object at 0x15f564ec0> async_client=<openai.resources.chat.completions.completions.AsyncCompletions object at 0x15f565850> root_client=<openai.OpenAI object at 0x15f5654f0> root_async_client=<openai.AsyncOpenAI object at 0x15f564a40> model_name='amazon/anthropic/claude-sonnet-4-20250514' temperature=0.0 model_kwargs={} openai_api_key=SecretStr('**********') openai_api_base='https://api.platform.a15t.com/v1' max_tokens=4000
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 후보 엔티티 개수: 100개
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,571 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 후보 엔티티 문자열 길이: 1,571 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 메시지 길이: 816 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 메시지 길이: 816 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,835 문자
2025-10-20 13:50:47,367 - mms_extractor - INFO - 🔍 예상 전체 프롬프트 길이: 4,835 문자
2025-10-20 13:50:48,972 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 13:50:49,267 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 13:50:49,277 - mms_extractor - INFO - ✅ LLM 추출 완료: ['T다이렉트샵', 'T기프트', '아이폰 12', '[크레앙] 3in1 무선 충전 살균기', '아이폰 12 Pro', '[프리디] 멀티 무선 충전기', '[사죠영] 죠르디 한정판 기프트', '아이폰12 Pro', '[에이프릴스톤] 보조배터리+멀티백']
2025-10-20 13:50:49,546 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 3.76초
2025-10-20 13:50:49,558 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 13:50:49,558 - mms_extractor - INFO - ============================================================
2025-10-20 13:50:49,558 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 13:50:49,558 - mms_extractor - INFO - ============================================================
2025-10-20 13:50:49,558 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내
2025-10-20 13:50:49,558 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내', '웹/앱 접속 유도']
2025-10-20 13:50:49,558 - mms_extractor - INFO - 상품 수: 2개
2025-10-20 13:50:49,558 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 13:50:49,558 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 13:50:49,558 - mms_extractor - INFO - process_message 실행완료: 24.22초
2025-10-20 13:50:49,558 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 13:50:49,570 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 13:50:49,572 - mongodb_utils - INFO - 문서 저장 성공: 68f5bfa9eca943c98ed10c31
2025-10-20 13:50:49,572 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 13:50:49,572 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 13:50:49,572 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-20 13:50:49,572 - __main__ - INFO - 추출 완료: 24.274초
2025-10-20 13:50:49,573 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 13:50:49] "POST /extract HTTP/1.1" 200 -
2025-10-20 13:50:49,592 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 13:50:49] "GET /health HTTP/1.1" 200 -
2025-10-20 14:17:34,826 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-20 14:17:34,826 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-20 14:17:34,826 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-20 14:17:34,826 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-20 14:17:34,826 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.24.95:8000
2025-10-20 14:17:34,826 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-20 14:17:34,826 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-20 14:17:34,826 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-20 14:17:34,826 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-20 14:17:34,826 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-20 14:17:34,826 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-20 14:17:34,826 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-20 14:17:34,900 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-20 14:17:35,358 - mms_extractor - INFO - Using device: mps
2025-10-20 14:17:35,359 - mms_extractor - INFO - _initialize_device 실행완료: 0.46초
2025-10-20 14:17:35,359 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-20 14:17:35,360 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-20 14:17:35,360 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-20 14:17:35,360 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-20 14:17:35,360 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-20 14:17:35,360 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-20 14:17:35,361 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-20 14:17:38,164 - mms_extractor - INFO - Model loaded on mps
2025-10-20 14:17:38,164 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 2.80초
2025-10-20 14:17:38,164 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-20 14:17:39,315 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-20 14:17:39,315 - mms_extractor - INFO - _initialize_kiwi 실행완료: 1.15초
2025-10-20 14:17:39,315 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-20 14:17:39,315 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:39,315 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-20 14:17:39,315 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:39,315 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-20 14:17:39,315 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-20 14:17:39,315 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-20 14:17:39,315 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-20 14:17:39,315 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 14:17:39,592 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-20 14:17:39,593 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 14:17:39,593 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-20 14:17:39,601 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-20 14:17:39,602 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-20 14:17:39,603 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 14:17:39,603 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 14:17:39,604 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-20 14:17:39,604 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-20 14:17:39,611 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-20 14:17:39,617 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-20 14:17:39,617 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-20 14:17:39,617 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 14:17:39,618 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-20 14:17:39,618 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-20 14:17:39,618 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-20 14:17:39,618 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 14:17:39,618 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-20 14:17:39,618 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-20 14:17:39,618 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-20 14:17:39,627 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-20 14:17:39,627 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-20 14:17:39,627 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 14:17:39,628 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-20 14:17:39,628 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 14:17:39,955 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-20 14:17:39,965 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-20 14:17:39,966 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-10-20 14:17:39,966 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-20 14:17:39,966 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-20 14:17:39,966 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-20 14:17:39,968 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-20 14:17:39,968 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-20 14:17:39,968 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-20 14:17:39,968 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-20 14:17:39,969 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-20 14:17:39,970 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-20 14:17:39,970 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주pass Netflix 인증']
2025-10-20 14:17:39,993 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-20 14:17:39,993 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-20 14:17:39,993 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-20 14:17:40,006 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-20 14:17:40,006 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-20 14:17:40,358 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-20 14:17:40,358 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-20 14:17:40,358 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-20 14:17:40,358 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-20 14:17:40,358 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-20 14:17:40,358 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 14:17:40,442 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-20 14:17:40,442 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 14:17:40,445 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-20 14:17:40,445 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-20 14:17:40,445 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-20 14:17:40,445 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 14:17:40,445 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-20 14:17:40,446 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-20 14:17:40,446 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:40,446 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-20 14:17:40,446 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:40,446 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-20 14:17:40,446 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-20 14:17:40,446 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-20 14:17:40,446 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-20 14:17:40,446 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-20 14:17:40,447 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-20 14:17:40,449 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-20 14:17:40,452 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-20 14:17:40,452 - mms_extractor - INFO - _load_data 실행완료: 1.14초
2025-10-20 14:17:40,452 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-20 14:17:40,452 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-20 14:17:40,452 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-20 14:17:40,452 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-20 14:17:40,452 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-20 14:17:40,452 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-20 14:17:40,452 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-20 14:17:40,452 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-20 14:17:40,452 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-20 14:17:40,452 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-20 14:17:40,452 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-20 14:17:40,452 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-20 14:17:40,522 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.95:8000
2025-10-20 14:17:40,522 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-20 14:17:47,625 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:17:47] "GET /health HTTP/1.1" 200 -
2025-10-20 14:17:49,485 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:17:49] "GET /health HTTP/1.1" 200 -
2025-10-20 14:17:49,501 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 14:17:49,502 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:49,502 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 14:17:49,502 - mms_extractor - INFO - ============================================================
2025-10-20 14:17:49,502 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=#...
2025-10-20 14:17:49,502 - mms_extractor - INFO - 메시지 길이: 816 문자
2025-10-20 14:17:49,502 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 14:17:49,502 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 14:17:49,502 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-20 14:17:49,502 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 14:17:49,502 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 14:17:49,502 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 14:17:49,502 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 14:17:49,502 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 14:17:49,503 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 14:17:49,503 - mms_extractor - INFO - 처리할 메시지 길이: 816 문자
2025-10-20 14:17:49,505 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 14:17:50,224 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 14:17:50,225 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 14:17:50,232 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 14:17:50,232 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 14:17:50,232 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['프리디', '사죠영', '택1', '스펙', '죠르디', '실드', '에이프릴', '한정판', '카카오톡', '충전기', '기프트', '스톤', '코로나', '아이폰']
2025-10-20 14:17:50,232 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 14:17:59,019 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 14:17:59,019 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 14:17:59,020 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 14:17:59,020 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 14:17:59,186 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 14:17:59,187 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 14:17:59,187 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 14:17:59,190 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 14:17:59,193 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 14:17:59,194 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 14:17:59,197 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:17:59,200 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 14:17:59,201 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 14:17:59,201 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 9.70초
2025-10-20 14:17:59,201 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:17:59,201 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 14:17:59,201 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 14:17:59,520 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 14:17:59,520 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 14:17:59,520 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 14:17:59,520 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 14:17:59,520 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 14:17:59,520 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:17:59,520 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 14:17:59,520 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 14:17:59,521 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 14:17:59,521 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-20 14:17:59,521 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 14:17:59,521 - mms_extractor - INFO - 구성된 프롬프트 길이: 6735 문자
2025-10-20 14:17:59,521 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-20 14:17:59,521 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 14:17:59,521 - mms_extractor - INFO - 📝 프롬프트 길이: 6,735 문자
2025-10-20 14:17:59,521 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 14:17:59,521 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 14:18:11,667 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 14:18:11,693 - mms_extractor - INFO - LLM 응답 길이: 1692 문자
2025-10-20 14:18:11,693 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "아이폰 12",
            "action": "구매"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "구매"
        },
        {
            "name": "5G",
            "action": "사용"
        },
        {
            "name": "A14 Bionic 칩",
            "action": "사용"
        },
        {
            "name": "세라믹 실드",
 ...
2025-10-20 14:18:11,694 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 14:18:11,695 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 14:18:11,695 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 14:18:11,695 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '아이폰 12', 'action': '구매'}, {'name': '아이폰 12 Pro', 'action': '구매'}, {'name': '5G', 'action': '사용'}, {'name': 'A14 Bionic 칩', 'action': '사용'}, {'name': '세라믹 실드', 'action': '사용'}, {'name': '카메라 시스템', 'action': '사용'}, {'name': 'Dolby Vision 영상 카메라', 'action': '사용'}, {'name': '[사죠영] 죠르디 한정판 기프트', 'action': '구매'}, {'name': '[프리디] 멀티 무선 충전기', 'action': '구매'}, {'name': '[에이프릴스톤] 보조배터리+멀티백', 'action': '구매'}, {'name': '[크레앙] 3in1 무선 충전 살균기', 'action': '구매'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 14:18:11,695 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 14:18:11,695 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 12', '아이폰 12 Pro', '5G', 'A14 Bionic 칩', '세라믹 실드', '카메라 시스템', 'Dolby Vision 영상 카메라', '[사죠영] 죠르디 한정판 기프트', '[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '[크레앙] 3in1 무선 충전 살균기']
2025-10-20 14:18:11,696 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 14:18:11,697 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-20 14:18:11,697 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-20 14:18:11,697 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-20 14:18:13,151 - mms_extractor - ERROR - 결합 유사도 계산 실패: DataFrame.reset_index() got an unexpected keyword argument 'name'
2025-10-20 14:18:13,152 - mms_extractor - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-10-20 14:18:13,152 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.46초
2025-10-20 14:18:13,153 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 14:18:13,153 - mms_extractor - INFO - ============================================================
2025-10-20 14:18:13,153 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 14:18:13,153 - mms_extractor - INFO - ============================================================
2025-10-20 14:18:13,153 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰12/ 12 Pro 사전예약 안내
2025-10-20 14:18:13,153 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-20 14:18:13,153 - mms_extractor - INFO - 상품 수: 11개
2025-10-20 14:18:13,153 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 14:18:13,153 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 14:18:13,154 - mms_extractor - INFO - process_message 실행완료: 23.65초
2025-10-20 14:18:13,154 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 14:18:13,658 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 14:18:13,662 - mongodb_utils - INFO - 문서 저장 성공: 68f5c615bc443fa2b62e0657
2025-10-20 14:18:13,665 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 14:18:13,665 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 14:18:13,665 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 1개
2025-10-20 14:18:13,665 - __main__ - INFO - 추출 완료: 24.164초
2025-10-20 14:18:13,667 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:18:13] "POST /extract HTTP/1.1" 200 -
2025-10-20 14:18:13,710 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:18:13] "GET /health HTTP/1.1" 200 -
2025-10-20 14:19:11,698 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:19:11] "GET /health HTTP/1.1" 200 -
2025-10-20 14:19:11,783 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:19:11] "GET /health HTTP/1.1" 200 -
2025-10-20 14:19:11,799 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 14:19:11,800 - mms_extractor - INFO - ============================================================
2025-10-20 14:19:11,800 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 14:19:11,800 - mms_extractor - INFO - ============================================================
2025-10-20 14:19:11,800 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰17/ 17 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=#...
2025-10-20 14:19:11,800 - mms_extractor - INFO - 메시지 길이: 816 문자
2025-10-20 14:19:11,800 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 14:19:11,800 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 14:19:11,800 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-20 14:19:11,801 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 14:19:11,801 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 14:19:11,801 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 14:19:11,801 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 14:19:11,801 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 14:19:11,801 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 14:19:11,801 - mms_extractor - INFO - 처리할 메시지 길이: 816 문자
2025-10-20 14:19:11,803 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 14:19:11,857 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 14:19:11,859 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 14:19:11,869 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 14:19:11,869 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 14:19:11,869 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['프리디', '사죠영', '택1', '스펙', '죠르디', '실드', '에이프릴', '한정판', '카카오톡', '충전기', '기프트', '스톤', '코로나', '아이폰']
2025-10-20 14:19:11,869 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 14:19:12,177 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 14:19:12,177 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 14:19:12,178 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 14:19:12,178 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 14:19:12,334 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 14:19:12,335 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 14:19:12,335 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 14:19:12,337 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 14:19:12,339 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 14:19:12,339 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 14:19:12,341 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:19:12,344 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 14:19:12,344 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 14:19:12,345 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 0.54초
2025-10-20 14:19:12,345 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:19:12,345 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 14:19:12,345 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 14:19:12,447 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 14:19:12,447 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 14:19:12,447 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 14:19:12,447 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 14:19:12,447 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 14:19:12,447 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:19:12,447 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 14:19:12,447 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 14:19:12,447 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 14:19:12,447 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-20 14:19:12,448 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 14:19:12,448 - mms_extractor - INFO - 구성된 프롬프트 길이: 6735 문자
2025-10-20 14:19:12,448 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-20 14:19:12,448 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 14:19:12,448 - mms_extractor - INFO - 📝 프롬프트 길이: 6,735 문자
2025-10-20 14:19:12,448 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 14:19:12,448 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 14:19:25,296 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 14:19:25,301 - mms_extractor - INFO - LLM 응답 길이: 1852 문자
2025-10-20 14:19:25,301 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰17/ 17 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "아이폰 17",
            "action": "구매"
        },
        {
            "name": "아이폰 17 Pro",
            "action": "구매"
        },
        {
            "name": "아이폰 12",
            "action": "구매"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "구매"
        },
        {
            "name": "5G",
   ...
2025-10-20 14:19:25,301 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 14:19:25,303 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 14:19:25,305 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 14:19:25,305 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰17/ 17 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '아이폰 17', 'action': '구매'}, {'name': '아이폰 17 Pro', 'action': '구매'}, {'name': '아이폰 12', 'action': '구매'}, {'name': '아이폰 12 Pro', 'action': '구매'}, {'name': '5G', 'action': '사용'}, {'name': 'A14 Bionic 칩', 'action': '사용'}, {'name': '세라믹 실드', 'action': '사용'}, {'name': '카메라 시스템', 'action': '사용'}, {'name': 'Dolby Vision 영상 카메라', 'action': '사용'}, {'name': '[사죠영] 죠르디 한정판 기프트', 'action': '기타'}, {'name': '[프리디] 멀티 무선 충전기', 'action': '기타'}, {'name': '[에이프릴스톤] 보조배터리+멀티백', 'action': '기타'}, {'name': '[크레앙] 3in1 무선 충전 살균기', 'action': '기타'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 14:19:25,306 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 14:19:25,306 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 17', '아이폰 17 Pro', '아이폰 12', '아이폰 12 Pro', '5G', 'A14 Bionic 칩', '세라믹 실드', '카메라 시스템', 'Dolby Vision 영상 카메라', '[사죠영] 죠르디 한정판 기프트', '[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '[크레앙] 3in1 무선 충전 살균기']
2025-10-20 14:19:25,307 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 14:19:25,308 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-20 14:19:25,308 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-20 14:19:25,308 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-20 14:19:26,780 - mms_extractor - ERROR - 결합 유사도 계산 실패: DataFrame.reset_index() got an unexpected keyword argument 'name'
2025-10-20 14:19:26,781 - mms_extractor - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-10-20 14:19:26,781 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.47초
2025-10-20 14:19:26,782 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 14:19:26,782 - mms_extractor - INFO - ============================================================
2025-10-20 14:19:26,782 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 14:19:26,782 - mms_extractor - INFO - ============================================================
2025-10-20 14:19:26,782 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰17/ 17 Pro 사전예약 안내
2025-10-20 14:19:26,782 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-20 14:19:26,782 - mms_extractor - INFO - 상품 수: 13개
2025-10-20 14:19:26,782 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 14:19:26,782 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 14:19:26,782 - mms_extractor - INFO - process_message 실행완료: 14.98초
2025-10-20 14:19:26,782 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 14:19:26,787 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 14:19:26,788 - mongodb_utils - INFO - 문서 저장 성공: 68f5c65ebc443fa2b62e0659
2025-10-20 14:19:26,788 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 14:19:26,788 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 14:19:26,788 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 1개
2025-10-20 14:19:26,788 - __main__ - INFO - 추출 완료: 14.989초
2025-10-20 14:19:26,789 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:19:26] "POST /extract HTTP/1.1" 200 -
2025-10-20 14:19:26,810 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:19:26] "GET /health HTTP/1.1" 200 -
2025-10-20 14:28:06,094 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:28:06] "GET /health HTTP/1.1" 200 -
2025-10-20 14:28:06,198 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:28:06] "GET /health HTTP/1.1" 200 -
2025-10-20 14:28:06,205 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 14:28:06,206 - mms_extractor - INFO - ============================================================
2025-10-20 14:28:06,206 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 14:28:06,206 - mms_extractor - INFO - ============================================================
2025-10-20 14:28:06,206 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=...
2025-10-20 14:28:06,206 - mms_extractor - INFO - 메시지 길이: 817 문자
2025-10-20 14:28:06,206 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 14:28:06,206 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 14:28:06,206 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-20 14:28:06,206 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 14:28:06,206 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 14:28:06,206 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 14:28:06,206 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 14:28:06,206 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 14:28:06,206 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 14:28:06,206 - mms_extractor - INFO - 처리할 메시지 길이: 817 문자
2025-10-20 14:28:06,207 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 14:28:06,218 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 14:28:06,220 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 14:28:06,229 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 14:28:06,229 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 14:28:06,229 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['프리디', '사죠영', '택1', '스펙', '죠르디', '실드', '에이프릴', '한정판', '카카오톡', '충전기', '기프트', '스톤', '코로나', '아이폰']
2025-10-20 14:28:06,229 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 14:28:13,981 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 14:28:13,982 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 14:28:13,983 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 14:28:13,983 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 14:28:14,163 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 14:28:14,164 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 14:28:14,164 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 14:28:14,166 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 14:28:14,168 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 14:28:14,169 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 14:28:14,171 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:28:14,174 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 14:28:14,175 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 14:28:14,175 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 7.97초
2025-10-20 14:28:14,175 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:28:14,175 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 14:28:14,175 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 14:28:14,304 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 14:28:14,304 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 14:28:14,305 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 14:28:14,305 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 14:28:14,305 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 14:28:14,305 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 14:28:14,305 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 14:28:14,305 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 14:28:14,305 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 14:28:14,305 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-20 14:28:14,305 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 14:28:14,305 - mms_extractor - INFO - 구성된 프롬프트 길이: 6736 문자
2025-10-20 14:28:14,305 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-20 14:28:14,305 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 14:28:14,305 - mms_extractor - INFO - 📝 프롬프트 길이: 6,736 문자
2025-10-20 14:28:14,305 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 14:28:14,306 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 14:28:25,033 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 14:28:25,041 - mms_extractor - INFO - LLM 응답 길이: 1521 문자
2025-10-20 14:28:25,041 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "아이폰 17",
            "action": "구매"
        },
        {
            "name": "아이폰 17 Pro",
            "action": "구매"
        },
        {
            "name": "아이폰 12",
            "action": "구매"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "구매"
        },
        {
            "name": "5G",
  ...
2025-10-20 14:28:25,042 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 14:28:25,044 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 14:28:25,045 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 14:28:25,045 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '아이폰 17', 'action': '구매'}, {'name': '아이폰 17 Pro', 'action': '구매'}, {'name': '아이폰 12', 'action': '구매'}, {'name': '아이폰 12 Pro', 'action': '구매'}, {'name': '5G', 'action': '사용'}, {'name': '[사죠영] 죠르디 한정판 기프트', 'action': '기타'}, {'name': '[프리디] 멀티 무선 충전기', 'action': '기타'}, {'name': '[에이프릴스톤] 보조배터리+멀티백', 'action': '기타'}, {'name': '[크레앙] 3in1 무선 충전 살균기', 'action': '기타'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 14:28:25,045 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 14:28:25,045 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 17', '아이폰 17 Pro', '아이폰 12', '아이폰 12 Pro', '5G', '[사죠영] 죠르디 한정판 기프트', '[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '[크레앙] 3in1 무선 충전 살균기']
2025-10-20 14:28:25,046 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 14:28:25,047 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: cld (amazon/anthropic/claude-sonnet-4-20250514)
2025-10-20 14:28:25,047 - mms_extractor - INFO - === 후보 엔티티 추출 시작 ===
2025-10-20 14:28:25,047 - mms_extractor - INFO - 퍼지 매칭 임계값: 0.4
2025-10-20 14:28:26,524 - mms_extractor - ERROR - 결합 유사도 계산 실패: DataFrame.reset_index() got an unexpected keyword argument 'name'
2025-10-20 14:28:26,525 - mms_extractor - ERROR - LLM 기반 엔티티 추출 실패: 'item_nm_alias'
2025-10-20 14:28:26,525 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 1.48초
2025-10-20 14:28:26,526 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 14:28:26,526 - mms_extractor - INFO - ============================================================
2025-10-20 14:28:26,526 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 14:28:26,526 - mms_extractor - INFO - ============================================================
2025-10-20 14:28:26,526 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내
2025-10-20 14:28:26,526 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-20 14:28:26,526 - mms_extractor - INFO - 상품 수: 9개
2025-10-20 14:28:26,526 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 14:28:26,526 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 14:28:26,526 - mms_extractor - INFO - process_message 실행완료: 20.32초
2025-10-20 14:28:26,526 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 14:28:26,532 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 14:28:26,533 - mongodb_utils - INFO - 문서 저장 성공: 68f5c87abc443fa2b62e065b
2025-10-20 14:28:26,533 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 14:28:26,533 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 14:28:26,533 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 1개
2025-10-20 14:28:26,533 - __main__ - INFO - 추출 완료: 20.328초
2025-10-20 14:28:26,534 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:28:26] "POST /extract HTTP/1.1" 200 -
2025-10-20 14:28:26,556 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 14:28:26] "GET /health HTTP/1.1" 200 -
2025-10-20 15:08:11,795 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-20 15:08:11,795 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-20 15:08:11,795 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-20 15:08:11,795 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-20 15:08:11,795 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.24.95:8000
2025-10-20 15:08:11,795 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-20 15:08:11,795 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-20 15:08:11,795 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-20 15:08:11,795 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-20 15:08:11,795 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-20 15:08:11,795 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-20 15:08:11,795 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-20 15:08:11,797 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-20 15:08:11,830 - mms_extractor - INFO - Using device: mps
2025-10-20 15:08:11,830 - mms_extractor - INFO - _initialize_device 실행완료: 0.03초
2025-10-20 15:08:11,830 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-20 15:08:11,831 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-20 15:08:11,831 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-20 15:08:11,831 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-20 15:08:11,831 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-20 15:08:11,831 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-20 15:08:11,831 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-20 15:08:12,235 - mms_extractor - INFO - Model loaded on mps
2025-10-20 15:08:12,235 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.40초
2025-10-20 15:08:12,235 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-20 15:08:12,824 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-20 15:08:12,824 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.59초
2025-10-20 15:08:12,824 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-20 15:08:12,824 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:12,824 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-20 15:08:12,825 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:12,825 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-20 15:08:12,825 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-20 15:08:12,825 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-20 15:08:12,825 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-20 15:08:12,825 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 15:08:12,981 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-20 15:08:12,981 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 15:08:12,981 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-20 15:08:12,988 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-20 15:08:12,989 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-20 15:08:12,990 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:08:12,990 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:08:12,991 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-20 15:08:12,991 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-20 15:08:12,992 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-20 15:08:12,995 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-20 15:08:12,996 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-20 15:08:12,996 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:08:12,996 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-20 15:08:12,996 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-20 15:08:12,996 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-20 15:08:12,996 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:08:12,997 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-20 15:08:12,997 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-20 15:08:12,997 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-20 15:08:12,998 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-20 15:08:12,998 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-20 15:08:12,998 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:08:12,998 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-20 15:08:12,999 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:08:13,292 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-20 15:08:13,302 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-20 15:08:13,303 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-10-20 15:08:13,303 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-20 15:08:13,304 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-20 15:08:13,304 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-20 15:08:13,305 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-20 15:08:13,305 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-20 15:08:13,305 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-20 15:08:13,305 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-20 15:08:13,306 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-20 15:08:13,308 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-20 15:08:13,308 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증', '우주Pass Netflix 인증', '우주패스 Netflix 인증']
2025-10-20 15:08:13,328 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-20 15:08:13,328 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-20 15:08:13,329 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-20 15:08:13,330 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-20 15:08:13,330 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-20 15:08:13,589 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-20 15:08:13,589 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-20 15:08:13,589 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-20 15:08:13,590 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-20 15:08:13,590 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-20 15:08:13,590 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 15:08:13,677 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-20 15:08:13,677 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 15:08:13,680 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-20 15:08:13,680 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-20 15:08:13,680 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-20 15:08:13,680 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:08:13,680 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-20 15:08:13,681 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-20 15:08:13,681 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:13,681 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-20 15:08:13,681 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:13,681 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-20 15:08:13,681 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-20 15:08:13,681 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-20 15:08:13,681 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-20 15:08:13,682 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-20 15:08:13,683 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-20 15:08:13,684 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-20 15:08:13,686 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-20 15:08:13,686 - mms_extractor - INFO - _load_data 실행완료: 0.86초
2025-10-20 15:08:13,686 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-20 15:08:13,686 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-20 15:08:13,686 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-20 15:08:13,686 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-20 15:08:13,686 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-20 15:08:13,686 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-20 15:08:13,686 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-20 15:08:13,686 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-20 15:08:13,686 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-20 15:08:13,686 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-20 15:08:13,687 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-20 15:08:13,687 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-20 15:08:13,775 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.95:8000
2025-10-20 15:08:13,776 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-20 15:08:24,371 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:08:24] "GET /health HTTP/1.1" 200 -
2025-10-20 15:08:24,383 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 15:08:24,384 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:24,384 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 15:08:24,384 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:24,384 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=...
2025-10-20 15:08:24,384 - mms_extractor - INFO - 메시지 길이: 817 문자
2025-10-20 15:08:24,384 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 15:08:24,384 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 15:08:24,384 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-20 15:08:24,384 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 15:08:24,384 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 15:08:24,384 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 15:08:24,384 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 15:08:24,384 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 15:08:24,384 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 15:08:24,384 - mms_extractor - INFO - 처리할 메시지 길이: 817 문자
2025-10-20 15:08:24,386 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 15:08:25,102 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 15:08:25,103 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 15:08:25,110 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 15:08:25,110 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 15:08:25,110 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['기프트', '스톤', '죠르디', '카카오톡', '코로나', '아이폰', '사죠영', '실드', '충전기', '택1', '프리디', '한정판', '에이프릴', '스펙']
2025-10-20 15:08:25,110 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 15:08:33,982 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 15:08:33,982 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 15:08:33,983 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 15:08:33,983 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 15:08:34,145 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 15:08:34,146 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 15:08:34,146 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 15:08:34,150 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 15:08:34,152 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 15:08:34,153 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 15:08:34,157 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:08:34,160 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 15:08:34,161 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 15:08:34,161 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 9.78초
2025-10-20 15:08:34,161 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:08:34,161 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 15:08:34,161 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 15:08:34,366 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 15:08:34,366 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 15:08:34,366 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 15:08:34,366 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 15:08:34,367 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 15:08:34,367 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:08:34,367 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 15:08:34,367 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 15:08:34,367 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 15:08:34,367 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-20 15:08:34,367 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 15:08:34,367 - mms_extractor - INFO - 구성된 프롬프트 길이: 6736 문자
2025-10-20 15:08:34,367 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-20 15:08:34,367 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 15:08:34,367 - mms_extractor - INFO - 📝 프롬프트 길이: 6,736 문자
2025-10-20 15:08:34,367 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 15:08:34,367 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 15:08:47,753 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 15:08:47,777 - mms_extractor - INFO - LLM 응답 길이: 1853 문자
2025-10-20 15:08:47,778 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "아이폰 17",
            "action": "구매"
        },
        {
            "name": "아이폰 17 Pro",
            "action": "구매"
        },
        {
            "name": "아이폰 12",
            "action": "구매"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "구매"
        },
        {
            "name": "5G",
  ...
2025-10-20 15:08:47,778 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 15:08:47,779 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 15:08:47,779 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 15:08:47,779 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '아이폰 17', 'action': '구매'}, {'name': '아이폰 17 Pro', 'action': '구매'}, {'name': '아이폰 12', 'action': '구매'}, {'name': '아이폰 12 Pro', 'action': '구매'}, {'name': '5G', 'action': '사용'}, {'name': 'A14 Bionic 칩', 'action': '사용'}, {'name': '세라믹 실드', 'action': '사용'}, {'name': '카메라 시스템', 'action': '사용'}, {'name': 'Dolby Vision 영상 카메라', 'action': '사용'}, {'name': '[사죠영] 죠르디 한정판 기프트', 'action': '기타'}, {'name': '[프리디] 멀티 무선 충전기', 'action': '기타'}, {'name': '[에이프릴스톤] 보조배터리+멀티백', 'action': '기타'}, {'name': '[크레앙] 3in1 무선 충전 살균기', 'action': '기타'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 15:08:47,779 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 15:08:47,779 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 17', '아이폰 17 Pro', '아이폰 12', '아이폰 12 Pro', '5G', 'A14 Bionic 칩', '세라믹 실드', '카메라 시스템', 'Dolby Vision 영상 카메라', '[사죠영] 죠르디 한정판 기프트', '[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '[크레앙] 3in1 무선 충전 살균기']
2025-10-20 15:08:47,781 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 15:08:47,781 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 3,234 문자
2025-10-20 15:08:47,781 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-20 15:08:47,781 - mms_extractor - INFO - 📝 프롬프트 길이: 3,234 문자
2025-10-20 15:08:47,781 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-20 15:08:47,781 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-20 15:08:47,781 - mms_extractor - INFO - 🔄 1개 LLM 모델로 엔티티 추출 시작
2025-10-20 15:08:47,782 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-20 15:08:47,782 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-20 15:08:47,782 - mms_extractor - INFO - 🔍 메시지 길이: 817 문자
2025-10-20 15:08:47,823 - mms_extractor - ERROR - LLM 모델에서 엔티티 추출 실패: name 'cand_entities_list' is not defined
2025-10-20 15:08:47,823 - mms_extractor - INFO - ✅ LLM 추출 완료: []
2025-10-20 15:08:47,823 - mms_extractor - WARNING - LLM 추출에서 유효한 엔티티를 찾지 못함
2025-10-20 15:08:47,825 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 0.04초
2025-10-20 15:08:47,828 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 15:08:47,828 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:47,828 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 15:08:47,828 - mms_extractor - INFO - ============================================================
2025-10-20 15:08:47,828 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내
2025-10-20 15:08:47,829 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-20 15:08:47,829 - mms_extractor - INFO - 상품 수: 13개
2025-10-20 15:08:47,829 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 15:08:47,829 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 15:08:47,829 - mms_extractor - INFO - process_message 실행완료: 23.45초
2025-10-20 15:08:47,829 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 15:08:48,443 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 15:08:48,447 - mongodb_utils - INFO - 문서 저장 성공: 68f5d1f06509ebf437b19fe7
2025-10-20 15:08:48,448 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 15:08:48,448 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 15:08:48,448 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-20 15:08:48,448 - __main__ - INFO - 추출 완료: 24.065초
2025-10-20 15:08:48,450 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:08:48] "POST /extract HTTP/1.1" 200 -
2025-10-20 15:08:48,494 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:08:48] "GET /health HTTP/1.1" 200 -
2025-10-20 15:12:21,240 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-20 15:12:21,240 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-20 15:12:21,241 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-20 15:12:21,241 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-20 15:12:21,241 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.24.95:8000
2025-10-20 15:12:21,241 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-20 15:12:21,241 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-20 15:12:21,241 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-20 15:12:21,241 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-20 15:12:21,241 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-20 15:12:21,241 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-20 15:12:21,241 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-20 15:12:21,242 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-20 15:12:21,270 - mms_extractor - INFO - Using device: mps
2025-10-20 15:12:21,270 - mms_extractor - INFO - _initialize_device 실행완료: 0.03초
2025-10-20 15:12:21,270 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-20 15:12:21,270 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-20 15:12:21,270 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-20 15:12:21,270 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-20 15:12:21,270 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-20 15:12:21,271 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-20 15:12:21,271 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-20 15:12:21,525 - mms_extractor - INFO - Model loaded on mps
2025-10-20 15:12:21,525 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.25초
2025-10-20 15:12:21,525 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-20 15:12:22,165 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-20 15:12:22,165 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.64초
2025-10-20 15:12:22,165 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-20 15:12:22,165 - mms_extractor - INFO - ============================================================
2025-10-20 15:12:22,165 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-20 15:12:22,165 - mms_extractor - INFO - ============================================================
2025-10-20 15:12:22,165 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-20 15:12:22,165 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-20 15:12:22,165 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-20 15:12:22,165 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-20 15:12:22,165 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 15:12:22,321 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-20 15:12:22,321 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 15:12:22,321 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-20 15:12:22,329 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-20 15:12:22,330 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-20 15:12:22,331 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:12:22,331 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:12:22,332 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-20 15:12:22,332 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-20 15:12:22,333 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-20 15:12:22,338 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-20 15:12:22,338 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-20 15:12:22,338 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:12:22,338 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-20 15:12:22,338 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-20 15:12:22,338 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-20 15:12:22,339 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:12:22,339 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-20 15:12:22,339 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-20 15:12:22,339 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-20 15:12:22,340 - mms_extractor - INFO - 로드된 별칭 규칙 수: 167개
2025-10-20 15:12:22,340 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-20 15:12:22,340 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:12:22,341 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-20 15:12:22,341 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-20 15:12:22,639 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-20 15:12:22,649 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22506
2025-10-20 15:12:22,650 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-10-20 15:12:22,650 - mms_extractor - INFO - 별칭 규칙 적용 완료: 167개 규칙
2025-10-20 15:12:22,650 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22506, 9)
2025-10-20 15:12:22,650 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-20 15:12:22,651 - mms_extractor - INFO - 정지어 로드 완료: 166개
2025-10-20 15:12:22,651 - mms_extractor - INFO - 로드된 정지어 수: 166개
2025-10-20 15:12:22,651 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-20 15:12:22,651 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-20 15:12:22,652 - mms_extractor - INFO - 등록할 고유 별칭 수: 16949개
2025-10-20 15:12:22,654 - mms_extractor - INFO - 유효한 별칭 수: 16948개
2025-10-20 15:12:22,654 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주pass Netflix 인증']
2025-10-20 15:12:22,675 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 16948개 성공, 0개 실패
2025-10-20 15:12:22,675 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-20 15:12:22,675 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-20 15:12:22,676 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-20 15:12:22,676 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-20 15:12:22,920 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-20 15:12:22,920 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-20 15:12:22,920 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-20 15:12:22,920 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-20 15:12:22,920 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-20 15:12:22,920 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-20 15:12:23,007 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-20 15:12:23,007 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-20 15:12:23,010 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-20 15:12:23,010 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-20 15:12:23,010 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-20 15:12:23,010 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-20 15:12:23,010 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-20 15:12:23,011 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-20 15:12:23,011 - mms_extractor - INFO - ============================================================
2025-10-20 15:12:23,011 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-20 15:12:23,011 - mms_extractor - INFO - ============================================================
2025-10-20 15:12:23,011 - mms_extractor - INFO - ✅ 상품 데이터: (22506, 9)
2025-10-20 15:12:23,011 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-20 15:12:23,011 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-20 15:12:23,011 - mms_extractor - INFO - ✅ 정지어: 166개
2025-10-20 15:12:23,011 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-20 15:12:23,012 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-20 15:12:23,014 - mms_extractor - INFO - 고유 별칭 수: 16948개
2025-10-20 15:12:23,016 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-20 15:12:23,016 - mms_extractor - INFO - _load_data 실행완료: 0.85초
2025-10-20 15:12:23,016 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-20 15:12:23,016 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-20 15:12:23,016 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-20 15:12:23,016 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-20 15:12:23,016 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-20 15:12:23,016 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-20 15:12:23,016 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-20 15:12:23,017 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-20 15:12:23,017 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-20 15:12:23,017 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-20 15:12:23,017 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-20 15:12:23,017 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-20 15:12:23,030 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.24.95:8000
2025-10-20 15:12:23,030 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-20 15:13:42,412 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:13:42] "GET /health HTTP/1.1" 200 -
2025-10-20 15:13:42,421 - __main__ - INFO - 데이터 소스로 메시지 처리 중: local
2025-10-20 15:13:42,421 - mms_extractor - INFO - ============================================================
2025-10-20 15:13:42,421 - mms_extractor - INFO - 🚀 MMS 메시지 처리 시작
2025-10-20 15:13:42,421 - mms_extractor - INFO - ============================================================
2025-10-20 15:13:42,421 - mms_extractor - INFO - 메시지 내용: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내\n(광고)[SKT] 아이폰 12/12 Pro 사전예약 안내  #04 고객님, 안녕하세요. 최고의 스마트폰 칩과 카메라, 견고한 세라믹 실드에 5G 기술까지! 이 모든 것을 갖춘 아이폰 12/12 Pro를 만나 보세요.  ▶ 혜택받고 사전예약하기: http://t-mms.kr/t.do?m=...
2025-10-20 15:13:42,421 - mms_extractor - INFO - 메시지 길이: 817 문자
2025-10-20 15:13:42,421 - mms_extractor - INFO - === 현재 추출기 설정 ===
2025-10-20 15:13:42,421 - mms_extractor - INFO - 데이터 소스: local
2025-10-20 15:13:42,421 - mms_extractor - INFO - 상품 정보 추출 모드: llm
2025-10-20 15:13:42,421 - mms_extractor - INFO - 엔티티 추출 모드: llm
2025-10-20 15:13:42,421 - mms_extractor - INFO - LLM 모델: ax
2025-10-20 15:13:42,422 - mms_extractor - INFO - 상품 데이터 크기: (22506, 9)
2025-10-20 15:13:42,422 - mms_extractor - INFO - 프로그램 데이터 크기: (25, 6)
2025-10-20 15:13:42,422 - mms_extractor - INFO - ============================== 1단계: 엔티티 추출 ==============================
2025-10-20 15:13:42,422 - mms_extractor - INFO - === Kiwi 기반 엔티티 추출 시작 ===
2025-10-20 15:13:42,422 - mms_extractor - INFO - 처리할 메시지 길이: 817 문자
2025-10-20 15:13:42,423 - mms_extractor - INFO - 매칭할 상품 별칭 수: 16949개
2025-10-20 15:13:43,207 - mms_extractor - INFO - 분할된 문장 수: 9개
2025-10-20 15:13:43,208 - mms_extractor - INFO - 필터링된 문장들: [' SK텔레콤 반가워요', '5G 아이폰 Pro 사전예약 안내 n 광고 SKT 아이폰 Pro 사전예약 안내 고객님 안녕하세요 ', '최고의 스마트폰 칩과 카메라 견고 세라믹 실드에 5G 기술까지 ']...
2025-10-20 15:13:43,217 - mms_extractor - INFO - 전체 토큰 수: 312개
2025-10-20 15:13:43,217 - mms_extractor - INFO - NNP 태그 토큰들: ['SK텔레콤', '아이폰', '아이폰', '실드', '아이폰', '아이폰', '스펙', '아이폰', '스마트폰', '택1', '사죠영', '죠르디', '한정판', '기프트', '프리디', '충전기', '에이프릴', '스톤', '충전', '기프트', '.', '카카오톡', '코로나']
2025-10-20 15:13:43,217 - mms_extractor - INFO - 필터링 후 Kiwi 추출 엔티티: ['충전기', '죠르디', '에이프릴', '한정판', '스톤', '기프트', '카카오톡', '아이폰', '택1', '프리디', '실드', '사죠영', '스펙', '코로나']
2025-10-20 15:13:43,217 - mms_extractor - INFO - 퍼지 매칭 시작...
2025-10-20 15:13:51,487 - mms_extractor - INFO - 퍼지 매칭 결과 크기: (2117, 3)
2025-10-20 15:13:51,488 - mms_extractor - INFO - 퍼지 매칭 성공: 2117개 결과
2025-10-20 15:13:51,489 - mms_extractor - INFO - 퍼지 매칭 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.4285714285714286}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.4}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.4}]
2025-10-20 15:13:51,489 - mms_extractor - INFO - 시퀀스 유사도 계산 시작...
2025-10-20 15:13:51,647 - mms_extractor - INFO - 시퀀스 유사도 결과 크기: (2117, 3)
2025-10-20 15:13:51,648 - mms_extractor - INFO - 시퀀스 유사도 샘플: [{'sent': ' SK텔레콤 반가워요', 'item_nm_alias': '국제전화사업자(온세텔레콤)', 'sim': 0.18461538461538463}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 5기가', 'sim': 0.15000000000000002}, {'sent': ' SK텔레콤 반가워요', 'item_nm_alias': 'T로밍 LongPass 2기가', 'sim': 0.15000000000000002}]
2025-10-20 15:13:51,648 - mms_extractor - INFO - 사용할 유사도 임계값: 0.7
2025-10-20 15:13:51,651 - mms_extractor - INFO - 임계값 필터링 후 후보 아이템 수: 11개
2025-10-20 15:13:51,654 - mms_extractor - INFO - Kiwi 엔티티 매칭 결과: 0개
2025-10-20 15:13:51,654 - mms_extractor - INFO - 통합된 후보 아이템 수: 11개
2025-10-20 15:13:51,658 - mms_extractor - INFO - 최종 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:13:51,660 - mms_extractor - INFO - 최종 상품 정보 DataFrame 크기: (10, 2)
2025-10-20 15:13:51,660 - mms_extractor - INFO - 최종 상품 정보 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}, {'item_nm': 'IPHONE 16 PRO', 'item_id': ['A5XE', 'A643', 'A5XN', 'A64C', 'A647', 'A63Y', 'A5XJ', 'A5X9']}]
2025-10-20 15:13:51,661 - mms_extractor - INFO - extract_entities_from_kiwi 실행완료: 9.24초
2025-10-20 15:13:51,661 - mms_extractor - INFO - 추출된 후보 엔티티: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:13:51,661 - mms_extractor - INFO - 매칭된 상품 정보: (10, 2)
2025-10-20 15:13:51,661 - mms_extractor - INFO - ============================== 2단계: 프로그램 분류 ==============================
2025-10-20 15:13:51,815 - mms_extractor - INFO - 프로그램 분류 결과 키: ['pgm_cand_info', 'similarities', 'pgm_pdf_tmp']
2025-10-20 15:13:51,815 - mms_extractor - INFO - ============================== 3단계: RAG 컨텍스트 구성 ==============================
2025-10-20 15:13:51,815 - mms_extractor - INFO - 프로그램 분류 컨텍스트 길이: 400 문자
2025-10-20 15:13:51,815 - mms_extractor - INFO - ============================== 4단계: 제품 정보 준비 ==============================
2025-10-20 15:13:51,815 - mms_extractor - INFO - 후보 아이템 리스트 크기: 11개
2025-10-20 15:13:51,815 - mms_extractor - INFO - 후보 아이템 리스트: ['충전', '스마트 사인', '아이폰 16 PRO', '아이폰 17 PRO', '아이폰 16', '아이폰 17', '5G 음성', 'Red메이트', 'red메이트', '아이폰 AIR', 'PPS스마트폰 라이트']
2025-10-20 15:13:51,815 - mms_extractor - INFO - extra_item_pdf 크기: (10, 2)
2025-10-20 15:13:51,816 - mms_extractor - INFO - extra_item_pdf 컬럼들: ['item_nm', 'item_id']
2025-10-20 15:13:51,816 - mms_extractor - INFO - extra_item_pdf 샘플: [{'item_nm': '5G 음성', 'item_id': ['NA00007314']}, {'item_nm': 'IPHONE 16', 'item_id': ['A5WC', 'A63N', 'A63T', 'A5WH', 'A63H', 'A5WN']}]
2025-10-20 15:13:51,816 - mms_extractor - INFO - LLM 모드: 참고용 후보 상품 목록을 RAG 컨텍스트에 추가
2025-10-20 15:13:51,816 - mms_extractor - INFO - ============================== 5단계: LLM 호출 ==============================
2025-10-20 15:13:51,816 - mms_extractor - INFO - 구성된 프롬프트 길이: 6736 문자
2025-10-20 15:13:51,816 - mms_extractor - INFO - RAG 컨텍스트 포함 여부: True
2025-10-20 15:13:51,816 - mms_extractor - INFO - 📝 프롬프트 저장됨: main_extraction_prompt
2025-10-20 15:13:51,816 - mms_extractor - INFO - 📝 프롬프트 길이: 6,736 문자
2025-10-20 15:13:51,816 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 1
2025-10-20 15:13:51,816 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt']
2025-10-20 15:14:05,376 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 15:14:05,385 - mms_extractor - INFO - LLM 응답 길이: 1853 문자
2025-10-20 15:14:05,385 - mms_extractor - INFO - LLM 응답 내용 (처음 500자): ```json
{
    "title": "[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내",
    "purpose": [
        "상품 가입 유도",
        "혜택 안내"
    ],
    "product": [
        {
            "name": "아이폰 17",
            "action": "구매"
        },
        {
            "name": "아이폰 17 Pro",
            "action": "구매"
        },
        {
            "name": "아이폰 12",
            "action": "구매"
        },
        {
            "name": "아이폰 12 Pro",
            "action": "구매"
        },
        {
            "name": "5G",
  ...
2025-10-20 15:14:05,386 - mms_extractor - INFO - ============================== 6단계: JSON 파싱 ==============================
2025-10-20 15:14:05,386 - mms_extractor - INFO - 추출된 JSON 객체 수: 1개
2025-10-20 15:14:05,386 - mms_extractor - INFO - 파싱된 JSON 객체 키: ['title', 'purpose', 'product', 'channel', 'pgm']
2025-10-20 15:14:05,387 - mms_extractor - INFO - 파싱된 JSON 내용: {'title': '[SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내', 'purpose': ['상품 가입 유도', '혜택 안내'], 'product': [{'name': '아이폰 17', 'action': '구매'}, {'name': '아이폰 17 Pro', 'action': '구매'}, {'name': '아이폰 12', 'action': '구매'}, {'name': '아이폰 12 Pro', 'action': '구매'}, {'name': '5G', 'action': '사용'}, {'name': 'A14 Bionic 칩', 'action': '사용'}, {'name': '세라믹 실드', 'action': '사용'}, {'name': '카메라 시스템', 'action': '사용'}, {'name': 'Dolby Vision 영상 카메라', 'action': '사용'}, {'name': '[사죠영] 죠르디 한정판 기프트', 'action': '기타'}, {'name': '[프리디] 멀티 무선 충전기', 'action': '기타'}, {'name': '[에이프릴스톤] 보조배터리+멀티백', 'action': '기타'}, {'name': '[크레앙] 3in1 무선 충전 살균기', 'action': '기타'}], 'channel': [{'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/2HeWcdx', 'action': '추가 정보'}, {'type': 'URL', 'value': 'http://t-mms.kr/t.do?m=#61&u=https://bit.ly/3o7zOnA', 'action': '추가 정보'}, {'type': '전화번호', 'value': '1558', 'action': '문의'}, {'type': '전화번호', 'value': '1504', 'action': '수신 거부'}], 'pgm': ['상품및부가서비스가입유도_단말', '사용법/혜택/이벤트안내_단말']}
2025-10-20 15:14:05,387 - mms_extractor - INFO - ============================== 7단계: 최종 결과 구성 ==============================
2025-10-20 15:14:05,387 - mms_extractor - INFO - LLM 추출 엔티티: ['아이폰 17', '아이폰 17 Pro', '아이폰 12', '아이폰 12 Pro', '5G', 'A14 Bionic 칩', '세라믹 실드', '카메라 시스템', 'Dolby Vision 영상 카메라', '[사죠영] 죠르디 한정판 기프트', '[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '[크레앙] 3in1 무선 충전 살균기']
2025-10-20 15:14:05,387 - mms_extractor - INFO - ✅ LLM 모델 초기화 완료: ax (skt/ax4)
2025-10-20 15:14:05,388 - mms_extractor - INFO - 🔍 최종 엔티티 추출 프롬프트 길이: 3,234 문자
2025-10-20 15:14:05,388 - mms_extractor - INFO - 📝 프롬프트 저장됨: entity_extraction_prompt
2025-10-20 15:14:05,388 - mms_extractor - INFO - 📝 프롬프트 길이: 3,234 문자
2025-10-20 15:14:05,388 - mms_extractor - INFO - 📝 현재 저장된 프롬프트 수: 2
2025-10-20 15:14:05,388 - mms_extractor - INFO - 📝 저장된 프롬프트 키들: ['main_extraction_prompt', 'entity_extraction_prompt']
2025-10-20 15:14:05,388 - mms_extractor - INFO - 🔄 1개 LLM 모델로 엔티티 추출 시작
2025-10-20 15:14:05,388 - mms_extractor - INFO - 엔티티 추출에 prompts 디렉토리의 DETAILED_ENTITY_EXTRACTION_PROMPT 사용
2025-10-20 15:14:05,388 - mms_extractor - INFO - 🔍 베이스 프롬프트 길이: 2,348 문자
2025-10-20 15:14:05,388 - mms_extractor - INFO - 🔍 메시지 길이: 817 문자
2025-10-20 15:14:07,128 - httpx - INFO - HTTP Request: POST https://api.platform.a15t.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-20 15:14:07,130 - mms_extractor - INFO - ✅ LLM 추출 완료: ['[프리디] 멀티 무선 충전기', '[에이프릴스톤] 보조배터리+멀티백', '아이폰 17', '[크레앙] 3in1 무선 충전 살균기', '아이폰 17 Pro', '아이폰 12 Pro', '아이폰 12', '[사죠영] 죠르디 한정판 기프트', 'T기프트', 'T다이렉트샵']
2025-10-20 15:14:07,440 - mms_extractor - INFO - extract_entities_by_llm 실행완료: 2.05초
2025-10-20 15:14:07,446 - mms_extractor - INFO - ============================== 8단계: 결과 검증 ==============================
2025-10-20 15:14:07,446 - mms_extractor - INFO - ============================================================
2025-10-20 15:14:07,446 - mms_extractor - INFO - ✅ 메시지 처리 완료 - 최종 결과 요약
2025-10-20 15:14:07,446 - mms_extractor - INFO - ============================================================
2025-10-20 15:14:07,446 - mms_extractor - INFO - 제목: [SK텔레콤] 반가워요 5G 아이폰 17/ 17 Pro 사전예약 안내
2025-10-20 15:14:07,447 - mms_extractor - INFO - 목적: ['상품 가입 유도', '혜택 안내']
2025-10-20 15:14:07,447 - mms_extractor - INFO - 상품 수: 2개
2025-10-20 15:14:07,447 - mms_extractor - INFO - 채널 수: 4개
2025-10-20 15:14:07,447 - mms_extractor - INFO - 프로그램 수: 2개
2025-10-20 15:14:07,447 - mms_extractor - INFO - process_message 실행완료: 25.03초
2025-10-20 15:14:07,447 - __main__ - INFO - MongoDB 저장 중...
2025-10-20 15:14:07,527 - mongodb_utils - INFO - MongoDB 연결 성공: aos.mmsext
2025-10-20 15:14:07,528 - mongodb_utils - INFO - 문서 저장 성공: 68f5d32ff21c15f34799c37a
2025-10-20 15:14:07,528 - mongodb_utils - INFO - MongoDB 연결 해제
2025-10-20 15:14:07,528 - __main__ - INFO - MongoDB 저장 완료!
2025-10-20 15:14:07,528 - __main__ - INFO - 추출 과정에서 캡처된 프롬프트: 2개
2025-10-20 15:14:07,528 - __main__ - INFO - 추출 완료: 25.107초
2025-10-20 15:14:07,529 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:14:07] "POST /extract HTTP/1.1" 200 -
2025-10-20 15:14:07,554 - werkzeug - INFO - 127.0.0.1 - - [20/Oct/2025 15:14:07] "GET /health HTTP/1.1" 200 -
2025-10-22 10:52:07,615 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-22 10:52:07,616 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-22 10:52:07,616 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-22 10:52:07,616 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-22 10:52:07,616 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.112.69:8000
2025-10-22 10:52:07,616 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-22 10:52:07,616 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-22 10:52:07,616 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-22 10:52:07,616 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-22 10:52:07,616 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-22 10:52:07,617 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-22 10:52:07,617 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-22 10:52:07,618 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-22 10:52:07,687 - mms_extractor - INFO - Using device: mps
2025-10-22 10:52:07,687 - mms_extractor - INFO - _initialize_device 실행완료: 0.07초
2025-10-22 10:52:07,687 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-22 10:52:07,687 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-22 10:52:07,687 - mms_extractor - INFO - _initialize_llm 실행완료: 0.00초
2025-10-22 10:52:07,687 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-22 10:52:07,687 - mms_extractor - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-22 10:52:07,688 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-22 10:52:07,688 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-22 10:52:08,387 - mms_extractor - INFO - Model loaded on mps
2025-10-22 10:52:08,387 - mms_extractor - INFO - _initialize_embedding_model 실행완료: 0.70초
2025-10-22 10:52:08,387 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-22 10:52:09,107 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-22 10:52:09,108 - mms_extractor - INFO - _initialize_kiwi 실행완료: 0.72초
2025-10-22 10:52:09,108 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-22 10:52:09,108 - mms_extractor - INFO - ============================================================
2025-10-22 10:52:09,108 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-22 10:52:09,108 - mms_extractor - INFO - ============================================================
2025-10-22 10:52:09,108 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-22 10:52:09,108 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-22 10:52:09,108 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-22 10:52:09,108 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-22 10:52:09,108 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-22 10:52:09,269 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-22 10:52:09,269 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-22 10:52:09,269 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-22 10:52:09,280 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-22 10:52:09,281 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-22 10:52:09,281 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 10:52:09,282 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 10:52:09,282 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-22 10:52:09,282 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-22 10:52:09,290 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-22 10:52:09,294 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-22 10:52:09,295 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-22 10:52:09,295 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 10:52:09,295 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-22 10:52:09,295 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-22 10:52:09,295 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-22 10:52:09,296 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 10:52:09,296 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-22 10:52:09,296 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-22 10:52:09,296 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-22 10:52:09,303 - mms_extractor - INFO - 로드된 별칭 규칙 수: 168개
2025-10-22 10:52:09,303 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-22 10:52:09,303 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 10:52:09,304 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-22 10:52:09,304 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 10:52:09,600 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-22 10:52:09,612 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22608
2025-10-22 10:52:09,612 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-22 10:52:09,613 - mms_extractor - INFO - 별칭 규칙 적용 완료: 168개 규칙
2025-10-22 10:52:09,613 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22608, 9)
2025-10-22 10:52:09,613 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-22 10:52:09,614 - mms_extractor - INFO - 정지어 로드 완료: 171개
2025-10-22 10:52:09,614 - mms_extractor - INFO - 로드된 정지어 수: 171개
2025-10-22 10:52:09,614 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-22 10:52:09,614 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-22 10:52:09,615 - mms_extractor - INFO - 등록할 고유 별칭 수: 17022개
2025-10-22 10:52:09,617 - mms_extractor - INFO - 유효한 별칭 수: 17021개
2025-10-22 10:52:09,617 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주pass Netflix 인증', '우주PASS Netflix 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주패스 넷플릭스 인증']
2025-10-22 10:52:09,638 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 17021개 성공, 0개 실패
2025-10-22 10:52:09,638 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-22 10:52:09,638 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-22 10:52:09,651 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-22 10:52:09,651 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-22 10:52:12,068 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-22 10:52:12,069 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-22 10:52:12,069 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-22 10:52:12,069 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-22 10:52:12,069 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-22 10:52:12,069 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-22 10:52:12,149 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-22 10:52:12,150 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-22 10:52:12,152 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-22 10:52:12,153 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-22 10:52:12,153 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-22 10:52:12,153 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 10:52:12,153 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-22 10:52:12,153 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-22 10:52:12,153 - mms_extractor - INFO - ============================================================
2025-10-22 10:52:12,153 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-22 10:52:12,153 - mms_extractor - INFO - ============================================================
2025-10-22 10:52:12,153 - mms_extractor - INFO - ✅ 상품 데이터: (22608, 9)
2025-10-22 10:52:12,153 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-22 10:52:12,154 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-22 10:52:12,154 - mms_extractor - INFO - ✅ 정지어: 171개
2025-10-22 10:52:12,154 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-22 10:52:12,155 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-22 10:52:12,157 - mms_extractor - INFO - 고유 별칭 수: 17021개
2025-10-22 10:52:12,158 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-22 10:52:12,158 - mms_extractor - INFO - _load_data 실행완료: 3.05초
2025-10-22 10:52:12,159 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-22 10:52:12,159 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-22 10:52:12,159 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-22 10:52:12,159 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-22 10:52:12,159 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-22 10:52:12,159 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-22 10:52:12,159 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-22 10:52:12,159 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-22 10:52:12,159 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-22 10:52:12,159 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-22 10:52:12,159 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-22 10:52:12,159 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-22 10:52:12,231 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.69:8000
2025-10-22 10:52:12,231 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-22 14:03:03,268 - __main__ - INFO - 🔧 --storage 옵션: local
2025-10-22 14:03:03,268 - __main__ - INFO - 🔧 환경변수 DAG_STORAGE_MODE 설정: local
2025-10-22 14:03:03,268 - __main__ - INFO - 📁 DAG 저장 모드: local - API server provides images (URL: API server IP)
2025-10-22 14:03:03,268 - __main__ - INFO - 📂 DAG 저장 경로: dag_images
2025-10-22 14:03:03,268 - __main__ - INFO - 🌐 로컬 서버 URL: http://172.23.112.69:8000
2025-10-22 14:03:03,268 - __main__ - INFO - CLI 데이터 소스 설정: local
2025-10-22 14:03:03,268 - __main__ - INFO - 전역 추출기 초기화 중...
2025-10-22 14:03:03,268 - __main__ - INFO - 데이터 소스로 전역 추출기 초기화 중: local
2025-10-22 14:03:03,268 - mms_extractor - INFO - 🚀 MMSExtractor 초기화 시작
2025-10-22 14:03:03,268 - mms_extractor - INFO - ⚙️ 기본 설정 적용 중...
2025-10-22 14:03:03,268 - mms_extractor - INFO - 📋 표준 추출 모드 (DAG 비활성화)
2025-10-22 14:03:03,268 - mms_extractor - INFO - 🔑 환경변수 로드 중...
2025-10-22 14:03:03,277 - mms_extractor - INFO - 💻 디바이스 설정 중...
2025-10-22 14:03:03,310 - mms_extractor - INFO - Using device: mps
2025-10-22 14:03:03,310 - utils - INFO - _initialize_device 실행완료: 0.03초
2025-10-22 14:03:03,310 - mms_extractor - INFO - 🤖 LLM 모델 초기화 중...
2025-10-22 14:03:03,311 - mms_extractor - INFO - LLM 초기화 완료: ax (skt/ax4)
2025-10-22 14:03:03,311 - utils - INFO - _initialize_llm 실행완료: 0.00초
2025-10-22 14:03:03,311 - mms_extractor - INFO - 🧠 임베딩 모델 로드 중...
2025-10-22 14:03:03,311 - utils - INFO - Loading model from ./models/ko-sbert-nli...
2025-10-22 14:03:03,311 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-10-22 14:03:03,311 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: ./models/ko-sbert-nli
2025-10-22 14:03:03,904 - utils - INFO - Model loaded on mps
2025-10-22 14:03:03,904 - utils - INFO - _initialize_embedding_model 실행완료: 0.59초
2025-10-22 14:03:03,904 - mms_extractor - INFO - 📝 NLP 도구 (Kiwi) 초기화 중...
2025-10-22 14:03:04,585 - mms_extractor - INFO - Kiwi 형태소 분석기 초기화 완료
2025-10-22 14:03:04,585 - utils - INFO - _initialize_kiwi 실행완료: 0.68초
2025-10-22 14:03:04,586 - mms_extractor - INFO - 📁 데이터 로드 중...
2025-10-22 14:03:04,586 - mms_extractor - INFO - ============================================================
2025-10-22 14:03:04,586 - mms_extractor - INFO - 📊 데이터 로딩 시작
2025-10-22 14:03:04,586 - mms_extractor - INFO - ============================================================
2025-10-22 14:03:04,586 - mms_extractor - INFO - 데이터 소스 모드: local
2025-10-22 14:03:04,586 - mms_extractor - INFO - 1️⃣ 상품 정보 로드 중...
2025-10-22 14:03:04,586 - mms_extractor - INFO - === 상품 정보 로드 시작 (모드: local) ===
2025-10-22 14:03:04,586 - mms_extractor - INFO - 로컬 CSV 파일에서 상품 정보 로드 중...
2025-10-22 14:03:04,586 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-22 14:03:04,753 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 데이터 크기: (16316, 9)
2025-10-22 14:03:04,754 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-22 14:03:04,754 - mms_extractor - INFO - 컬럼 매핑: {'ITEM_NM': 'item_nm', 'ITEM_ID': 'item_id', 'ITEM_DESC': 'item_desc', 'ITEM_DMN': 'item_dmn', 'ITEM_ALS': 'item_nm_alias'}
2025-10-22 14:03:04,761 - mms_extractor - INFO - 중복 제거 후 데이터 크기: (16316, 5)
2025-10-22 14:03:04,762 - mms_extractor - INFO - item_nm_alias에서 16316개 null 값을 item_nm으로 채웁니다.
2025-10-22 14:03:04,762 - mms_extractor - INFO - 로컬 모드 최종 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 14:03:04,763 - mms_extractor - INFO - item_nm_alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 14:03:04,763 - mms_extractor - INFO - 로컬 모드 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70', '뉴스콤 관제30', '구축-Smart PayHub']
2025-10-22 14:03:04,763 - mms_extractor - INFO - 로컬 모드 데이터 샘플 (5개 행):
2025-10-22 14:03:04,767 - mms_extractor - INFO - [{'item_nm': '우주패스 Netflix 인증', 'item_id': 'NA00008735', 'item_desc': '우주패스 Netflix 인증&&T 우주패스 Netflix를 인증하면 가입되는 더미코드&&', 'item_dmn': 'P', 'item_nm_alias': '우주패스 Netflix 인증', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008735', 'oper_dt_hms': '20250101000000'}, {'item_nm': 'LTE-M10(24년_간선망)', 'item_id': 'NA00008782', 'item_desc': 'LTE-M10(24년_간선망)&&ㅇ 한전 AMI 간선망용 무선모뎀 사업수주에 따른 신규 전용상품(요금제) 출시   - 수주일자 : 4/3  - 수량 : 13,656대 (Cat.1 모뎀)  - 상품명 : LTE-M10(24년_한전 간선망)  - 제안요금 : 711원(Vat별도)     > “LTE-M 10 요금제” + “기업데이터 청구” 형태       >  총91MB 제공  - 부가서비스 상품명 : 한전_부가_PGW#37    > UUT 211 적용&&', 'item_dmn': 'P', 'item_nm_alias': 'LTE-M10(24년_간선망)', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00008782', 'oper_dt_hms': '20250101000000'}, {'item_nm': '유선대체 70', 'item_id': 'NA00005883', 'item_desc': '유선대체 70&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건&&ㅇ 기본료 : 7,000원 (VAT포함 7,700원)_ㅇ 기본제공 : 데이터 120MB_ㅇ 특징_  - 월 제공 데이터 소진 후 30kbps로 속도 제어된 상태에서 사용하는 Data는 비과금 처리(월 기본료를 제외한 추가과금 없음)_  - 유선대체 요금제는 당사가 지정하는 012번호의 사물통신형 단말중에서 고정형결제기만 가입가능(단말 리스트 별도관리)_ㅇ 초과요율_  - Data : 월 제공 Data 소진 이후, 30Kbps로 속도 제어된 상태로 사용하는 Data는 비과금 처리(기본료를 초과하여 과금하지 않음)_  - 문자 : SMS 22원/건, 텍스트형MMS 33원/건, 멀티미디어형MMS 110원/건', 'item_dmn': 'P', 'item_nm_alias': '유선대체 70', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NA00005883', 'oper_dt_hms': '20250101000000'}, {'item_nm': '뉴스콤 관제30', 'item_id': 'NB00000764', 'item_desc': '뉴스콤 관제30&&고객사의 메인망은 초고속인터넷이고 백업망으로 당사의 이동통신망을 이용하는 무선라우터를 공급하는 경우, 원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off/ 원격조치 불가능시 출동후 장애 조치 서비스&&원격에서 무선라우터에 연결된 LTE망 장애여부 확인 / 원격 On-Off / 원격조치 불가능시 출동후 장애 조치 서비스', 'item_dmn': 'P', 'item_nm_alias': '뉴스콤 관제30', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'NB00000764', 'oper_dt_hms': '20250101000000'}, {'item_nm': '구축-Smart PayHub', 'item_id': 'PD00013310', 'item_desc': '구축-Smart PayHub&&&&', 'item_dmn': 'P', 'item_nm_alias': '구축-Smart PayHub', 'item_ctg': None, 'item_emb_vec': None, 'ofer_cd': 'PD00013310', 'oper_dt_hms': '20250101000000'}]
2025-10-22 14:03:04,771 - mms_extractor - INFO - 도메인 필터링: 16316 -> 10551 (제외된 도메인: ['R'])
2025-10-22 14:03:04,771 - mms_extractor - INFO - === 상품 정보 로드 최종 완료: 10551개 상품 ===
2025-10-22 14:03:04,771 - mms_extractor - INFO - 최종 데이터 스키마: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 14:03:04,771 - mms_extractor - INFO - 최종 데이터 타입: {'item_nm': dtype('O'), 'item_id': dtype('O'), 'item_desc': dtype('O'), 'item_dmn': dtype('O'), 'item_nm_alias': dtype('O'), 'item_ctg': dtype('O'), 'item_emb_vec': dtype('O'), 'ofer_cd': dtype('O'), 'oper_dt_hms': dtype('O')}
2025-10-22 14:03:04,771 - mms_extractor - INFO - 모든 중요 컬럼이 존재합니다.
2025-10-22 14:03:04,772 - mms_extractor - INFO - 상품 정보 로드 후 데이터 크기: (10551, 9)
2025-10-22 14:03:04,772 - mms_extractor - INFO - 상품 정보 컬럼들: ['item_nm', 'item_id', 'item_desc', 'item_dmn', 'item_nm_alias', 'item_ctg', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 14:03:04,772 - mms_extractor - INFO - 2️⃣ 별칭 규칙 적용 중...
2025-10-22 14:03:04,772 - mms_extractor - INFO - === 별칭 규칙 적용 시작 ===
2025-10-22 14:03:04,772 - mms_extractor - INFO - 별칭 규칙 적용 전 상품 데이터 크기: (10551, 9)
2025-10-22 14:03:04,775 - mms_extractor - INFO - 로드된 별칭 규칙 수: 168개
2025-10-22 14:03:04,775 - mms_extractor - INFO - null이 아닌 상품명 수: 10393개
2025-10-22 14:03:04,775 - mms_extractor - INFO - 별칭 적용 전 상품명 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 14:03:04,776 - mms_extractor - INFO - 기존 item_nm_alias 데이터를 발견했습니다. 별칭 규칙과 병합합니다.
2025-10-22 14:03:04,776 - mms_extractor - INFO - 기존 alias 샘플: ['우주패스 Netflix 인증', 'LTE-M10(24년_간선망)', '유선대체 70']
2025-10-22 14:03:05,004 - mms_extractor - INFO - 기존 ITEM_ALS 데이터와 별칭 규칙이 성공적으로 병합되었습니다.
2025-10-22 14:03:05,013 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: 10551 -> 22608
2025-10-22 14:03:05,014 - mms_extractor - INFO - 별칭 적용 후 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-10-22 14:03:05,014 - mms_extractor - INFO - 별칭 규칙 적용 완료: 168개 규칙
2025-10-22 14:03:05,015 - mms_extractor - INFO - 별칭 규칙 적용 후 데이터 크기: (22608, 9)
2025-10-22 14:03:05,015 - mms_extractor - INFO - 3️⃣ 정지어 로드 중...
2025-10-22 14:03:05,015 - mms_extractor - INFO - 정지어 로드 완료: 176개
2025-10-22 14:03:05,016 - mms_extractor - INFO - 로드된 정지어 수: 176개
2025-10-22 14:03:05,016 - mms_extractor - INFO - 4️⃣ Kiwi에 상품명 등록 중...
2025-10-22 14:03:05,016 - mms_extractor - INFO - === Kiwi에 상품명 등록 시작 ===
2025-10-22 14:03:05,017 - mms_extractor - INFO - 등록할 고유 별칭 수: 17022개
2025-10-22 14:03:05,018 - mms_extractor - INFO - 유효한 별칭 수: 17021개
2025-10-22 14:03:05,018 - mms_extractor - INFO - 등록할 별칭 샘플: ['우주패스 넷플릭스 인증', '우주패스 Netflix 인증', '우주Pass Netflix 인증', '우주PASS Netflix 인증', '우주pass Netflix 인증']
2025-10-22 14:03:05,041 - mms_extractor - INFO - Kiwi에 상품명 등록 완료: 17021개 성공, 0개 실패
2025-10-22 14:03:05,041 - mms_extractor - INFO - 5️⃣ 프로그램 분류 정보 로드 중...
2025-10-22 14:03:05,041 - mms_extractor - INFO - 프로그램 분류 정보 로딩 시작...
2025-10-22 14:03:05,045 - mms_extractor - INFO - 로컬 파일에서 프로그램 정보 로드: 25개
2025-10-22 14:03:05,045 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 시작...
2025-10-22 14:03:05,675 - mms_extractor - INFO - 프로그램 분류 임베딩 생성 완료: 25개 프로그램
2025-10-22 14:03:05,676 - mms_extractor - INFO - 프로그램 분류 정보 로드 후 데이터 크기: (25, 6)
2025-10-22 14:03:05,676 - mms_extractor - INFO - 6️⃣ 조직 정보 로드 중...
2025-10-22 14:03:05,676 - mms_extractor - INFO - === 조직 정보 로드 시작 (모드: local) ===
2025-10-22 14:03:05,676 - mms_extractor - INFO - 로컬 CSV 파일에서 조직 정보 로드 중...
2025-10-22 14:03:05,676 - mms_extractor - INFO - CSV 파일 경로: ./data/offer_master_data.csv
2025-10-22 14:03:05,944 - mms_extractor - INFO - 로컬 CSV에서 로드된 원본 조직 데이터 크기: (16316, 9)
2025-10-22 14:03:05,944 - mms_extractor - INFO - 로컬 CSV 원본 컬럼들: ['ITEM_ID', 'ITEM_NM', 'ITEM_DMN', 'ITEM_DESC', 'ITEM_CTG', 'ITEM_ALS', 'ITEM_EMB_VEC', 'OFER_CD', 'OPER_DT_HMS']
2025-10-22 14:03:05,948 - mms_extractor - INFO - 로컬 모드: ITEM_DMN='R' 필터링 후 데이터 크기: (5765, 9)
2025-10-22 14:03:05,948 - mms_extractor - INFO - 조직 데이터 샘플 (3개 행): [{'item_id': 'D15198_0020', 'item_nm': '가로수대리점 하늘도시점', 'item_dmn': 'R', 'item_desc': '인천 중구 하늘중앙로195번길 11,&&1층 105호(중산동)&&003202309011', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541517', 'oper_dt_hms': 20250909151123}, {'item_id': 'D13622_0398', 'item_nm': 'MD대리점 주엽직영점', 'item_dmn': 'R', 'item_desc': '경기 고양시 일산서구 중앙로 1426,&&(주엽동) 1층111호&&003109152662', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430541945', 'oper_dt_hms': 20250909151123}, {'item_id': 'D15320_0001', 'item_nm': '강서대리점(온라인매장)', 'item_dmn': 'R', 'item_desc': '서울 양천구 남부순환로 354,&&1층 (신월동)&&007078567800', 'item_ctg': '501', 'item_als': nan, 'item_emb_vec': nan, 'ofer_cd': '1430542104', 'oper_dt_hms': 20250909151123}]
2025-10-22 14:03:05,948 - mms_extractor - INFO - === 조직 정보 로드 최종 완료: 5765개 조직 ===
2025-10-22 14:03:05,948 - mms_extractor - INFO - 최종 조직 데이터 스키마: ['item_id', 'item_nm', 'item_dmn', 'item_desc', 'item_ctg', 'item_als', 'item_emb_vec', 'ofer_cd', 'oper_dt_hms']
2025-10-22 14:03:05,948 - mms_extractor - INFO - 모든 중요 조직 컬럼이 정상적으로 로드되었습니다.
2025-10-22 14:03:05,949 - mms_extractor - INFO - 조직 정보 로드 후 데이터 크기: (5765, 9)
2025-10-22 14:03:05,949 - mms_extractor - INFO - ============================================================
2025-10-22 14:03:05,949 - mms_extractor - INFO - 📋 데이터 로딩 완료 - 최종 상태 요약
2025-10-22 14:03:05,949 - mms_extractor - INFO - ============================================================
2025-10-22 14:03:05,949 - mms_extractor - INFO - ✅ 상품 데이터: (22608, 9)
2025-10-22 14:03:05,949 - mms_extractor - INFO - ✅ 프로그램 데이터: (25, 6)
2025-10-22 14:03:05,949 - mms_extractor - INFO - ✅ 조직 데이터: (5765, 9)
2025-10-22 14:03:05,949 - mms_extractor - INFO - ✅ 정지어: 176개
2025-10-22 14:03:05,949 - mms_extractor - INFO - === 상품 데이터 상세 정보 ===
2025-10-22 14:03:05,950 - mms_extractor - INFO - 고유 상품명 수: 6586개
2025-10-22 14:03:05,952 - mms_extractor - INFO - 고유 별칭 수: 17021개
2025-10-22 14:03:05,955 - mms_extractor - INFO - 고유 상품ID 수: 10551개
2025-10-22 14:03:05,955 - utils - INFO - _load_data 실행완료: 1.37초
2025-10-22 14:03:05,955 - mms_extractor - INFO - ✅ MMSExtractor 초기화 완료
2025-10-22 14:03:05,955 - __main__ - INFO - 전역 추출기 초기화 완료
2025-10-22 14:03:05,955 - __main__ - INFO - 파싱된 인자: host=0.0.0.0, port=8000, debug=False
2025-10-22 14:03:05,955 - __main__ - INFO - ✅ 전역 추출기 초기화 완료, 요청 처리 준비됨
2025-10-22 14:03:05,955 - __main__ - INFO - MMS 추출기 API 서버를 0.0.0.0:8000에서 시작합니다
2025-10-22 14:03:05,955 - __main__ - INFO - 사용 가능한 엔드포인트:
2025-10-22 14:03:05,955 - __main__ - INFO -   GET  /health - 헬스체크
2025-10-22 14:03:05,955 - __main__ - INFO -   GET  /models - 사용 가능한 모델 목록
2025-10-22 14:03:05,955 - __main__ - INFO -   GET  /status - 서버 상태 조회
2025-10-22 14:03:05,955 - __main__ - INFO -   POST /extract - 단일 메시지 추출
2025-10-22 14:03:05,955 - __main__ - INFO -   POST /extract/batch - 다중 메시지 배치 추출
2025-10-22 14:03:05,955 - __main__ - INFO -   POST /dag - Entity DAG 추출
2025-10-22 14:03:06,211 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://172.23.112.69:8000
2025-10-22 14:03:06,212 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-22 14:04:21,409 - werkzeug - INFO - 127.0.0.1 - - [22/Oct/2025 14:04:21] "GET /health HTTP/1.1" 200 -
2025-10-22 14:04:26,247 - werkzeug - INFO - 127.0.0.1 - - [22/Oct/2025 14:04:26] "GET /health HTTP/1.1" 200 -
