# Detail URL ìº¡ì²˜ ê°œì„  ë‚´ì—­

## ğŸ” ë¬¸ì œ ìƒí™©

**ì´ˆê¸° ê²°ê³¼**: 187ê°œ ìƒí’ˆ ì¤‘ **2ê°œë§Œ ì„±ê³µ** (1% ì„±ê³µë¥ )

```
âœ… 2/187ê°œ ìƒí’ˆì˜ detail_url ìº¡ì²˜ ì™„ë£Œ
detail_url í†µê³„: 3/187ê°œ ìƒí’ˆì— URL ìˆìŒ
```

## ğŸ¯ ì‹¤íŒ¨ ì›ì¸ ë¶„ì„

### 1. **Viewport ë¬¸ì œ**
- `is_visible(timeout=1000)` ì²´í¬ê°€ ë„ˆë¬´ ì—„ê²©
- í™”ë©´ì— ë³´ì´ì§€ ì•ŠëŠ” ìš”ì†ŒëŠ” ëª¨ë‘ ì‹¤íŒ¨
- ë¬´í•œ ìŠ¤í¬ë¡¤ë¡œ ë¡œë“œëœ 187ê°œ ìƒí’ˆì„ ëª¨ë‘ viewportì— í‘œì‹œí•  ìˆ˜ ì—†ìŒ

### 2. **Selector ì¡°ê±´ì´ ë„ˆë¬´ êµ¬ì²´ì **
```python
# ì›ë˜ ì½”ë“œ (ë„ˆë¬´ ì—„ê²©)
link_selector = f'a.inner-link[prdid="{prd_id}"][godetailyn="Y"]'
```
- `godetailyn="Y"` ì†ì„±ì´ ì—†ëŠ” ìƒí’ˆì€ ëª¨ë‘ ì œì™¸ë¨
- ì¼ë¶€ ìƒí’ˆë§Œ ì´ ì†ì„±ì„ ê°€ì§

### 3. **íƒ€ì„ì•„ì›ƒ ë¶€ì¡±**
- ìš”ì†Œ ì°¾ê¸°: 1000ms (ë„ˆë¬´ ì§§ìŒ)
- í˜ì´ì§€ ì´ë™ ëŒ€ê¸°: 3000ms (ë¶€ì¡±í•  ìˆ˜ ìˆìŒ)

## âœ… ê°œì„  ì‚¬í•­

### 1. **ë‹¤ì¤‘ Selector íŒ¨í„´** (ìš°ì„ ìˆœìœ„ ìˆœ)
```python
selectors = [
    f'a.inner-link[prdid="{prd_id}"][godetailyn="Y"]',  # ì›ë˜ ì¡°ê±´
    f'a.inner-link[prdid="{prd_id}"]',                  # godetailyn ì—†ì–´ë„ OK
    f'a[prdid="{prd_id}"]',                            # inner-link ì—†ì–´ë„ OK
]
```

### 2. **Viewport ìŠ¤í¬ë¡¤ ìë™í™”**
```python
# ìš”ì†Œë¡œ ìŠ¤í¬ë¡¤í•´ì„œ í™”ë©´ì— í‘œì‹œ
link.scroll_into_view_if_needed(timeout=2000)
page.wait_for_timeout(300)
```

### 3. **ê´€ëŒ€í•œ ì¡´ì¬ ì—¬ë¶€ ì²´í¬**
```python
# is_visible() ëŒ€ì‹  count() ì‚¬ìš©
if page.locator(selector).count() > 0:
    # ìš”ì†Œê°€ DOMì— ì¡´ì¬í•˜ë©´ OK (ë³´ì´ì§€ ì•Šì•„ë„)
```

### 4. **ê°•ì œ í´ë¦­ ë©”ì»¤ë‹ˆì¦˜**
```python
try:
    link.click(timeout=3000)
except:
    # Playwright í´ë¦­ ì‹¤íŒ¨ ì‹œ JavaScript ê°•ì œ í´ë¦­
    page.evaluate(f'document.querySelector("{selector}").click()')
```

### 5. **íƒ€ì„ì•„ì›ƒ ì¦ê°€**
- ìš”ì†Œ ì°¾ê¸°: 1000ms â†’ **2000ms**
- í˜ì´ì§€ ì´ë™ ëŒ€ê¸°: 3000ms â†’ **5000ms**
- URL ë³€ê²½ ëŒ€ê¸°: 1000ms â†’ **1500ms**

### 6. **ì—ëŸ¬ ë³µêµ¬ ê°•í™”**
```python
try:
    page.go_back()
    page.wait_for_timeout(500)
except:
    # ë’¤ë¡œê°€ê¸° ì‹¤íŒ¨ ì‹œ ëª©ë¡ í˜ì´ì§€ ì¬ì ‘ì†
    page.goto(url, wait_until='networkidle', timeout=30000)
```

### 7. **ì‹¤íŒ¨ ì›ì¸ ì¶”ì  ë° ì¶œë ¥**
```python
failed_reasons = {
    'not_found': 0,        # ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
    'click_failed': 0,     # í´ë¦­ ì‹¤íŒ¨
    'url_not_changed': 0,  # URL ë³€ê²½ ì•ˆë¨
    'TimeoutError': 0,     # íƒ€ì„ì•„ì›ƒ
    # ... ê¸°íƒ€ ì˜ˆì™¸ íƒ€ì…
}
```

ì¶œë ¥ ì˜ˆì‹œ:
```
  âœ… 150/187ê°œ ìƒí’ˆì˜ detail_url ìº¡ì²˜ ì™„ë£Œ
  âŒ ì‹¤íŒ¨ ì›ì¸ ë¶„ì„:
     - not_found: 25ê°œ
     - url_not_changed: 10ê°œ
     - click_failed: 2ê°œ
```

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

| ê°œì„  ì „ | ê°œì„  í›„ (ì˜ˆìƒ) |
|---------|---------------|
| 2/187ê°œ (1%) | **150+/187ê°œ (80%+)** |

## ğŸš€ í…ŒìŠ¤íŠ¸ ë°©ë²•

```bash
cd /Users/yongwook/workspace/AgenticWorkflow/info_builder
source ../venv/bin/activate
python test_crawl_details.py
```

## ğŸ’¡ ì¶”ê°€ ê°œì„  ì•„ì´ë””ì–´ (í•„ìš”ì‹œ)

1. **ë³‘ë ¬ ì²˜ë¦¬**: ì—¬ëŸ¬ ë¸Œë¼ìš°ì € íƒ­ì—ì„œ ë™ì‹œì— URL ìº¡ì²˜
2. **ìºì‹±**: í•œ ë²ˆ ìº¡ì²˜í•œ URLì€ ì €ì¥í•´ë‘ê³  ì¬ì‚¬ìš©
3. **ìƒ˜í”Œë§**: ì „ì²´ê°€ ì•„ë‹Œ ì¼ë¶€ë§Œ ìº¡ì²˜ (ì‹œê°„ ë‹¨ì¶•)
4. **íŒ¨í„´ í•™ìŠµ**: ì„±ê³µí•œ URL íŒ¨í„´ì„ ë¶„ì„í•´ì„œ ë‚˜ë¨¸ì§€ IDë¡œ URL ìƒì„±

